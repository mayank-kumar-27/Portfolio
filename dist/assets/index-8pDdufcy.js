var wX=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var kwe=wX((zwe,Pj)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function TB(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var CB={exports:{}},rw={},AB={exports:{}},hn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv=Symbol.for("react.element"),bX=Symbol.for("react.portal"),SX=Symbol.for("react.fragment"),EX=Symbol.for("react.strict_mode"),MX=Symbol.for("react.profiler"),TX=Symbol.for("react.provider"),CX=Symbol.for("react.context"),AX=Symbol.for("react.forward_ref"),RX=Symbol.for("react.suspense"),PX=Symbol.for("react.memo"),IX=Symbol.for("react.lazy"),VD=Symbol.iterator;function DX(n){return n===null||typeof n!="object"?null:(n=VD&&n[VD]||n["@@iterator"],typeof n=="function"?n:null)}var RB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PB=Object.assign,IB={};function um(n,e,t){this.props=n,this.context=e,this.refs=IB,this.updater=t||RB}um.prototype.isReactComponent={};um.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};um.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function DB(){}DB.prototype=um.prototype;function dA(n,e,t){this.props=n,this.context=e,this.refs=IB,this.updater=t||RB}var pA=dA.prototype=new DB;pA.constructor=dA;PB(pA,um.prototype);pA.isPureReactComponent=!0;var WD=Array.isArray,NB=Object.prototype.hasOwnProperty,mA={current:null},kB={key:!0,ref:!0,__self:!0,__source:!0};function LB(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)NB.call(e,r)&&!kB.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Iv,type:n,key:s,ref:o,props:i,_owner:mA.current}}function NX(n,e){return{$$typeof:Iv,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function gA(n){return typeof n=="object"&&n!==null&&n.$$typeof===Iv}function kX(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var HD=/\/+/g;function CS(n,e){return typeof n=="object"&&n!==null&&n.key!=null?kX(""+n.key):e.toString(36)}function Qx(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Iv:case bX:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+CS(o,0):r,WD(i)?(t="",n!=null&&(t=n.replace(HD,"$&/")+"/"),Qx(i,e,t,"",function(u){return u})):i!=null&&(gA(i)&&(i=NX(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(HD,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",WD(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+CS(s,a);o+=Qx(s,e,t,l,i)}else if(l=DX(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+CS(s,a++),o+=Qx(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function o1(n,e,t){if(n==null)return n;var r=[],i=0;return Qx(n,r,"","",function(s){return e.call(t,s,i++)}),r}function LX(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Cs={current:null},e2={transition:null},FX={ReactCurrentDispatcher:Cs,ReactCurrentBatchConfig:e2,ReactCurrentOwner:mA};function FB(){throw Error("act(...) is not supported in production builds of React.")}hn.Children={map:o1,forEach:function(n,e,t){o1(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return o1(n,function(){e++}),e},toArray:function(n){return o1(n,function(e){return e})||[]},only:function(n){if(!gA(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};hn.Component=um;hn.Fragment=SX;hn.Profiler=MX;hn.PureComponent=dA;hn.StrictMode=EX;hn.Suspense=RX;hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FX;hn.act=FB;hn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=PB({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=mA.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)NB.call(e,l)&&!kB.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Iv,type:n.type,key:i,ref:s,props:r,_owner:o}};hn.createContext=function(n){return n={$$typeof:CX,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:TX,_context:n},n.Consumer=n};hn.createElement=LB;hn.createFactory=function(n){var e=LB.bind(null,n);return e.type=n,e};hn.createRef=function(){return{current:null}};hn.forwardRef=function(n){return{$$typeof:AX,render:n}};hn.isValidElement=gA;hn.lazy=function(n){return{$$typeof:IX,_payload:{_status:-1,_result:n},_init:LX}};hn.memo=function(n,e){return{$$typeof:PX,type:n,compare:e===void 0?null:e}};hn.startTransition=function(n){var e=e2.transition;e2.transition={};try{n()}finally{e2.transition=e}};hn.unstable_act=FB;hn.useCallback=function(n,e){return Cs.current.useCallback(n,e)};hn.useContext=function(n){return Cs.current.useContext(n)};hn.useDebugValue=function(){};hn.useDeferredValue=function(n){return Cs.current.useDeferredValue(n)};hn.useEffect=function(n,e){return Cs.current.useEffect(n,e)};hn.useId=function(){return Cs.current.useId()};hn.useImperativeHandle=function(n,e,t){return Cs.current.useImperativeHandle(n,e,t)};hn.useInsertionEffect=function(n,e){return Cs.current.useInsertionEffect(n,e)};hn.useLayoutEffect=function(n,e){return Cs.current.useLayoutEffect(n,e)};hn.useMemo=function(n,e){return Cs.current.useMemo(n,e)};hn.useReducer=function(n,e,t){return Cs.current.useReducer(n,e,t)};hn.useRef=function(n){return Cs.current.useRef(n)};hn.useState=function(n){return Cs.current.useState(n)};hn.useSyncExternalStore=function(n,e,t){return Cs.current.useSyncExternalStore(n,e,t)};hn.useTransition=function(){return Cs.current.useTransition()};hn.version="18.3.1";AB.exports=hn;var U=AB.exports;const OB=TB(U);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OX=U,BX=Symbol.for("react.element"),UX=Symbol.for("react.fragment"),zX=Object.prototype.hasOwnProperty,VX=OX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WX={key:!0,ref:!0,__self:!0,__source:!0};function BB(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)zX.call(e,r)&&!WX.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:BX,type:n,key:s,ref:o,props:i,_owner:VX.current}}rw.Fragment=UX;rw.jsx=BB;rw.jsxs=BB;CB.exports=rw;var z=CB.exports,UB={exports:{}},No={},zB={exports:{}},VB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(N,B){var D=N.length;N.push(B);e:for(;0<D;){var $=D-1>>>1,ee=N[$];if(0<i(ee,B))N[$]=B,N[D]=ee,D=$;else break e}}function t(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var B=N[0],D=N.pop();if(D!==B){N[0]=D;e:for(var $=0,ee=N.length,te=ee>>>1;$<te;){var se=2*($+1)-1,me=N[se],_e=se+1,pe=N[_e];if(0>i(me,D))_e<ee&&0>i(pe,me)?(N[$]=pe,N[_e]=D,$=_e):(N[$]=me,N[se]=D,$=se);else if(_e<ee&&0>i(pe,D))N[$]=pe,N[_e]=D,$=_e;else break e}}return B}function i(N,B){var D=N.sortIndex-B.sortIndex;return D!==0?D:N.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,d=!1,p=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var B=t(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=N)r(u),B.sortIndex=B.expirationTime,e(l,B);else break;B=t(u)}}function b(N){if(y=!1,w(N),!p)if(t(l)!==null)p=!0,W(S);else{var B=t(u);B!==null&&G(b,B.startTime-N)}}function S(N,B){p=!1,y&&(y=!1,m(P),P=-1),d=!0;var D=h;try{for(w(B),f=t(l);f!==null&&(!(f.expirationTime>B)||N&&!k());){var $=f.callback;if(typeof $=="function"){f.callback=null,h=f.priorityLevel;var ee=$(f.expirationTime<=B);B=n.unstable_now(),typeof ee=="function"?f.callback=ee:f===t(l)&&r(l),w(B)}else r(l);f=t(l)}if(f!==null)var te=!0;else{var se=t(u);se!==null&&G(b,se.startTime-B),te=!1}return te}finally{f=null,h=D,d=!1}}var M=!1,T=null,P=-1,C=5,A=-1;function k(){return!(n.unstable_now()-A<C)}function L(){if(T!==null){var N=n.unstable_now();A=N;var B=!0;try{B=T(!0,N)}finally{B?H():(M=!1,T=null)}}else M=!1}var H;if(typeof _=="function")H=function(){_(L)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=L,H=function(){V.postMessage(null)}}else H=function(){x(L,0)};function W(N){T=N,M||(M=!0,H())}function G(N,B){P=x(function(){N(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(N){N.callback=null},n.unstable_continueExecution=function(){p||d||(p=!0,W(S))},n.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<N?Math.floor(1e3/N):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(N){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var D=h;h=B;try{return N()}finally{h=D}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var D=h;h=N;try{return B()}finally{h=D}},n.unstable_scheduleCallback=function(N,B,D){var $=n.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?$+D:$):D=$,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=D+ee,N={id:c++,callback:B,priorityLevel:N,startTime:D,expirationTime:ee,sortIndex:-1},D>$?(N.sortIndex=D,e(u,N),t(l)===null&&N===t(u)&&(y?(m(P),P=-1):y=!0,G(b,D-$))):(N.sortIndex=ee,e(l,N),p||d||(p=!0,W(S))),N},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(N){var B=h;return function(){var D=h;h=B;try{return N.apply(this,arguments)}finally{h=D}}}})(VB);zB.exports=VB;var HX=zB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GX=U,Po=HX;function Xe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var WB=new Set,bg={};function Rh(n,e){Up(n,e),Up(n+"Capture",e)}function Up(n,e){for(bg[n]=e,n=0;n<e.length;n++)WB.add(e[n])}var uu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oM=Object.prototype.hasOwnProperty,jX=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,GD={},jD={};function XX(n){return oM.call(jD,n)?!0:oM.call(GD,n)?!1:jX.test(n)?jD[n]=!0:(GD[n]=!0,!1)}function $X(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function qX(n,e,t,r){if(e===null||typeof e>"u"||$X(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function As(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ui={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ui[n]=new As(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ui[e]=new As(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ui[n]=new As(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ui[n]=new As(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ui[n]=new As(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ui[n]=new As(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ui[n]=new As(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ui[n]=new As(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ui[n]=new As(n,5,!1,n.toLowerCase(),null,!1,!1)});var vA=/[\-:]([a-z])/g;function yA(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(vA,yA);Ui[e]=new As(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(vA,yA);Ui[e]=new As(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(vA,yA);Ui[e]=new As(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ui[n]=new As(n,1,!1,n.toLowerCase(),null,!1,!1)});Ui.xlinkHref=new As("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ui[n]=new As(n,1,!1,n.toLowerCase(),null,!0,!0)});function xA(n,e,t,r){var i=Ui.hasOwnProperty(e)?Ui[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qX(e,t,i,r)&&(t=null),r||i===null?XX(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var bu=GX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a1=Symbol.for("react.element"),Gd=Symbol.for("react.portal"),jd=Symbol.for("react.fragment"),_A=Symbol.for("react.strict_mode"),aM=Symbol.for("react.profiler"),HB=Symbol.for("react.provider"),GB=Symbol.for("react.context"),wA=Symbol.for("react.forward_ref"),lM=Symbol.for("react.suspense"),uM=Symbol.for("react.suspense_list"),bA=Symbol.for("react.memo"),Zu=Symbol.for("react.lazy"),jB=Symbol.for("react.offscreen"),XD=Symbol.iterator;function Xm(n){return n===null||typeof n!="object"?null:(n=XD&&n[XD]||n["@@iterator"],typeof n=="function"?n:null)}var yr=Object.assign,AS;function M0(n){if(AS===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);AS=e&&e[1]||""}return`
`+AS+n}var RS=!1;function PS(n,e){if(!n||RS)return"";RS=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{RS=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?M0(n):""}function YX(n){switch(n.tag){case 5:return M0(n.type);case 16:return M0("Lazy");case 13:return M0("Suspense");case 19:return M0("SuspenseList");case 0:case 2:case 15:return n=PS(n.type,!1),n;case 11:return n=PS(n.type.render,!1),n;case 1:return n=PS(n.type,!0),n;default:return""}}function cM(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case jd:return"Fragment";case Gd:return"Portal";case aM:return"Profiler";case _A:return"StrictMode";case lM:return"Suspense";case uM:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case GB:return(n.displayName||"Context")+".Consumer";case HB:return(n._context.displayName||"Context")+".Provider";case wA:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case bA:return e=n.displayName||null,e!==null?e:cM(n.type)||"Memo";case Zu:e=n._payload,n=n._init;try{return cM(n(e))}catch{}}return null}function KX(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cM(e);case 8:return e===_A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rc(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function XB(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZX(n){var e=XB(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function l1(n){n._valueTracker||(n._valueTracker=ZX(n))}function $B(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=XB(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function L2(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function fM(n,e){var t=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function $D(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Rc(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qB(n,e){e=e.checked,e!=null&&xA(n,"checked",e,!1)}function hM(n,e){qB(n,e);var t=Rc(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?dM(n,e.type,t):e.hasOwnProperty("defaultValue")&&dM(n,e.type,Rc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function qD(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function dM(n,e,t){(e!=="number"||L2(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var T0=Array.isArray;function vp(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Rc(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function pM(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Xe(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function YD(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Xe(92));if(T0(t)){if(1<t.length)throw Error(Xe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Rc(t)}}function YB(n,e){var t=Rc(e.value),r=Rc(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function KD(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function KB(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mM(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?KB(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var u1,ZB=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(u1=u1||document.createElement("div"),u1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=u1.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Sg(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var B0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JX=["Webkit","ms","Moz","O"];Object.keys(B0).forEach(function(n){JX.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),B0[e]=B0[n]})});function JB(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||B0.hasOwnProperty(n)&&B0[n]?(""+e).trim():e+"px"}function QB(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=JB(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var QX=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gM(n,e){if(e){if(QX[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Xe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Xe(62))}}function vM(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yM=null;function SA(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var xM=null,yp=null,xp=null;function ZD(n){if(n=kv(n)){if(typeof xM!="function")throw Error(Xe(280));var e=n.stateNode;e&&(e=lw(e),xM(n.stateNode,n.type,e))}}function eU(n){yp?xp?xp.push(n):xp=[n]:yp=n}function tU(){if(yp){var n=yp,e=xp;if(xp=yp=null,ZD(n),e)for(n=0;n<e.length;n++)ZD(e[n])}}function nU(n,e){return n(e)}function rU(){}var IS=!1;function iU(n,e,t){if(IS)return n(e,t);IS=!0;try{return nU(n,e,t)}finally{IS=!1,(yp!==null||xp!==null)&&(rU(),tU())}}function Eg(n,e){var t=n.stateNode;if(t===null)return null;var r=lw(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Xe(231,e,typeof t));return t}var _M=!1;if(uu)try{var $m={};Object.defineProperty($m,"passive",{get:function(){_M=!0}}),window.addEventListener("test",$m,$m),window.removeEventListener("test",$m,$m)}catch{_M=!1}function e$(n,e,t,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var U0=!1,F2=null,O2=!1,wM=null,t$={onError:function(n){U0=!0,F2=n}};function n$(n,e,t,r,i,s,o,a,l){U0=!1,F2=null,e$.apply(t$,arguments)}function r$(n,e,t,r,i,s,o,a,l){if(n$.apply(this,arguments),U0){if(U0){var u=F2;U0=!1,F2=null}else throw Error(Xe(198));O2||(O2=!0,wM=u)}}function Ph(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function sU(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function JD(n){if(Ph(n)!==n)throw Error(Xe(188))}function i$(n){var e=n.alternate;if(!e){if(e=Ph(n),e===null)throw Error(Xe(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return JD(i),n;if(s===r)return JD(i),e;s=s.sibling}throw Error(Xe(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(Xe(189))}}if(t.alternate!==r)throw Error(Xe(190))}if(t.tag!==3)throw Error(Xe(188));return t.stateNode.current===t?n:e}function oU(n){return n=i$(n),n!==null?aU(n):null}function aU(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=aU(n);if(e!==null)return e;n=n.sibling}return null}var lU=Po.unstable_scheduleCallback,QD=Po.unstable_cancelCallback,s$=Po.unstable_shouldYield,o$=Po.unstable_requestPaint,Lr=Po.unstable_now,a$=Po.unstable_getCurrentPriorityLevel,EA=Po.unstable_ImmediatePriority,uU=Po.unstable_UserBlockingPriority,B2=Po.unstable_NormalPriority,l$=Po.unstable_LowPriority,cU=Po.unstable_IdlePriority,iw=null,gl=null;function u$(n){if(gl&&typeof gl.onCommitFiberRoot=="function")try{gl.onCommitFiberRoot(iw,n,void 0,(n.current.flags&128)===128)}catch{}}var Da=Math.clz32?Math.clz32:h$,c$=Math.log,f$=Math.LN2;function h$(n){return n>>>=0,n===0?32:31-(c$(n)/f$|0)|0}var c1=64,f1=4194304;function C0(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function U2(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=C0(a):(s&=o,s!==0&&(r=C0(s)))}else o=t&~i,o!==0?r=C0(o):s!==0&&(r=C0(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Da(e),i=1<<t,r|=n[t],e&=~i;return r}function d$(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p$(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Da(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=d$(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function bM(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function fU(){var n=c1;return c1<<=1,!(c1&4194240)&&(c1=64),n}function DS(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Dv(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Da(e),n[e]=t}function m$(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Da(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function MA(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Da(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var On=0;function hU(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var dU,TA,pU,mU,gU,SM=!1,h1=[],hc=null,dc=null,pc=null,Mg=new Map,Tg=new Map,ec=[],g$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eN(n,e){switch(n){case"focusin":case"focusout":hc=null;break;case"dragenter":case"dragleave":dc=null;break;case"mouseover":case"mouseout":pc=null;break;case"pointerover":case"pointerout":Mg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tg.delete(e.pointerId)}}function qm(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=kv(e),e!==null&&TA(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function v$(n,e,t,r,i){switch(e){case"focusin":return hc=qm(hc,n,e,t,r,i),!0;case"dragenter":return dc=qm(dc,n,e,t,r,i),!0;case"mouseover":return pc=qm(pc,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Mg.set(s,qm(Mg.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Tg.set(s,qm(Tg.get(s)||null,n,e,t,r,i)),!0}return!1}function vU(n){var e=Uf(n.target);if(e!==null){var t=Ph(e);if(t!==null){if(e=t.tag,e===13){if(e=sU(t),e!==null){n.blockedOn=e,gU(n.priority,function(){pU(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function t2(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=EM(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);yM=r,t.target.dispatchEvent(r),yM=null}else return e=kv(t),e!==null&&TA(e),n.blockedOn=t,!1;e.shift()}return!0}function tN(n,e,t){t2(n)&&t.delete(e)}function y$(){SM=!1,hc!==null&&t2(hc)&&(hc=null),dc!==null&&t2(dc)&&(dc=null),pc!==null&&t2(pc)&&(pc=null),Mg.forEach(tN),Tg.forEach(tN)}function Ym(n,e){n.blockedOn===e&&(n.blockedOn=null,SM||(SM=!0,Po.unstable_scheduleCallback(Po.unstable_NormalPriority,y$)))}function Cg(n){function e(i){return Ym(i,n)}if(0<h1.length){Ym(h1[0],n);for(var t=1;t<h1.length;t++){var r=h1[t];r.blockedOn===n&&(r.blockedOn=null)}}for(hc!==null&&Ym(hc,n),dc!==null&&Ym(dc,n),pc!==null&&Ym(pc,n),Mg.forEach(e),Tg.forEach(e),t=0;t<ec.length;t++)r=ec[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ec.length&&(t=ec[0],t.blockedOn===null);)vU(t),t.blockedOn===null&&ec.shift()}var _p=bu.ReactCurrentBatchConfig,z2=!0;function x$(n,e,t,r){var i=On,s=_p.transition;_p.transition=null;try{On=1,CA(n,e,t,r)}finally{On=i,_p.transition=s}}function _$(n,e,t,r){var i=On,s=_p.transition;_p.transition=null;try{On=4,CA(n,e,t,r)}finally{On=i,_p.transition=s}}function CA(n,e,t,r){if(z2){var i=EM(n,e,t,r);if(i===null)WS(n,e,r,V2,t),eN(n,r);else if(v$(i,n,e,t,r))r.stopPropagation();else if(eN(n,r),e&4&&-1<g$.indexOf(n)){for(;i!==null;){var s=kv(i);if(s!==null&&dU(s),s=EM(n,e,t,r),s===null&&WS(n,e,r,V2,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else WS(n,e,r,null,t)}}var V2=null;function EM(n,e,t,r){if(V2=null,n=SA(r),n=Uf(n),n!==null)if(e=Ph(n),e===null)n=null;else if(t=e.tag,t===13){if(n=sU(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return V2=n,null}function yU(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a$()){case EA:return 1;case uU:return 4;case B2:case l$:return 16;case cU:return 536870912;default:return 16}default:return 16}}var rc=null,AA=null,n2=null;function xU(){if(n2)return n2;var n,e=AA,t=e.length,r,i="value"in rc?rc.value:rc.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return n2=i.slice(n,1<r?1-r:void 0)}function r2(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function d1(){return!0}function nN(){return!1}function ko(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?d1:nN,this.isPropagationStopped=nN,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=d1)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=d1)},persist:function(){},isPersistent:d1}),e}var cm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RA=ko(cm),Nv=yr({},cm,{view:0,detail:0}),w$=ko(Nv),NS,kS,Km,sw=yr({},Nv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:PA,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Km&&(Km&&n.type==="mousemove"?(NS=n.screenX-Km.screenX,kS=n.screenY-Km.screenY):kS=NS=0,Km=n),NS)},movementY:function(n){return"movementY"in n?n.movementY:kS}}),rN=ko(sw),b$=yr({},sw,{dataTransfer:0}),S$=ko(b$),E$=yr({},Nv,{relatedTarget:0}),LS=ko(E$),M$=yr({},cm,{animationName:0,elapsedTime:0,pseudoElement:0}),T$=ko(M$),C$=yr({},cm,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),A$=ko(C$),R$=yr({},cm,{data:0}),iN=ko(R$),P$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},D$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N$(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=D$[n])?!!e[n]:!1}function PA(){return N$}var k$=yr({},Nv,{key:function(n){if(n.key){var e=P$[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=r2(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?I$[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:PA,charCode:function(n){return n.type==="keypress"?r2(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?r2(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),L$=ko(k$),F$=yr({},sw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sN=ko(F$),O$=yr({},Nv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:PA}),B$=ko(O$),U$=yr({},cm,{propertyName:0,elapsedTime:0,pseudoElement:0}),z$=ko(U$),V$=yr({},sw,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),W$=ko(V$),H$=[9,13,27,32],IA=uu&&"CompositionEvent"in window,z0=null;uu&&"documentMode"in document&&(z0=document.documentMode);var G$=uu&&"TextEvent"in window&&!z0,_U=uu&&(!IA||z0&&8<z0&&11>=z0),oN=" ",aN=!1;function wU(n,e){switch(n){case"keyup":return H$.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bU(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xd=!1;function j$(n,e){switch(n){case"compositionend":return bU(e);case"keypress":return e.which!==32?null:(aN=!0,oN);case"textInput":return n=e.data,n===oN&&aN?null:n;default:return null}}function X$(n,e){if(Xd)return n==="compositionend"||!IA&&wU(n,e)?(n=xU(),n2=AA=rc=null,Xd=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _U&&e.locale!=="ko"?null:e.data;default:return null}}var $$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lN(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!$$[n.type]:e==="textarea"}function SU(n,e,t,r){eU(r),e=W2(e,"onChange"),0<e.length&&(t=new RA("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var V0=null,Ag=null;function q$(n){kU(n,0)}function ow(n){var e=Yd(n);if($B(e))return n}function Y$(n,e){if(n==="change")return e}var EU=!1;if(uu){var FS;if(uu){var OS="oninput"in document;if(!OS){var uN=document.createElement("div");uN.setAttribute("oninput","return;"),OS=typeof uN.oninput=="function"}FS=OS}else FS=!1;EU=FS&&(!document.documentMode||9<document.documentMode)}function cN(){V0&&(V0.detachEvent("onpropertychange",MU),Ag=V0=null)}function MU(n){if(n.propertyName==="value"&&ow(Ag)){var e=[];SU(e,Ag,n,SA(n)),iU(q$,e)}}function K$(n,e,t){n==="focusin"?(cN(),V0=e,Ag=t,V0.attachEvent("onpropertychange",MU)):n==="focusout"&&cN()}function Z$(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ow(Ag)}function J$(n,e){if(n==="click")return ow(e)}function Q$(n,e){if(n==="input"||n==="change")return ow(e)}function eq(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Fa=typeof Object.is=="function"?Object.is:eq;function Rg(n,e){if(Fa(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!oM.call(e,i)||!Fa(n[i],e[i]))return!1}return!0}function fN(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function hN(n,e){var t=fN(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=fN(t)}}function TU(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?TU(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function CU(){for(var n=window,e=L2();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=L2(n.document)}return e}function DA(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function tq(n){var e=CU(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&TU(t.ownerDocument.documentElement,t)){if(r!==null&&DA(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=hN(t,s);var o=hN(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var nq=uu&&"documentMode"in document&&11>=document.documentMode,$d=null,MM=null,W0=null,TM=!1;function dN(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;TM||$d==null||$d!==L2(r)||(r=$d,"selectionStart"in r&&DA(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),W0&&Rg(W0,r)||(W0=r,r=W2(MM,"onSelect"),0<r.length&&(e=new RA("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=$d)))}function p1(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var qd={animationend:p1("Animation","AnimationEnd"),animationiteration:p1("Animation","AnimationIteration"),animationstart:p1("Animation","AnimationStart"),transitionend:p1("Transition","TransitionEnd")},BS={},AU={};uu&&(AU=document.createElement("div").style,"AnimationEvent"in window||(delete qd.animationend.animation,delete qd.animationiteration.animation,delete qd.animationstart.animation),"TransitionEvent"in window||delete qd.transitionend.transition);function aw(n){if(BS[n])return BS[n];if(!qd[n])return n;var e=qd[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in AU)return BS[n]=e[t];return n}var RU=aw("animationend"),PU=aw("animationiteration"),IU=aw("animationstart"),DU=aw("transitionend"),NU=new Map,pN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hc(n,e){NU.set(n,e),Rh(e,[n])}for(var US=0;US<pN.length;US++){var zS=pN[US],rq=zS.toLowerCase(),iq=zS[0].toUpperCase()+zS.slice(1);Hc(rq,"on"+iq)}Hc(RU,"onAnimationEnd");Hc(PU,"onAnimationIteration");Hc(IU,"onAnimationStart");Hc("dblclick","onDoubleClick");Hc("focusin","onFocus");Hc("focusout","onBlur");Hc(DU,"onTransitionEnd");Up("onMouseEnter",["mouseout","mouseover"]);Up("onMouseLeave",["mouseout","mouseover"]);Up("onPointerEnter",["pointerout","pointerover"]);Up("onPointerLeave",["pointerout","pointerover"]);Rh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var A0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sq=new Set("cancel close invalid load scroll toggle".split(" ").concat(A0));function mN(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,r$(r,e,void 0,n),n.currentTarget=null}function kU(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;mN(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;mN(i,a,u),s=l}}}if(O2)throw n=wM,O2=!1,wM=null,n}function Yn(n,e){var t=e[IM];t===void 0&&(t=e[IM]=new Set);var r=n+"__bubble";t.has(r)||(LU(e,n,2,!1),t.add(r))}function VS(n,e,t){var r=0;e&&(r|=4),LU(t,n,r,e)}var m1="_reactListening"+Math.random().toString(36).slice(2);function Pg(n){if(!n[m1]){n[m1]=!0,WB.forEach(function(t){t!=="selectionchange"&&(sq.has(t)||VS(t,!1,n),VS(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[m1]||(e[m1]=!0,VS("selectionchange",!1,e))}}function LU(n,e,t,r){switch(yU(e)){case 1:var i=x$;break;case 4:i=_$;break;default:i=CA}t=i.bind(null,e,t,n),i=void 0,!_M||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function WS(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Uf(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}iU(function(){var u=s,c=SA(t),f=[];e:{var h=NU.get(n);if(h!==void 0){var d=RA,p=n;switch(n){case"keypress":if(r2(t)===0)break e;case"keydown":case"keyup":d=L$;break;case"focusin":p="focus",d=LS;break;case"focusout":p="blur",d=LS;break;case"beforeblur":case"afterblur":d=LS;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=rN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=S$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=B$;break;case RU:case PU:case IU:d=T$;break;case DU:d=z$;break;case"scroll":d=w$;break;case"wheel":d=W$;break;case"copy":case"cut":case"paste":d=A$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=sN}var y=(e&4)!==0,x=!y&&n==="scroll",m=y?h!==null?h+"Capture":null:h;y=[];for(var _=u,w;_!==null;){w=_;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,m!==null&&(b=Eg(_,m),b!=null&&y.push(Ig(_,b,w)))),x)break;_=_.return}0<y.length&&(h=new d(h,p,null,t,c),f.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",d=n==="mouseout"||n==="pointerout",h&&t!==yM&&(p=t.relatedTarget||t.fromElement)&&(Uf(p)||p[cu]))break e;if((d||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=t.relatedTarget||t.toElement,d=u,p=p?Uf(p):null,p!==null&&(x=Ph(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=u),d!==p)){if(y=rN,b="onMouseLeave",m="onMouseEnter",_="mouse",(n==="pointerout"||n==="pointerover")&&(y=sN,b="onPointerLeave",m="onPointerEnter",_="pointer"),x=d==null?h:Yd(d),w=p==null?h:Yd(p),h=new y(b,_+"leave",d,t,c),h.target=x,h.relatedTarget=w,b=null,Uf(c)===u&&(y=new y(m,_+"enter",p,t,c),y.target=w,y.relatedTarget=x,b=y),x=b,d&&p)t:{for(y=d,m=p,_=0,w=y;w;w=td(w))_++;for(w=0,b=m;b;b=td(b))w++;for(;0<_-w;)y=td(y),_--;for(;0<w-_;)m=td(m),w--;for(;_--;){if(y===m||m!==null&&y===m.alternate)break t;y=td(y),m=td(m)}y=null}else y=null;d!==null&&gN(f,h,d,y,!1),p!==null&&x!==null&&gN(f,x,p,y,!0)}}e:{if(h=u?Yd(u):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var S=Y$;else if(lN(h))if(EU)S=Q$;else{S=Z$;var M=K$}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=J$);if(S&&(S=S(n,u))){SU(f,S,t,c);break e}M&&M(n,h,u),n==="focusout"&&(M=h._wrapperState)&&M.controlled&&h.type==="number"&&dM(h,"number",h.value)}switch(M=u?Yd(u):window,n){case"focusin":(lN(M)||M.contentEditable==="true")&&($d=M,MM=u,W0=null);break;case"focusout":W0=MM=$d=null;break;case"mousedown":TM=!0;break;case"contextmenu":case"mouseup":case"dragend":TM=!1,dN(f,t,c);break;case"selectionchange":if(nq)break;case"keydown":case"keyup":dN(f,t,c)}var T;if(IA)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Xd?wU(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(_U&&t.locale!=="ko"&&(Xd||P!=="onCompositionStart"?P==="onCompositionEnd"&&Xd&&(T=xU()):(rc=c,AA="value"in rc?rc.value:rc.textContent,Xd=!0)),M=W2(u,P),0<M.length&&(P=new iN(P,n,null,t,c),f.push({event:P,listeners:M}),T?P.data=T:(T=bU(t),T!==null&&(P.data=T)))),(T=G$?j$(n,t):X$(n,t))&&(u=W2(u,"onBeforeInput"),0<u.length&&(c=new iN("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=T))}kU(f,e)})}function Ig(n,e,t){return{instance:n,listener:e,currentTarget:t}}function W2(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Eg(n,t),s!=null&&r.unshift(Ig(n,s,i)),s=Eg(n,e),s!=null&&r.push(Ig(n,s,i))),n=n.return}return r}function td(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function gN(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Eg(t,s),l!=null&&o.unshift(Ig(t,l,a))):i||(l=Eg(t,s),l!=null&&o.push(Ig(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var oq=/\r\n?/g,aq=/\u0000|\uFFFD/g;function vN(n){return(typeof n=="string"?n:""+n).replace(oq,`
`).replace(aq,"")}function g1(n,e,t){if(e=vN(e),vN(n)!==e&&t)throw Error(Xe(425))}function H2(){}var CM=null,AM=null;function RM(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var PM=typeof setTimeout=="function"?setTimeout:void 0,lq=typeof clearTimeout=="function"?clearTimeout:void 0,yN=typeof Promise=="function"?Promise:void 0,uq=typeof queueMicrotask=="function"?queueMicrotask:typeof yN<"u"?function(n){return yN.resolve(null).then(n).catch(cq)}:PM;function cq(n){setTimeout(function(){throw n})}function HS(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Cg(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Cg(e)}function mc(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function xN(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var fm=Math.random().toString(36).slice(2),al="__reactFiber$"+fm,Dg="__reactProps$"+fm,cu="__reactContainer$"+fm,IM="__reactEvents$"+fm,fq="__reactListeners$"+fm,hq="__reactHandles$"+fm;function Uf(n){var e=n[al];if(e)return e;for(var t=n.parentNode;t;){if(e=t[cu]||t[al]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=xN(n);n!==null;){if(t=n[al])return t;n=xN(n)}return e}n=t,t=n.parentNode}return null}function kv(n){return n=n[al]||n[cu],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Yd(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Xe(33))}function lw(n){return n[Dg]||null}var DM=[],Kd=-1;function Gc(n){return{current:n}}function Jn(n){0>Kd||(n.current=DM[Kd],DM[Kd]=null,Kd--)}function Xn(n,e){Kd++,DM[Kd]=n.current,n.current=e}var Pc={},as=Gc(Pc),Hs=Gc(!1),mh=Pc;function zp(n,e){var t=n.type.contextTypes;if(!t)return Pc;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Gs(n){return n=n.childContextTypes,n!=null}function G2(){Jn(Hs),Jn(as)}function _N(n,e,t){if(as.current!==Pc)throw Error(Xe(168));Xn(as,e),Xn(Hs,t)}function FU(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Xe(108,KX(n)||"Unknown",i));return yr({},t,r)}function j2(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Pc,mh=as.current,Xn(as,n),Xn(Hs,Hs.current),!0}function wN(n,e,t){var r=n.stateNode;if(!r)throw Error(Xe(169));t?(n=FU(n,e,mh),r.__reactInternalMemoizedMergedChildContext=n,Jn(Hs),Jn(as),Xn(as,n)):Jn(Hs),Xn(Hs,t)}var Yl=null,uw=!1,GS=!1;function OU(n){Yl===null?Yl=[n]:Yl.push(n)}function dq(n){uw=!0,OU(n)}function jc(){if(!GS&&Yl!==null){GS=!0;var n=0,e=On;try{var t=Yl;for(On=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Yl=null,uw=!1}catch(i){throw Yl!==null&&(Yl=Yl.slice(n+1)),lU(EA,jc),i}finally{On=e,GS=!1}}return null}var Zd=[],Jd=0,X2=null,$2=0,qo=[],Yo=0,gh=null,eu=1,tu="";function Tf(n,e){Zd[Jd++]=$2,Zd[Jd++]=X2,X2=n,$2=e}function BU(n,e,t){qo[Yo++]=eu,qo[Yo++]=tu,qo[Yo++]=gh,gh=n;var r=eu;n=tu;var i=32-Da(r)-1;r&=~(1<<i),t+=1;var s=32-Da(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,eu=1<<32-Da(e)+i|t<<i|r,tu=s+n}else eu=1<<s|t<<i|r,tu=n}function NA(n){n.return!==null&&(Tf(n,1),BU(n,1,0))}function kA(n){for(;n===X2;)X2=Zd[--Jd],Zd[Jd]=null,$2=Zd[--Jd],Zd[Jd]=null;for(;n===gh;)gh=qo[--Yo],qo[Yo]=null,tu=qo[--Yo],qo[Yo]=null,eu=qo[--Yo],qo[Yo]=null}var To=null,_o=null,nr=!1,Ca=null;function UU(n,e){var t=ta(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function bN(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,To=n,_o=mc(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,To=n,_o=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=gh!==null?{id:eu,overflow:tu}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ta(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,To=n,_o=null,!0):!1;default:return!1}}function NM(n){return(n.mode&1)!==0&&(n.flags&128)===0}function kM(n){if(nr){var e=_o;if(e){var t=e;if(!bN(n,e)){if(NM(n))throw Error(Xe(418));e=mc(t.nextSibling);var r=To;e&&bN(n,e)?UU(r,t):(n.flags=n.flags&-4097|2,nr=!1,To=n)}}else{if(NM(n))throw Error(Xe(418));n.flags=n.flags&-4097|2,nr=!1,To=n}}}function SN(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;To=n}function v1(n){if(n!==To)return!1;if(!nr)return SN(n),nr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!RM(n.type,n.memoizedProps)),e&&(e=_o)){if(NM(n))throw zU(),Error(Xe(418));for(;e;)UU(n,e),e=mc(e.nextSibling)}if(SN(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Xe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){_o=mc(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}_o=null}}else _o=To?mc(n.stateNode.nextSibling):null;return!0}function zU(){for(var n=_o;n;)n=mc(n.nextSibling)}function Vp(){_o=To=null,nr=!1}function LA(n){Ca===null?Ca=[n]:Ca.push(n)}var pq=bu.ReactCurrentBatchConfig;function Zm(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Xe(309));var r=t.stateNode}if(!r)throw Error(Xe(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(Xe(284));if(!t._owner)throw Error(Xe(290,n))}return n}function y1(n,e){throw n=Object.prototype.toString.call(e),Error(Xe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function EN(n){var e=n._init;return e(n._payload)}function VU(n){function e(m,_){if(n){var w=m.deletions;w===null?(m.deletions=[_],m.flags|=16):w.push(_)}}function t(m,_){if(!n)return null;for(;_!==null;)e(m,_),_=_.sibling;return null}function r(m,_){for(m=new Map;_!==null;)_.key!==null?m.set(_.key,_):m.set(_.index,_),_=_.sibling;return m}function i(m,_){return m=xc(m,_),m.index=0,m.sibling=null,m}function s(m,_,w){return m.index=w,n?(w=m.alternate,w!==null?(w=w.index,w<_?(m.flags|=2,_):w):(m.flags|=2,_)):(m.flags|=1048576,_)}function o(m){return n&&m.alternate===null&&(m.flags|=2),m}function a(m,_,w,b){return _===null||_.tag!==6?(_=ZS(w,m.mode,b),_.return=m,_):(_=i(_,w),_.return=m,_)}function l(m,_,w,b){var S=w.type;return S===jd?c(m,_,w.props.children,b,w.key):_!==null&&(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zu&&EN(S)===_.type)?(b=i(_,w.props),b.ref=Zm(m,_,w),b.return=m,b):(b=c2(w.type,w.key,w.props,null,m.mode,b),b.ref=Zm(m,_,w),b.return=m,b)}function u(m,_,w,b){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=JS(w,m.mode,b),_.return=m,_):(_=i(_,w.children||[]),_.return=m,_)}function c(m,_,w,b,S){return _===null||_.tag!==7?(_=eh(w,m.mode,b,S),_.return=m,_):(_=i(_,w),_.return=m,_)}function f(m,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return _=ZS(""+_,m.mode,w),_.return=m,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case a1:return w=c2(_.type,_.key,_.props,null,m.mode,w),w.ref=Zm(m,null,_),w.return=m,w;case Gd:return _=JS(_,m.mode,w),_.return=m,_;case Zu:var b=_._init;return f(m,b(_._payload),w)}if(T0(_)||Xm(_))return _=eh(_,m.mode,w,null),_.return=m,_;y1(m,_)}return null}function h(m,_,w,b){var S=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:a(m,_,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case a1:return w.key===S?l(m,_,w,b):null;case Gd:return w.key===S?u(m,_,w,b):null;case Zu:return S=w._init,h(m,_,S(w._payload),b)}if(T0(w)||Xm(w))return S!==null?null:c(m,_,w,b,null);y1(m,w)}return null}function d(m,_,w,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(w)||null,a(_,m,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case a1:return m=m.get(b.key===null?w:b.key)||null,l(_,m,b,S);case Gd:return m=m.get(b.key===null?w:b.key)||null,u(_,m,b,S);case Zu:var M=b._init;return d(m,_,w,M(b._payload),S)}if(T0(b)||Xm(b))return m=m.get(w)||null,c(_,m,b,S,null);y1(_,b)}return null}function p(m,_,w,b){for(var S=null,M=null,T=_,P=_=0,C=null;T!==null&&P<w.length;P++){T.index>P?(C=T,T=null):C=T.sibling;var A=h(m,T,w[P],b);if(A===null){T===null&&(T=C);break}n&&T&&A.alternate===null&&e(m,T),_=s(A,_,P),M===null?S=A:M.sibling=A,M=A,T=C}if(P===w.length)return t(m,T),nr&&Tf(m,P),S;if(T===null){for(;P<w.length;P++)T=f(m,w[P],b),T!==null&&(_=s(T,_,P),M===null?S=T:M.sibling=T,M=T);return nr&&Tf(m,P),S}for(T=r(m,T);P<w.length;P++)C=d(T,m,P,w[P],b),C!==null&&(n&&C.alternate!==null&&T.delete(C.key===null?P:C.key),_=s(C,_,P),M===null?S=C:M.sibling=C,M=C);return n&&T.forEach(function(k){return e(m,k)}),nr&&Tf(m,P),S}function y(m,_,w,b){var S=Xm(w);if(typeof S!="function")throw Error(Xe(150));if(w=S.call(w),w==null)throw Error(Xe(151));for(var M=S=null,T=_,P=_=0,C=null,A=w.next();T!==null&&!A.done;P++,A=w.next()){T.index>P?(C=T,T=null):C=T.sibling;var k=h(m,T,A.value,b);if(k===null){T===null&&(T=C);break}n&&T&&k.alternate===null&&e(m,T),_=s(k,_,P),M===null?S=k:M.sibling=k,M=k,T=C}if(A.done)return t(m,T),nr&&Tf(m,P),S;if(T===null){for(;!A.done;P++,A=w.next())A=f(m,A.value,b),A!==null&&(_=s(A,_,P),M===null?S=A:M.sibling=A,M=A);return nr&&Tf(m,P),S}for(T=r(m,T);!A.done;P++,A=w.next())A=d(T,m,P,A.value,b),A!==null&&(n&&A.alternate!==null&&T.delete(A.key===null?P:A.key),_=s(A,_,P),M===null?S=A:M.sibling=A,M=A);return n&&T.forEach(function(L){return e(m,L)}),nr&&Tf(m,P),S}function x(m,_,w,b){if(typeof w=="object"&&w!==null&&w.type===jd&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case a1:e:{for(var S=w.key,M=_;M!==null;){if(M.key===S){if(S=w.type,S===jd){if(M.tag===7){t(m,M.sibling),_=i(M,w.props.children),_.return=m,m=_;break e}}else if(M.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zu&&EN(S)===M.type){t(m,M.sibling),_=i(M,w.props),_.ref=Zm(m,M,w),_.return=m,m=_;break e}t(m,M);break}else e(m,M);M=M.sibling}w.type===jd?(_=eh(w.props.children,m.mode,b,w.key),_.return=m,m=_):(b=c2(w.type,w.key,w.props,null,m.mode,b),b.ref=Zm(m,_,w),b.return=m,m=b)}return o(m);case Gd:e:{for(M=w.key;_!==null;){if(_.key===M)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){t(m,_.sibling),_=i(_,w.children||[]),_.return=m,m=_;break e}else{t(m,_);break}else e(m,_);_=_.sibling}_=JS(w,m.mode,b),_.return=m,m=_}return o(m);case Zu:return M=w._init,x(m,_,M(w._payload),b)}if(T0(w))return p(m,_,w,b);if(Xm(w))return y(m,_,w,b);y1(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,_!==null&&_.tag===6?(t(m,_.sibling),_=i(_,w),_.return=m,m=_):(t(m,_),_=ZS(w,m.mode,b),_.return=m,m=_),o(m)):t(m,_)}return x}var Wp=VU(!0),WU=VU(!1),q2=Gc(null),Y2=null,Qd=null,FA=null;function OA(){FA=Qd=Y2=null}function BA(n){var e=q2.current;Jn(q2),n._currentValue=e}function LM(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function wp(n,e){Y2=n,FA=Qd=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Us=!0),n.firstContext=null)}function ua(n){var e=n._currentValue;if(FA!==n)if(n={context:n,memoizedValue:e,next:null},Qd===null){if(Y2===null)throw Error(Xe(308));Qd=n,Y2.dependencies={lanes:0,firstContext:n}}else Qd=Qd.next=n;return e}var zf=null;function UA(n){zf===null?zf=[n]:zf.push(n)}function HU(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,UA(e)):(t.next=i.next,i.next=t),e.interleaved=t,fu(n,r)}function fu(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ju=!1;function zA(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GU(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function iu(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function gc(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,En&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fu(n,t)}return i=r.interleaved,i===null?(e.next=e,UA(r)):(e.next=i.next,i.next=e),r.interleaved=e,fu(n,t)}function i2(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,MA(n,t)}}function MN(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function K2(n,e,t,r){var i=n.updateQueue;Ju=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=n.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,d=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,y=a;switch(h=e,d=t,y.tag){case 1:if(p=y.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=yr({},f,h);break e;case 2:Ju=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=d,l=f):c=c.next=d,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);yh|=o,n.lanes=o,n.memoizedState=f}}function TN(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(Xe(191,i));i.call(r)}}}var Lv={},vl=Gc(Lv),Ng=Gc(Lv),kg=Gc(Lv);function Vf(n){if(n===Lv)throw Error(Xe(174));return n}function VA(n,e){switch(Xn(kg,e),Xn(Ng,n),Xn(vl,Lv),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mM(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=mM(e,n)}Jn(vl),Xn(vl,e)}function Hp(){Jn(vl),Jn(Ng),Jn(kg)}function jU(n){Vf(kg.current);var e=Vf(vl.current),t=mM(e,n.type);e!==t&&(Xn(Ng,n),Xn(vl,t))}function WA(n){Ng.current===n&&(Jn(vl),Jn(Ng))}var lr=Gc(0);function Z2(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jS=[];function HA(){for(var n=0;n<jS.length;n++)jS[n]._workInProgressVersionPrimary=null;jS.length=0}var s2=bu.ReactCurrentDispatcher,XS=bu.ReactCurrentBatchConfig,vh=0,mr=null,Qr=null,xi=null,J2=!1,H0=!1,Lg=0,mq=0;function Gi(){throw Error(Xe(321))}function GA(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Fa(n[t],e[t]))return!1;return!0}function jA(n,e,t,r,i,s){if(vh=s,mr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,s2.current=n===null||n.memoizedState===null?xq:_q,n=t(r,i),H0){s=0;do{if(H0=!1,Lg=0,25<=s)throw Error(Xe(301));s+=1,xi=Qr=null,e.updateQueue=null,s2.current=wq,n=t(r,i)}while(H0)}if(s2.current=Q2,e=Qr!==null&&Qr.next!==null,vh=0,xi=Qr=mr=null,J2=!1,e)throw Error(Xe(300));return n}function XA(){var n=Lg!==0;return Lg=0,n}function nl(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?mr.memoizedState=xi=n:xi=xi.next=n,xi}function ca(){if(Qr===null){var n=mr.alternate;n=n!==null?n.memoizedState:null}else n=Qr.next;var e=xi===null?mr.memoizedState:xi.next;if(e!==null)xi=e,Qr=n;else{if(n===null)throw Error(Xe(310));Qr=n,n={memoizedState:Qr.memoizedState,baseState:Qr.baseState,baseQueue:Qr.baseQueue,queue:Qr.queue,next:null},xi===null?mr.memoizedState=xi=n:xi=xi.next=n}return xi}function Fg(n,e){return typeof e=="function"?e(n):e}function $S(n){var e=ca(),t=e.queue;if(t===null)throw Error(Xe(311));t.lastRenderedReducer=n;var r=Qr,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((vh&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,mr.lanes|=c,yh|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Fa(r,e.memoizedState)||(Us=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,mr.lanes|=s,yh|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function qS(n){var e=ca(),t=e.queue;if(t===null)throw Error(Xe(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Fa(s,e.memoizedState)||(Us=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function XU(){}function $U(n,e){var t=mr,r=ca(),i=e(),s=!Fa(r.memoizedState,i);if(s&&(r.memoizedState=i,Us=!0),r=r.queue,$A(KU.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||xi!==null&&xi.memoizedState.tag&1){if(t.flags|=2048,Og(9,YU.bind(null,t,r,i,e),void 0,null),wi===null)throw Error(Xe(349));vh&30||qU(t,e,i)}return i}function qU(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=mr.updateQueue,e===null?(e={lastEffect:null,stores:null},mr.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function YU(n,e,t,r){e.value=t,e.getSnapshot=r,ZU(e)&&JU(n)}function KU(n,e,t){return t(function(){ZU(e)&&JU(n)})}function ZU(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Fa(n,t)}catch{return!0}}function JU(n){var e=fu(n,1);e!==null&&Na(e,n,1,-1)}function CN(n){var e=nl();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fg,lastRenderedState:n},e.queue=n,n=n.dispatch=yq.bind(null,mr,n),[e.memoizedState,n]}function Og(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=mr.updateQueue,e===null?(e={lastEffect:null,stores:null},mr.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function QU(){return ca().memoizedState}function o2(n,e,t,r){var i=nl();mr.flags|=n,i.memoizedState=Og(1|e,t,void 0,r===void 0?null:r)}function cw(n,e,t,r){var i=ca();r=r===void 0?null:r;var s=void 0;if(Qr!==null){var o=Qr.memoizedState;if(s=o.destroy,r!==null&&GA(r,o.deps)){i.memoizedState=Og(e,t,s,r);return}}mr.flags|=n,i.memoizedState=Og(1|e,t,s,r)}function AN(n,e){return o2(8390656,8,n,e)}function $A(n,e){return cw(2048,8,n,e)}function e6(n,e){return cw(4,2,n,e)}function t6(n,e){return cw(4,4,n,e)}function n6(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function r6(n,e,t){return t=t!=null?t.concat([n]):null,cw(4,4,n6.bind(null,e,n),t)}function qA(){}function i6(n,e){var t=ca();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&GA(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function s6(n,e){var t=ca();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&GA(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function o6(n,e,t){return vh&21?(Fa(t,e)||(t=fU(),mr.lanes|=t,yh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Us=!0),n.memoizedState=t)}function gq(n,e){var t=On;On=t!==0&&4>t?t:4,n(!0);var r=XS.transition;XS.transition={};try{n(!1),e()}finally{On=t,XS.transition=r}}function a6(){return ca().memoizedState}function vq(n,e,t){var r=yc(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},l6(n))u6(e,t);else if(t=HU(n,e,t,r),t!==null){var i=Es();Na(t,n,r,i),c6(t,e,r)}}function yq(n,e,t){var r=yc(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(l6(n))u6(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,Fa(a,o)){var l=e.interleaved;l===null?(i.next=i,UA(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=HU(n,e,i,r),t!==null&&(i=Es(),Na(t,n,r,i),c6(t,e,r))}}function l6(n){var e=n.alternate;return n===mr||e!==null&&e===mr}function u6(n,e){H0=J2=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function c6(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,MA(n,t)}}var Q2={readContext:ua,useCallback:Gi,useContext:Gi,useEffect:Gi,useImperativeHandle:Gi,useInsertionEffect:Gi,useLayoutEffect:Gi,useMemo:Gi,useReducer:Gi,useRef:Gi,useState:Gi,useDebugValue:Gi,useDeferredValue:Gi,useTransition:Gi,useMutableSource:Gi,useSyncExternalStore:Gi,useId:Gi,unstable_isNewReconciler:!1},xq={readContext:ua,useCallback:function(n,e){return nl().memoizedState=[n,e===void 0?null:e],n},useContext:ua,useEffect:AN,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,o2(4194308,4,n6.bind(null,e,n),t)},useLayoutEffect:function(n,e){return o2(4194308,4,n,e)},useInsertionEffect:function(n,e){return o2(4,2,n,e)},useMemo:function(n,e){var t=nl();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=nl();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=vq.bind(null,mr,n),[r.memoizedState,n]},useRef:function(n){var e=nl();return n={current:n},e.memoizedState=n},useState:CN,useDebugValue:qA,useDeferredValue:function(n){return nl().memoizedState=n},useTransition:function(){var n=CN(!1),e=n[0];return n=gq.bind(null,n[1]),nl().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=mr,i=nl();if(nr){if(t===void 0)throw Error(Xe(407));t=t()}else{if(t=e(),wi===null)throw Error(Xe(349));vh&30||qU(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,AN(KU.bind(null,r,s,n),[n]),r.flags|=2048,Og(9,YU.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=nl(),e=wi.identifierPrefix;if(nr){var t=tu,r=eu;t=(r&~(1<<32-Da(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Lg++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=mq++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},_q={readContext:ua,useCallback:i6,useContext:ua,useEffect:$A,useImperativeHandle:r6,useInsertionEffect:e6,useLayoutEffect:t6,useMemo:s6,useReducer:$S,useRef:QU,useState:function(){return $S(Fg)},useDebugValue:qA,useDeferredValue:function(n){var e=ca();return o6(e,Qr.memoizedState,n)},useTransition:function(){var n=$S(Fg)[0],e=ca().memoizedState;return[n,e]},useMutableSource:XU,useSyncExternalStore:$U,useId:a6,unstable_isNewReconciler:!1},wq={readContext:ua,useCallback:i6,useContext:ua,useEffect:$A,useImperativeHandle:r6,useInsertionEffect:e6,useLayoutEffect:t6,useMemo:s6,useReducer:qS,useRef:QU,useState:function(){return qS(Fg)},useDebugValue:qA,useDeferredValue:function(n){var e=ca();return Qr===null?e.memoizedState=n:o6(e,Qr.memoizedState,n)},useTransition:function(){var n=qS(Fg)[0],e=ca().memoizedState;return[n,e]},useMutableSource:XU,useSyncExternalStore:$U,useId:a6,unstable_isNewReconciler:!1};function Ea(n,e){if(n&&n.defaultProps){e=yr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function FM(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:yr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var fw={isMounted:function(n){return(n=n._reactInternals)?Ph(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Es(),i=yc(n),s=iu(r,i);s.payload=e,t!=null&&(s.callback=t),e=gc(n,s,i),e!==null&&(Na(e,n,i,r),i2(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Es(),i=yc(n),s=iu(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=gc(n,s,i),e!==null&&(Na(e,n,i,r),i2(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Es(),r=yc(n),i=iu(t,r);i.tag=2,e!=null&&(i.callback=e),e=gc(n,i,r),e!==null&&(Na(e,n,r,t),i2(e,n,r))}};function RN(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Rg(t,r)||!Rg(i,s):!0}function f6(n,e,t){var r=!1,i=Pc,s=e.contextType;return typeof s=="object"&&s!==null?s=ua(s):(i=Gs(e)?mh:as.current,r=e.contextTypes,s=(r=r!=null)?zp(n,i):Pc),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fw,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function PN(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&fw.enqueueReplaceState(e,e.state,null)}function OM(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},zA(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ua(s):(s=Gs(e)?mh:as.current,i.context=zp(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(FM(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&fw.enqueueReplaceState(i,i.state,null),K2(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Gp(n,e){try{var t="",r=e;do t+=YX(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function YS(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function BM(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var bq=typeof WeakMap=="function"?WeakMap:Map;function h6(n,e,t){t=iu(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){t_||(t_=!0,qM=r),BM(n,e)},t}function d6(n,e,t){t=iu(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){BM(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){BM(n,e),typeof r!="function"&&(vc===null?vc=new Set([this]):vc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function IN(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new bq;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Fq.bind(null,n,e,t),e.then(n,n))}function DN(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function NN(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=iu(-1,1),e.tag=2,gc(t,e,1))),t.lanes|=1),n)}var Sq=bu.ReactCurrentOwner,Us=!1;function gs(n,e,t,r){e.child=n===null?WU(e,null,t,r):Wp(e,n.child,t,r)}function kN(n,e,t,r,i){t=t.render;var s=e.ref;return wp(e,i),r=jA(n,e,t,r,s,i),t=XA(),n!==null&&!Us?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,hu(n,e,i)):(nr&&t&&NA(e),e.flags|=1,gs(n,e,r,i),e.child)}function LN(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!nR(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,p6(n,e,s,r,i)):(n=c2(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Rg,t(o,r)&&n.ref===e.ref)return hu(n,e,i)}return e.flags|=1,n=xc(s,r),n.ref=e.ref,n.return=e,e.child=n}function p6(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Rg(s,r)&&n.ref===e.ref)if(Us=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Us=!0);else return e.lanes=n.lanes,hu(n,e,i)}return UM(n,e,t,r,i)}function m6(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xn(tp,fo),fo|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Xn(tp,fo),fo|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Xn(tp,fo),fo|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Xn(tp,fo),fo|=r;return gs(n,e,i,t),e.child}function g6(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function UM(n,e,t,r,i){var s=Gs(t)?mh:as.current;return s=zp(e,s),wp(e,i),t=jA(n,e,t,r,s,i),r=XA(),n!==null&&!Us?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,hu(n,e,i)):(nr&&r&&NA(e),e.flags|=1,gs(n,e,t,i),e.child)}function FN(n,e,t,r,i){if(Gs(t)){var s=!0;j2(e)}else s=!1;if(wp(e,i),e.stateNode===null)a2(n,e),f6(e,t,r),OM(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=ua(u):(u=Gs(t)?mh:as.current,u=zp(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&PN(e,o,r,u),Ju=!1;var h=e.memoizedState;o.state=h,K2(e,r,o,i),l=e.memoizedState,a!==r||h!==l||Hs.current||Ju?(typeof c=="function"&&(FM(e,t,c,r),l=e.memoizedState),(a=Ju||RN(e,t,a,r,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,GU(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ea(e.type,a),o.props=u,f=e.pendingProps,h=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=ua(l):(l=Gs(t)?mh:as.current,l=zp(e,l));var d=t.getDerivedStateFromProps;(c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&PN(e,o,r,l),Ju=!1,h=e.memoizedState,o.state=h,K2(e,r,o,i);var p=e.memoizedState;a!==f||h!==p||Hs.current||Ju?(typeof d=="function"&&(FM(e,t,d,r),p=e.memoizedState),(u=Ju||RN(e,t,u,r,h,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return zM(n,e,t,r,s,i)}function zM(n,e,t,r,i,s){g6(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&wN(e,t,!1),hu(n,e,s);r=e.stateNode,Sq.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Wp(e,n.child,null,s),e.child=Wp(e,null,a,s)):gs(n,e,a,s),e.memoizedState=r.state,i&&wN(e,t,!0),e.child}function v6(n){var e=n.stateNode;e.pendingContext?_N(n,e.pendingContext,e.pendingContext!==e.context):e.context&&_N(n,e.context,!1),VA(n,e.containerInfo)}function ON(n,e,t,r,i){return Vp(),LA(i),e.flags|=256,gs(n,e,t,r),e.child}var VM={dehydrated:null,treeContext:null,retryLane:0};function WM(n){return{baseLanes:n,cachePool:null,transitions:null}}function y6(n,e,t){var r=e.pendingProps,i=lr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Xn(lr,i&1),n===null)return kM(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=pw(o,r,0,null),n=eh(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=WM(t),e.memoizedState=VM,n):YA(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Eq(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=xc(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=xc(a,s):(s=eh(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?WM(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=VM,r}return s=n.child,n=s.sibling,r=xc(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function YA(n,e){return e=pw({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function x1(n,e,t,r){return r!==null&&LA(r),Wp(e,n.child,null,t),n=YA(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Eq(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=YS(Error(Xe(422))),x1(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=pw({mode:"visible",children:r.children},i,0,null),s=eh(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Wp(e,n.child,null,o),e.child.memoizedState=WM(o),e.memoizedState=VM,s);if(!(e.mode&1))return x1(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Xe(419)),r=YS(s,r,void 0),x1(n,e,o,r)}if(a=(o&n.childLanes)!==0,Us||a){if(r=wi,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fu(n,i),Na(r,n,i,-1))}return tR(),r=YS(Error(Xe(421))),x1(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Oq.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,_o=mc(i.nextSibling),To=e,nr=!0,Ca=null,n!==null&&(qo[Yo++]=eu,qo[Yo++]=tu,qo[Yo++]=gh,eu=n.id,tu=n.overflow,gh=e),e=YA(e,r.children),e.flags|=4096,e)}function BN(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),LM(n.return,e,t)}function KS(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function x6(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(gs(n,e,r.children,t),r=lr.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&BN(n,t,e);else if(n.tag===19)BN(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Xn(lr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Z2(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),KS(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Z2(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}KS(e,!0,t,null,s);break;case"together":KS(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function a2(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function hu(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),yh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Xe(153));if(e.child!==null){for(n=e.child,t=xc(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=xc(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Mq(n,e,t){switch(e.tag){case 3:v6(e),Vp();break;case 5:jU(e);break;case 1:Gs(e.type)&&j2(e);break;case 4:VA(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xn(q2,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xn(lr,lr.current&1),e.flags|=128,null):t&e.child.childLanes?y6(n,e,t):(Xn(lr,lr.current&1),n=hu(n,e,t),n!==null?n.sibling:null);Xn(lr,lr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return x6(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xn(lr,lr.current),r)break;return null;case 22:case 23:return e.lanes=0,m6(n,e,t)}return hu(n,e,t)}var _6,HM,w6,b6;_6=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};HM=function(){};w6=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Vf(vl.current);var s=null;switch(t){case"input":i=fM(n,i),r=fM(n,r),s=[];break;case"select":i=yr({},i,{value:void 0}),r=yr({},r,{value:void 0}),s=[];break;case"textarea":i=pM(n,i),r=pM(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=H2)}gM(t,r);var o;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bg.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bg.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Yn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};b6=function(n,e,t,r){t!==r&&(e.flags|=4)};function Jm(n,e){if(!nr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function ji(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Tq(n,e,t){var r=e.pendingProps;switch(kA(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ji(e),null;case 1:return Gs(e.type)&&G2(),ji(e),null;case 3:return r=e.stateNode,Hp(),Jn(Hs),Jn(as),HA(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(v1(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ca!==null&&(ZM(Ca),Ca=null))),HM(n,e),ji(e),null;case 5:WA(e);var i=Vf(kg.current);if(t=e.type,n!==null&&e.stateNode!=null)w6(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Xe(166));return ji(e),null}if(n=Vf(vl.current),v1(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[al]=e,r[Dg]=s,n=(e.mode&1)!==0,t){case"dialog":Yn("cancel",r),Yn("close",r);break;case"iframe":case"object":case"embed":Yn("load",r);break;case"video":case"audio":for(i=0;i<A0.length;i++)Yn(A0[i],r);break;case"source":Yn("error",r);break;case"img":case"image":case"link":Yn("error",r),Yn("load",r);break;case"details":Yn("toggle",r);break;case"input":$D(r,s),Yn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Yn("invalid",r);break;case"textarea":YD(r,s),Yn("invalid",r)}gM(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&g1(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&g1(r.textContent,a,n),i=["children",""+a]):bg.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Yn("scroll",r)}switch(t){case"input":l1(r),qD(r,s,!0);break;case"textarea":l1(r),KD(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=H2)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=KB(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[al]=e,n[Dg]=r,_6(n,e,!1,!1),e.stateNode=n;e:{switch(o=vM(t,r),t){case"dialog":Yn("cancel",n),Yn("close",n),i=r;break;case"iframe":case"object":case"embed":Yn("load",n),i=r;break;case"video":case"audio":for(i=0;i<A0.length;i++)Yn(A0[i],n);i=r;break;case"source":Yn("error",n),i=r;break;case"img":case"image":case"link":Yn("error",n),Yn("load",n),i=r;break;case"details":Yn("toggle",n),i=r;break;case"input":$D(n,r),i=fM(n,r),Yn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=yr({},r,{value:void 0}),Yn("invalid",n);break;case"textarea":YD(n,r),i=pM(n,r),Yn("invalid",n);break;default:i=r}gM(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?QB(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ZB(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Sg(n,l):typeof l=="number"&&Sg(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(bg.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Yn("scroll",n):l!=null&&xA(n,s,l,o))}switch(t){case"input":l1(n),qD(n,r,!1);break;case"textarea":l1(n),KD(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Rc(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?vp(n,!!r.multiple,s,!1):r.defaultValue!=null&&vp(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=H2)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ji(e),null;case 6:if(n&&e.stateNode!=null)b6(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Xe(166));if(t=Vf(kg.current),Vf(vl.current),v1(e)){if(r=e.stateNode,t=e.memoizedProps,r[al]=e,(s=r.nodeValue!==t)&&(n=To,n!==null))switch(n.tag){case 3:g1(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&g1(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[al]=e,e.stateNode=r}return ji(e),null;case 13:if(Jn(lr),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(nr&&_o!==null&&e.mode&1&&!(e.flags&128))zU(),Vp(),e.flags|=98560,s=!1;else if(s=v1(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(Xe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Xe(317));s[al]=e}else Vp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ji(e),s=!1}else Ca!==null&&(ZM(Ca),Ca=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||lr.current&1?ni===0&&(ni=3):tR())),e.updateQueue!==null&&(e.flags|=4),ji(e),null);case 4:return Hp(),HM(n,e),n===null&&Pg(e.stateNode.containerInfo),ji(e),null;case 10:return BA(e.type._context),ji(e),null;case 17:return Gs(e.type)&&G2(),ji(e),null;case 19:if(Jn(lr),s=e.memoizedState,s===null)return ji(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Jm(s,!1);else{if(ni!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Z2(n),o!==null){for(e.flags|=128,Jm(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Xn(lr,lr.current&1|2),e.child}n=n.sibling}s.tail!==null&&Lr()>jp&&(e.flags|=128,r=!0,Jm(s,!1),e.lanes=4194304)}else{if(!r)if(n=Z2(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Jm(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!nr)return ji(e),null}else 2*Lr()-s.renderingStartTime>jp&&t!==1073741824&&(e.flags|=128,r=!0,Jm(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Lr(),e.sibling=null,t=lr.current,Xn(lr,r?t&1|2:t&1),e):(ji(e),null);case 22:case 23:return eR(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?fo&1073741824&&(ji(e),e.subtreeFlags&6&&(e.flags|=8192)):ji(e),null;case 24:return null;case 25:return null}throw Error(Xe(156,e.tag))}function Cq(n,e){switch(kA(e),e.tag){case 1:return Gs(e.type)&&G2(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Hp(),Jn(Hs),Jn(as),HA(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return WA(e),null;case 13:if(Jn(lr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Xe(340));Vp()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Jn(lr),null;case 4:return Hp(),null;case 10:return BA(e.type._context),null;case 22:case 23:return eR(),null;case 24:return null;default:return null}}var _1=!1,Ji=!1,Aq=typeof WeakSet=="function"?WeakSet:Set,ft=null;function ep(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Mr(n,e,r)}else t.current=null}function GM(n,e,t){try{t()}catch(r){Mr(n,e,r)}}var UN=!1;function Rq(n,e){if(CM=z2,n=CU(),DA(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,c=0,f=n,h=null;t:for(;;){for(var d;f!==t||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===n)break t;if(h===t&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(AM={focusedElem:n,selectionRange:t},z2=!1,ft=e;ft!==null;)if(e=ft,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ft=n;else for(;ft!==null;){e=ft;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,x=p.memoizedState,m=e.stateNode,_=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:Ea(e.type,y),x);m.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Xe(163))}}catch(b){Mr(e,e.return,b)}if(n=e.sibling,n!==null){n.return=e.return,ft=n;break}ft=e.return}return p=UN,UN=!1,p}function G0(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&GM(e,t,s)}i=i.next}while(i!==r)}}function hw(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function jM(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function S6(n){var e=n.alternate;e!==null&&(n.alternate=null,S6(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[al],delete e[Dg],delete e[IM],delete e[fq],delete e[hq])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function E6(n){return n.tag===5||n.tag===3||n.tag===4}function zN(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||E6(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function XM(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=H2));else if(r!==4&&(n=n.child,n!==null))for(XM(n,e,t),n=n.sibling;n!==null;)XM(n,e,t),n=n.sibling}function $M(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for($M(n,e,t),n=n.sibling;n!==null;)$M(n,e,t),n=n.sibling}var Ai=null,Ta=!1;function Bu(n,e,t){for(t=t.child;t!==null;)M6(n,e,t),t=t.sibling}function M6(n,e,t){if(gl&&typeof gl.onCommitFiberUnmount=="function")try{gl.onCommitFiberUnmount(iw,t)}catch{}switch(t.tag){case 5:Ji||ep(t,e);case 6:var r=Ai,i=Ta;Ai=null,Bu(n,e,t),Ai=r,Ta=i,Ai!==null&&(Ta?(n=Ai,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ai.removeChild(t.stateNode));break;case 18:Ai!==null&&(Ta?(n=Ai,t=t.stateNode,n.nodeType===8?HS(n.parentNode,t):n.nodeType===1&&HS(n,t),Cg(n)):HS(Ai,t.stateNode));break;case 4:r=Ai,i=Ta,Ai=t.stateNode.containerInfo,Ta=!0,Bu(n,e,t),Ai=r,Ta=i;break;case 0:case 11:case 14:case 15:if(!Ji&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&GM(t,e,o),i=i.next}while(i!==r)}Bu(n,e,t);break;case 1:if(!Ji&&(ep(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Mr(t,e,a)}Bu(n,e,t);break;case 21:Bu(n,e,t);break;case 22:t.mode&1?(Ji=(r=Ji)||t.memoizedState!==null,Bu(n,e,t),Ji=r):Bu(n,e,t);break;default:Bu(n,e,t)}}function VN(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Aq),e.forEach(function(r){var i=Bq.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function va(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ai=a.stateNode,Ta=!1;break e;case 3:Ai=a.stateNode.containerInfo,Ta=!0;break e;case 4:Ai=a.stateNode.containerInfo,Ta=!0;break e}a=a.return}if(Ai===null)throw Error(Xe(160));M6(s,o,i),Ai=null,Ta=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Mr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T6(e,n),e=e.sibling}function T6(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(va(e,n),el(n),r&4){try{G0(3,n,n.return),hw(3,n)}catch(y){Mr(n,n.return,y)}try{G0(5,n,n.return)}catch(y){Mr(n,n.return,y)}}break;case 1:va(e,n),el(n),r&512&&t!==null&&ep(t,t.return);break;case 5:if(va(e,n),el(n),r&512&&t!==null&&ep(t,t.return),n.flags&32){var i=n.stateNode;try{Sg(i,"")}catch(y){Mr(n,n.return,y)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qB(i,s),vM(a,o);var u=vM(a,s);for(o=0;o<l.length;o+=2){var c=l[o],f=l[o+1];c==="style"?QB(i,f):c==="dangerouslySetInnerHTML"?ZB(i,f):c==="children"?Sg(i,f):xA(i,c,f,u)}switch(a){case"input":hM(i,s);break;case"textarea":YB(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?vp(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?vp(i,!!s.multiple,s.defaultValue,!0):vp(i,!!s.multiple,s.multiple?[]:"",!1))}i[Dg]=s}catch(y){Mr(n,n.return,y)}}break;case 6:if(va(e,n),el(n),r&4){if(n.stateNode===null)throw Error(Xe(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(y){Mr(n,n.return,y)}}break;case 3:if(va(e,n),el(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Cg(e.containerInfo)}catch(y){Mr(n,n.return,y)}break;case 4:va(e,n),el(n);break;case 13:va(e,n),el(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(JA=Lr())),r&4&&VN(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ji=(u=Ji)||c,va(e,n),Ji=u):va(e,n),el(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(ft=n,c=n.child;c!==null;){for(f=ft=c;ft!==null;){switch(h=ft,d=h.child,h.tag){case 0:case 11:case 14:case 15:G0(4,h,h.return);break;case 1:ep(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){Mr(r,t,y)}}break;case 5:ep(h,h.return);break;case 22:if(h.memoizedState!==null){HN(f);continue}}d!==null?(d.return=h,ft=d):HN(f)}c=c.sibling}e:for(c=null,f=n;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=JB("display",o))}catch(y){Mr(n,n.return,y)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(y){Mr(n,n.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:va(e,n),el(n),r&4&&VN(n);break;case 21:break;default:va(e,n),el(n)}}function el(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(E6(t)){var r=t;break e}t=t.return}throw Error(Xe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Sg(i,""),r.flags&=-33);var s=zN(n);$M(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=zN(n);XM(n,a,o);break;default:throw Error(Xe(161))}}catch(l){Mr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Pq(n,e,t){ft=n,C6(n)}function C6(n,e,t){for(var r=(n.mode&1)!==0;ft!==null;){var i=ft,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||_1;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ji;a=_1;var u=Ji;if(_1=o,(Ji=l)&&!u)for(ft=i;ft!==null;)o=ft,l=o.child,o.tag===22&&o.memoizedState!==null?GN(i):l!==null?(l.return=o,ft=l):GN(i);for(;s!==null;)ft=s,C6(s),s=s.sibling;ft=i,_1=a,Ji=u}WN(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ft=s):WN(n)}}function WN(n){for(;ft!==null;){var e=ft;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ji||hw(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ji)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Ea(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&TN(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}TN(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Cg(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Xe(163))}Ji||e.flags&512&&jM(e)}catch(h){Mr(e,e.return,h)}}if(e===n){ft=null;break}if(t=e.sibling,t!==null){t.return=e.return,ft=t;break}ft=e.return}}function HN(n){for(;ft!==null;){var e=ft;if(e===n){ft=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ft=t;break}ft=e.return}}function GN(n){for(;ft!==null;){var e=ft;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{hw(4,e)}catch(l){Mr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Mr(e,i,l)}}var s=e.return;try{jM(e)}catch(l){Mr(e,s,l)}break;case 5:var o=e.return;try{jM(e)}catch(l){Mr(e,o,l)}}}catch(l){Mr(e,e.return,l)}if(e===n){ft=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ft=a;break}ft=e.return}}var Iq=Math.ceil,e_=bu.ReactCurrentDispatcher,KA=bu.ReactCurrentOwner,oa=bu.ReactCurrentBatchConfig,En=0,wi=null,jr=null,Fi=0,fo=0,tp=Gc(0),ni=0,Bg=null,yh=0,dw=0,ZA=0,j0=null,Ls=null,JA=0,jp=1/0,$l=null,t_=!1,qM=null,vc=null,w1=!1,ic=null,n_=0,X0=0,YM=null,l2=-1,u2=0;function Es(){return En&6?Lr():l2!==-1?l2:l2=Lr()}function yc(n){return n.mode&1?En&2&&Fi!==0?Fi&-Fi:pq.transition!==null?(u2===0&&(u2=fU()),u2):(n=On,n!==0||(n=window.event,n=n===void 0?16:yU(n.type)),n):1}function Na(n,e,t,r){if(50<X0)throw X0=0,YM=null,Error(Xe(185));Dv(n,t,r),(!(En&2)||n!==wi)&&(n===wi&&(!(En&2)&&(dw|=t),ni===4&&tc(n,Fi)),js(n,r),t===1&&En===0&&!(e.mode&1)&&(jp=Lr()+500,uw&&jc()))}function js(n,e){var t=n.callbackNode;p$(n,e);var r=U2(n,n===wi?Fi:0);if(r===0)t!==null&&QD(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&QD(t),e===1)n.tag===0?dq(jN.bind(null,n)):OU(jN.bind(null,n)),uq(function(){!(En&6)&&jc()}),t=null;else{switch(hU(r)){case 1:t=EA;break;case 4:t=uU;break;case 16:t=B2;break;case 536870912:t=cU;break;default:t=B2}t=L6(t,A6.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function A6(n,e){if(l2=-1,u2=0,En&6)throw Error(Xe(327));var t=n.callbackNode;if(bp()&&n.callbackNode!==t)return null;var r=U2(n,n===wi?Fi:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=r_(n,r);else{e=r;var i=En;En|=2;var s=P6();(wi!==n||Fi!==e)&&($l=null,jp=Lr()+500,Qf(n,e));do try{kq();break}catch(a){R6(n,a)}while(!0);OA(),e_.current=s,En=i,jr!==null?e=0:(wi=null,Fi=0,e=ni)}if(e!==0){if(e===2&&(i=bM(n),i!==0&&(r=i,e=KM(n,i))),e===1)throw t=Bg,Qf(n,0),tc(n,r),js(n,Lr()),t;if(e===6)tc(n,r);else{if(i=n.current.alternate,!(r&30)&&!Dq(i)&&(e=r_(n,r),e===2&&(s=bM(n),s!==0&&(r=s,e=KM(n,s))),e===1))throw t=Bg,Qf(n,0),tc(n,r),js(n,Lr()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(Xe(345));case 2:Cf(n,Ls,$l);break;case 3:if(tc(n,r),(r&130023424)===r&&(e=JA+500-Lr(),10<e)){if(U2(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Es(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=PM(Cf.bind(null,n,Ls,$l),e);break}Cf(n,Ls,$l);break;case 4:if(tc(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Da(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Lr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Iq(r/1960))-r,10<r){n.timeoutHandle=PM(Cf.bind(null,n,Ls,$l),r);break}Cf(n,Ls,$l);break;case 5:Cf(n,Ls,$l);break;default:throw Error(Xe(329))}}}return js(n,Lr()),n.callbackNode===t?A6.bind(null,n):null}function KM(n,e){var t=j0;return n.current.memoizedState.isDehydrated&&(Qf(n,e).flags|=256),n=r_(n,e),n!==2&&(e=Ls,Ls=t,e!==null&&ZM(e)),n}function ZM(n){Ls===null?Ls=n:Ls.push.apply(Ls,n)}function Dq(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Fa(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tc(n,e){for(e&=~ZA,e&=~dw,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Da(e),r=1<<t;n[t]=-1,e&=~r}}function jN(n){if(En&6)throw Error(Xe(327));bp();var e=U2(n,0);if(!(e&1))return js(n,Lr()),null;var t=r_(n,e);if(n.tag!==0&&t===2){var r=bM(n);r!==0&&(e=r,t=KM(n,r))}if(t===1)throw t=Bg,Qf(n,0),tc(n,e),js(n,Lr()),t;if(t===6)throw Error(Xe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Cf(n,Ls,$l),js(n,Lr()),null}function QA(n,e){var t=En;En|=1;try{return n(e)}finally{En=t,En===0&&(jp=Lr()+500,uw&&jc())}}function xh(n){ic!==null&&ic.tag===0&&!(En&6)&&bp();var e=En;En|=1;var t=oa.transition,r=On;try{if(oa.transition=null,On=1,n)return n()}finally{On=r,oa.transition=t,En=e,!(En&6)&&jc()}}function eR(){fo=tp.current,Jn(tp)}function Qf(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,lq(t)),jr!==null)for(t=jr.return;t!==null;){var r=t;switch(kA(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&G2();break;case 3:Hp(),Jn(Hs),Jn(as),HA();break;case 5:WA(r);break;case 4:Hp();break;case 13:Jn(lr);break;case 19:Jn(lr);break;case 10:BA(r.type._context);break;case 22:case 23:eR()}t=t.return}if(wi=n,jr=n=xc(n.current,null),Fi=fo=e,ni=0,Bg=null,ZA=dw=yh=0,Ls=j0=null,zf!==null){for(e=0;e<zf.length;e++)if(t=zf[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}zf=null}return n}function R6(n,e){do{var t=jr;try{if(OA(),s2.current=Q2,J2){for(var r=mr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}J2=!1}if(vh=0,xi=Qr=mr=null,H0=!1,Lg=0,KA.current=null,t===null||t.return===null){ni=1,Bg=e,jr=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=Fi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=DN(o);if(d!==null){d.flags&=-257,NN(d,o,a,s,e),d.mode&1&&IN(s,u,e),e=d,l=u;var p=e.updateQueue;if(p===null){var y=new Set;y.add(l),e.updateQueue=y}else p.add(l);break e}else{if(!(e&1)){IN(s,u,e),tR();break e}l=Error(Xe(426))}}else if(nr&&a.mode&1){var x=DN(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),NN(x,o,a,s,e),LA(Gp(l,a));break e}}s=l=Gp(l,a),ni!==4&&(ni=2),j0===null?j0=[s]:j0.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=h6(s,l,e);MN(s,m);break e;case 1:a=l;var _=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(vc===null||!vc.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=d6(s,a,e);MN(s,b);break e}}s=s.return}while(s!==null)}D6(t)}catch(S){e=S,jr===t&&t!==null&&(jr=t=t.return);continue}break}while(!0)}function P6(){var n=e_.current;return e_.current=Q2,n===null?Q2:n}function tR(){(ni===0||ni===3||ni===2)&&(ni=4),wi===null||!(yh&268435455)&&!(dw&268435455)||tc(wi,Fi)}function r_(n,e){var t=En;En|=2;var r=P6();(wi!==n||Fi!==e)&&($l=null,Qf(n,e));do try{Nq();break}catch(i){R6(n,i)}while(!0);if(OA(),En=t,e_.current=r,jr!==null)throw Error(Xe(261));return wi=null,Fi=0,ni}function Nq(){for(;jr!==null;)I6(jr)}function kq(){for(;jr!==null&&!s$();)I6(jr)}function I6(n){var e=k6(n.alternate,n,fo);n.memoizedProps=n.pendingProps,e===null?D6(n):jr=e,KA.current=null}function D6(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Cq(t,e),t!==null){t.flags&=32767,jr=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ni=6,jr=null;return}}else if(t=Tq(t,e,fo),t!==null){jr=t;return}if(e=e.sibling,e!==null){jr=e;return}jr=e=n}while(e!==null);ni===0&&(ni=5)}function Cf(n,e,t){var r=On,i=oa.transition;try{oa.transition=null,On=1,Lq(n,e,t,r)}finally{oa.transition=i,On=r}return null}function Lq(n,e,t,r){do bp();while(ic!==null);if(En&6)throw Error(Xe(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Xe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(m$(n,s),n===wi&&(jr=wi=null,Fi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||w1||(w1=!0,L6(B2,function(){return bp(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=oa.transition,oa.transition=null;var o=On;On=1;var a=En;En|=4,KA.current=null,Rq(n,t),T6(t,n),tq(AM),z2=!!CM,AM=CM=null,n.current=t,Pq(t),o$(),En=a,On=o,oa.transition=s}else n.current=t;if(w1&&(w1=!1,ic=n,n_=i),s=n.pendingLanes,s===0&&(vc=null),u$(t.stateNode),js(n,Lr()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(t_)throw t_=!1,n=qM,qM=null,n;return n_&1&&n.tag!==0&&bp(),s=n.pendingLanes,s&1?n===YM?X0++:(X0=0,YM=n):X0=0,jc(),null}function bp(){if(ic!==null){var n=hU(n_),e=oa.transition,t=On;try{if(oa.transition=null,On=16>n?16:n,ic===null)var r=!1;else{if(n=ic,ic=null,n_=0,En&6)throw Error(Xe(331));var i=En;for(En|=4,ft=n.current;ft!==null;){var s=ft,o=s.child;if(ft.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ft=u;ft!==null;){var c=ft;switch(c.tag){case 0:case 11:case 15:G0(8,c,s)}var f=c.child;if(f!==null)f.return=c,ft=f;else for(;ft!==null;){c=ft;var h=c.sibling,d=c.return;if(S6(c),c===u){ft=null;break}if(h!==null){h.return=d,ft=h;break}ft=d}}}var p=s.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}ft=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ft=o;else e:for(;ft!==null;){if(s=ft,s.flags&2048)switch(s.tag){case 0:case 11:case 15:G0(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,ft=m;break e}ft=s.return}}var _=n.current;for(ft=_;ft!==null;){o=ft;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ft=w;else e:for(o=_;ft!==null;){if(a=ft,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hw(9,a)}}catch(S){Mr(a,a.return,S)}if(a===o){ft=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,ft=b;break e}ft=a.return}}if(En=i,jc(),gl&&typeof gl.onPostCommitFiberRoot=="function")try{gl.onPostCommitFiberRoot(iw,n)}catch{}r=!0}return r}finally{On=t,oa.transition=e}}return!1}function XN(n,e,t){e=Gp(t,e),e=h6(n,e,1),n=gc(n,e,1),e=Es(),n!==null&&(Dv(n,1,e),js(n,e))}function Mr(n,e,t){if(n.tag===3)XN(n,n,t);else for(;e!==null;){if(e.tag===3){XN(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(vc===null||!vc.has(r))){n=Gp(t,n),n=d6(e,n,1),e=gc(e,n,1),n=Es(),e!==null&&(Dv(e,1,n),js(e,n));break}}e=e.return}}function Fq(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Es(),n.pingedLanes|=n.suspendedLanes&t,wi===n&&(Fi&t)===t&&(ni===4||ni===3&&(Fi&130023424)===Fi&&500>Lr()-JA?Qf(n,0):ZA|=t),js(n,e)}function N6(n,e){e===0&&(n.mode&1?(e=f1,f1<<=1,!(f1&130023424)&&(f1=4194304)):e=1);var t=Es();n=fu(n,e),n!==null&&(Dv(n,e,t),js(n,t))}function Oq(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),N6(n,t)}function Bq(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Xe(314))}r!==null&&r.delete(e),N6(n,t)}var k6;k6=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Hs.current)Us=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Us=!1,Mq(n,e,t);Us=!!(n.flags&131072)}else Us=!1,nr&&e.flags&1048576&&BU(e,$2,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;a2(n,e),n=e.pendingProps;var i=zp(e,as.current);wp(e,t),i=jA(null,e,r,n,i,t);var s=XA();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gs(r)?(s=!0,j2(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,zA(e),i.updater=fw,e.stateNode=i,i._reactInternals=e,OM(e,r,n,t),e=zM(null,e,r,!0,s,t)):(e.tag=0,nr&&s&&NA(e),gs(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(a2(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=zq(r),n=Ea(r,n),i){case 0:e=UM(null,e,r,n,t);break e;case 1:e=FN(null,e,r,n,t);break e;case 11:e=kN(null,e,r,n,t);break e;case 14:e=LN(null,e,r,Ea(r.type,n),t);break e}throw Error(Xe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ea(r,i),UM(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ea(r,i),FN(n,e,r,i,t);case 3:e:{if(v6(e),n===null)throw Error(Xe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,GU(n,e),K2(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Gp(Error(Xe(423)),e),e=ON(n,e,r,t,i);break e}else if(r!==i){i=Gp(Error(Xe(424)),e),e=ON(n,e,r,t,i);break e}else for(_o=mc(e.stateNode.containerInfo.firstChild),To=e,nr=!0,Ca=null,t=WU(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Vp(),r===i){e=hu(n,e,t);break e}gs(n,e,r,t)}e=e.child}return e;case 5:return jU(e),n===null&&kM(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,RM(r,i)?o=null:s!==null&&RM(r,s)&&(e.flags|=32),g6(n,e),gs(n,e,o,t),e.child;case 6:return n===null&&kM(e),null;case 13:return y6(n,e,t);case 4:return VA(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Wp(e,null,r,t):gs(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ea(r,i),kN(n,e,r,i,t);case 7:return gs(n,e,e.pendingProps,t),e.child;case 8:return gs(n,e,e.pendingProps.children,t),e.child;case 12:return gs(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Xn(q2,r._currentValue),r._currentValue=o,s!==null)if(Fa(s.value,o)){if(s.children===i.children&&!Hs.current){e=hu(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=iu(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),LM(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Xe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),LM(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}gs(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,wp(e,t),i=ua(i),r=r(i),e.flags|=1,gs(n,e,r,t),e.child;case 14:return r=e.type,i=Ea(r,e.pendingProps),i=Ea(r.type,i),LN(n,e,r,i,t);case 15:return p6(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ea(r,i),a2(n,e),e.tag=1,Gs(r)?(n=!0,j2(e)):n=!1,wp(e,t),f6(e,r,i),OM(e,r,i,t),zM(null,e,r,!0,n,t);case 19:return x6(n,e,t);case 22:return m6(n,e,t)}throw Error(Xe(156,e.tag))};function L6(n,e){return lU(n,e)}function Uq(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ta(n,e,t,r){return new Uq(n,e,t,r)}function nR(n){return n=n.prototype,!(!n||!n.isReactComponent)}function zq(n){if(typeof n=="function")return nR(n)?1:0;if(n!=null){if(n=n.$$typeof,n===wA)return 11;if(n===bA)return 14}return 2}function xc(n,e){var t=n.alternate;return t===null?(t=ta(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function c2(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")nR(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case jd:return eh(t.children,i,s,e);case _A:o=8,i|=8;break;case aM:return n=ta(12,t,e,i|2),n.elementType=aM,n.lanes=s,n;case lM:return n=ta(13,t,e,i),n.elementType=lM,n.lanes=s,n;case uM:return n=ta(19,t,e,i),n.elementType=uM,n.lanes=s,n;case jB:return pw(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case HB:o=10;break e;case GB:o=9;break e;case wA:o=11;break e;case bA:o=14;break e;case Zu:o=16,r=null;break e}throw Error(Xe(130,n==null?n:typeof n,""))}return e=ta(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function eh(n,e,t,r){return n=ta(7,n,r,e),n.lanes=t,n}function pw(n,e,t,r){return n=ta(22,n,r,e),n.elementType=jB,n.lanes=t,n.stateNode={isHidden:!1},n}function ZS(n,e,t){return n=ta(6,n,null,e),n.lanes=t,n}function JS(n,e,t){return e=ta(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Vq(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=DS(0),this.expirationTimes=DS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=DS(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rR(n,e,t,r,i,s,o,a,l){return n=new Vq(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ta(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},zA(s),n}function Wq(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gd,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function F6(n){if(!n)return Pc;n=n._reactInternals;e:{if(Ph(n)!==n||n.tag!==1)throw Error(Xe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Xe(171))}if(n.tag===1){var t=n.type;if(Gs(t))return FU(n,t,e)}return e}function O6(n,e,t,r,i,s,o,a,l){return n=rR(t,r,!0,n,i,s,o,a,l),n.context=F6(null),t=n.current,r=Es(),i=yc(t),s=iu(r,i),s.callback=e??null,gc(t,s,i),n.current.lanes=i,Dv(n,i,r),js(n,r),n}function mw(n,e,t,r){var i=e.current,s=Es(),o=yc(i);return t=F6(t),e.context===null?e.context=t:e.pendingContext=t,e=iu(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=gc(i,e,o),n!==null&&(Na(n,i,o,s),i2(n,i,o)),o}function i_(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function $N(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function iR(n,e){$N(n,e),(n=n.alternate)&&$N(n,e)}function Hq(){return null}var B6=typeof reportError=="function"?reportError:function(n){console.error(n)};function sR(n){this._internalRoot=n}gw.prototype.render=sR.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Xe(409));mw(n,e,null,null)};gw.prototype.unmount=sR.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;xh(function(){mw(null,n,null,null)}),e[cu]=null}};function gw(n){this._internalRoot=n}gw.prototype.unstable_scheduleHydration=function(n){if(n){var e=mU();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ec.length&&e!==0&&e<ec[t].priority;t++);ec.splice(t,0,n),t===0&&vU(n)}};function oR(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function qN(){}function Gq(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=i_(o);s.call(u)}}var o=O6(e,r,n,0,null,!1,!1,"",qN);return n._reactRootContainer=o,n[cu]=o.current,Pg(n.nodeType===8?n.parentNode:n),xh(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=i_(l);a.call(u)}}var l=rR(n,0,!1,null,null,!1,!1,"",qN);return n._reactRootContainer=l,n[cu]=l.current,Pg(n.nodeType===8?n.parentNode:n),xh(function(){mw(e,l,t,r)}),l}function yw(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=i_(o);a.call(l)}}mw(e,o,n,i)}else o=Gq(t,e,n,i,r);return i_(o)}dU=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=C0(e.pendingLanes);t!==0&&(MA(e,t|1),js(e,Lr()),!(En&6)&&(jp=Lr()+500,jc()))}break;case 13:xh(function(){var r=fu(n,1);if(r!==null){var i=Es();Na(r,n,1,i)}}),iR(n,1)}};TA=function(n){if(n.tag===13){var e=fu(n,134217728);if(e!==null){var t=Es();Na(e,n,134217728,t)}iR(n,134217728)}};pU=function(n){if(n.tag===13){var e=yc(n),t=fu(n,e);if(t!==null){var r=Es();Na(t,n,e,r)}iR(n,e)}};mU=function(){return On};gU=function(n,e){var t=On;try{return On=n,e()}finally{On=t}};xM=function(n,e,t){switch(e){case"input":if(hM(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=lw(r);if(!i)throw Error(Xe(90));$B(r),hM(r,i)}}}break;case"textarea":YB(n,t);break;case"select":e=t.value,e!=null&&vp(n,!!t.multiple,e,!1)}};nU=QA;rU=xh;var jq={usingClientEntryPoint:!1,Events:[kv,Yd,lw,eU,tU,QA]},Qm={findFiberByHostInstance:Uf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xq={bundleType:Qm.bundleType,version:Qm.version,rendererPackageName:Qm.rendererPackageName,rendererConfig:Qm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bu.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=oU(n),n===null?null:n.stateNode},findFiberByHostInstance:Qm.findFiberByHostInstance||Hq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var b1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!b1.isDisabled&&b1.supportsFiber)try{iw=b1.inject(Xq),gl=b1}catch{}}No.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jq;No.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oR(e))throw Error(Xe(200));return Wq(n,e,null,t)};No.createRoot=function(n,e){if(!oR(n))throw Error(Xe(299));var t=!1,r="",i=B6;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=rR(n,1,!1,null,null,t,!1,r,i),n[cu]=e.current,Pg(n.nodeType===8?n.parentNode:n),new sR(e)};No.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Xe(188)):(n=Object.keys(n).join(","),Error(Xe(268,n)));return n=oU(e),n=n===null?null:n.stateNode,n};No.flushSync=function(n){return xh(n)};No.hydrate=function(n,e,t){if(!vw(e))throw Error(Xe(200));return yw(null,n,e,!0,t)};No.hydrateRoot=function(n,e,t){if(!oR(n))throw Error(Xe(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=B6;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=O6(e,null,n,1,t??null,i,!1,s,o),n[cu]=e.current,Pg(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new gw(e)};No.render=function(n,e,t){if(!vw(e))throw Error(Xe(200));return yw(null,n,e,!1,t)};No.unmountComponentAtNode=function(n){if(!vw(n))throw Error(Xe(40));return n._reactRootContainer?(xh(function(){yw(null,null,n,!1,function(){n._reactRootContainer=null,n[cu]=null})}),!0):!1};No.unstable_batchedUpdates=QA;No.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!vw(t))throw Error(Xe(200));if(n==null||n._reactInternals===void 0)throw Error(Xe(38));return yw(n,e,t,!1,r)};No.version="18.3.1-next-f1338f8080-20240426";function U6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U6)}catch(n){console.error(n)}}U6(),UB.exports=No;var $q=UB.exports,z6,YN=$q;z6=YN.createRoot,YN.hydrateRoot;/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var KN="popstate";function qq(n={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return JM("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Ug(i)}return Kq(e,t,null,n)}function gr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Oa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yq(){return Math.random().toString(36).substring(2,10)}function ZN(n,e){return{usr:n.state,key:n.key,idx:e}}function JM(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?hm(e):e,state:t,key:e&&e.key||r||Yq()}}function Ug({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function hm(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function Kq(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",l=null,u=c();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function c(){return(o.state||{idx:null}).idx}function f(){a="POP";let x=c(),m=x==null?null:x-u;u=x,l&&l({action:a,location:y.location,delta:m})}function h(x,m){a="PUSH";let _=JM(y.location,x,m);u=c()+1;let w=ZN(_,u),b=y.createHref(_);try{o.pushState(w,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(b)}s&&l&&l({action:a,location:y.location,delta:1})}function d(x,m){a="REPLACE";let _=JM(y.location,x,m);u=c();let w=ZN(_,u),b=y.createHref(_);o.replaceState(w,"",b),s&&l&&l({action:a,location:y.location,delta:0})}function p(x){return Zq(x)}let y={get action(){return a},get location(){return n(i,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(KN,f),l=x,()=>{i.removeEventListener(KN,f),l=null}},createHref(x){return e(i,x)},createURL:p,encodeLocation(x){let m=p(x);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:h,replace:d,go(x){return o.go(x)}};return y}function Zq(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),gr(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Ug(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function V6(n,e,t="/"){return Jq(n,e,t,!1)}function Jq(n,e,t,r){let i=typeof e=="string"?hm(e):e,s=du(i.pathname||"/",t);if(s==null)return null;let o=W6(n);Qq(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=cY(s);a=lY(o[l],u,r)}return a}function W6(n,e=[],t=[],r="",i=!1){let s=(o,a,l=i,u)=>{let c={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(r)&&l)return;gr(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let f=su([r,c.relativePath]),h=t.concat(c);o.children&&o.children.length>0&&(gr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),W6(o.children,e,h,f,l)),!(o.path==null&&!o.index)&&e.push({path:f,score:oY(f,o.index),routesMeta:h})};return n.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let u of H6(o.path))s(o,a,!0,u)}),e}function H6(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=H6(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function Qq(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:aY(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var eY=/^:[\w-]+$/,tY=3,nY=2,rY=1,iY=10,sY=-2,JN=n=>n==="*";function oY(n,e){let t=n.split("/"),r=t.length;return t.some(JN)&&(r+=sY),e&&(r+=nY),t.filter(i=>!JN(i)).reduce((i,s)=>i+(eY.test(s)?tY:s===""?rY:iY),r)}function aY(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function lY(n,e,t=!1){let{routesMeta:r}=n,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",f=s_({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!f&&u&&t&&!r[r.length-1].route.index&&(f=s_({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:su([s,f.pathname]),pathnameBase:pY(su([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=su([s,f.pathnameBase]))}return o}function s_(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=uY(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,{paramName:c,isOptional:f},h)=>{if(c==="*"){let p=a[h]||"";o=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const d=a[h];return f&&!d?u[c]=void 0:u[c]=(d||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:n}}function uY(n,e=!1,t=!0){Oa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function cY(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Oa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function du(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var G6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fY=n=>G6.test(n);function hY(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?hm(n):n,s;if(t)if(fY(t))s=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Oa(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?s=QN(t.substring(1),"/"):s=QN(t,e)}else s=e;return{pathname:s,search:mY(r),hash:gY(i)}}function QN(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function QS(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function dY(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function j6(n){let e=dY(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function X6(n,e,t,r=!1){let i;typeof n=="string"?i=hm(n):(i={...n},gr(!i.pathname||!i.pathname.includes("?"),QS("?","pathname","search",i)),gr(!i.pathname||!i.pathname.includes("#"),QS("#","pathname","hash",i)),gr(!i.search||!i.search.includes("#"),QS("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}a=f>=0?e[f]:"/"}let l=hY(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var su=n=>n.join("/").replace(/\/\/+/g,"/"),pY=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),mY=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,gY=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,vY=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function yY(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function xY(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var $6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function q6(n,e){let t=n;if(typeof t!="string"||!G6.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if($6)try{let s=new URL(window.location.href),o=t.startsWith("//")?new URL(s.protocol+t):new URL(t),a=du(o.pathname,e);o.origin===s.origin&&a!=null?t=a+o.search+o.hash:i=!0}catch{Oa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Y6=["POST","PUT","PATCH","DELETE"];new Set(Y6);var _Y=["GET",...Y6];new Set(_Y);var dm=U.createContext(null);dm.displayName="DataRouter";var xw=U.createContext(null);xw.displayName="DataRouterState";var wY=U.createContext(!1),K6=U.createContext({isTransitioning:!1});K6.displayName="ViewTransition";var bY=U.createContext(new Map);bY.displayName="Fetchers";var SY=U.createContext(null);SY.displayName="Await";var ha=U.createContext(null);ha.displayName="Navigation";var Fv=U.createContext(null);Fv.displayName="Location";var Su=U.createContext({outlet:null,matches:[],isDataRoute:!1});Su.displayName="Route";var aR=U.createContext(null);aR.displayName="RouteError";var Z6="REACT_ROUTER_ERROR",EY="REDIRECT",MY="ROUTE_ERROR_RESPONSE";function TY(n){if(n.startsWith(`${Z6}:${EY}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function CY(n){if(n.startsWith(`${Z6}:${MY}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new vY(e.status,e.statusText,e.data)}catch{}}function AY(n,{relative:e}={}){gr(Ov(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(ha),{hash:i,pathname:s,search:o}=Bv(n,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:su([t,s])),r.createHref({pathname:a,search:o,hash:i})}function Ov(){return U.useContext(Fv)!=null}function Ba(){return gr(Ov(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Fv).location}var J6="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Q6(n){U.useContext(ha).static||U.useLayoutEffect(n)}function _w(){let{isDataRoute:n}=U.useContext(Su);return n?VY():RY()}function RY(){gr(Ov(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(dm),{basename:e,navigator:t}=U.useContext(ha),{matches:r}=U.useContext(Su),{pathname:i}=Ba(),s=JSON.stringify(j6(r)),o=U.useRef(!1);return Q6(()=>{o.current=!0}),U.useCallback((l,u={})=>{if(Oa(o.current,J6),!o.current)return;if(typeof l=="number"){t.go(l);return}let c=X6(l,JSON.parse(s),i,u.relative==="path");n==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:su([e,c.pathname])),(u.replace?t.replace:t.push)(c,u.state,u)},[e,t,s,i,n])}U.createContext(null);function Bv(n,{relative:e}={}){let{matches:t}=U.useContext(Su),{pathname:r}=Ba(),i=JSON.stringify(j6(t));return U.useMemo(()=>X6(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function PY(n,e){return ez(n,e)}function ez(n,e,t,r,i){var _;gr(Ov(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=U.useContext(ha),{matches:o}=U.useContext(Su),a=o[o.length-1],l=a?a.params:{},u=a?a.pathname:"/",c=a?a.pathnameBase:"/",f=a&&a.route;{let w=f&&f.path||"";nz(u,!f||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let h=Ba(),d;if(e){let w=typeof e=="string"?hm(e):e;gr(c==="/"||((_=w.pathname)==null?void 0:_.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${w.pathname}" was given in the \`location\` prop.`),d=w}else d=h;let p=d.pathname||"/",y=p;if(c!=="/"){let w=c.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=V6(n,{pathname:y});Oa(f||x!=null,`No routes matched location "${d.pathname}${d.search}${d.hash}" `),Oa(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${d.pathname}${d.search}${d.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let m=LY(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:su([c,s.encodeLocation?s.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:su([c,s.encodeLocation?s.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),o,t,r,i);return e&&m?U.createElement(Fv.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...d},navigationType:"POP"}},m):m}function IY(){let n=zY(),e=yY(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:s},"ErrorBoundary")," or"," ",U.createElement("code",{style:s},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var DY=U.createElement(IY,null),tz=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=CY(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(Su.Provider,{value:this.props.routeContext},U.createElement(aR.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(NY,{error:n},e):e}};tz.contextType=wY;var eE=new WeakMap;function NY({children:n,error:e}){let{basename:t}=U.useContext(ha);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=TY(e.digest);if(r){let i=eE.get(e);if(i)throw i;let s=q6(r.location,t);if($6&&!eE.get(e))if(s.isExternal||r.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:r.replace}));throw eE.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return n}function kY({routeContext:n,match:e,children:t}){let r=U.useContext(dm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Su.Provider,{value:n},t)}function LY(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,o=t==null?void 0:t.errors;if(o!=null){let c=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);gr(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let a=!1,l=-1;if(t)for(let c=0;c<s.length;c++){let f=s[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:h,errors:d}=t,p=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!d||d[f.route.id]===void 0);if(f.route.lazy||p){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}let u=t&&r?(c,f)=>{var h,d;r(c,{location:t.location,params:((d=(h=t.matches)==null?void 0:h[0])==null?void 0:d.params)??{},unstable_pattern:xY(t.matches),errorInfo:f})}:void 0;return s.reduceRight((c,f,h)=>{let d,p=!1,y=null,x=null;t&&(d=o&&f.route.id?o[f.route.id]:void 0,y=f.route.errorElement||DY,a&&(l<0&&h===0?(nz("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,x=null):l===h&&(p=!0,x=f.route.hydrateFallbackElement||null)));let m=e.concat(s.slice(0,h+1)),_=()=>{let w;return d?w=y:p?w=x:f.route.Component?w=U.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=c,U.createElement(kY,{match:f,routeContext:{outlet:c,matches:m,isDataRoute:t!=null},children:w})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?U.createElement(tz,{location:t.location,revalidation:t.revalidation,component:y,error:d,children:_(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:u}):_()},null)}function lR(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FY(n){let e=U.useContext(dm);return gr(e,lR(n)),e}function OY(n){let e=U.useContext(xw);return gr(e,lR(n)),e}function BY(n){let e=U.useContext(Su);return gr(e,lR(n)),e}function uR(n){let e=BY(n),t=e.matches[e.matches.length-1];return gr(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function UY(){return uR("useRouteId")}function zY(){var r;let n=U.useContext(aR),e=OY("useRouteError"),t=uR("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function VY(){let{router:n}=FY("useNavigate"),e=uR("useNavigate"),t=U.useRef(!1);return Q6(()=>{t.current=!0}),U.useCallback(async(i,s={})=>{Oa(t.current,J6),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...s}))},[n,e])}var ek={};function nz(n,e,t){!e&&!ek[n]&&(ek[n]=!0,Oa(!1,t))}U.memo(WY);function WY({routes:n,future:e,state:t,onError:r}){return ez(n,void 0,t,r,e)}function kd(n){gr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function HY({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:s=!1,unstable_useTransitions:o}){gr(!Ov(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),l=U.useMemo(()=>({basename:a,navigator:i,static:s,unstable_useTransitions:o,future:{}}),[a,i,s,o]);typeof t=="string"&&(t=hm(t));let{pathname:u="/",search:c="",hash:f="",state:h=null,key:d="default"}=t,p=U.useMemo(()=>{let y=du(u,a);return y==null?null:{location:{pathname:y,search:c,hash:f,state:h,key:d},navigationType:r}},[a,u,c,f,h,d,r]);return Oa(p!=null,`<Router basename="${a}"> is not able to match the URL "${u}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:U.createElement(ha.Provider,{value:l},U.createElement(Fv.Provider,{children:e,value:p}))}function GY({children:n,location:e}){return PY(QM(n),e)}function QM(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let s=[...e,i];if(r.type===U.Fragment){t.push.apply(t,QM(r.props.children,s));return}gr(r.type===kd,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=QM(r.props.children,s)),t.push(o)}),t}var f2="get",h2="application/x-www-form-urlencoded";function ww(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function jY(n){return ww(n)&&n.tagName.toLowerCase()==="button"}function XY(n){return ww(n)&&n.tagName.toLowerCase()==="form"}function $Y(n){return ww(n)&&n.tagName.toLowerCase()==="input"}function qY(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function YY(n,e){return n.button===0&&(!e||e==="_self")&&!qY(n)}var S1=null;function KY(){if(S1===null)try{new FormData(document.createElement("form"),0),S1=!1}catch{S1=!0}return S1}var ZY=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tE(n){return n!=null&&!ZY.has(n)?(Oa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${h2}"`),null):n}function JY(n,e){let t,r,i,s,o;if(XY(n)){let a=n.getAttribute("action");r=a?du(a,e):null,t=n.getAttribute("method")||f2,i=tE(n.getAttribute("enctype"))||h2,s=new FormData(n)}else if(jY(n)||$Y(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(r=l?du(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||f2,i=tE(n.getAttribute("formenctype"))||tE(a.getAttribute("enctype"))||h2,s=new FormData(a,n),!KY()){let{name:u,type:c,value:f}=n;if(c==="image"){let h=u?`${u}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else u&&s.append(u,f)}}else{if(ww(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=f2,r=null,i=h2,o=n}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cR(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function QY(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&du(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function eK(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tK(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function nK(n,e,t){let r=await Promise.all(n.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await eK(s,t);return o.links?o.links():[]}return[]}));return oK(r.flat(1).filter(tK).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function tk(n,e,t,r,i,s){let o=(l,u)=>t[u]?l.route.id!==t[u].route.id:!0,a=(l,u)=>{var c;return t[u].pathname!==l.pathname||((c=t[u].route.path)==null?void 0:c.endsWith("*"))&&t[u].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):s==="data"?e.filter((l,u)=>{var f;let c=r.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function rK(n,e,{includeHydrateFallback:t}={}){return iK(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function iK(n){return[...new Set(n)]}function sK(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function oK(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let s=JSON.stringify(sK(i));return t.has(s)||(t.add(s),r.push({key:s,link:i})),r},[])}function rz(){let n=U.useContext(dm);return cR(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function aK(){let n=U.useContext(xw);return cR(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var fR=U.createContext(void 0);fR.displayName="FrameworkContext";function iz(){let n=U.useContext(fR);return cR(n,"You must render this element inside a <HydratedRouter> element"),n}function lK(n,e){let t=U.useContext(fR),[r,i]=U.useState(!1),[s,o]=U.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:f}=e,h=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let y=m=>{m.forEach(_=>{o(_.isIntersecting)})},x=new IntersectionObserver(y,{threshold:.5});return h.current&&x.observe(h.current),()=>{x.disconnect()}}},[n]),U.useEffect(()=>{if(r){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[r]);let d=()=>{i(!0)},p=()=>{i(!1),o(!1)};return t?n!=="intent"?[s,h,{}]:[s,h,{onFocus:e0(a,d),onBlur:e0(l,p),onMouseEnter:e0(u,d),onMouseLeave:e0(c,p),onTouchStart:e0(f,d)}]:[!1,h,{}]}function e0(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function uK({page:n,...e}){let{router:t}=rz(),r=U.useMemo(()=>V6(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(fK,{page:n,matches:r,...e}):null}function cK(n){let{manifest:e,routeModules:t}=iz(),[r,i]=U.useState([]);return U.useEffect(()=>{let s=!1;return nK(n,e,t).then(o=>{s||i(o)}),()=>{s=!0}},[n,e,t]),r}function fK({page:n,matches:e,...t}){let r=Ba(),{manifest:i,routeModules:s}=iz(),{basename:o}=rz(),{loaderData:a,matches:l}=aK(),u=U.useMemo(()=>tk(n,e,l,i,r,"data"),[n,e,l,i,r]),c=U.useMemo(()=>tk(n,e,l,i,r,"assets"),[n,e,l,i,r]),f=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let p=new Set,y=!1;if(e.forEach(m=>{var w;let _=i.routes[m.route.id];!_||!_.hasLoader||(!u.some(b=>b.route.id===m.route.id)&&m.route.id in a&&((w=s[m.route.id])!=null&&w.shouldRevalidate)||_.hasClientLoader?y=!0:p.add(m.route.id))}),p.size===0)return[];let x=QY(n,o,"data");return y&&p.size>0&&x.searchParams.set("_routes",e.filter(m=>p.has(m.route.id)).map(m=>m.route.id).join(",")),[x.pathname+x.search]},[o,a,r,i,u,e,n,s]),h=U.useMemo(()=>rK(c,i),[c,i]),d=cK(c);return U.createElement(U.Fragment,null,f.map(p=>U.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),h.map(p=>U.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),d.map(({key:p,link:y})=>U.createElement("link",{key:p,nonce:t.nonce,...y})))}function hK(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var dK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dK&&(window.__reactRouterVersion="7.11.0")}catch{}function pK({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=qq({window:r,v5Compat:!0}));let s=i.current,[o,a]=U.useState({action:s.action,location:s.location}),l=U.useCallback(u=>{t===!1?a(u):U.startTransition(()=>a(u))},[t]);return U.useLayoutEffect(()=>s.listen(l),[s,l]),U.createElement(HY,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:t})}var sz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oz=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:f,unstable_defaultShouldRevalidate:h,...d},p){let{basename:y,unstable_useTransitions:x}=U.useContext(ha),m=typeof u=="string"&&sz.test(u),_=q6(u,y);u=_.to;let w=AY(u,{relative:i}),[b,S,M]=lK(r,d),T=yK(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:f,unstable_defaultShouldRevalidate:h,unstable_useTransitions:x});function P(A){e&&e(A),A.defaultPrevented||T(A)}let C=U.createElement("a",{...d,...M,href:_.absoluteURL||w,onClick:_.isExternal||s?e:P,ref:hK(p,S),target:l,"data-discover":!m&&t==="render"?"true":void 0});return b&&!m?U.createElement(U.Fragment,null,C,U.createElement(uK,{page:w})):C});oz.displayName="Link";var mK=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:l,...u},c){let f=Bv(o,{relative:u.relative}),h=Ba(),d=U.useContext(xw),{navigator:p,basename:y}=U.useContext(ha),x=d!=null&&SK(f)&&a===!0,m=p.encodeLocation?p.encodeLocation(f).pathname:f.pathname,_=h.pathname,w=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;t||(_=_.toLowerCase(),w=w?w.toLowerCase():null,m=m.toLowerCase()),w&&y&&(w=du(w,y)||w);const b=m!=="/"&&m.endsWith("/")?m.length-1:m.length;let S=_===m||!i&&_.startsWith(m)&&_.charAt(b)==="/",M=w!=null&&(w===m||!i&&w.startsWith(m)&&w.charAt(m.length)==="/"),T={isActive:S,isPending:M,isTransitioning:x},P=S?e:void 0,C;typeof r=="function"?C=r(T):C=[r,S?"active":null,M?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let A=typeof s=="function"?s(T):s;return U.createElement(oz,{...u,"aria-current":P,className:C,ref:c,style:A,to:o,viewTransition:a},typeof l=="function"?l(T):l)});mK.displayName="NavLink";var gK=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:s,method:o=f2,action:a,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:f,unstable_defaultShouldRevalidate:h,...d},p)=>{let{unstable_useTransitions:y}=U.useContext(ha),x=wK(),m=bK(a,{relative:u}),_=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&sz.test(a),b=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let M=S.nativeEvent.submitter,T=(M==null?void 0:M.getAttribute("formmethod"))||o,P=()=>x(M||S.currentTarget,{fetcherKey:e,method:T,navigate:t,replace:i,state:s,relative:u,preventScrollReset:c,viewTransition:f,unstable_defaultShouldRevalidate:h});y&&t!==!1?U.startTransition(()=>P()):P()};return U.createElement("form",{ref:p,method:_,action:m,onSubmit:r?l:b,...d,"data-discover":!w&&n==="render"?"true":void 0})});gK.displayName="Form";function vK(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function az(n){let e=U.useContext(dm);return gr(e,vK(n)),e}function yK(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:l}={}){let u=_w(),c=Ba(),f=Bv(n,{relative:s});return U.useCallback(h=>{if(YY(h,e)){h.preventDefault();let d=t!==void 0?t:Ug(c)===Ug(f),p=()=>u(n,{replace:d,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a});l?U.startTransition(()=>p()):p()}},[c,u,f,t,r,e,n,i,s,o,a,l])}var xK=0,_K=()=>`__${String(++xK)}__`;function wK(){let{router:n}=az("useSubmit"),{basename:e}=U.useContext(ha),t=UY(),r=n.fetch,i=n.navigate;return U.useCallback(async(s,o={})=>{let{action:a,method:l,encType:u,formData:c,body:f}=JY(s,e);if(o.navigate===!1){let h=o.fetcherKey||_K();await r(h,t,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:c,body:f,formMethod:o.method||l,formEncType:o.encType||u,flushSync:o.flushSync})}else await i(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:c,body:f,formMethod:o.method||l,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function bK(n,{relative:e}={}){let{basename:t}=U.useContext(ha),r=U.useContext(Su);gr(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...Bv(n||".",{relative:e})},o=Ba();if(n==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(c=>c==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let c=a.toString();s.search=c?`?${c}`:""}}return(!n||n===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:su([t,s.pathname])),Ug(s)}function SK(n,{relative:e}={}){let t=U.useContext(K6);gr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=az("useViewTransitionState"),i=Bv(n,{relative:e});if(!t.isTransitioning)return!1;let s=du(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=du(t.nextLocation.pathname,r)||t.nextLocation.pathname;return s_(i.pathname,o)!=null||s_(i.pathname,s)!=null}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const pm="160",EK={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},MK={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},lz=0,eT=1,uz=2,TK=3,cz=0,bw=1,$0=2,Ma=3,Tl=0,ri=1,xs=2,CK=2,Ms=0,th=1,o_=2,tT=3,nT=4,fz=5,nc=100,hz=101,dz=102,rT=103,iT=104,pz=200,mz=201,gz=202,vz=203,a_=204,l_=205,yz=206,xz=207,_z=208,wz=209,bz=210,Sz=211,Ez=212,Mz=213,Tz=214,Cz=0,hR=1,Az=2,zg=3,Rz=4,Pz=5,Iz=6,Dz=7,Uv=0,Nz=1,kz=2,ka=0,Lz=1,Fz=2,Oz=3,dR=4,Bz=5,Uz=6,sT="attached",zz="detached",Sw=300,pu=301,Ic=302,Vg=303,Wg=304,mm=306,Hg=1e3,Cr=1001,Gg=1002,kr=1003,u_=1004,AK=1004,q0=1005,RK=1005,bn=1006,pR=1007,PK=1007,Dc=1008,IK=1008,Oi=1009,Vz=1010,Wz=1011,Ew=1012,mR=1013,fl=1014,zs=1015,Nc=1016,gR=1017,vR=1018,ou=1020,Hz=1021,ki=1023,Gz=1024,jz=1025,_c=1026,kc=1027,Xz=1028,yR=1029,$z=1030,xR=1031,_R=1033,d2=33776,p2=33777,m2=33778,g2=33779,oT=35840,aT=35841,lT=35842,uT=35843,wR=36196,cT=37492,fT=37496,hT=37808,dT=37809,pT=37810,mT=37811,gT=37812,vT=37813,yT=37814,xT=37815,_T=37816,wT=37817,bT=37818,ST=37819,ET=37820,MT=37821,v2=36492,TT=36494,CT=36495,qz=36283,AT=36284,RT=36285,PT=36286,Yz=2200,Kz=2201,Zz=2202,jg=2300,Xg=2301,y2=2302,Wf=2400,Hf=2401,$g=2402,Mw=2500,bR=2501,DK=0,NK=1,kK=2,SR=3e3,wc=3001,gm=3200,Jz=3201,Xc=0,Qz=1,_s="",mn="srgb",fa="srgb-linear",Tw="display-p3",zv="display-p3-linear",qg="linear",Gn="srgb",Yg="rec709",Kg="p3",LK=0,Af=7680,FK=7681,OK=7682,BK=7683,UK=34055,zK=34056,VK=5386,WK=512,HK=513,GK=514,jK=515,XK=516,$K=517,qK=518,IT=519,e8=512,t8=513,n8=514,ER=515,r8=516,i8=517,s8=518,o8=519,Zg=35044,YK=35048,KK=35040,ZK=35045,JK=35049,QK=35041,eZ=35046,tZ=35050,nZ=35042,rZ="100",DT="300 es",c_=1035,Ra=2e3,Xp=2001;class da{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const Xi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let nk=1234567;const nh=Math.PI/180,$p=180/Math.PI;function Co(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Xi[n&255]+Xi[n>>8&255]+Xi[n>>16&255]+Xi[n>>24&255]+"-"+Xi[e&255]+Xi[e>>8&255]+"-"+Xi[e>>16&15|64]+Xi[e>>24&255]+"-"+Xi[t&63|128]+Xi[t>>8&255]+"-"+Xi[t>>16&255]+Xi[t>>24&255]+Xi[r&255]+Xi[r>>8&255]+Xi[r>>16&255]+Xi[r>>24&255]).toLowerCase()}function Tr(n,e,t){return Math.max(e,Math.min(t,n))}function MR(n,e){return(n%e+e)%e}function iZ(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function sZ(n,e,t){return n!==e?(t-n)/(e-n):0}function Y0(n,e,t){return(1-t)*n+t*e}function oZ(n,e,t,r){return Y0(n,e,1-Math.exp(-t*r))}function aZ(n,e=1){return e-Math.abs(MR(n,e*2)-e)}function lZ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function uZ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function cZ(n,e){return n+Math.floor(Math.random()*(e-n+1))}function fZ(n,e){return n+Math.random()*(e-n)}function hZ(n){return n*(.5-Math.random())}function dZ(n){n!==void 0&&(nk=n);let e=nk+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pZ(n){return n*nh}function mZ(n){return n*$p}function NT(n){return(n&n-1)===0&&n!==0}function gZ(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function f_(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function vZ(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+r)/2),c=o((e+r)/2),f=s((e-r)/2),h=o((e-r)/2),d=s((r-e)/2),p=o((r-e)/2);switch(i){case"XYX":n.set(a*c,l*f,l*h,a*u);break;case"YZY":n.set(l*h,a*c,l*f,a*u);break;case"ZXZ":n.set(l*f,l*h,a*c,a*u);break;case"XZX":n.set(a*c,l*p,l*d,a*u);break;case"YXY":n.set(l*d,a*c,l*p,a*u);break;case"ZYZ":n.set(l*p,l*d,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Os(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Zt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const uo={DEG2RAD:nh,RAD2DEG:$p,generateUUID:Co,clamp:Tr,euclideanModulo:MR,mapLinear:iZ,inverseLerp:sZ,lerp:Y0,damp:oZ,pingpong:aZ,smoothstep:lZ,smootherstep:uZ,randInt:cZ,randFloat:fZ,randFloatSpread:hZ,seededRandom:dZ,degToRad:pZ,radToDeg:mZ,isPowerOfTwo:NT,ceilPowerOfTwo:gZ,floorPowerOfTwo:f_,setQuaternionFromProperEuler:vZ,normalize:Zt,denormalize:Os};class Me{constructor(e=0,t=0){Me.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Tr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class en{constructor(e,t,r,i,s,o,a,l,u){en.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,u)}set(e,t,r,i,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=r,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],u=r[1],c=r[4],f=r[7],h=r[2],d=r[5],p=r[8],y=i[0],x=i[3],m=i[6],_=i[1],w=i[4],b=i[7],S=i[2],M=i[5],T=i[8];return s[0]=o*y+a*_+l*S,s[3]=o*x+a*w+l*M,s[6]=o*m+a*b+l*T,s[1]=u*y+c*_+f*S,s[4]=u*x+c*w+f*M,s[7]=u*m+c*b+f*T,s[2]=h*y+d*_+p*S,s[5]=h*x+d*w+p*M,s[8]=h*m+d*b+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-r*s*c+r*a*l+i*s*u-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=c*o-a*u,h=a*l-c*s,d=u*s-o*l,p=t*f+r*h+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/p;return e[0]=f*y,e[1]=(i*u-c*r)*y,e[2]=(a*r-i*o)*y,e[3]=h*y,e[4]=(c*t-i*l)*y,e[5]=(i*s-a*t)*y,e[6]=d*y,e[7]=(r*l-u*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(r*l,r*u,-r*(l*o+u*a)+o+e,-i*u,i*l,-i*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(nE.makeScale(e,t)),this}rotate(e){return this.premultiply(nE.makeRotation(-e)),this}translate(e,t){return this.premultiply(nE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const nE=new en;function a8(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const yZ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function np(n,e){return new yZ[n](e)}function Jg(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function l8(){const n=Jg("canvas");return n.style.display="block",n}const rk={};function K0(n){n in rk||(rk[n]=!0,console.warn(n))}const ik=new en().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),sk=new en().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),E1={[fa]:{transfer:qg,primaries:Yg,toReference:n=>n,fromReference:n=>n},[mn]:{transfer:Gn,primaries:Yg,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[zv]:{transfer:qg,primaries:Kg,toReference:n=>n.applyMatrix3(sk),fromReference:n=>n.applyMatrix3(ik)},[Tw]:{transfer:Gn,primaries:Kg,toReference:n=>n.convertSRGBToLinear().applyMatrix3(sk),fromReference:n=>n.applyMatrix3(ik).convertLinearToSRGB()}},xZ=new Set([fa,zv]),Fn={enabled:!0,_workingColorSpace:fa,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!xZ.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=E1[e].toReference,i=E1[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return E1[n].primaries},getTransfer:function(n){return n===_s?qg:E1[n].transfer}};function Sp(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function rE(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let nd;class TR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{nd===void 0&&(nd=Jg("canvas")),nd.width=e.width,nd.height=e.height;const r=nd.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=nd}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Jg("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=Sp(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Sp(t[r]/255)*255):t[r]=Sp(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _Z=0;class Gf{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_Z++}),this.uuid=Co(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(iE(i[o].image)):s.push(iE(i[o]))}else s=iE(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function iE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?TR.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wZ=0;class vr extends da{constructor(e=vr.DEFAULT_IMAGE,t=vr.DEFAULT_MAPPING,r=Cr,i=Cr,s=bn,o=Dc,a=ki,l=Oi,u=vr.DEFAULT_ANISOTROPY,c=_s){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wZ++}),this.uuid=Co(),this.name="",this.source=new Gf(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Me(0,0),this.repeat=new Me(1,1),this.center=new Me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new en,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof c=="string"?this.colorSpace=c:(K0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===wc?mn:_s),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Sw)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Hg:e.x=e.x-Math.floor(e.x);break;case Cr:e.x=e.x<0?0:1;break;case Gg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Hg:e.y=e.y-Math.floor(e.y);break;case Cr:e.y=e.y<0?0:1;break;case Gg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return K0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===mn?wc:SR}set encoding(e){K0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===wc?mn:_s}}vr.DEFAULT_IMAGE=null;vr.DEFAULT_MAPPING=Sw;vr.DEFAULT_ANISOTROPY=1;class Sn{constructor(e=0,t=0,r=0,i=1){Sn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,u=l[0],c=l[4],f=l[8],h=l[1],d=l[5],p=l[9],y=l[2],x=l[6],m=l[10];if(Math.abs(c-h)<.01&&Math.abs(f-y)<.01&&Math.abs(p-x)<.01){if(Math.abs(c+h)<.1&&Math.abs(f+y)<.1&&Math.abs(p+x)<.1&&Math.abs(u+d+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(u+1)/2,b=(d+1)/2,S=(m+1)/2,M=(c+h)/4,T=(f+y)/4,P=(p+x)/4;return w>b&&w>S?w<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(w),i=M/r,s=T/r):b>S?b<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(b),r=M/i,s=P/i):S<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(S),r=T/s,i=P/s),this.set(r,i,s,t),this}let _=Math.sqrt((x-p)*(x-p)+(f-y)*(f-y)+(h-c)*(h-c));return Math.abs(_)<.001&&(_=1),this.x=(x-p)/_,this.y=(f-y)/_,this.z=(h-c)/_,this.w=Math.acos((u+d+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class u8 extends da{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Sn(0,0,e,t),this.scissorTest=!1,this.viewport=new Sn(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(K0("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===wc?mn:_s),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:bn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new vr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Gf(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Br extends u8{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class Cw extends vr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=kr,this.minFilter=kr,this.wrapR=Cr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bZ extends Br{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new Cw(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class CR extends vr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=kr,this.minFilter=kr,this.wrapR=Cr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class SZ extends Br{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new CR(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class EZ extends Br{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Xs{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let l=r[i+0],u=r[i+1],c=r[i+2],f=r[i+3];const h=s[o+0],d=s[o+1],p=s[o+2],y=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=f;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=y;return}if(f!==y||l!==h||u!==d||c!==p){let x=1-a;const m=l*h+u*d+c*p+f*y,_=m>=0?1:-1,w=1-m*m;if(w>Number.EPSILON){const S=Math.sqrt(w),M=Math.atan2(S,m*_);x=Math.sin(x*M)/S,a=Math.sin(a*M)/S}const b=a*_;if(l=l*x+h*b,u=u*x+d*b,c=c*x+p*b,f=f*x+y*b,x===1-a){const S=1/Math.sqrt(l*l+u*u+c*c+f*f);l*=S,u*=S,c*=S,f*=S}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],l=r[i+1],u=r[i+2],c=r[i+3],f=s[o],h=s[o+1],d=s[o+2],p=s[o+3];return e[t]=a*p+c*f+l*d-u*h,e[t+1]=l*p+c*h+u*f-a*d,e[t+2]=u*p+c*d+a*h-l*f,e[t+3]=c*p-a*f-l*h-u*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(r/2),c=a(i/2),f=a(s/2),h=l(r/2),d=l(i/2),p=l(s/2);switch(o){case"XYZ":this._x=h*c*f+u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f-h*d*p;break;case"YXZ":this._x=h*c*f+u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f+h*d*p;break;case"ZXY":this._x=h*c*f-u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f-h*d*p;break;case"ZYX":this._x=h*c*f-u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f+h*d*p;break;case"YZX":this._x=h*c*f+u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f-h*d*p;break;case"XZY":this._x=h*c*f-u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],c=t[6],f=t[10],h=r+a+f;if(h>0){const d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-l)*d,this._y=(s-u)*d,this._z=(o-i)*d}else if(r>a&&r>f){const d=2*Math.sqrt(1+r-a-f);this._w=(c-l)/d,this._x=.25*d,this._y=(i+o)/d,this._z=(s+u)/d}else if(a>f){const d=2*Math.sqrt(1+a-r-f);this._w=(s-u)/d,this._x=(i+o)/d,this._y=.25*d,this._z=(l+c)/d}else{const d=2*Math.sqrt(1+f-r-a);this._w=(o-i)/d,this._x=(s+u)/d,this._y=(l+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Tr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+o*a+i*u-s*l,this._y=i*c+o*l+s*a-r*u,this._z=s*c+o*u+r*l-i*a,this._w=o*c-r*a-i*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const d=1-t;return this._w=d*o+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),f=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=o*f+this._w*h,this._x=r*f+this._x*h,this._y=i*f+this._y*h,this._z=s*f+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,r=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ok.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ok.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*i-a*r),c=2*(a*t-s*i),f=2*(s*r-o*t);return this.x=t+l*u+o*f-a*c,this.y=r+l*c+a*u-s*f,this.z=i+l*f+s*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return sE.copy(this).projectOnVector(e),this.sub(sE)}reflect(e){return this.sub(sE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Tr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const sE=new Q,ok=new Xs;class Ts{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(ya.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(ya.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=ya.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ya):ya.fromBufferAttribute(s,o),ya.applyMatrix4(e.matrixWorld),this.expandByPoint(ya);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),M1.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),M1.copy(r.boundingBox)),M1.applyMatrix4(e.matrixWorld),this.union(M1)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ya),ya.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(t0),T1.subVectors(this.max,t0),rd.subVectors(e.a,t0),id.subVectors(e.b,t0),sd.subVectors(e.c,t0),Uu.subVectors(id,rd),zu.subVectors(sd,id),hf.subVectors(rd,sd);let t=[0,-Uu.z,Uu.y,0,-zu.z,zu.y,0,-hf.z,hf.y,Uu.z,0,-Uu.x,zu.z,0,-zu.x,hf.z,0,-hf.x,-Uu.y,Uu.x,0,-zu.y,zu.x,0,-hf.y,hf.x,0];return!oE(t,rd,id,sd,T1)||(t=[1,0,0,0,1,0,0,0,1],!oE(t,rd,id,sd,T1))?!1:(C1.crossVectors(Uu,zu),t=[C1.x,C1.y,C1.z],oE(t,rd,id,sd,T1))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ya).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ya).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ul[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ul[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ul[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ul[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ul[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ul[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ul[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ul[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ul),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ul=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],ya=new Q,M1=new Ts,rd=new Q,id=new Q,sd=new Q,Uu=new Q,zu=new Q,hf=new Q,t0=new Q,T1=new Q,C1=new Q,df=new Q;function oE(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){df.fromArray(n,s);const a=i.x*Math.abs(df.x)+i.y*Math.abs(df.y)+i.z*Math.abs(df.z),l=e.dot(df),u=t.dot(df),c=r.dot(df);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const MZ=new Ts,n0=new Q,aE=new Q;class ss{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):MZ.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;n0.subVectors(e,this.center);const t=n0.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(n0,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(aE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(n0.copy(e.center).add(aE)),this.expandByPoint(n0.copy(e.center).sub(aE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const zl=new Q,lE=new Q,A1=new Q,Vu=new Q,uE=new Q,R1=new Q,cE=new Q;class vm{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=zl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(zl.copy(this.origin).addScaledVector(this.direction,t),zl.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){lE.copy(e).add(t).multiplyScalar(.5),A1.copy(t).sub(e).normalize(),Vu.copy(this.origin).sub(lE);const s=e.distanceTo(t)*.5,o=-this.direction.dot(A1),a=Vu.dot(this.direction),l=-Vu.dot(A1),u=Vu.lengthSq(),c=Math.abs(1-o*o);let f,h,d,p;if(c>0)if(f=o*l-a,h=o*a-l,p=s*c,f>=0)if(h>=-p)if(h<=p){const y=1/c;f*=y,h*=y,d=f*(f+o*h+2*a)+h*(o*f+h+2*l)+u}else h=s,f=Math.max(0,-(o*h+a)),d=-f*f+h*(h+2*l)+u;else h=-s,f=Math.max(0,-(o*h+a)),d=-f*f+h*(h+2*l)+u;else h<=-p?(f=Math.max(0,-(-o*s+a)),h=f>0?-s:Math.min(Math.max(-s,-l),s),d=-f*f+h*(h+2*l)+u):h<=p?(f=0,h=Math.min(Math.max(-s,-l),s),d=h*(h+2*l)+u):(f=Math.max(0,-(o*s+a)),h=f>0?s:Math.min(Math.max(-s,-l),s),d=-f*f+h*(h+2*l)+u);else h=o>0?-s:s,f=Math.max(0,-(o*h+a)),d=-f*f+h*(h+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(lE).addScaledVector(A1,h),d}intersectSphere(e,t){zl.subVectors(e.center,this.origin);const r=zl.dot(this.direction),i=zl.dot(zl)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,f=1/this.direction.z,h=this.origin;return u>=0?(r=(e.min.x-h.x)*u,i=(e.max.x-h.x)*u):(r=(e.max.x-h.x)*u,i=(e.min.x-h.x)*u),c>=0?(s=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(s=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-h.z)*f,l=(e.max.z-h.z)*f):(a=(e.max.z-h.z)*f,l=(e.min.z-h.z)*f),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,zl)!==null}intersectTriangle(e,t,r,i,s){uE.subVectors(t,e),R1.subVectors(r,e),cE.crossVectors(uE,R1);let o=this.direction.dot(cE),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Vu.subVectors(this.origin,e);const l=a*this.direction.dot(R1.crossVectors(Vu,R1));if(l<0)return null;const u=a*this.direction.dot(uE.cross(Vu));if(u<0||l+u>o)return null;const c=-a*Vu.dot(cE);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ht{constructor(e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x){Ht.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x)}set(e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x){const m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=i,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=u,m[6]=c,m[10]=f,m[14]=h,m[3]=d,m[7]=p,m[11]=y,m[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ht().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/od.setFromMatrixColumn(e,0).length(),s=1/od.setFromMatrixColumn(e,1).length(),o=1/od.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const h=o*c,d=o*f,p=a*c,y=a*f;t[0]=l*c,t[4]=-l*f,t[8]=u,t[1]=d+p*u,t[5]=h-y*u,t[9]=-a*l,t[2]=y-h*u,t[6]=p+d*u,t[10]=o*l}else if(e.order==="YXZ"){const h=l*c,d=l*f,p=u*c,y=u*f;t[0]=h+y*a,t[4]=p*a-d,t[8]=o*u,t[1]=o*f,t[5]=o*c,t[9]=-a,t[2]=d*a-p,t[6]=y+h*a,t[10]=o*l}else if(e.order==="ZXY"){const h=l*c,d=l*f,p=u*c,y=u*f;t[0]=h-y*a,t[4]=-o*f,t[8]=p+d*a,t[1]=d+p*a,t[5]=o*c,t[9]=y-h*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const h=o*c,d=o*f,p=a*c,y=a*f;t[0]=l*c,t[4]=p*u-d,t[8]=h*u+y,t[1]=l*f,t[5]=y*u+h,t[9]=d*u-p,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const h=o*l,d=o*u,p=a*l,y=a*u;t[0]=l*c,t[4]=y-h*f,t[8]=p*f+d,t[1]=f,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=d*f+p,t[10]=h-y*f}else if(e.order==="XZY"){const h=o*l,d=o*u,p=a*l,y=a*u;t[0]=l*c,t[4]=-f,t[8]=u*c,t[1]=h*f+y,t[5]=o*c,t[9]=d*f-p,t[2]=p*f-d,t[6]=a*c,t[10]=y*f+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(TZ,e,CZ)}lookAt(e,t,r){const i=this.elements;return ao.subVectors(e,t),ao.lengthSq()===0&&(ao.z=1),ao.normalize(),Wu.crossVectors(r,ao),Wu.lengthSq()===0&&(Math.abs(r.z)===1?ao.x+=1e-4:ao.z+=1e-4,ao.normalize(),Wu.crossVectors(r,ao)),Wu.normalize(),P1.crossVectors(ao,Wu),i[0]=Wu.x,i[4]=P1.x,i[8]=ao.x,i[1]=Wu.y,i[5]=P1.y,i[9]=ao.y,i[2]=Wu.z,i[6]=P1.z,i[10]=ao.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],u=r[12],c=r[1],f=r[5],h=r[9],d=r[13],p=r[2],y=r[6],x=r[10],m=r[14],_=r[3],w=r[7],b=r[11],S=r[15],M=i[0],T=i[4],P=i[8],C=i[12],A=i[1],k=i[5],L=i[9],H=i[13],F=i[2],V=i[6],W=i[10],G=i[14],N=i[3],B=i[7],D=i[11],$=i[15];return s[0]=o*M+a*A+l*F+u*N,s[4]=o*T+a*k+l*V+u*B,s[8]=o*P+a*L+l*W+u*D,s[12]=o*C+a*H+l*G+u*$,s[1]=c*M+f*A+h*F+d*N,s[5]=c*T+f*k+h*V+d*B,s[9]=c*P+f*L+h*W+d*D,s[13]=c*C+f*H+h*G+d*$,s[2]=p*M+y*A+x*F+m*N,s[6]=p*T+y*k+x*V+m*B,s[10]=p*P+y*L+x*W+m*D,s[14]=p*C+y*H+x*G+m*$,s[3]=_*M+w*A+b*F+S*N,s[7]=_*T+w*k+b*V+S*B,s[11]=_*P+w*L+b*W+S*D,s[15]=_*C+w*H+b*G+S*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],f=e[6],h=e[10],d=e[14],p=e[3],y=e[7],x=e[11],m=e[15];return p*(+s*l*f-i*u*f-s*a*h+r*u*h+i*a*d-r*l*d)+y*(+t*l*d-t*u*h+s*o*h-i*o*d+i*u*c-s*l*c)+x*(+t*u*f-t*a*d-s*o*f+r*o*d+s*a*c-r*u*c)+m*(-i*a*c-t*l*f+t*a*h+i*o*f-r*o*h+r*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],y=e[13],x=e[14],m=e[15],_=f*x*u-y*h*u+y*l*d-a*x*d-f*l*m+a*h*m,w=p*h*u-c*x*u-p*l*d+o*x*d+c*l*m-o*h*m,b=c*y*u-p*f*u+p*a*d-o*y*d-c*a*m+o*f*m,S=p*f*l-c*y*l-p*a*h+o*y*h+c*a*x-o*f*x,M=t*_+r*w+i*b+s*S;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=_*T,e[1]=(y*h*s-f*x*s-y*i*d+r*x*d+f*i*m-r*h*m)*T,e[2]=(a*x*s-y*l*s+y*i*u-r*x*u-a*i*m+r*l*m)*T,e[3]=(f*l*s-a*h*s-f*i*u+r*h*u+a*i*d-r*l*d)*T,e[4]=w*T,e[5]=(c*x*s-p*h*s+p*i*d-t*x*d-c*i*m+t*h*m)*T,e[6]=(p*l*s-o*x*s-p*i*u+t*x*u+o*i*m-t*l*m)*T,e[7]=(o*h*s-c*l*s+c*i*u-t*h*u-o*i*d+t*l*d)*T,e[8]=b*T,e[9]=(p*f*s-c*y*s-p*r*d+t*y*d+c*r*m-t*f*m)*T,e[10]=(o*y*s-p*a*s+p*r*u-t*y*u-o*r*m+t*a*m)*T,e[11]=(c*a*s-o*f*s-c*r*u+t*f*u+o*r*d-t*a*d)*T,e[12]=S*T,e[13]=(c*y*i-p*f*i+p*r*h-t*y*h-c*r*x+t*f*x)*T,e[14]=(p*a*i-o*y*i-p*r*l+t*y*l+o*r*x-t*a*x)*T,e[15]=(o*f*i-c*a*i+c*r*l-t*f*l-o*r*h+t*a*h)*T,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+r,u*a-i*l,u*l+i*a,0,u*a+i*l,c*a+r,c*l-i*o,0,u*l-i*a,c*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,c=o+o,f=a+a,h=s*u,d=s*c,p=s*f,y=o*c,x=o*f,m=a*f,_=l*u,w=l*c,b=l*f,S=r.x,M=r.y,T=r.z;return i[0]=(1-(y+m))*S,i[1]=(d+b)*S,i[2]=(p-w)*S,i[3]=0,i[4]=(d-b)*M,i[5]=(1-(h+m))*M,i[6]=(x+_)*M,i[7]=0,i[8]=(p+w)*T,i[9]=(x-_)*T,i[10]=(1-(h+y))*T,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=od.set(i[0],i[1],i[2]).length();const o=od.set(i[4],i[5],i[6]).length(),a=od.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],xa.copy(this);const u=1/s,c=1/o,f=1/a;return xa.elements[0]*=u,xa.elements[1]*=u,xa.elements[2]*=u,xa.elements[4]*=c,xa.elements[5]*=c,xa.elements[6]*=c,xa.elements[8]*=f,xa.elements[9]*=f,xa.elements[10]*=f,t.setFromRotationMatrix(xa),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o,a=Ra){const l=this.elements,u=2*s/(t-e),c=2*s/(r-i),f=(t+e)/(t-e),h=(r+i)/(r-i);let d,p;if(a===Ra)d=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===Xp)d=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=c,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=d,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,o,a=Ra){const l=this.elements,u=1/(t-e),c=1/(r-i),f=1/(o-s),h=(t+e)*u,d=(r+i)*c;let p,y;if(a===Ra)p=(o+s)*f,y=-2*f;else if(a===Xp)p=s*f,y=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-d,l[2]=0,l[6]=0,l[10]=y,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const od=new Q,xa=new Ht,TZ=new Q(0,0,0),CZ=new Q(1,1,1),Wu=new Q,P1=new Q,ao=new Q,ak=new Ht,lk=new Xs;let AR=class c8{constructor(e=0,t=0,r=0,i=c8.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],u=i[5],c=i[9],f=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Tr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Tr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(Tr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-f,d),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Tr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Tr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Tr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return ak.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ak,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return lk.setFromEuler(this),this.setFromQuaternion(lk,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};AR.DEFAULT_ORDER="XYZ";class rh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let AZ=0;const uk=new Q,ad=new Xs,Vl=new Ht,I1=new Q,r0=new Q,RZ=new Q,PZ=new Xs,ck=new Q(1,0,0),fk=new Q(0,1,0),hk=new Q(0,0,1),IZ={type:"added"},DZ={type:"removed"};class Rn extends da{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:AZ++}),this.uuid=Co(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Rn.DEFAULT_UP.clone();const e=new Q,t=new AR,r=new Xs,i=new Q(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ht},normalMatrix:{value:new en}}),this.matrix=new Ht,this.matrixWorld=new Ht,this.matrixAutoUpdate=Rn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Rn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new rh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ad.setFromAxisAngle(e,t),this.quaternion.multiply(ad),this}rotateOnWorldAxis(e,t){return ad.setFromAxisAngle(e,t),this.quaternion.premultiply(ad),this}rotateX(e){return this.rotateOnAxis(ck,e)}rotateY(e){return this.rotateOnAxis(fk,e)}rotateZ(e){return this.rotateOnAxis(hk,e)}translateOnAxis(e,t){return uk.copy(e).applyQuaternion(this.quaternion),this.position.add(uk.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ck,e)}translateY(e){return this.translateOnAxis(fk,e)}translateZ(e){return this.translateOnAxis(hk,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Vl.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?I1.copy(e):I1.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),r0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vl.lookAt(r0,I1,this.up):Vl.lookAt(I1,r0,this.up),this.quaternion.setFromRotationMatrix(Vl),i&&(Vl.extractRotation(i.matrixWorld),ad.setFromRotationMatrix(Vl),this.quaternion.premultiply(ad.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(IZ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DZ)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Vl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Vl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(r0,e,RZ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(r0,PZ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const f=l[u];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),f=o(e.shapes),h=o(e.skeletons),d=o(e.animations),p=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),f.length>0&&(r.shapes=f),h.length>0&&(r.skeletons=h),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Rn.DEFAULT_UP=new Q(0,1,0);Rn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Rn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _a=new Q,Wl=new Q,fE=new Q,Hl=new Q,ld=new Q,ud=new Q,dk=new Q,hE=new Q,dE=new Q,pE=new Q;let D1=!1,jf=class Rf{constructor(e=new Q,t=new Q,r=new Q){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),_a.subVectors(e,t),i.cross(_a);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){_a.subVectors(i,t),Wl.subVectors(r,t),fE.subVectors(e,t);const o=_a.dot(_a),a=_a.dot(Wl),l=_a.dot(fE),u=Wl.dot(Wl),c=Wl.dot(fE),f=o*u-a*a;if(f===0)return s.set(0,0,0),null;const h=1/f,d=(u*l-a*c)*h,p=(o*c-a*l)*h;return s.set(1-d-p,p,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Hl)===null?!1:Hl.x>=0&&Hl.y>=0&&Hl.x+Hl.y<=1}static getUV(e,t,r,i,s,o,a,l){return D1===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),D1=!0),this.getInterpolation(e,t,r,i,s,o,a,l)}static getInterpolation(e,t,r,i,s,o,a,l){return this.getBarycoord(e,t,r,i,Hl)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Hl.x),l.addScaledVector(o,Hl.y),l.addScaledVector(a,Hl.z),l)}static isFrontFacing(e,t,r,i){return _a.subVectors(r,t),Wl.subVectors(e,t),_a.cross(Wl).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _a.subVectors(this.c,this.b),Wl.subVectors(this.a,this.b),_a.cross(Wl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rf.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rf.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return D1===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),D1=!0),Rf.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}getInterpolation(e,t,r,i,s){return Rf.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Rf.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rf.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;ld.subVectors(i,r),ud.subVectors(s,r),hE.subVectors(e,r);const l=ld.dot(hE),u=ud.dot(hE);if(l<=0&&u<=0)return t.copy(r);dE.subVectors(e,i);const c=ld.dot(dE),f=ud.dot(dE);if(c>=0&&f<=c)return t.copy(i);const h=l*f-c*u;if(h<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(r).addScaledVector(ld,o);pE.subVectors(e,s);const d=ld.dot(pE),p=ud.dot(pE);if(p>=0&&d<=p)return t.copy(s);const y=d*u-l*p;if(y<=0&&u>=0&&p<=0)return a=u/(u-p),t.copy(r).addScaledVector(ud,a);const x=c*p-d*f;if(x<=0&&f-c>=0&&d-p>=0)return dk.subVectors(s,i),a=(f-c)/(f-c+(d-p)),t.copy(i).addScaledVector(dk,a);const m=1/(x+y+h);return o=y*m,a=h*m,t.copy(r).addScaledVector(ld,o).addScaledVector(ud,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const f8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Hu={h:0,s:0,l:0},N1={h:0,s:0,l:0};function mE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class it{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=mn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Fn.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Fn.workingColorSpace){return this.r=e,this.g=t,this.b=r,Fn.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Fn.workingColorSpace){if(e=MR(e,1),t=Tr(t,0,1),r=Tr(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=mE(o,s,e+1/3),this.g=mE(o,s,e),this.b=mE(o,s,e-1/3)}return Fn.toWorkingColorSpace(this,i),this}setStyle(e,t=mn){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=mn){const r=f8[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Sp(e.r),this.g=Sp(e.g),this.b=Sp(e.b),this}copyLinearToSRGB(e){return this.r=rE(e.r),this.g=rE(e.g),this.b=rE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=mn){return Fn.fromWorkingColorSpace($i.copy(this),e),Math.round(Tr($i.r*255,0,255))*65536+Math.round(Tr($i.g*255,0,255))*256+Math.round(Tr($i.b*255,0,255))}getHexString(e=mn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Fn.workingColorSpace){Fn.fromWorkingColorSpace($i.copy(this),t);const r=$i.r,i=$i.g,s=$i.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const f=o-a;switch(u=c<=.5?f/(o+a):f/(2-o-a),o){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=Fn.workingColorSpace){return Fn.fromWorkingColorSpace($i.copy(this),t),e.r=$i.r,e.g=$i.g,e.b=$i.b,e}getStyle(e=mn){Fn.fromWorkingColorSpace($i.copy(this),e);const t=$i.r,r=$i.g,i=$i.b;return e!==mn?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Hu),this.setHSL(Hu.h+e,Hu.s+t,Hu.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Hu),e.getHSL(N1);const r=Y0(Hu.h,N1.h,t),i=Y0(Hu.s,N1.s,t),s=Y0(Hu.l,N1.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const $i=new it;it.NAMES=f8;let NZ=0;class Mi extends da{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:NZ++}),this.uuid=Co(),this.name="",this.type="Material",this.blending=th,this.side=Tl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=a_,this.blendDst=l_,this.blendEquation=nc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new it(0,0,0),this.blendAlpha=0,this.depthFunc=zg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=IT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Af,this.stencilZFail=Af,this.stencilZPass=Af,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==th&&(r.blending=this.blending),this.side!==Tl&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==a_&&(r.blendSrc=this.blendSrc),this.blendDst!==l_&&(r.blendDst=this.blendDst),this.blendEquation!==nc&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==zg&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==IT&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Af&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Af&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Af&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class $c extends Mi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new it(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Zl=kZ();function kZ(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):u<-14?(r[l]=1024>>-u-14,r[l|256]=1024>>-u-14|32768,i[l]=-u-1,i[l|256]=-u-1):u<=15?(r[l]=u+15<<10,r[l|256]=u+15<<10|32768,i[l]=13,i[l|256]=13):u<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function Ns(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Tr(n,-65504,65504),Zl.floatView[0]=n;const e=Zl.uint32View[0],t=e>>23&511;return Zl.baseTable[t]+((e&8388607)>>Zl.shiftTable[t])}function R0(n){const e=n>>10;return Zl.uint32View[0]=Zl.mantissaTable[Zl.offsetTable[e]+(n&1023)]+Zl.exponentTable[e],Zl.floatView[0]}const LZ={toHalfFloat:Ns,fromHalfFloat:R0},Vr=new Q,k1=new Me;class vn{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=Zg,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=zs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)k1.fromBufferAttribute(this,t),k1.applyMatrix3(e),this.setXY(t,k1.x,k1.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Vr.fromBufferAttribute(this,t),Vr.applyMatrix3(e),this.setXYZ(t,Vr.x,Vr.y,Vr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Vr.fromBufferAttribute(this,t),Vr.applyMatrix4(e),this.setXYZ(t,Vr.x,Vr.y,Vr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Vr.fromBufferAttribute(this,t),Vr.applyNormalMatrix(e),this.setXYZ(t,Vr.x,Vr.y,Vr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Vr.fromBufferAttribute(this,t),Vr.transformDirection(e),this.setXYZ(t,Vr.x,Vr.y,Vr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Os(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Zt(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Os(t,this.array)),t}setX(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Os(t,this.array)),t}setY(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Os(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Os(t,this.array)),t}setW(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array),s=Zt(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zg&&(e.usage=this.usage),e}}class FZ extends vn{constructor(e,t,r){super(new Int8Array(e),t,r)}}class OZ extends vn{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class BZ extends vn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class UZ extends vn{constructor(e,t,r){super(new Int16Array(e),t,r)}}class RR extends vn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class zZ extends vn{constructor(e,t,r){super(new Int32Array(e),t,r)}}class PR extends vn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class VZ extends vn{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=R0(this.array[e*this.itemSize]);return this.normalized&&(t=Os(t,this.array)),t}setX(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize]=Ns(t),this}getY(e){let t=R0(this.array[e*this.itemSize+1]);return this.normalized&&(t=Os(t,this.array)),t}setY(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+1]=Ns(t),this}getZ(e){let t=R0(this.array[e*this.itemSize+2]);return this.normalized&&(t=Os(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+2]=Ns(t),this}getW(e){let t=R0(this.array[e*this.itemSize+3]);return this.normalized&&(t=Os(t,this.array)),t}setW(e,t){return this.normalized&&(t=Zt(t,this.array)),this.array[e*this.itemSize+3]=Ns(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array)),this.array[e+0]=Ns(t),this.array[e+1]=Ns(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array)),this.array[e+0]=Ns(t),this.array[e+1]=Ns(r),this.array[e+2]=Ns(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array),s=Zt(s,this.array)),this.array[e+0]=Ns(t),this.array[e+1]=Ns(r),this.array[e+2]=Ns(i),this.array[e+3]=Ns(s),this}}class St extends vn{constructor(e,t,r){super(new Float32Array(e),t,r)}}class WZ extends vn{constructor(e,t,r){super(new Float64Array(e),t,r)}}let HZ=0;const jo=new Ht,gE=new Rn,cd=new Q,lo=new Ts,i0=new Ts,mi=new Q;class qt extends da{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:HZ++}),this.uuid=Co(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(a8(e)?PR:RR)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new en().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return jo.makeRotationFromQuaternion(e),this.applyMatrix4(jo),this}rotateX(e){return jo.makeRotationX(e),this.applyMatrix4(jo),this}rotateY(e){return jo.makeRotationY(e),this.applyMatrix4(jo),this}rotateZ(e){return jo.makeRotationZ(e),this.applyMatrix4(jo),this}translate(e,t,r){return jo.makeTranslation(e,t,r),this.applyMatrix4(jo),this}scale(e,t,r){return jo.makeScale(e,t,r),this.applyMatrix4(jo),this}lookAt(e){return gE.lookAt(e),gE.updateMatrix(),this.applyMatrix4(gE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(cd).negate(),this.translate(cd.x,cd.y,cd.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new St(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ts);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];lo.setFromBufferAttribute(s),this.morphTargetsRelative?(mi.addVectors(this.boundingBox.min,lo.min),this.boundingBox.expandByPoint(mi),mi.addVectors(this.boundingBox.max,lo.max),this.boundingBox.expandByPoint(mi)):(this.boundingBox.expandByPoint(lo.min),this.boundingBox.expandByPoint(lo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ss);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Q,1/0);return}if(e){const r=this.boundingSphere.center;if(lo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];i0.setFromBufferAttribute(a),this.morphTargetsRelative?(mi.addVectors(lo.min,i0.min),lo.expandByPoint(mi),mi.addVectors(lo.max,i0.max),lo.expandByPoint(mi)):(lo.expandByPoint(i0.min),lo.expandByPoint(i0.max))}lo.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)mi.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(mi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)mi.fromBufferAttribute(a,u),l&&(cd.fromBufferAttribute(e,u),mi.add(cd)),i=Math.max(i,r.distanceToSquared(mi))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new vn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let A=0;A<a;A++)u[A]=new Q,c[A]=new Q;const f=new Q,h=new Q,d=new Q,p=new Me,y=new Me,x=new Me,m=new Q,_=new Q;function w(A,k,L){f.fromArray(i,A*3),h.fromArray(i,k*3),d.fromArray(i,L*3),p.fromArray(o,A*2),y.fromArray(o,k*2),x.fromArray(o,L*2),h.sub(f),d.sub(f),y.sub(p),x.sub(p);const H=1/(y.x*x.y-x.x*y.y);isFinite(H)&&(m.copy(h).multiplyScalar(x.y).addScaledVector(d,-y.y).multiplyScalar(H),_.copy(d).multiplyScalar(y.x).addScaledVector(h,-x.x).multiplyScalar(H),u[A].add(m),u[k].add(m),u[L].add(m),c[A].add(_),c[k].add(_),c[L].add(_))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let A=0,k=b.length;A<k;++A){const L=b[A],H=L.start,F=L.count;for(let V=H,W=H+F;V<W;V+=3)w(r[V+0],r[V+1],r[V+2])}const S=new Q,M=new Q,T=new Q,P=new Q;function C(A){T.fromArray(s,A*3),P.copy(T);const k=u[A];S.copy(k),S.sub(T.multiplyScalar(T.dot(k))).normalize(),M.crossVectors(P,k);const H=M.dot(c[A])<0?-1:1;l[A*4]=S.x,l[A*4+1]=S.y,l[A*4+2]=S.z,l[A*4+3]=H}for(let A=0,k=b.length;A<k;++A){const L=b[A],H=L.start,F=L.count;for(let V=H,W=H+F;V<W;V+=3)C(r[V+0]),C(r[V+1]),C(r[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new vn(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,d=r.count;h<d;h++)r.setXYZ(h,0,0,0);const i=new Q,s=new Q,o=new Q,a=new Q,l=new Q,u=new Q,c=new Q,f=new Q;if(e)for(let h=0,d=e.count;h<d;h+=3){const p=e.getX(h+0),y=e.getX(h+1),x=e.getX(h+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,x),c.subVectors(o,s),f.subVectors(i,s),c.cross(f),a.fromBufferAttribute(r,p),l.fromBufferAttribute(r,y),u.fromBufferAttribute(r,x),a.add(c),l.add(c),u.add(c),r.setXYZ(p,a.x,a.y,a.z),r.setXYZ(y,l.x,l.y,l.z),r.setXYZ(x,u.x,u.y,u.z)}else for(let h=0,d=t.count;h<d;h+=3)i.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),c.subVectors(o,s),f.subVectors(i,s),c.cross(f),r.setXYZ(h+0,c.x,c.y,c.z),r.setXYZ(h+1,c.x,c.y,c.z),r.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)mi.fromBufferAttribute(e,t),mi.normalize(),e.setXYZ(t,mi.x,mi.y,mi.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,f=a.normalized,h=new u.constructor(l.length*c);let d=0,p=0;for(let y=0,x=l.length;y<x;y++){a.isInterleavedBufferAttribute?d=l[y]*a.data.stride+a.offset:d=l[y]*c;for(let m=0;m<c;m++)h[p++]=u[d++]}return new vn(h,c,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qt,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],u=e(l,r);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,f=u.length;c<f;c++){const h=u[c],d=e(h,r);l.push(d)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let f=0,h=u.length;f<h;f++){const d=u[f];c.push(d.toJSON(e.data))}c.length>0&&(i[l]=c,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],f=s[u];for(let h=0,d=f.length;h<d;h++)c.push(f[h].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pk=new Ht,pf=new vm,L1=new ss,mk=new Q,fd=new Q,hd=new Q,dd=new Q,vE=new Q,F1=new Q,O1=new Me,B1=new Me,U1=new Me,gk=new Q,vk=new Q,yk=new Q,z1=new Q,V1=new Q;let Qn=class extends Rn{constructor(e=new qt,t=new $c){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){F1.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],f=s[l];c!==0&&(vE.fromBufferAttribute(f,e),o?F1.addScaledVector(vE,c):F1.addScaledVector(vE.sub(t),c))}t.add(F1)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),L1.copy(r.boundingSphere),L1.applyMatrix4(s),pf.copy(e.ray).recast(e.near),!(L1.containsPoint(pf.origin)===!1&&(pf.intersectSphere(L1,mk)===null||pf.origin.distanceToSquared(mk)>(e.far-e.near)**2))&&(pk.copy(s).invert(),pf.copy(e.ray).applyMatrix4(pk),!(r.boundingBox!==null&&pf.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,pf)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,f=s.attributes.normal,h=s.groups,d=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const x=h[p],m=o[x.materialIndex],_=Math.max(x.start,d.start),w=Math.min(a.count,Math.min(x.start+x.count,d.start+d.count));for(let b=_,S=w;b<S;b+=3){const M=a.getX(b),T=a.getX(b+1),P=a.getX(b+2);i=W1(this,m,e,r,u,c,f,M,T,P),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const p=Math.max(0,d.start),y=Math.min(a.count,d.start+d.count);for(let x=p,m=y;x<m;x+=3){const _=a.getX(x),w=a.getX(x+1),b=a.getX(x+2);i=W1(this,o,e,r,u,c,f,_,w,b),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,y=h.length;p<y;p++){const x=h[p],m=o[x.materialIndex],_=Math.max(x.start,d.start),w=Math.min(l.count,Math.min(x.start+x.count,d.start+d.count));for(let b=_,S=w;b<S;b+=3){const M=b,T=b+1,P=b+2;i=W1(this,m,e,r,u,c,f,M,T,P),i&&(i.faceIndex=Math.floor(b/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const p=Math.max(0,d.start),y=Math.min(l.count,d.start+d.count);for(let x=p,m=y;x<m;x+=3){const _=x,w=x+1,b=x+2;i=W1(this,o,e,r,u,c,f,_,w,b),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}}};function GZ(n,e,t,r,i,s,o,a){let l;if(e.side===ri?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===Tl,a),l===null)return null;V1.copy(a),V1.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(V1);return u<t.near||u>t.far?null:{distance:u,point:V1.clone(),object:n}}function W1(n,e,t,r,i,s,o,a,l,u){n.getVertexPosition(a,fd),n.getVertexPosition(l,hd),n.getVertexPosition(u,dd);const c=GZ(n,e,t,r,fd,hd,dd,z1);if(c){i&&(O1.fromBufferAttribute(i,a),B1.fromBufferAttribute(i,l),U1.fromBufferAttribute(i,u),c.uv=jf.getInterpolation(z1,fd,hd,dd,O1,B1,U1,new Me)),s&&(O1.fromBufferAttribute(s,a),B1.fromBufferAttribute(s,l),U1.fromBufferAttribute(s,u),c.uv1=jf.getInterpolation(z1,fd,hd,dd,O1,B1,U1,new Me),c.uv2=c.uv1),o&&(gk.fromBufferAttribute(o,a),vk.fromBufferAttribute(o,l),yk.fromBufferAttribute(o,u),c.normal=jf.getInterpolation(z1,fd,hd,dd,gk,vk,yk,new Q),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const f={a,b:l,c:u,normal:new Q,materialIndex:0};jf.getNormal(fd,hd,dd,f.normal),c.face=f}return c}class Ih extends qt{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],f=[];let h=0,d=0;p("z","y","x",-1,-1,r,t,e,o,s,0),p("z","y","x",1,-1,r,t,-e,o,s,1),p("x","z","y",1,1,e,r,t,i,o,2),p("x","z","y",1,-1,e,r,-t,i,o,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new St(u,3)),this.setAttribute("normal",new St(c,3)),this.setAttribute("uv",new St(f,2));function p(y,x,m,_,w,b,S,M,T,P,C){const A=b/T,k=S/P,L=b/2,H=S/2,F=M/2,V=T+1,W=P+1;let G=0,N=0;const B=new Q;for(let D=0;D<W;D++){const $=D*k-H;for(let ee=0;ee<V;ee++){const te=ee*A-L;B[y]=te*_,B[x]=$*w,B[m]=F,u.push(B.x,B.y,B.z),B[y]=0,B[x]=0,B[m]=M>0?1:-1,c.push(B.x,B.y,B.z),f.push(ee/T),f.push(1-D/P),G+=1}}for(let D=0;D<P;D++)for(let $=0;$<T;$++){const ee=h+$+V*D,te=h+$+V*(D+1),se=h+($+1)+V*(D+1),me=h+($+1)+V*D;l.push(ee,te,me),l.push(te,se,me),N+=6}a.addGroup(d,N,C),d+=N,h+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ih(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function qp(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function ps(n){const e={};for(let t=0;t<n.length;t++){const r=qp(n[t]);for(const i in r)e[i]=r[i]}return e}function jZ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function h8(n){return n.getRenderTarget()===null?n.outputColorSpace:Fn.workingColorSpace}const IR={clone:qp,merge:ps};var XZ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$Z=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class $r extends Mi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=XZ,this.fragmentShader=$Z,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=qp(e.uniforms),this.uniformsGroups=jZ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class _h extends Rn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ht,this.projectionMatrix=new Ht,this.projectionMatrixInverse=new Ht,this.coordinateSystem=Ra}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let ti=class extends _h{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=$p*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(nh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return $p*2*Math.atan(Math.tan(nh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(nh*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*r/u,i*=o.width/l,r*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const pd=-90,md=1;class d8 extends Rn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new ti(pd,md,e,t);i.layers=this.layers,this.add(i);const s=new ti(pd,md,e,t);s.layers=this.layers,this.add(s);const o=new ti(pd,md,e,t);o.layers=this.layers,this.add(o);const a=new ti(pd,md,e,t);a.layers=this.layers,this.add(a);const l=new ti(pd,md,e,t);l.layers=this.layers,this.add(l);const u=new ti(pd,md,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Ra)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Xp)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,c]=this.children,f=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const y=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,a),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,u),r.texture.generateMipmaps=y,e.setRenderTarget(r,5,i),e.render(t,c),e.setRenderTarget(f,h,d),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class Vv extends vr{constructor(e,t,r,i,s,o,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:pu,super(e,t,r,i,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class p8 extends Br{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(K0("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===wc?mn:_s),this.texture=new Vv(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:bn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Ih(5,5,5),s=new $r({name:"CubemapFromEquirect",uniforms:qp(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:ri,blending:Ms});s.uniforms.tEquirect.value=t;const o=new Qn(i,s),a=t.minFilter;return t.minFilter===Dc&&(t.minFilter=bn),new d8(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const yE=new Q,qZ=new Q,YZ=new en;class Qu{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=yE.subVectors(r,t).cross(qZ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(yE),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||YZ.getNormalMatrix(e),i=this.coplanarPoint(yE).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const mf=new ss,H1=new Q;class Wv{constructor(e=new Qu,t=new Qu,r=new Qu,i=new Qu,s=new Qu,o=new Qu){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Ra){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],c=i[5],f=i[6],h=i[7],d=i[8],p=i[9],y=i[10],x=i[11],m=i[12],_=i[13],w=i[14],b=i[15];if(r[0].setComponents(l-s,h-u,x-d,b-m).normalize(),r[1].setComponents(l+s,h+u,x+d,b+m).normalize(),r[2].setComponents(l+o,h+c,x+p,b+_).normalize(),r[3].setComponents(l-o,h-c,x-p,b-_).normalize(),r[4].setComponents(l-a,h-f,x-y,b-w).normalize(),t===Ra)r[5].setComponents(l+a,h+f,x+y,b+w).normalize();else if(t===Xp)r[5].setComponents(a,f,y,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),mf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),mf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(mf)}intersectsSprite(e){return mf.center.set(0,0,0),mf.radius=.7071067811865476,mf.applyMatrix4(e.matrixWorld),this.intersectsSphere(mf)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(H1.x=i.normal.x>0?e.max.x:e.min.x,H1.y=i.normal.y>0?e.max.y:e.min.y,H1.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(H1)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function m8(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function KZ(n,e){const t=e.isWebGL2,r=new WeakMap;function i(u,c){const f=u.array,h=u.usage,d=f.byteLength,p=n.createBuffer();n.bindBuffer(c,p),n.bufferData(c,f,h),u.onUploadCallback();let y;if(f instanceof Float32Array)y=n.FLOAT;else if(f instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)y=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)y=n.SHORT;else if(f instanceof Uint32Array)y=n.UNSIGNED_INT;else if(f instanceof Int32Array)y=n.INT;else if(f instanceof Int8Array)y=n.BYTE;else if(f instanceof Uint8Array)y=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)y=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:p,type:y,bytesPerElement:f.BYTES_PER_ELEMENT,version:u.version,size:d}}function s(u,c,f){const h=c.array,d=c._updateRange,p=c.updateRanges;if(n.bindBuffer(f,u),d.count===-1&&p.length===0&&n.bufferSubData(f,0,h),p.length!==0){for(let y=0,x=p.length;y<x;y++){const m=p[y];t?n.bufferSubData(f,m.start*h.BYTES_PER_ELEMENT,h,m.start,m.count):n.bufferSubData(f,m.start*h.BYTES_PER_ELEMENT,h.subarray(m.start,m.start+m.count))}c.clearUpdateRanges()}d.count!==-1&&(t?n.bufferSubData(f,d.offset*h.BYTES_PER_ELEMENT,h,d.offset,d.count):n.bufferSubData(f,d.offset*h.BYTES_PER_ELEMENT,h.subarray(d.offset,d.offset+d.count)),d.count=-1),c.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=r.get(u);c&&(n.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const h=r.get(u);(!h||h.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const f=r.get(u);if(f===void 0)r.set(u,i(u,c));else if(f.version<u.version){if(f.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,u,c),f.version=u.version}}return{get:o,remove:a,update:l}}class yl extends qt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(i),u=a+1,c=l+1,f=e/a,h=t/l,d=[],p=[],y=[],x=[];for(let m=0;m<c;m++){const _=m*h-o;for(let w=0;w<u;w++){const b=w*f-s;p.push(b,-_,0),y.push(0,0,1),x.push(w/a),x.push(1-m/l)}}for(let m=0;m<l;m++)for(let _=0;_<a;_++){const w=_+u*m,b=_+u*(m+1),S=_+1+u*(m+1),M=_+1+u*m;d.push(w,b,M),d.push(b,S,M)}this.setIndex(d),this.setAttribute("position",new St(p,3)),this.setAttribute("normal",new St(y,3)),this.setAttribute("uv",new St(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yl(e.width,e.height,e.widthSegments,e.heightSegments)}}var ZZ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,JZ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,QZ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,eJ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tJ=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,nJ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,rJ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,iJ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sJ=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,oJ=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,aJ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,lJ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,uJ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,cJ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,fJ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hJ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,dJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mJ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gJ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,vJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,yJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,xJ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,_J=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,wJ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,bJ=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,SJ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,EJ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,MJ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,TJ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,CJ="gl_FragColor = linearToOutputTexel( gl_FragColor );",AJ=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,RJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PJ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,IJ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DJ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,NJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,kJ=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,LJ=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,FJ=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,OJ=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,BJ=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,UJ=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,zJ=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,VJ=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,WJ=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,HJ=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,GJ=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,jJ=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,XJ=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,$J=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,qJ=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,YJ=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,KJ=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZJ=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,JJ=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,QJ=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,eQ=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tQ=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nQ=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,rQ=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,iQ=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sQ=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,oQ=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aQ=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lQ=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,uQ=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,cQ=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,fQ=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,hQ=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,dQ=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,pQ=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,mQ=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gQ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vQ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yQ=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xQ=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,_Q=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,wQ=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,bQ=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,SQ=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,EQ=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,MQ=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,TQ=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,CQ=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,AQ=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,RQ=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PQ=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,IQ=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,DQ=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,NQ=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,kQ=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,LQ=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,FQ=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,OQ=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,BQ=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,UQ=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,zQ=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,VQ=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,WQ=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,HQ=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,GQ=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,jQ=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,XQ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,$Q=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,qQ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,YQ=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const KQ=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ZQ=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,JQ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,QQ=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,eee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,tee=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nee=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ree=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,iee=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,see=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,oee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,aee=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lee=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,uee=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cee=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fee=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hee=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dee=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pee=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mee=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gee=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,vee=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,yee=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xee=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_ee=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,wee=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bee=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,See=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Eee=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Mee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Tee=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Cee=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Aee=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ree=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Kt={alphahash_fragment:ZZ,alphahash_pars_fragment:JZ,alphamap_fragment:QZ,alphamap_pars_fragment:eJ,alphatest_fragment:tJ,alphatest_pars_fragment:nJ,aomap_fragment:rJ,aomap_pars_fragment:iJ,batching_pars_vertex:sJ,batching_vertex:oJ,begin_vertex:aJ,beginnormal_vertex:lJ,bsdfs:uJ,iridescence_fragment:cJ,bumpmap_pars_fragment:fJ,clipping_planes_fragment:hJ,clipping_planes_pars_fragment:dJ,clipping_planes_pars_vertex:pJ,clipping_planes_vertex:mJ,color_fragment:gJ,color_pars_fragment:vJ,color_pars_vertex:yJ,color_vertex:xJ,common:_J,cube_uv_reflection_fragment:wJ,defaultnormal_vertex:bJ,displacementmap_pars_vertex:SJ,displacementmap_vertex:EJ,emissivemap_fragment:MJ,emissivemap_pars_fragment:TJ,colorspace_fragment:CJ,colorspace_pars_fragment:AJ,envmap_fragment:RJ,envmap_common_pars_fragment:PJ,envmap_pars_fragment:IJ,envmap_pars_vertex:DJ,envmap_physical_pars_fragment:GJ,envmap_vertex:NJ,fog_vertex:kJ,fog_pars_vertex:LJ,fog_fragment:FJ,fog_pars_fragment:OJ,gradientmap_pars_fragment:BJ,lightmap_fragment:UJ,lightmap_pars_fragment:zJ,lights_lambert_fragment:VJ,lights_lambert_pars_fragment:WJ,lights_pars_begin:HJ,lights_toon_fragment:jJ,lights_toon_pars_fragment:XJ,lights_phong_fragment:$J,lights_phong_pars_fragment:qJ,lights_physical_fragment:YJ,lights_physical_pars_fragment:KJ,lights_fragment_begin:ZJ,lights_fragment_maps:JJ,lights_fragment_end:QJ,logdepthbuf_fragment:eQ,logdepthbuf_pars_fragment:tQ,logdepthbuf_pars_vertex:nQ,logdepthbuf_vertex:rQ,map_fragment:iQ,map_pars_fragment:sQ,map_particle_fragment:oQ,map_particle_pars_fragment:aQ,metalnessmap_fragment:lQ,metalnessmap_pars_fragment:uQ,morphcolor_vertex:cQ,morphnormal_vertex:fQ,morphtarget_pars_vertex:hQ,morphtarget_vertex:dQ,normal_fragment_begin:pQ,normal_fragment_maps:mQ,normal_pars_fragment:gQ,normal_pars_vertex:vQ,normal_vertex:yQ,normalmap_pars_fragment:xQ,clearcoat_normal_fragment_begin:_Q,clearcoat_normal_fragment_maps:wQ,clearcoat_pars_fragment:bQ,iridescence_pars_fragment:SQ,opaque_fragment:EQ,packing:MQ,premultiplied_alpha_fragment:TQ,project_vertex:CQ,dithering_fragment:AQ,dithering_pars_fragment:RQ,roughnessmap_fragment:PQ,roughnessmap_pars_fragment:IQ,shadowmap_pars_fragment:DQ,shadowmap_pars_vertex:NQ,shadowmap_vertex:kQ,shadowmask_pars_fragment:LQ,skinbase_vertex:FQ,skinning_pars_vertex:OQ,skinning_vertex:BQ,skinnormal_vertex:UQ,specularmap_fragment:zQ,specularmap_pars_fragment:VQ,tonemapping_fragment:WQ,tonemapping_pars_fragment:HQ,transmission_fragment:GQ,transmission_pars_fragment:jQ,uv_pars_fragment:XQ,uv_pars_vertex:$Q,uv_vertex:qQ,worldpos_vertex:YQ,background_vert:KQ,background_frag:ZQ,backgroundCube_vert:JQ,backgroundCube_frag:QQ,cube_vert:eee,cube_frag:tee,depth_vert:nee,depth_frag:ree,distanceRGBA_vert:iee,distanceRGBA_frag:see,equirect_vert:oee,equirect_frag:aee,linedashed_vert:lee,linedashed_frag:uee,meshbasic_vert:cee,meshbasic_frag:fee,meshlambert_vert:hee,meshlambert_frag:dee,meshmatcap_vert:pee,meshmatcap_frag:mee,meshnormal_vert:gee,meshnormal_frag:vee,meshphong_vert:yee,meshphong_frag:xee,meshphysical_vert:_ee,meshphysical_frag:wee,meshtoon_vert:bee,meshtoon_frag:See,points_vert:Eee,points_frag:Mee,shadow_vert:Tee,shadow_frag:Cee,sprite_vert:Aee,sprite_frag:Ree},et={common:{diffuse:{value:new it(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new en},alphaMap:{value:null},alphaMapTransform:{value:new en},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new en}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new en}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new en}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new en},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new en},normalScale:{value:new Me(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new en},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new en}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new en}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new en}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new it(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new it(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new en},alphaTest:{value:0},uvTransform:{value:new en}},sprite:{diffuse:{value:new it(16777215)},opacity:{value:1},center:{value:new Me(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new en},alphaMap:{value:null},alphaMapTransform:{value:new en},alphaTest:{value:0}}},Ko={basic:{uniforms:ps([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.fog]),vertexShader:Kt.meshbasic_vert,fragmentShader:Kt.meshbasic_frag},lambert:{uniforms:ps([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new it(0)}}]),vertexShader:Kt.meshlambert_vert,fragmentShader:Kt.meshlambert_frag},phong:{uniforms:ps([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new it(0)},specular:{value:new it(1118481)},shininess:{value:30}}]),vertexShader:Kt.meshphong_vert,fragmentShader:Kt.meshphong_frag},standard:{uniforms:ps([et.common,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.roughnessmap,et.metalnessmap,et.fog,et.lights,{emissive:{value:new it(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kt.meshphysical_vert,fragmentShader:Kt.meshphysical_frag},toon:{uniforms:ps([et.common,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.gradientmap,et.fog,et.lights,{emissive:{value:new it(0)}}]),vertexShader:Kt.meshtoon_vert,fragmentShader:Kt.meshtoon_frag},matcap:{uniforms:ps([et.common,et.bumpmap,et.normalmap,et.displacementmap,et.fog,{matcap:{value:null}}]),vertexShader:Kt.meshmatcap_vert,fragmentShader:Kt.meshmatcap_frag},points:{uniforms:ps([et.points,et.fog]),vertexShader:Kt.points_vert,fragmentShader:Kt.points_frag},dashed:{uniforms:ps([et.common,et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kt.linedashed_vert,fragmentShader:Kt.linedashed_frag},depth:{uniforms:ps([et.common,et.displacementmap]),vertexShader:Kt.depth_vert,fragmentShader:Kt.depth_frag},normal:{uniforms:ps([et.common,et.bumpmap,et.normalmap,et.displacementmap,{opacity:{value:1}}]),vertexShader:Kt.meshnormal_vert,fragmentShader:Kt.meshnormal_frag},sprite:{uniforms:ps([et.sprite,et.fog]),vertexShader:Kt.sprite_vert,fragmentShader:Kt.sprite_frag},background:{uniforms:{uvTransform:{value:new en},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Kt.background_vert,fragmentShader:Kt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Kt.backgroundCube_vert,fragmentShader:Kt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kt.cube_vert,fragmentShader:Kt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kt.equirect_vert,fragmentShader:Kt.equirect_frag},distanceRGBA:{uniforms:ps([et.common,et.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kt.distanceRGBA_vert,fragmentShader:Kt.distanceRGBA_frag},shadow:{uniforms:ps([et.lights,et.fog,{color:{value:new it(0)},opacity:{value:1}}]),vertexShader:Kt.shadow_vert,fragmentShader:Kt.shadow_frag}};Ko.physical={uniforms:ps([Ko.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new en},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new en},clearcoatNormalScale:{value:new Me(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new en},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new en},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new en},sheen:{value:0},sheenColor:{value:new it(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new en},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new en},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new en},transmissionSamplerSize:{value:new Me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new en},attenuationDistance:{value:0},attenuationColor:{value:new it(0)},specularColor:{value:new it(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new en},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new en},anisotropyVector:{value:new Me},anisotropyMap:{value:null},anisotropyMapTransform:{value:new en}}]),vertexShader:Kt.meshphysical_vert,fragmentShader:Kt.meshphysical_frag};const G1={r:0,b:0,g:0};function Pee(n,e,t,r,i,s,o){const a=new it(0);let l=s===!0?0:1,u,c,f=null,h=0,d=null;function p(x,m){let _=!1,w=m.isScene===!0?m.background:null;w&&w.isTexture&&(w=(m.backgroundBlurriness>0?t:e).get(w)),w===null?y(a,l):w&&w.isColor&&(y(w,1),_=!0);const b=n.xr.getEnvironmentBlendMode();b==="additive"?r.buffers.color.setClear(0,0,0,1,o):b==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),w&&(w.isCubeTexture||w.mapping===mm)?(c===void 0&&(c=new Qn(new Ih(1,1,1),new $r({name:"BackgroundCubeMaterial",uniforms:qp(Ko.backgroundCube.uniforms),vertexShader:Ko.backgroundCube.vertexShader,fragmentShader:Ko.backgroundCube.fragmentShader,side:ri,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(S,M,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=w,c.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=Fn.getTransfer(w.colorSpace)!==Gn,(f!==w||h!==w.version||d!==n.toneMapping)&&(c.material.needsUpdate=!0,f=w,h=w.version,d=n.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null)):w&&w.isTexture&&(u===void 0&&(u=new Qn(new yl(2,2),new $r({name:"BackgroundMaterial",uniforms:qp(Ko.background.uniforms),vertexShader:Ko.background.vertexShader,fragmentShader:Ko.background.fragmentShader,side:Tl,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=w,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=Fn.getTransfer(w.colorSpace)!==Gn,w.matrixAutoUpdate===!0&&w.updateMatrix(),u.material.uniforms.uvTransform.value.copy(w.matrix),(f!==w||h!==w.version||d!==n.toneMapping)&&(u.material.needsUpdate=!0,f=w,h=w.version,d=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function y(x,m){x.getRGB(G1,h8(n)),r.buffers.color.setClear(G1.r,G1.g,G1.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(x,m=1){a.set(x),l=m,y(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,y(a,l)},render:p}}function Iee(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=x(null);let u=l,c=!1;function f(F,V,W,G,N){let B=!1;if(o){const D=y(G,W,V);u!==D&&(u=D,d(u.object)),B=m(F,G,W,N),B&&_(F,G,W,N)}else{const D=V.wireframe===!0;(u.geometry!==G.id||u.program!==W.id||u.wireframe!==D)&&(u.geometry=G.id,u.program=W.id,u.wireframe=D,B=!0)}N!==null&&t.update(N,n.ELEMENT_ARRAY_BUFFER),(B||c)&&(c=!1,P(F,V,W,G),N!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(N).buffer))}function h(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function d(F){return r.isWebGL2?n.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return r.isWebGL2?n.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function y(F,V,W){const G=W.wireframe===!0;let N=a[F.id];N===void 0&&(N={},a[F.id]=N);let B=N[V.id];B===void 0&&(B={},N[V.id]=B);let D=B[G];return D===void 0&&(D=x(h()),B[G]=D),D}function x(F){const V=[],W=[],G=[];for(let N=0;N<i;N++)V[N]=0,W[N]=0,G[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:W,attributeDivisors:G,object:F,attributes:{},index:null}}function m(F,V,W,G){const N=u.attributes,B=V.attributes;let D=0;const $=W.getAttributes();for(const ee in $)if($[ee].location>=0){const se=N[ee];let me=B[ee];if(me===void 0&&(ee==="instanceMatrix"&&F.instanceMatrix&&(me=F.instanceMatrix),ee==="instanceColor"&&F.instanceColor&&(me=F.instanceColor)),se===void 0||se.attribute!==me||me&&se.data!==me.data)return!0;D++}return u.attributesNum!==D||u.index!==G}function _(F,V,W,G){const N={},B=V.attributes;let D=0;const $=W.getAttributes();for(const ee in $)if($[ee].location>=0){let se=B[ee];se===void 0&&(ee==="instanceMatrix"&&F.instanceMatrix&&(se=F.instanceMatrix),ee==="instanceColor"&&F.instanceColor&&(se=F.instanceColor));const me={};me.attribute=se,se&&se.data&&(me.data=se.data),N[ee]=me,D++}u.attributes=N,u.attributesNum=D,u.index=G}function w(){const F=u.newAttributes;for(let V=0,W=F.length;V<W;V++)F[V]=0}function b(F){S(F,0)}function S(F,V){const W=u.newAttributes,G=u.enabledAttributes,N=u.attributeDivisors;W[F]=1,G[F]===0&&(n.enableVertexAttribArray(F),G[F]=1),N[F]!==V&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,V),N[F]=V)}function M(){const F=u.newAttributes,V=u.enabledAttributes;for(let W=0,G=V.length;W<G;W++)V[W]!==F[W]&&(n.disableVertexAttribArray(W),V[W]=0)}function T(F,V,W,G,N,B,D){D===!0?n.vertexAttribIPointer(F,V,W,N,B):n.vertexAttribPointer(F,V,W,G,N,B)}function P(F,V,W,G){if(r.isWebGL2===!1&&(F.isInstancedMesh||G.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const N=G.attributes,B=W.getAttributes(),D=V.defaultAttributeValues;for(const $ in B){const ee=B[$];if(ee.location>=0){let te=N[$];if(te===void 0&&($==="instanceMatrix"&&F.instanceMatrix&&(te=F.instanceMatrix),$==="instanceColor"&&F.instanceColor&&(te=F.instanceColor)),te!==void 0){const se=te.normalized,me=te.itemSize,_e=t.get(te);if(_e===void 0)continue;const pe=_e.buffer,Ne=_e.type,Ue=_e.bytesPerElement,We=r.isWebGL2===!0&&(Ne===n.INT||Ne===n.UNSIGNED_INT||te.gpuType===mR);if(te.isInterleavedBufferAttribute){const Be=te.data,J=Be.stride,he=te.offset;if(Be.isInstancedInterleavedBuffer){for(let de=0;de<ee.locationSize;de++)S(ee.location+de,Be.meshPerAttribute);F.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let de=0;de<ee.locationSize;de++)b(ee.location+de);n.bindBuffer(n.ARRAY_BUFFER,pe);for(let de=0;de<ee.locationSize;de++)T(ee.location+de,me/ee.locationSize,Ne,se,J*Ue,(he+me/ee.locationSize*de)*Ue,We)}else{if(te.isInstancedBufferAttribute){for(let Be=0;Be<ee.locationSize;Be++)S(ee.location+Be,te.meshPerAttribute);F.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let Be=0;Be<ee.locationSize;Be++)b(ee.location+Be);n.bindBuffer(n.ARRAY_BUFFER,pe);for(let Be=0;Be<ee.locationSize;Be++)T(ee.location+Be,me/ee.locationSize,Ne,se,me*Ue,me/ee.locationSize*Be*Ue,We)}}else if(D!==void 0){const se=D[$];if(se!==void 0)switch(se.length){case 2:n.vertexAttrib2fv(ee.location,se);break;case 3:n.vertexAttrib3fv(ee.location,se);break;case 4:n.vertexAttrib4fv(ee.location,se);break;default:n.vertexAttrib1fv(ee.location,se)}}}}M()}function C(){L();for(const F in a){const V=a[F];for(const W in V){const G=V[W];for(const N in G)p(G[N].object),delete G[N];delete V[W]}delete a[F]}}function A(F){if(a[F.id]===void 0)return;const V=a[F.id];for(const W in V){const G=V[W];for(const N in G)p(G[N].object),delete G[N];delete V[W]}delete a[F.id]}function k(F){for(const V in a){const W=a[V];if(W[F.id]===void 0)continue;const G=W[F.id];for(const N in G)p(G[N].object),delete G[N];delete W[F.id]}}function L(){H(),c=!0,u!==l&&(u=l,d(u.object))}function H(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:L,resetDefaultState:H,dispose:C,releaseStatesOfGeometry:A,releaseStatesOfProgram:k,initAttributes:w,enableAttribute:b,disableUnusedAttributes:M}}function Dee(n,e,t,r){const i=r.isWebGL2;let s;function o(c){s=c}function a(c,f){n.drawArrays(s,c,f),t.update(f,s,1)}function l(c,f,h){if(h===0)return;let d,p;if(i)d=n,p="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,f,h),t.update(f,s,h)}function u(c,f,h){if(h===0)return;const d=e.get("WEBGL_multi_draw");if(d===null)for(let p=0;p<h;p++)this.render(c[p],f[p]);else{d.multiDrawArraysWEBGL(s,c,0,f,0,h);let p=0;for(let y=0;y<h;y++)p+=f[y];t.update(p,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=u}function Nee(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(T){if(T==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),h=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),y=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),_=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),w=h>0,b=o||e.has("OES_texture_float"),S=w&&b,M=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:c,maxTextures:f,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:y,maxVertexUniforms:x,maxVaryings:m,maxFragmentUniforms:_,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:M}}function kee(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new Qu,a=new en,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,h){const d=f.length!==0||h||r!==0||i;return i=h,r=f.length,d},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,h){t=c(f,h,0)},this.setState=function(f,h,d){const p=f.clippingPlanes,y=f.clipIntersection,x=f.clipShadows,m=n.get(f);if(!i||p===null||p.length===0||s&&!x)s?c(null):u();else{const _=s?0:r,w=_*4;let b=m.clippingState||null;l.value=b,b=c(p,h,w,d);for(let S=0;S!==w;++S)b[S]=t[S];m.clippingState=b,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=_}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(f,h,d,p){const y=f!==null?f.length:0;let x=null;if(y!==0){if(x=l.value,p!==!0||x===null){const m=d+y*4,_=h.matrixWorldInverse;a.getNormalMatrix(_),(x===null||x.length<m)&&(x=new Float32Array(m));for(let w=0,b=d;w!==y;++w,b+=4)o.copy(f[w]).applyMatrix4(_,a),o.normal.toArray(x,b),x[b+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,x}}function Lee(n){let e=new WeakMap;function t(o,a){return a===Vg?o.mapping=pu:a===Wg&&(o.mapping=Ic),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===Vg||a===Wg)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new p8(l.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class qc extends _h{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const rp=4,xk=[.125,.215,.35,.446,.526,.582],Of=20,xE=new qc,_k=new it;let _E=null,wE=0,bE=0;const Pf=(1+Math.sqrt(5))/2,gd=1/Pf,wk=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,Pf,gd),new Q(0,Pf,-gd),new Q(gd,0,Pf),new Q(-gd,0,Pf),new Q(Pf,gd,0),new Q(-Pf,gd,0)];class kT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){_E=this._renderer.getRenderTarget(),wE=this._renderer.getActiveCubeFace(),bE=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Ek(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Sk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_E,wE,bE),e.scissorTest=!1,j1(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===pu||e.mapping===Ic?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_E=this._renderer.getRenderTarget(),wE=this._renderer.getActiveCubeFace(),bE=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:bn,minFilter:bn,generateMipmaps:!1,type:Nc,format:ki,colorSpace:fa,depthBuffer:!1},i=bk(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=bk(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Fee(s)),this._blurMaterial=Oee(s,e,t)}return i}_compileMaterial(e){const t=new Qn(this._lodPlanes[0],e);this._renderer.compile(t,xE)}_sceneToCubeUV(e,t,r,i){const a=new ti(90,1,t,r),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,f=c.autoClear,h=c.toneMapping;c.getClearColor(_k),c.toneMapping=ka,c.autoClear=!1;const d=new $c({name:"PMREM.Background",side:ri,depthWrite:!1,depthTest:!1}),p=new Qn(new Ih,d);let y=!1;const x=e.background;x?x.isColor&&(d.color.copy(x),e.background=null,y=!0):(d.color.copy(_k),y=!0);for(let m=0;m<6;m++){const _=m%3;_===0?(a.up.set(0,l[m],0),a.lookAt(u[m],0,0)):_===1?(a.up.set(0,0,l[m]),a.lookAt(0,u[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,u[m]));const w=this._cubeSize;j1(i,_*w,m>2?w:0,w,w),c.setRenderTarget(i),y&&c.render(p,a),c.render(e,a)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=h,c.autoClear=f,e.background=x}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===pu||e.mapping===Ic;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Ek()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Sk());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new Qn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;j1(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,xE)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=wk[(i-1)%wk.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,f=new Qn(this._lodPlanes[i],u),h=u.uniforms,d=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*d):2*Math.PI/(2*Of-1),y=s/p,x=isFinite(s)?1+Math.floor(c*y):Of;x>Of&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Of}`);const m=[];let _=0;for(let T=0;T<Of;++T){const P=T/y,C=Math.exp(-P*P/2);m.push(C),T===0?_+=C:T<x&&(_+=2*C)}for(let T=0;T<m.length;T++)m[T]=m[T]/_;h.envMap.value=e.texture,h.samples.value=x,h.weights.value=m,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:w}=this;h.dTheta.value=p,h.mipInt.value=w-r;const b=this._sizeLods[i],S=3*b*(i>w-rp?i-w+rp:0),M=4*(this._cubeSize-b);j1(t,S,M,3*b,2*b),l.setRenderTarget(t),l.render(f,xE)}}function Fee(n){const e=[],t=[],r=[];let i=n;const s=n-rp+1+xk.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>n-rp?l=xk[o-n+rp-1]:o===0&&(l=0),r.push(l);const u=1/(a-2),c=-u,f=1+u,h=[c,c,f,c,f,f,c,c,f,f,c,f],d=6,p=6,y=3,x=2,m=1,_=new Float32Array(y*p*d),w=new Float32Array(x*p*d),b=new Float32Array(m*p*d);for(let M=0;M<d;M++){const T=M%3*2/3-1,P=M>2?0:-1,C=[T,P,0,T+2/3,P,0,T+2/3,P+1,0,T,P,0,T+2/3,P+1,0,T,P+1,0];_.set(C,y*p*M),w.set(h,x*p*M);const A=[M,M,M,M,M,M];b.set(A,m*p*M)}const S=new qt;S.setAttribute("position",new vn(_,y)),S.setAttribute("uv",new vn(w,x)),S.setAttribute("faceIndex",new vn(b,m)),e.push(S),i>rp&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function bk(n,e,t){const r=new Br(n,e,t);return r.texture.mapping=mm,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function j1(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function Oee(n,e,t){const r=new Float32Array(Of),i=new Q(0,1,0);return new $r({name:"SphericalGaussianBlur",defines:{n:Of,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:DR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ms,depthTest:!1,depthWrite:!1})}function Sk(){return new $r({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:DR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ms,depthTest:!1,depthWrite:!1})}function Ek(){return new $r({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:DR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ms,depthTest:!1,depthWrite:!1})}function DR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Bee(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,u=l===Vg||l===Wg,c=l===pu||l===Ic;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new kT(n)),f=u?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(u&&f&&f.height>0||c&&f&&i(f)){t===null&&(t=new kT(n));const h=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function i(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function Uee(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function zee(n,e,t,r){const i={},s=new WeakMap;function o(f){const h=f.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const y=h.morphAttributes[p];for(let x=0,m=y.length;x<m;x++)e.remove(y[x])}h.removeEventListener("dispose",o),delete i[h.id];const d=s.get(h);d&&(e.remove(d),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(f,h){return i[h.id]===!0||(h.addEventListener("dispose",o),i[h.id]=!0,t.memory.geometries++),h}function l(f){const h=f.attributes;for(const p in h)e.update(h[p],n.ARRAY_BUFFER);const d=f.morphAttributes;for(const p in d){const y=d[p];for(let x=0,m=y.length;x<m;x++)e.update(y[x],n.ARRAY_BUFFER)}}function u(f){const h=[],d=f.index,p=f.attributes.position;let y=0;if(d!==null){const _=d.array;y=d.version;for(let w=0,b=_.length;w<b;w+=3){const S=_[w+0],M=_[w+1],T=_[w+2];h.push(S,M,M,T,T,S)}}else if(p!==void 0){const _=p.array;y=p.version;for(let w=0,b=_.length/3-1;w<b;w+=3){const S=w+0,M=w+1,T=w+2;h.push(S,M,M,T,T,S)}}else return;const x=new(a8(h)?PR:RR)(h,1);x.version=y;const m=s.get(f);m&&e.remove(m),s.set(f,x)}function c(f){const h=s.get(f);if(h){const d=f.index;d!==null&&h.version<d.version&&u(f)}else u(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:c}}function Vee(n,e,t,r){const i=r.isWebGL2;let s;function o(d){s=d}let a,l;function u(d){a=d.type,l=d.bytesPerElement}function c(d,p){n.drawElements(s,p,a,d*l),t.update(p,s,1)}function f(d,p,y){if(y===0)return;let x,m;if(i)x=n,m="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[m](s,p,a,d*l,y),t.update(p,s,y)}function h(d,p,y){if(y===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let m=0;m<y;m++)this.render(d[m]/l,p[m]);else{x.multiDrawElementsWEBGL(s,p,0,a,d,0,y);let m=0;for(let _=0;_<y;_++)m+=p[_];t.update(m,s,1)}}this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=f,this.renderMultiDraw=h}function Wee(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function Hee(n,e){return n[0]-e[0]}function Gee(n,e){return Math.abs(e[1])-Math.abs(n[1])}function jee(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new Sn,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,f){const h=u.morphTargetInfluences;if(e.isWebGL2===!0){const p=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,y=p!==void 0?p.length:0;let x=s.get(c);if(x===void 0||x.count!==y){let V=function(){H.dispose(),s.delete(c),c.removeEventListener("dispose",V)};var d=V;x!==void 0&&x.texture.dispose();const w=c.morphAttributes.position!==void 0,b=c.morphAttributes.normal!==void 0,S=c.morphAttributes.color!==void 0,M=c.morphAttributes.position||[],T=c.morphAttributes.normal||[],P=c.morphAttributes.color||[];let C=0;w===!0&&(C=1),b===!0&&(C=2),S===!0&&(C=3);let A=c.attributes.position.count*C,k=1;A>e.maxTextureSize&&(k=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const L=new Float32Array(A*k*4*y),H=new Cw(L,A,k,y);H.type=zs,H.needsUpdate=!0;const F=C*4;for(let W=0;W<y;W++){const G=M[W],N=T[W],B=P[W],D=A*k*4*W;for(let $=0;$<G.count;$++){const ee=$*F;w===!0&&(o.fromBufferAttribute(G,$),L[D+ee+0]=o.x,L[D+ee+1]=o.y,L[D+ee+2]=o.z,L[D+ee+3]=0),b===!0&&(o.fromBufferAttribute(N,$),L[D+ee+4]=o.x,L[D+ee+5]=o.y,L[D+ee+6]=o.z,L[D+ee+7]=0),S===!0&&(o.fromBufferAttribute(B,$),L[D+ee+8]=o.x,L[D+ee+9]=o.y,L[D+ee+10]=o.z,L[D+ee+11]=B.itemSize===4?o.w:1)}}x={count:y,texture:H,size:new Me(A,k)},s.set(c,x),c.addEventListener("dispose",V)}let m=0;for(let w=0;w<h.length;w++)m+=h[w];const _=c.morphTargetsRelative?1:1-m;f.getUniforms().setValue(n,"morphTargetBaseInfluence",_),f.getUniforms().setValue(n,"morphTargetInfluences",h),f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{const p=h===void 0?0:h.length;let y=r[c.id];if(y===void 0||y.length!==p){y=[];for(let b=0;b<p;b++)y[b]=[b,0];r[c.id]=y}for(let b=0;b<p;b++){const S=y[b];S[0]=b,S[1]=h[b]}y.sort(Gee);for(let b=0;b<8;b++)b<p&&y[b][1]?(a[b][0]=y[b][0],a[b][1]=y[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(Hee);const x=c.morphAttributes.position,m=c.morphAttributes.normal;let _=0;for(let b=0;b<8;b++){const S=a[b],M=S[0],T=S[1];M!==Number.MAX_SAFE_INTEGER&&T?(x&&c.getAttribute("morphTarget"+b)!==x[M]&&c.setAttribute("morphTarget"+b,x[M]),m&&c.getAttribute("morphNormal"+b)!==m[M]&&c.setAttribute("morphNormal"+b,m[M]),i[b]=T,_+=T):(x&&c.hasAttribute("morphTarget"+b)===!0&&c.deleteAttribute("morphTarget"+b),m&&c.hasAttribute("morphNormal"+b)===!0&&c.deleteAttribute("morphNormal"+b),i[b]=0)}const w=c.morphTargetsRelative?1:1-_;f.getUniforms().setValue(n,"morphTargetBaseInfluence",w),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function Xee(n,e,t,r){let i=new WeakMap;function s(l){const u=r.render.frame,c=l.geometry,f=e.get(l,c);if(i.get(f)!==u&&(e.update(f),i.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==u&&(h.update(),i.set(h,u))}return f}function o(){i=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}class Hv extends vr{constructor(e,t,r,i,s,o,a,l,u,c){if(c=c!==void 0?c:_c,c!==_c&&c!==kc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===_c&&(r=fl),r===void 0&&c===kc&&(r=ou),super(null,i,s,o,a,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:kr,this.minFilter=l!==void 0?l:kr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const g8=new vr,v8=new Hv(1,1);v8.compareFunction=ER;const y8=new Cw,x8=new CR,_8=new Vv,Mk=[],Tk=[],Ck=new Float32Array(16),Ak=new Float32Array(9),Rk=new Float32Array(4);function ym(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=Mk[i];if(s===void 0&&(s=new Float32Array(i),Mk[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function oi(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function ai(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function Aw(n,e){let t=Tk[e];t===void 0&&(t=new Int32Array(e),Tk[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function $ee(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function qee(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(oi(t,e))return;n.uniform2fv(this.addr,e),ai(t,e)}}function Yee(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(oi(t,e))return;n.uniform3fv(this.addr,e),ai(t,e)}}function Kee(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(oi(t,e))return;n.uniform4fv(this.addr,e),ai(t,e)}}function Zee(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(oi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ai(t,e)}else{if(oi(t,r))return;Rk.set(r),n.uniformMatrix2fv(this.addr,!1,Rk),ai(t,r)}}function Jee(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(oi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ai(t,e)}else{if(oi(t,r))return;Ak.set(r),n.uniformMatrix3fv(this.addr,!1,Ak),ai(t,r)}}function Qee(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(oi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ai(t,e)}else{if(oi(t,r))return;Ck.set(r),n.uniformMatrix4fv(this.addr,!1,Ck),ai(t,r)}}function ete(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function tte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(oi(t,e))return;n.uniform2iv(this.addr,e),ai(t,e)}}function nte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(oi(t,e))return;n.uniform3iv(this.addr,e),ai(t,e)}}function rte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(oi(t,e))return;n.uniform4iv(this.addr,e),ai(t,e)}}function ite(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function ste(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(oi(t,e))return;n.uniform2uiv(this.addr,e),ai(t,e)}}function ote(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(oi(t,e))return;n.uniform3uiv(this.addr,e),ai(t,e)}}function ate(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(oi(t,e))return;n.uniform4uiv(this.addr,e),ai(t,e)}}function lte(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?v8:g8;t.setTexture2D(e||s,i)}function ute(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||x8,i)}function cte(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||_8,i)}function fte(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||y8,i)}function hte(n){switch(n){case 5126:return $ee;case 35664:return qee;case 35665:return Yee;case 35666:return Kee;case 35674:return Zee;case 35675:return Jee;case 35676:return Qee;case 5124:case 35670:return ete;case 35667:case 35671:return tte;case 35668:case 35672:return nte;case 35669:case 35673:return rte;case 5125:return ite;case 36294:return ste;case 36295:return ote;case 36296:return ate;case 35678:case 36198:case 36298:case 36306:case 35682:return lte;case 35679:case 36299:case 36307:return ute;case 35680:case 36300:case 36308:case 36293:return cte;case 36289:case 36303:case 36311:case 36292:return fte}}function dte(n,e){n.uniform1fv(this.addr,e)}function pte(n,e){const t=ym(e,this.size,2);n.uniform2fv(this.addr,t)}function mte(n,e){const t=ym(e,this.size,3);n.uniform3fv(this.addr,t)}function gte(n,e){const t=ym(e,this.size,4);n.uniform4fv(this.addr,t)}function vte(n,e){const t=ym(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function yte(n,e){const t=ym(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function xte(n,e){const t=ym(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function _te(n,e){n.uniform1iv(this.addr,e)}function wte(n,e){n.uniform2iv(this.addr,e)}function bte(n,e){n.uniform3iv(this.addr,e)}function Ste(n,e){n.uniform4iv(this.addr,e)}function Ete(n,e){n.uniform1uiv(this.addr,e)}function Mte(n,e){n.uniform2uiv(this.addr,e)}function Tte(n,e){n.uniform3uiv(this.addr,e)}function Cte(n,e){n.uniform4uiv(this.addr,e)}function Ate(n,e,t){const r=this.cache,i=e.length,s=Aw(t,i);oi(r,s)||(n.uniform1iv(this.addr,s),ai(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||g8,s[o])}function Rte(n,e,t){const r=this.cache,i=e.length,s=Aw(t,i);oi(r,s)||(n.uniform1iv(this.addr,s),ai(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||x8,s[o])}function Pte(n,e,t){const r=this.cache,i=e.length,s=Aw(t,i);oi(r,s)||(n.uniform1iv(this.addr,s),ai(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||_8,s[o])}function Ite(n,e,t){const r=this.cache,i=e.length,s=Aw(t,i);oi(r,s)||(n.uniform1iv(this.addr,s),ai(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||y8,s[o])}function Dte(n){switch(n){case 5126:return dte;case 35664:return pte;case 35665:return mte;case 35666:return gte;case 35674:return vte;case 35675:return yte;case 35676:return xte;case 5124:case 35670:return _te;case 35667:case 35671:return wte;case 35668:case 35672:return bte;case 35669:case 35673:return Ste;case 5125:return Ete;case 36294:return Mte;case 36295:return Tte;case 36296:return Cte;case 35678:case 36198:case 36298:case 36306:case 35682:return Ate;case 35679:case 36299:case 36307:return Rte;case 35680:case 36300:case 36308:case 36293:return Pte;case 36289:case 36303:case 36311:case 36292:return Ite}}class Nte{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=hte(t.type)}}class kte{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Dte(t.type)}}class Lte{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const SE=/(\w+)(\])?(\[|\.)?/g;function Pk(n,e){n.seq.push(e),n.map[e.id]=e}function Fte(n,e,t){const r=n.name,i=r.length;for(SE.lastIndex=0;;){const s=SE.exec(r),o=SE.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===i){Pk(t,u===void 0?new Nte(a,n,e):new kte(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new Lte(a),Pk(t,f)),t=f}}}class x2{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);Fte(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function Ik(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const Ote=37297;let Bte=0;function Ute(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function zte(n){const e=Fn.getPrimaries(Fn.workingColorSpace),t=Fn.getPrimaries(n);let r;switch(e===t?r="":e===Kg&&t===Yg?r="LinearDisplayP3ToLinearSRGB":e===Yg&&t===Kg&&(r="LinearSRGBToLinearDisplayP3"),n){case fa:case zv:return[r,"LinearTransferOETF"];case mn:case Tw:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function Dk(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+Ute(n.getShaderSource(e),o)}else return i}function Vte(n,e){const t=zte(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Wte(n,e){let t;switch(e){case Lz:t="Linear";break;case Fz:t="Reinhard";break;case Oz:t="OptimizedCineon";break;case dR:t="ACESFilmic";break;case Uz:t="AgX";break;case Bz:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Hte(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ip).join(`
`)}function Gte(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(ip).join(`
`)}function jte(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function Xte(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function ip(n){return n!==""}function Nk(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function kk(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const $te=/^[ \t]*#include +<([\w\d./]+)>/gm;function LT(n){return n.replace($te,Yte)}const qte=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Yte(n,e){let t=Kt[e];if(t===void 0){const r=qte.get(e);if(r!==void 0)t=Kt[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return LT(t)}const Kte=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Lk(n){return n.replace(Kte,Zte)}function Zte(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function Fk(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Jte(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===bw?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===$0?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ma&&(e="SHADOWMAP_TYPE_VSM"),e}function Qte(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case pu:case Ic:e="ENVMAP_TYPE_CUBE";break;case mm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ene(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Ic:e="ENVMAP_MODE_REFRACTION";break}return e}function tne(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Uv:e="ENVMAP_BLENDING_MULTIPLY";break;case Nz:e="ENVMAP_BLENDING_MIX";break;case kz:e="ENVMAP_BLENDING_ADD";break}return e}function nne(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function rne(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=Jte(t),u=Qte(t),c=ene(t),f=tne(t),h=nne(t),d=t.isWebGL2?"":Hte(t),p=Gte(t),y=jte(s),x=i.createProgram();let m,_,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(ip).join(`
`),m.length>0&&(m+=`
`),_=[d,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(ip).join(`
`),_.length>0&&(_+=`
`)):(m=[Fk(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ip).join(`
`),_=[d,Fk(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+f:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ka?"#define TONE_MAPPING":"",t.toneMapping!==ka?Kt.tonemapping_pars_fragment:"",t.toneMapping!==ka?Wte("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Kt.colorspace_pars_fragment,Vte("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(ip).join(`
`)),o=LT(o),o=Nk(o,t),o=kk(o,t),a=LT(a),a=Nk(a,t),a=kk(a,t),o=Lk(o),a=Lk(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,m=[p,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,_=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===DT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===DT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const b=w+m+o,S=w+_+a,M=Ik(i,i.VERTEX_SHADER,b),T=Ik(i,i.FRAGMENT_SHADER,S);i.attachShader(x,M),i.attachShader(x,T),t.index0AttributeName!==void 0?i.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(x,0,"position"),i.linkProgram(x);function P(L){if(n.debug.checkShaderErrors){const H=i.getProgramInfoLog(x).trim(),F=i.getShaderInfoLog(M).trim(),V=i.getShaderInfoLog(T).trim();let W=!0,G=!0;if(i.getProgramParameter(x,i.LINK_STATUS)===!1)if(W=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,x,M,T);else{const N=Dk(i,M,"vertex"),B=Dk(i,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(x,i.VALIDATE_STATUS)+`

Program Info Log: `+H+`
`+N+`
`+B)}else H!==""?console.warn("THREE.WebGLProgram: Program Info Log:",H):(F===""||V==="")&&(G=!1);G&&(L.diagnostics={runnable:W,programLog:H,vertexShader:{log:F,prefix:m},fragmentShader:{log:V,prefix:_}})}i.deleteShader(M),i.deleteShader(T),C=new x2(i,x),A=Xte(i,x)}let C;this.getUniforms=function(){return C===void 0&&P(this),C};let A;this.getAttributes=function(){return A===void 0&&P(this),A};let k=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return k===!1&&(k=i.getProgramParameter(x,Ote)),k},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Bte++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=T,this}let ine=0;class sne{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new one(e),t.set(e,r)),r}}class one{constructor(e){this.id=ine++,this.code=e,this.usedTimes=0}}function ane(n,e,t,r,i,s,o){const a=new rh,l=new sne,u=[],c=i.isWebGL2,f=i.logarithmicDepthBuffer,h=i.vertexTextures;let d=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(C){return C===0?"uv":`uv${C}`}function x(C,A,k,L,H){const F=L.fog,V=H.geometry,W=C.isMeshStandardMaterial?L.environment:null,G=(C.isMeshStandardMaterial?t:e).get(C.envMap||W),N=G&&G.mapping===mm?G.image.height:null,B=p[C.type];C.precision!==null&&(d=i.getMaxPrecision(C.precision),d!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",d,"instead."));const D=V.morphAttributes.position||V.morphAttributes.normal||V.morphAttributes.color,$=D!==void 0?D.length:0;let ee=0;V.morphAttributes.position!==void 0&&(ee=1),V.morphAttributes.normal!==void 0&&(ee=2),V.morphAttributes.color!==void 0&&(ee=3);let te,se,me,_e;if(B){const ot=Ko[B];te=ot.vertexShader,se=ot.fragmentShader}else te=C.vertexShader,se=C.fragmentShader,l.update(C),me=l.getVertexShaderID(C),_e=l.getFragmentShaderID(C);const pe=n.getRenderTarget(),Ne=H.isInstancedMesh===!0,Ue=H.isBatchedMesh===!0,We=!!C.map,Be=!!C.matcap,J=!!G,he=!!C.aoMap,de=!!C.lightMap,Ie=!!C.bumpMap,ve=!!C.normalMap,oe=!!C.displacementMap,ze=!!C.emissiveMap,X=!!C.metalnessMap,j=!!C.roughnessMap,ae=C.anisotropy>0,Oe=C.clearcoat>0,Se=C.iridescence>0,K=C.sheen>0,ge=C.transmission>0,Te=ae&&!!C.anisotropyMap,Le=Oe&&!!C.clearcoatMap,Pe=Oe&&!!C.clearcoatNormalMap,De=Oe&&!!C.clearcoatRoughnessMap,Ae=Se&&!!C.iridescenceMap,ht=Se&&!!C.iridescenceThicknessMap,Ze=K&&!!C.sheenColorMap,at=K&&!!C.sheenRoughnessMap,Qe=!!C.specularMap,$e=!!C.specularColorMap,Dt=!!C.specularIntensityMap,Ft=ge&&!!C.transmissionMap,sn=ge&&!!C.thicknessMap,Ke=!!C.gradientMap,He=!!C.alphaMap,re=C.alphaTest>0,je=!!C.alphaHash,qe=!!C.extensions,At=!!V.attributes.uv1,_t=!!V.attributes.uv2,Jt=!!V.attributes.uv3;let cn=ka;return C.toneMapped&&(pe===null||pe.isXRRenderTarget===!0)&&(cn=n.toneMapping),{isWebGL2:c,shaderID:B,shaderType:C.type,shaderName:C.name,vertexShader:te,fragmentShader:se,defines:C.defines,customVertexShaderID:me,customFragmentShaderID:_e,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:d,batching:Ue,instancing:Ne,instancingColor:Ne&&H.instanceColor!==null,supportsVertexTextures:h,outputColorSpace:pe===null?n.outputColorSpace:pe.isXRRenderTarget===!0?pe.texture.colorSpace:fa,map:We,matcap:Be,envMap:J,envMapMode:J&&G.mapping,envMapCubeUVHeight:N,aoMap:he,lightMap:de,bumpMap:Ie,normalMap:ve,displacementMap:h&&oe,emissiveMap:ze,normalMapObjectSpace:ve&&C.normalMapType===Qz,normalMapTangentSpace:ve&&C.normalMapType===Xc,metalnessMap:X,roughnessMap:j,anisotropy:ae,anisotropyMap:Te,clearcoat:Oe,clearcoatMap:Le,clearcoatNormalMap:Pe,clearcoatRoughnessMap:De,iridescence:Se,iridescenceMap:Ae,iridescenceThicknessMap:ht,sheen:K,sheenColorMap:Ze,sheenRoughnessMap:at,specularMap:Qe,specularColorMap:$e,specularIntensityMap:Dt,transmission:ge,transmissionMap:Ft,thicknessMap:sn,gradientMap:Ke,opaque:C.transparent===!1&&C.blending===th,alphaMap:He,alphaTest:re,alphaHash:je,combine:C.combine,mapUv:We&&y(C.map.channel),aoMapUv:he&&y(C.aoMap.channel),lightMapUv:de&&y(C.lightMap.channel),bumpMapUv:Ie&&y(C.bumpMap.channel),normalMapUv:ve&&y(C.normalMap.channel),displacementMapUv:oe&&y(C.displacementMap.channel),emissiveMapUv:ze&&y(C.emissiveMap.channel),metalnessMapUv:X&&y(C.metalnessMap.channel),roughnessMapUv:j&&y(C.roughnessMap.channel),anisotropyMapUv:Te&&y(C.anisotropyMap.channel),clearcoatMapUv:Le&&y(C.clearcoatMap.channel),clearcoatNormalMapUv:Pe&&y(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:De&&y(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Ae&&y(C.iridescenceMap.channel),iridescenceThicknessMapUv:ht&&y(C.iridescenceThicknessMap.channel),sheenColorMapUv:Ze&&y(C.sheenColorMap.channel),sheenRoughnessMapUv:at&&y(C.sheenRoughnessMap.channel),specularMapUv:Qe&&y(C.specularMap.channel),specularColorMapUv:$e&&y(C.specularColorMap.channel),specularIntensityMapUv:Dt&&y(C.specularIntensityMap.channel),transmissionMapUv:Ft&&y(C.transmissionMap.channel),thicknessMapUv:sn&&y(C.thicknessMap.channel),alphaMapUv:He&&y(C.alphaMap.channel),vertexTangents:!!V.attributes.tangent&&(ve||ae),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!V.attributes.color&&V.attributes.color.itemSize===4,vertexUv1s:At,vertexUv2s:_t,vertexUv3s:Jt,pointsUvs:H.isPoints===!0&&!!V.attributes.uv&&(We||He),fog:!!F,useFog:C.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:H.isSkinnedMesh===!0,morphTargets:V.morphAttributes.position!==void 0,morphNormals:V.morphAttributes.normal!==void 0,morphColors:V.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:ee,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numLightProbes:A.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&k.length>0,shadowMapType:n.shadowMap.type,toneMapping:cn,useLegacyLights:n._useLegacyLights,decodeVideoTexture:We&&C.map.isVideoTexture===!0&&Fn.getTransfer(C.map.colorSpace)===Gn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===xs,flipSided:C.side===ri,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:qe&&C.extensions.derivatives===!0,extensionFragDepth:qe&&C.extensions.fragDepth===!0,extensionDrawBuffers:qe&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:qe&&C.extensions.shaderTextureLOD===!0,extensionClipCullDistance:qe&&C.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function m(C){const A=[];if(C.shaderID?A.push(C.shaderID):(A.push(C.customVertexShaderID),A.push(C.customFragmentShaderID)),C.defines!==void 0)for(const k in C.defines)A.push(k),A.push(C.defines[k]);return C.isRawShaderMaterial===!1&&(_(A,C),w(A,C),A.push(n.outputColorSpace)),A.push(C.customProgramCacheKey),A.join()}function _(C,A){C.push(A.precision),C.push(A.outputColorSpace),C.push(A.envMapMode),C.push(A.envMapCubeUVHeight),C.push(A.mapUv),C.push(A.alphaMapUv),C.push(A.lightMapUv),C.push(A.aoMapUv),C.push(A.bumpMapUv),C.push(A.normalMapUv),C.push(A.displacementMapUv),C.push(A.emissiveMapUv),C.push(A.metalnessMapUv),C.push(A.roughnessMapUv),C.push(A.anisotropyMapUv),C.push(A.clearcoatMapUv),C.push(A.clearcoatNormalMapUv),C.push(A.clearcoatRoughnessMapUv),C.push(A.iridescenceMapUv),C.push(A.iridescenceThicknessMapUv),C.push(A.sheenColorMapUv),C.push(A.sheenRoughnessMapUv),C.push(A.specularMapUv),C.push(A.specularColorMapUv),C.push(A.specularIntensityMapUv),C.push(A.transmissionMapUv),C.push(A.thicknessMapUv),C.push(A.combine),C.push(A.fogExp2),C.push(A.sizeAttenuation),C.push(A.morphTargetsCount),C.push(A.morphAttributeCount),C.push(A.numDirLights),C.push(A.numPointLights),C.push(A.numSpotLights),C.push(A.numSpotLightMaps),C.push(A.numHemiLights),C.push(A.numRectAreaLights),C.push(A.numDirLightShadows),C.push(A.numPointLightShadows),C.push(A.numSpotLightShadows),C.push(A.numSpotLightShadowsWithMaps),C.push(A.numLightProbes),C.push(A.shadowMapType),C.push(A.toneMapping),C.push(A.numClippingPlanes),C.push(A.numClipIntersection),C.push(A.depthPacking)}function w(C,A){a.disableAll(),A.isWebGL2&&a.enable(0),A.supportsVertexTextures&&a.enable(1),A.instancing&&a.enable(2),A.instancingColor&&a.enable(3),A.matcap&&a.enable(4),A.envMap&&a.enable(5),A.normalMapObjectSpace&&a.enable(6),A.normalMapTangentSpace&&a.enable(7),A.clearcoat&&a.enable(8),A.iridescence&&a.enable(9),A.alphaTest&&a.enable(10),A.vertexColors&&a.enable(11),A.vertexAlphas&&a.enable(12),A.vertexUv1s&&a.enable(13),A.vertexUv2s&&a.enable(14),A.vertexUv3s&&a.enable(15),A.vertexTangents&&a.enable(16),A.anisotropy&&a.enable(17),A.alphaHash&&a.enable(18),A.batching&&a.enable(19),C.push(a.mask),a.disableAll(),A.fog&&a.enable(0),A.useFog&&a.enable(1),A.flatShading&&a.enable(2),A.logarithmicDepthBuffer&&a.enable(3),A.skinning&&a.enable(4),A.morphTargets&&a.enable(5),A.morphNormals&&a.enable(6),A.morphColors&&a.enable(7),A.premultipliedAlpha&&a.enable(8),A.shadowMapEnabled&&a.enable(9),A.useLegacyLights&&a.enable(10),A.doubleSided&&a.enable(11),A.flipSided&&a.enable(12),A.useDepthPacking&&a.enable(13),A.dithering&&a.enable(14),A.transmission&&a.enable(15),A.sheen&&a.enable(16),A.opaque&&a.enable(17),A.pointsUvs&&a.enable(18),A.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function b(C){const A=p[C.type];let k;if(A){const L=Ko[A];k=IR.clone(L.uniforms)}else k=C.uniforms;return k}function S(C,A){let k;for(let L=0,H=u.length;L<H;L++){const F=u[L];if(F.cacheKey===A){k=F,++k.usedTimes;break}}return k===void 0&&(k=new rne(n,A,C,s),u.push(k)),k}function M(C){if(--C.usedTimes===0){const A=u.indexOf(C);u[A]=u[u.length-1],u.pop(),C.destroy()}}function T(C){l.remove(C)}function P(){l.dispose()}return{getParameters:x,getProgramCacheKey:m,getUniforms:b,acquireProgram:S,releaseProgram:M,releaseShaderCache:T,programs:u,dispose:P}}function lne(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function une(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Ok(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Bk(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(f,h,d,p,y,x){let m=n[e];return m===void 0?(m={id:f.id,object:f,geometry:h,material:d,groupOrder:p,renderOrder:f.renderOrder,z:y,group:x},n[e]=m):(m.id=f.id,m.object=f,m.geometry=h,m.material=d,m.groupOrder=p,m.renderOrder=f.renderOrder,m.z=y,m.group=x),e++,m}function a(f,h,d,p,y,x){const m=o(f,h,d,p,y,x);d.transmission>0?r.push(m):d.transparent===!0?i.push(m):t.push(m)}function l(f,h,d,p,y,x){const m=o(f,h,d,p,y,x);d.transmission>0?r.unshift(m):d.transparent===!0?i.unshift(m):t.unshift(m)}function u(f,h){t.length>1&&t.sort(f||une),r.length>1&&r.sort(h||Ok),i.length>1&&i.sort(h||Ok)}function c(){for(let f=e,h=n.length;f<h;f++){const d=n[f];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:c,sort:u}}function cne(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new Bk,n.set(r,[o])):i>=s.length?(o=new Bk,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function fne(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new it};break;case"SpotLight":t={position:new Q,direction:new Q,color:new it,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new it,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new it,groundColor:new it};break;case"RectAreaLight":t={color:new it,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return n[e.id]=t,t}}}function hne(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let dne=0;function pne(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function mne(n,e){const t=new fne,r=hne(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new Q);const s=new Q,o=new Ht,a=new Ht;function l(c,f){let h=0,d=0,p=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let y=0,x=0,m=0,_=0,w=0,b=0,S=0,M=0,T=0,P=0,C=0;c.sort(pne);const A=f===!0?Math.PI:1;for(let L=0,H=c.length;L<H;L++){const F=c[L],V=F.color,W=F.intensity,G=F.distance,N=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)h+=V.r*W*A,d+=V.g*W*A,p+=V.b*W*A;else if(F.isLightProbe){for(let B=0;B<9;B++)i.probe[B].addScaledVector(F.sh.coefficients[B],W);C++}else if(F.isDirectionalLight){const B=t.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*A),F.castShadow){const D=F.shadow,$=r.get(F);$.shadowBias=D.bias,$.shadowNormalBias=D.normalBias,$.shadowRadius=D.radius,$.shadowMapSize=D.mapSize,i.directionalShadow[y]=$,i.directionalShadowMap[y]=N,i.directionalShadowMatrix[y]=F.shadow.matrix,b++}i.directional[y]=B,y++}else if(F.isSpotLight){const B=t.get(F);B.position.setFromMatrixPosition(F.matrixWorld),B.color.copy(V).multiplyScalar(W*A),B.distance=G,B.coneCos=Math.cos(F.angle),B.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),B.decay=F.decay,i.spot[m]=B;const D=F.shadow;if(F.map&&(i.spotLightMap[T]=F.map,T++,D.updateMatrices(F),F.castShadow&&P++),i.spotLightMatrix[m]=D.matrix,F.castShadow){const $=r.get(F);$.shadowBias=D.bias,$.shadowNormalBias=D.normalBias,$.shadowRadius=D.radius,$.shadowMapSize=D.mapSize,i.spotShadow[m]=$,i.spotShadowMap[m]=N,M++}m++}else if(F.isRectAreaLight){const B=t.get(F);B.color.copy(V).multiplyScalar(W),B.halfWidth.set(F.width*.5,0,0),B.halfHeight.set(0,F.height*.5,0),i.rectArea[_]=B,_++}else if(F.isPointLight){const B=t.get(F);if(B.color.copy(F.color).multiplyScalar(F.intensity*A),B.distance=F.distance,B.decay=F.decay,F.castShadow){const D=F.shadow,$=r.get(F);$.shadowBias=D.bias,$.shadowNormalBias=D.normalBias,$.shadowRadius=D.radius,$.shadowMapSize=D.mapSize,$.shadowCameraNear=D.camera.near,$.shadowCameraFar=D.camera.far,i.pointShadow[x]=$,i.pointShadowMap[x]=N,i.pointShadowMatrix[x]=F.shadow.matrix,S++}i.point[x]=B,x++}else if(F.isHemisphereLight){const B=t.get(F);B.skyColor.copy(F.color).multiplyScalar(W*A),B.groundColor.copy(F.groundColor).multiplyScalar(W*A),i.hemi[w]=B,w++}}_>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=et.LTC_FLOAT_1,i.rectAreaLTC2=et.LTC_FLOAT_2):(i.rectAreaLTC1=et.LTC_HALF_1,i.rectAreaLTC2=et.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=et.LTC_FLOAT_1,i.rectAreaLTC2=et.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=et.LTC_HALF_1,i.rectAreaLTC2=et.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=d,i.ambient[2]=p;const k=i.hash;(k.directionalLength!==y||k.pointLength!==x||k.spotLength!==m||k.rectAreaLength!==_||k.hemiLength!==w||k.numDirectionalShadows!==b||k.numPointShadows!==S||k.numSpotShadows!==M||k.numSpotMaps!==T||k.numLightProbes!==C)&&(i.directional.length=y,i.spot.length=m,i.rectArea.length=_,i.point.length=x,i.hemi.length=w,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=S,i.pointShadowMap.length=S,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=S,i.spotLightMatrix.length=M+T-P,i.spotLightMap.length=T,i.numSpotLightShadowsWithMaps=P,i.numLightProbes=C,k.directionalLength=y,k.pointLength=x,k.spotLength=m,k.rectAreaLength=_,k.hemiLength=w,k.numDirectionalShadows=b,k.numPointShadows=S,k.numSpotShadows=M,k.numSpotMaps=T,k.numLightProbes=C,i.version=dne++)}function u(c,f){let h=0,d=0,p=0,y=0,x=0;const m=f.matrixWorldInverse;for(let _=0,w=c.length;_<w;_++){const b=c[_];if(b.isDirectionalLight){const S=i.directional[h];S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(m),h++}else if(b.isSpotLight){const S=i.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(m),S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(m),p++}else if(b.isRectAreaLight){const S=i.rectArea[y];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(m),a.identity(),o.copy(b.matrixWorld),o.premultiply(m),a.extractRotation(o),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),y++}else if(b.isPointLight){const S=i.point[d];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(m),d++}else if(b.isHemisphereLight){const S=i.hemi[x];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(m),x++}}}return{setup:l,setupView:u,state:i}}function Uk(n,e){const t=new mne(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(f){r.push(f)}function a(f){i.push(f)}function l(f){t.setup(r,f)}function u(f){t.setupView(r,f)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function gne(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new Uk(n,e),t.set(s,[l])):o>=a.length?(l=new Uk(n,e),a.push(l)):l=a[o],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class NR extends Mi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gm,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class kR extends Mi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const vne=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,yne=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function xne(n,e,t){let r=new Wv;const i=new Me,s=new Me,o=new Sn,a=new NR({depthPacking:Jz}),l=new kR,u={},c=t.maxTextureSize,f={[Tl]:ri,[ri]:Tl,[xs]:xs},h=new $r({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Me},radius:{value:4}},vertexShader:vne,fragmentShader:yne}),d=h.clone();d.defines.HORIZONTAL_PASS=1;const p=new qt;p.setAttribute("position",new vn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Qn(p,h),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bw;let m=this.type;this.render=function(M,T,P){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||M.length===0)return;const C=n.getRenderTarget(),A=n.getActiveCubeFace(),k=n.getActiveMipmapLevel(),L=n.state;L.setBlending(Ms),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);const H=m!==Ma&&this.type===Ma,F=m===Ma&&this.type!==Ma;for(let V=0,W=M.length;V<W;V++){const G=M[V],N=G.shadow;if(N===void 0){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(N.autoUpdate===!1&&N.needsUpdate===!1)continue;i.copy(N.mapSize);const B=N.getFrameExtents();if(i.multiply(B),s.copy(N.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(s.x=Math.floor(c/B.x),i.x=s.x*B.x,N.mapSize.x=s.x),i.y>c&&(s.y=Math.floor(c/B.y),i.y=s.y*B.y,N.mapSize.y=s.y)),N.map===null||H===!0||F===!0){const $=this.type!==Ma?{minFilter:kr,magFilter:kr}:{};N.map!==null&&N.map.dispose(),N.map=new Br(i.x,i.y,$),N.map.texture.name=G.name+".shadowMap",N.camera.updateProjectionMatrix()}n.setRenderTarget(N.map),n.clear();const D=N.getViewportCount();for(let $=0;$<D;$++){const ee=N.getViewport($);o.set(s.x*ee.x,s.y*ee.y,s.x*ee.z,s.y*ee.w),L.viewport(o),N.updateMatrices(G,$),r=N.getFrustum(),b(T,P,N.camera,G,this.type)}N.isPointLightShadow!==!0&&this.type===Ma&&_(N,P),N.needsUpdate=!1}m=this.type,x.needsUpdate=!1,n.setRenderTarget(C,A,k)};function _(M,T){const P=e.update(y);h.defines.VSM_SAMPLES!==M.blurSamples&&(h.defines.VSM_SAMPLES=M.blurSamples,d.defines.VSM_SAMPLES=M.blurSamples,h.needsUpdate=!0,d.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Br(i.x,i.y)),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(T,null,P,h,y,null),d.uniforms.shadow_pass.value=M.mapPass.texture,d.uniforms.resolution.value=M.mapSize,d.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(T,null,P,d,y,null)}function w(M,T,P,C){let A=null;const k=P.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(k!==void 0)A=k;else if(A=P.isPointLight===!0?l:a,n.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0){const L=A.uuid,H=T.uuid;let F=u[L];F===void 0&&(F={},u[L]=F);let V=F[H];V===void 0&&(V=A.clone(),F[H]=V,T.addEventListener("dispose",S)),A=V}if(A.visible=T.visible,A.wireframe=T.wireframe,C===Ma?A.side=T.shadowSide!==null?T.shadowSide:T.side:A.side=T.shadowSide!==null?T.shadowSide:f[T.side],A.alphaMap=T.alphaMap,A.alphaTest=T.alphaTest,A.map=T.map,A.clipShadows=T.clipShadows,A.clippingPlanes=T.clippingPlanes,A.clipIntersection=T.clipIntersection,A.displacementMap=T.displacementMap,A.displacementScale=T.displacementScale,A.displacementBias=T.displacementBias,A.wireframeLinewidth=T.wireframeLinewidth,A.linewidth=T.linewidth,P.isPointLight===!0&&A.isMeshDistanceMaterial===!0){const L=n.properties.get(A);L.light=P}return A}function b(M,T,P,C,A){if(M.visible===!1)return;if(M.layers.test(T.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&A===Ma)&&(!M.frustumCulled||r.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,M.matrixWorld);const H=e.update(M),F=M.material;if(Array.isArray(F)){const V=H.groups;for(let W=0,G=V.length;W<G;W++){const N=V[W],B=F[N.materialIndex];if(B&&B.visible){const D=w(M,B,C,A);M.onBeforeShadow(n,M,T,P,H,D,N),n.renderBufferDirect(P,null,H,D,M,N),M.onAfterShadow(n,M,T,P,H,D,N)}}}else if(F.visible){const V=w(M,F,C,A);M.onBeforeShadow(n,M,T,P,H,V,null),n.renderBufferDirect(P,null,H,V,M,null),M.onAfterShadow(n,M,T,P,H,V,null)}}const L=M.children;for(let H=0,F=L.length;H<F;H++)b(L[H],T,P,C,A)}function S(M){M.target.removeEventListener("dispose",S);for(const P in u){const C=u[P],A=M.target.uuid;A in C&&(C[A].dispose(),delete C[A])}}}function _ne(n,e,t){const r=t.isWebGL2;function i(){let re=!1;const je=new Sn;let qe=null;const At=new Sn(0,0,0,0);return{setMask:function(_t){qe!==_t&&!re&&(n.colorMask(_t,_t,_t,_t),qe=_t)},setLocked:function(_t){re=_t},setClear:function(_t,Jt,cn,ut,ot){ot===!0&&(_t*=ut,Jt*=ut,cn*=ut),je.set(_t,Jt,cn,ut),At.equals(je)===!1&&(n.clearColor(_t,Jt,cn,ut),At.copy(je))},reset:function(){re=!1,qe=null,At.set(-1,0,0,0)}}}function s(){let re=!1,je=null,qe=null,At=null;return{setTest:function(_t){_t?Ue(n.DEPTH_TEST):We(n.DEPTH_TEST)},setMask:function(_t){je!==_t&&!re&&(n.depthMask(_t),je=_t)},setFunc:function(_t){if(qe!==_t){switch(_t){case Cz:n.depthFunc(n.NEVER);break;case hR:n.depthFunc(n.ALWAYS);break;case Az:n.depthFunc(n.LESS);break;case zg:n.depthFunc(n.LEQUAL);break;case Rz:n.depthFunc(n.EQUAL);break;case Pz:n.depthFunc(n.GEQUAL);break;case Iz:n.depthFunc(n.GREATER);break;case Dz:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}qe=_t}},setLocked:function(_t){re=_t},setClear:function(_t){At!==_t&&(n.clearDepth(_t),At=_t)},reset:function(){re=!1,je=null,qe=null,At=null}}}function o(){let re=!1,je=null,qe=null,At=null,_t=null,Jt=null,cn=null,ut=null,ot=null;return{setTest:function(xt){re||(xt?Ue(n.STENCIL_TEST):We(n.STENCIL_TEST))},setMask:function(xt){je!==xt&&!re&&(n.stencilMask(xt),je=xt)},setFunc:function(xt,Ge,wt){(qe!==xt||At!==Ge||_t!==wt)&&(n.stencilFunc(xt,Ge,wt),qe=xt,At=Ge,_t=wt)},setOp:function(xt,Ge,wt){(Jt!==xt||cn!==Ge||ut!==wt)&&(n.stencilOp(xt,Ge,wt),Jt=xt,cn=Ge,ut=wt)},setLocked:function(xt){re=xt},setClear:function(xt){ot!==xt&&(n.clearStencil(xt),ot=xt)},reset:function(){re=!1,je=null,qe=null,At=null,_t=null,Jt=null,cn=null,ut=null,ot=null}}}const a=new i,l=new s,u=new o,c=new WeakMap,f=new WeakMap;let h={},d={},p=new WeakMap,y=[],x=null,m=!1,_=null,w=null,b=null,S=null,M=null,T=null,P=null,C=new it(0,0,0),A=0,k=!1,L=null,H=null,F=null,V=null,W=null;const G=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let N=!1,B=0;const D=n.getParameter(n.VERSION);D.indexOf("WebGL")!==-1?(B=parseFloat(/^WebGL (\d)/.exec(D)[1]),N=B>=1):D.indexOf("OpenGL ES")!==-1&&(B=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),N=B>=2);let $=null,ee={};const te=n.getParameter(n.SCISSOR_BOX),se=n.getParameter(n.VIEWPORT),me=new Sn().fromArray(te),_e=new Sn().fromArray(se);function pe(re,je,qe,At){const _t=new Uint8Array(4),Jt=n.createTexture();n.bindTexture(re,Jt),n.texParameteri(re,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(re,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let cn=0;cn<qe;cn++)r&&(re===n.TEXTURE_3D||re===n.TEXTURE_2D_ARRAY)?n.texImage3D(je,0,n.RGBA,1,1,At,0,n.RGBA,n.UNSIGNED_BYTE,_t):n.texImage2D(je+cn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,_t);return Jt}const Ne={};Ne[n.TEXTURE_2D]=pe(n.TEXTURE_2D,n.TEXTURE_2D,1),Ne[n.TEXTURE_CUBE_MAP]=pe(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Ne[n.TEXTURE_2D_ARRAY]=pe(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ne[n.TEXTURE_3D]=pe(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Ue(n.DEPTH_TEST),l.setFunc(zg),ze(!1),X(eT),Ue(n.CULL_FACE),ve(Ms);function Ue(re){h[re]!==!0&&(n.enable(re),h[re]=!0)}function We(re){h[re]!==!1&&(n.disable(re),h[re]=!1)}function Be(re,je){return d[re]!==je?(n.bindFramebuffer(re,je),d[re]=je,r&&(re===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=je),re===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=je)),!0):!1}function J(re,je){let qe=y,At=!1;if(re)if(qe=p.get(je),qe===void 0&&(qe=[],p.set(je,qe)),re.isWebGLMultipleRenderTargets){const _t=re.texture;if(qe.length!==_t.length||qe[0]!==n.COLOR_ATTACHMENT0){for(let Jt=0,cn=_t.length;Jt<cn;Jt++)qe[Jt]=n.COLOR_ATTACHMENT0+Jt;qe.length=_t.length,At=!0}}else qe[0]!==n.COLOR_ATTACHMENT0&&(qe[0]=n.COLOR_ATTACHMENT0,At=!0);else qe[0]!==n.BACK&&(qe[0]=n.BACK,At=!0);At&&(t.isWebGL2?n.drawBuffers(qe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(qe))}function he(re){return x!==re?(n.useProgram(re),x=re,!0):!1}const de={[nc]:n.FUNC_ADD,[hz]:n.FUNC_SUBTRACT,[dz]:n.FUNC_REVERSE_SUBTRACT};if(r)de[rT]=n.MIN,de[iT]=n.MAX;else{const re=e.get("EXT_blend_minmax");re!==null&&(de[rT]=re.MIN_EXT,de[iT]=re.MAX_EXT)}const Ie={[pz]:n.ZERO,[mz]:n.ONE,[gz]:n.SRC_COLOR,[a_]:n.SRC_ALPHA,[bz]:n.SRC_ALPHA_SATURATE,[_z]:n.DST_COLOR,[yz]:n.DST_ALPHA,[vz]:n.ONE_MINUS_SRC_COLOR,[l_]:n.ONE_MINUS_SRC_ALPHA,[wz]:n.ONE_MINUS_DST_COLOR,[xz]:n.ONE_MINUS_DST_ALPHA,[Sz]:n.CONSTANT_COLOR,[Ez]:n.ONE_MINUS_CONSTANT_COLOR,[Mz]:n.CONSTANT_ALPHA,[Tz]:n.ONE_MINUS_CONSTANT_ALPHA};function ve(re,je,qe,At,_t,Jt,cn,ut,ot,xt){if(re===Ms){m===!0&&(We(n.BLEND),m=!1);return}if(m===!1&&(Ue(n.BLEND),m=!0),re!==fz){if(re!==_||xt!==k){if((w!==nc||M!==nc)&&(n.blendEquation(n.FUNC_ADD),w=nc,M=nc),xt)switch(re){case th:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case o_:n.blendFunc(n.ONE,n.ONE);break;case tT:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case nT:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case th:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case o_:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case tT:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case nT:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}b=null,S=null,T=null,P=null,C.set(0,0,0),A=0,_=re,k=xt}return}_t=_t||je,Jt=Jt||qe,cn=cn||At,(je!==w||_t!==M)&&(n.blendEquationSeparate(de[je],de[_t]),w=je,M=_t),(qe!==b||At!==S||Jt!==T||cn!==P)&&(n.blendFuncSeparate(Ie[qe],Ie[At],Ie[Jt],Ie[cn]),b=qe,S=At,T=Jt,P=cn),(ut.equals(C)===!1||ot!==A)&&(n.blendColor(ut.r,ut.g,ut.b,ot),C.copy(ut),A=ot),_=re,k=!1}function oe(re,je){re.side===xs?We(n.CULL_FACE):Ue(n.CULL_FACE);let qe=re.side===ri;je&&(qe=!qe),ze(qe),re.blending===th&&re.transparent===!1?ve(Ms):ve(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.blendColor,re.blendAlpha,re.premultipliedAlpha),l.setFunc(re.depthFunc),l.setTest(re.depthTest),l.setMask(re.depthWrite),a.setMask(re.colorWrite);const At=re.stencilWrite;u.setTest(At),At&&(u.setMask(re.stencilWriteMask),u.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),u.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),ae(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?Ue(n.SAMPLE_ALPHA_TO_COVERAGE):We(n.SAMPLE_ALPHA_TO_COVERAGE)}function ze(re){L!==re&&(re?n.frontFace(n.CW):n.frontFace(n.CCW),L=re)}function X(re){re!==lz?(Ue(n.CULL_FACE),re!==H&&(re===eT?n.cullFace(n.BACK):re===uz?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):We(n.CULL_FACE),H=re}function j(re){re!==F&&(N&&n.lineWidth(re),F=re)}function ae(re,je,qe){re?(Ue(n.POLYGON_OFFSET_FILL),(V!==je||W!==qe)&&(n.polygonOffset(je,qe),V=je,W=qe)):We(n.POLYGON_OFFSET_FILL)}function Oe(re){re?Ue(n.SCISSOR_TEST):We(n.SCISSOR_TEST)}function Se(re){re===void 0&&(re=n.TEXTURE0+G-1),$!==re&&(n.activeTexture(re),$=re)}function K(re,je,qe){qe===void 0&&($===null?qe=n.TEXTURE0+G-1:qe=$);let At=ee[qe];At===void 0&&(At={type:void 0,texture:void 0},ee[qe]=At),(At.type!==re||At.texture!==je)&&($!==qe&&(n.activeTexture(qe),$=qe),n.bindTexture(re,je||Ne[re]),At.type=re,At.texture=je)}function ge(){const re=ee[$];re!==void 0&&re.type!==void 0&&(n.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function Te(){try{n.compressedTexImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Le(){try{n.compressedTexImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Pe(){try{n.texSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function De(){try{n.texSubImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Ae(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ht(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Ze(){try{n.texStorage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function at(){try{n.texStorage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Qe(){try{n.texImage2D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function $e(){try{n.texImage3D.apply(n,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Dt(re){me.equals(re)===!1&&(n.scissor(re.x,re.y,re.z,re.w),me.copy(re))}function Ft(re){_e.equals(re)===!1&&(n.viewport(re.x,re.y,re.z,re.w),_e.copy(re))}function sn(re,je){let qe=f.get(je);qe===void 0&&(qe=new WeakMap,f.set(je,qe));let At=qe.get(re);At===void 0&&(At=n.getUniformBlockIndex(je,re.name),qe.set(re,At))}function Ke(re,je){const At=f.get(je).get(re);c.get(je)!==At&&(n.uniformBlockBinding(je,At,re.__bindingPointIndex),c.set(je,At))}function He(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},$=null,ee={},d={},p=new WeakMap,y=[],x=null,m=!1,_=null,w=null,b=null,S=null,M=null,T=null,P=null,C=new it(0,0,0),A=0,k=!1,L=null,H=null,F=null,V=null,W=null,me.set(0,0,n.canvas.width,n.canvas.height),_e.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:Ue,disable:We,bindFramebuffer:Be,drawBuffers:J,useProgram:he,setBlending:ve,setMaterial:oe,setFlipSided:ze,setCullFace:X,setLineWidth:j,setPolygonOffset:ae,setScissorTest:Oe,activeTexture:Se,bindTexture:K,unbindTexture:ge,compressedTexImage2D:Te,compressedTexImage3D:Le,texImage2D:Qe,texImage3D:$e,updateUBOMapping:sn,uniformBlockBinding:Ke,texStorage2D:Ze,texStorage3D:at,texSubImage2D:Pe,texSubImage3D:De,compressedTexSubImage2D:Ae,compressedTexSubImage3D:ht,scissor:Dt,viewport:Ft,reset:He}}function wne(n,e,t,r,i,s,o){const a=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new WeakMap;let f;const h=new WeakMap;let d=!1;try{d=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(X,j){return d?new OffscreenCanvas(X,j):Jg("canvas")}function y(X,j,ae,Oe){let Se=1;if((X.width>Oe||X.height>Oe)&&(Se=Oe/Math.max(X.width,X.height)),Se<1||j===!0)if(typeof HTMLImageElement<"u"&&X instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&X instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&X instanceof ImageBitmap){const K=j?f_:Math.floor,ge=K(Se*X.width),Te=K(Se*X.height);f===void 0&&(f=p(ge,Te));const Le=ae?p(ge,Te):f;return Le.width=ge,Le.height=Te,Le.getContext("2d").drawImage(X,0,0,ge,Te),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+X.width+"x"+X.height+") to ("+ge+"x"+Te+")."),Le}else return"data"in X&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+X.width+"x"+X.height+")."),X;return X}function x(X){return NT(X.width)&&NT(X.height)}function m(X){return a?!1:X.wrapS!==Cr||X.wrapT!==Cr||X.minFilter!==kr&&X.minFilter!==bn}function _(X,j){return X.generateMipmaps&&j&&X.minFilter!==kr&&X.minFilter!==bn}function w(X){n.generateMipmap(X)}function b(X,j,ae,Oe,Se=!1){if(a===!1)return j;if(X!==null){if(n[X]!==void 0)return n[X];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+X+"'")}let K=j;if(j===n.RED&&(ae===n.FLOAT&&(K=n.R32F),ae===n.HALF_FLOAT&&(K=n.R16F),ae===n.UNSIGNED_BYTE&&(K=n.R8)),j===n.RED_INTEGER&&(ae===n.UNSIGNED_BYTE&&(K=n.R8UI),ae===n.UNSIGNED_SHORT&&(K=n.R16UI),ae===n.UNSIGNED_INT&&(K=n.R32UI),ae===n.BYTE&&(K=n.R8I),ae===n.SHORT&&(K=n.R16I),ae===n.INT&&(K=n.R32I)),j===n.RG&&(ae===n.FLOAT&&(K=n.RG32F),ae===n.HALF_FLOAT&&(K=n.RG16F),ae===n.UNSIGNED_BYTE&&(K=n.RG8)),j===n.RGBA){const ge=Se?qg:Fn.getTransfer(Oe);ae===n.FLOAT&&(K=n.RGBA32F),ae===n.HALF_FLOAT&&(K=n.RGBA16F),ae===n.UNSIGNED_BYTE&&(K=ge===Gn?n.SRGB8_ALPHA8:n.RGBA8),ae===n.UNSIGNED_SHORT_4_4_4_4&&(K=n.RGBA4),ae===n.UNSIGNED_SHORT_5_5_5_1&&(K=n.RGB5_A1)}return(K===n.R16F||K===n.R32F||K===n.RG16F||K===n.RG32F||K===n.RGBA16F||K===n.RGBA32F)&&e.get("EXT_color_buffer_float"),K}function S(X,j,ae){return _(X,ae)===!0||X.isFramebufferTexture&&X.minFilter!==kr&&X.minFilter!==bn?Math.log2(Math.max(j.width,j.height))+1:X.mipmaps!==void 0&&X.mipmaps.length>0?X.mipmaps.length:X.isCompressedTexture&&Array.isArray(X.image)?j.mipmaps.length:1}function M(X){return X===kr||X===u_||X===q0?n.NEAREST:n.LINEAR}function T(X){const j=X.target;j.removeEventListener("dispose",T),C(j),j.isVideoTexture&&c.delete(j)}function P(X){const j=X.target;j.removeEventListener("dispose",P),k(j)}function C(X){const j=r.get(X);if(j.__webglInit===void 0)return;const ae=X.source,Oe=h.get(ae);if(Oe){const Se=Oe[j.__cacheKey];Se.usedTimes--,Se.usedTimes===0&&A(X),Object.keys(Oe).length===0&&h.delete(ae)}r.remove(X)}function A(X){const j=r.get(X);n.deleteTexture(j.__webglTexture);const ae=X.source,Oe=h.get(ae);delete Oe[j.__cacheKey],o.memory.textures--}function k(X){const j=X.texture,ae=r.get(X),Oe=r.get(j);if(Oe.__webglTexture!==void 0&&(n.deleteTexture(Oe.__webglTexture),o.memory.textures--),X.depthTexture&&X.depthTexture.dispose(),X.isWebGLCubeRenderTarget)for(let Se=0;Se<6;Se++){if(Array.isArray(ae.__webglFramebuffer[Se]))for(let K=0;K<ae.__webglFramebuffer[Se].length;K++)n.deleteFramebuffer(ae.__webglFramebuffer[Se][K]);else n.deleteFramebuffer(ae.__webglFramebuffer[Se]);ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer[Se])}else{if(Array.isArray(ae.__webglFramebuffer))for(let Se=0;Se<ae.__webglFramebuffer.length;Se++)n.deleteFramebuffer(ae.__webglFramebuffer[Se]);else n.deleteFramebuffer(ae.__webglFramebuffer);if(ae.__webglDepthbuffer&&n.deleteRenderbuffer(ae.__webglDepthbuffer),ae.__webglMultisampledFramebuffer&&n.deleteFramebuffer(ae.__webglMultisampledFramebuffer),ae.__webglColorRenderbuffer)for(let Se=0;Se<ae.__webglColorRenderbuffer.length;Se++)ae.__webglColorRenderbuffer[Se]&&n.deleteRenderbuffer(ae.__webglColorRenderbuffer[Se]);ae.__webglDepthRenderbuffer&&n.deleteRenderbuffer(ae.__webglDepthRenderbuffer)}if(X.isWebGLMultipleRenderTargets)for(let Se=0,K=j.length;Se<K;Se++){const ge=r.get(j[Se]);ge.__webglTexture&&(n.deleteTexture(ge.__webglTexture),o.memory.textures--),r.remove(j[Se])}r.remove(j),r.remove(X)}let L=0;function H(){L=0}function F(){const X=L;return X>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+X+" texture units while this GPU supports only "+i.maxTextures),L+=1,X}function V(X){const j=[];return j.push(X.wrapS),j.push(X.wrapT),j.push(X.wrapR||0),j.push(X.magFilter),j.push(X.minFilter),j.push(X.anisotropy),j.push(X.internalFormat),j.push(X.format),j.push(X.type),j.push(X.generateMipmaps),j.push(X.premultiplyAlpha),j.push(X.flipY),j.push(X.unpackAlignment),j.push(X.colorSpace),j.join()}function W(X,j){const ae=r.get(X);if(X.isVideoTexture&&oe(X),X.isRenderTargetTexture===!1&&X.version>0&&ae.__version!==X.version){const Oe=X.image;if(Oe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Oe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{me(ae,X,j);return}}t.bindTexture(n.TEXTURE_2D,ae.__webglTexture,n.TEXTURE0+j)}function G(X,j){const ae=r.get(X);if(X.version>0&&ae.__version!==X.version){me(ae,X,j);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ae.__webglTexture,n.TEXTURE0+j)}function N(X,j){const ae=r.get(X);if(X.version>0&&ae.__version!==X.version){me(ae,X,j);return}t.bindTexture(n.TEXTURE_3D,ae.__webglTexture,n.TEXTURE0+j)}function B(X,j){const ae=r.get(X);if(X.version>0&&ae.__version!==X.version){_e(ae,X,j);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture,n.TEXTURE0+j)}const D={[Hg]:n.REPEAT,[Cr]:n.CLAMP_TO_EDGE,[Gg]:n.MIRRORED_REPEAT},$={[kr]:n.NEAREST,[u_]:n.NEAREST_MIPMAP_NEAREST,[q0]:n.NEAREST_MIPMAP_LINEAR,[bn]:n.LINEAR,[pR]:n.LINEAR_MIPMAP_NEAREST,[Dc]:n.LINEAR_MIPMAP_LINEAR},ee={[e8]:n.NEVER,[o8]:n.ALWAYS,[t8]:n.LESS,[ER]:n.LEQUAL,[n8]:n.EQUAL,[s8]:n.GEQUAL,[r8]:n.GREATER,[i8]:n.NOTEQUAL};function te(X,j,ae){if(ae?(n.texParameteri(X,n.TEXTURE_WRAP_S,D[j.wrapS]),n.texParameteri(X,n.TEXTURE_WRAP_T,D[j.wrapT]),(X===n.TEXTURE_3D||X===n.TEXTURE_2D_ARRAY)&&n.texParameteri(X,n.TEXTURE_WRAP_R,D[j.wrapR]),n.texParameteri(X,n.TEXTURE_MAG_FILTER,$[j.magFilter]),n.texParameteri(X,n.TEXTURE_MIN_FILTER,$[j.minFilter])):(n.texParameteri(X,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(X,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(X===n.TEXTURE_3D||X===n.TEXTURE_2D_ARRAY)&&n.texParameteri(X,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(j.wrapS!==Cr||j.wrapT!==Cr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(X,n.TEXTURE_MAG_FILTER,M(j.magFilter)),n.texParameteri(X,n.TEXTURE_MIN_FILTER,M(j.minFilter)),j.minFilter!==kr&&j.minFilter!==bn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),j.compareFunction&&(n.texParameteri(X,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(X,n.TEXTURE_COMPARE_FUNC,ee[j.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Oe=e.get("EXT_texture_filter_anisotropic");if(j.magFilter===kr||j.minFilter!==q0&&j.minFilter!==Dc||j.type===zs&&e.has("OES_texture_float_linear")===!1||a===!1&&j.type===Nc&&e.has("OES_texture_half_float_linear")===!1)return;(j.anisotropy>1||r.get(j).__currentAnisotropy)&&(n.texParameterf(X,Oe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,i.getMaxAnisotropy())),r.get(j).__currentAnisotropy=j.anisotropy)}}function se(X,j){let ae=!1;X.__webglInit===void 0&&(X.__webglInit=!0,j.addEventListener("dispose",T));const Oe=j.source;let Se=h.get(Oe);Se===void 0&&(Se={},h.set(Oe,Se));const K=V(j);if(K!==X.__cacheKey){Se[K]===void 0&&(Se[K]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ae=!0),Se[K].usedTimes++;const ge=Se[X.__cacheKey];ge!==void 0&&(Se[X.__cacheKey].usedTimes--,ge.usedTimes===0&&A(j)),X.__cacheKey=K,X.__webglTexture=Se[K].texture}return ae}function me(X,j,ae){let Oe=n.TEXTURE_2D;(j.isDataArrayTexture||j.isCompressedArrayTexture)&&(Oe=n.TEXTURE_2D_ARRAY),j.isData3DTexture&&(Oe=n.TEXTURE_3D);const Se=se(X,j),K=j.source;t.bindTexture(Oe,X.__webglTexture,n.TEXTURE0+ae);const ge=r.get(K);if(K.version!==ge.__version||Se===!0){t.activeTexture(n.TEXTURE0+ae);const Te=Fn.getPrimaries(Fn.workingColorSpace),Le=j.colorSpace===_s?null:Fn.getPrimaries(j.colorSpace),Pe=j.colorSpace===_s||Te===Le?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,j.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,j.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Pe);const De=m(j)&&x(j.image)===!1;let Ae=y(j.image,De,!1,i.maxTextureSize);Ae=ze(j,Ae);const ht=x(Ae)||a,Ze=s.convert(j.format,j.colorSpace);let at=s.convert(j.type),Qe=b(j.internalFormat,Ze,at,j.colorSpace,j.isVideoTexture);te(Oe,j,ht);let $e;const Dt=j.mipmaps,Ft=a&&j.isVideoTexture!==!0&&Qe!==wR,sn=ge.__version===void 0||Se===!0,Ke=S(j,Ae,ht);if(j.isDepthTexture)Qe=n.DEPTH_COMPONENT,a?j.type===zs?Qe=n.DEPTH_COMPONENT32F:j.type===fl?Qe=n.DEPTH_COMPONENT24:j.type===ou?Qe=n.DEPTH24_STENCIL8:Qe=n.DEPTH_COMPONENT16:j.type===zs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===_c&&Qe===n.DEPTH_COMPONENT&&j.type!==Ew&&j.type!==fl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=fl,at=s.convert(j.type)),j.format===kc&&Qe===n.DEPTH_COMPONENT&&(Qe=n.DEPTH_STENCIL,j.type!==ou&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=ou,at=s.convert(j.type))),sn&&(Ft?t.texStorage2D(n.TEXTURE_2D,1,Qe,Ae.width,Ae.height):t.texImage2D(n.TEXTURE_2D,0,Qe,Ae.width,Ae.height,0,Ze,at,null));else if(j.isDataTexture)if(Dt.length>0&&ht){Ft&&sn&&t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Dt[0].width,Dt[0].height);for(let He=0,re=Dt.length;He<re;He++)$e=Dt[He],Ft?t.texSubImage2D(n.TEXTURE_2D,He,0,0,$e.width,$e.height,Ze,at,$e.data):t.texImage2D(n.TEXTURE_2D,He,Qe,$e.width,$e.height,0,Ze,at,$e.data);j.generateMipmaps=!1}else Ft?(sn&&t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ae.width,Ae.height,Ze,at,Ae.data)):t.texImage2D(n.TEXTURE_2D,0,Qe,Ae.width,Ae.height,0,Ze,at,Ae.data);else if(j.isCompressedTexture)if(j.isCompressedArrayTexture){Ft&&sn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ke,Qe,Dt[0].width,Dt[0].height,Ae.depth);for(let He=0,re=Dt.length;He<re;He++)$e=Dt[He],j.format!==ki?Ze!==null?Ft?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,He,0,0,0,$e.width,$e.height,Ae.depth,Ze,$e.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,He,Qe,$e.width,$e.height,Ae.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?t.texSubImage3D(n.TEXTURE_2D_ARRAY,He,0,0,0,$e.width,$e.height,Ae.depth,Ze,at,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,He,Qe,$e.width,$e.height,Ae.depth,0,Ze,at,$e.data)}else{Ft&&sn&&t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Dt[0].width,Dt[0].height);for(let He=0,re=Dt.length;He<re;He++)$e=Dt[He],j.format!==ki?Ze!==null?Ft?t.compressedTexSubImage2D(n.TEXTURE_2D,He,0,0,$e.width,$e.height,Ze,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,He,Qe,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?t.texSubImage2D(n.TEXTURE_2D,He,0,0,$e.width,$e.height,Ze,at,$e.data):t.texImage2D(n.TEXTURE_2D,He,Qe,$e.width,$e.height,0,Ze,at,$e.data)}else if(j.isDataArrayTexture)Ft?(sn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ke,Qe,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ze,at,Ae.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Qe,Ae.width,Ae.height,Ae.depth,0,Ze,at,Ae.data);else if(j.isData3DTexture)Ft?(sn&&t.texStorage3D(n.TEXTURE_3D,Ke,Qe,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ze,at,Ae.data)):t.texImage3D(n.TEXTURE_3D,0,Qe,Ae.width,Ae.height,Ae.depth,0,Ze,at,Ae.data);else if(j.isFramebufferTexture){if(sn)if(Ft)t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Ae.width,Ae.height);else{let He=Ae.width,re=Ae.height;for(let je=0;je<Ke;je++)t.texImage2D(n.TEXTURE_2D,je,Qe,He,re,0,Ze,at,null),He>>=1,re>>=1}}else if(Dt.length>0&&ht){Ft&&sn&&t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Dt[0].width,Dt[0].height);for(let He=0,re=Dt.length;He<re;He++)$e=Dt[He],Ft?t.texSubImage2D(n.TEXTURE_2D,He,0,0,Ze,at,$e):t.texImage2D(n.TEXTURE_2D,He,Qe,Ze,at,$e);j.generateMipmaps=!1}else Ft?(sn&&t.texStorage2D(n.TEXTURE_2D,Ke,Qe,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ze,at,Ae)):t.texImage2D(n.TEXTURE_2D,0,Qe,Ze,at,Ae);_(j,ht)&&w(Oe),ge.__version=K.version,j.onUpdate&&j.onUpdate(j)}X.__version=j.version}function _e(X,j,ae){if(j.image.length!==6)return;const Oe=se(X,j),Se=j.source;t.bindTexture(n.TEXTURE_CUBE_MAP,X.__webglTexture,n.TEXTURE0+ae);const K=r.get(Se);if(Se.version!==K.__version||Oe===!0){t.activeTexture(n.TEXTURE0+ae);const ge=Fn.getPrimaries(Fn.workingColorSpace),Te=j.colorSpace===_s?null:Fn.getPrimaries(j.colorSpace),Le=j.colorSpace===_s||ge===Te?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,j.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,j.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Le);const Pe=j.isCompressedTexture||j.image[0].isCompressedTexture,De=j.image[0]&&j.image[0].isDataTexture,Ae=[];for(let He=0;He<6;He++)!Pe&&!De?Ae[He]=y(j.image[He],!1,!0,i.maxCubemapSize):Ae[He]=De?j.image[He].image:j.image[He],Ae[He]=ze(j,Ae[He]);const ht=Ae[0],Ze=x(ht)||a,at=s.convert(j.format,j.colorSpace),Qe=s.convert(j.type),$e=b(j.internalFormat,at,Qe,j.colorSpace),Dt=a&&j.isVideoTexture!==!0,Ft=K.__version===void 0||Oe===!0;let sn=S(j,ht,Ze);te(n.TEXTURE_CUBE_MAP,j,Ze);let Ke;if(Pe){Dt&&Ft&&t.texStorage2D(n.TEXTURE_CUBE_MAP,sn,$e,ht.width,ht.height);for(let He=0;He<6;He++){Ke=Ae[He].mipmaps;for(let re=0;re<Ke.length;re++){const je=Ke[re];j.format!==ki?at!==null?Dt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re,0,0,je.width,je.height,at,je.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re,$e,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Dt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re,0,0,je.width,je.height,at,Qe,je.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re,$e,je.width,je.height,0,at,Qe,je.data)}}}else{Ke=j.mipmaps,Dt&&Ft&&(Ke.length>0&&sn++,t.texStorage2D(n.TEXTURE_CUBE_MAP,sn,$e,Ae[0].width,Ae[0].height));for(let He=0;He<6;He++)if(De){Dt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,0,0,Ae[He].width,Ae[He].height,at,Qe,Ae[He].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,$e,Ae[He].width,Ae[He].height,0,at,Qe,Ae[He].data);for(let re=0;re<Ke.length;re++){const qe=Ke[re].image[He].image;Dt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re+1,0,0,qe.width,qe.height,at,Qe,qe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re+1,$e,qe.width,qe.height,0,at,Qe,qe.data)}}else{Dt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,0,0,at,Qe,Ae[He]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,$e,at,Qe,Ae[He]);for(let re=0;re<Ke.length;re++){const je=Ke[re];Dt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re+1,0,0,at,Qe,je.image[He]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+He,re+1,$e,at,Qe,je.image[He])}}}_(j,Ze)&&w(n.TEXTURE_CUBE_MAP),K.__version=Se.version,j.onUpdate&&j.onUpdate(j)}X.__version=j.version}function pe(X,j,ae,Oe,Se,K){const ge=s.convert(ae.format,ae.colorSpace),Te=s.convert(ae.type),Le=b(ae.internalFormat,ge,Te,ae.colorSpace);if(!r.get(j).__hasExternalTextures){const De=Math.max(1,j.width>>K),Ae=Math.max(1,j.height>>K);Se===n.TEXTURE_3D||Se===n.TEXTURE_2D_ARRAY?t.texImage3D(Se,K,Le,De,Ae,j.depth,0,ge,Te,null):t.texImage2D(Se,K,Le,De,Ae,0,ge,Te,null)}t.bindFramebuffer(n.FRAMEBUFFER,X),ve(j)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Oe,Se,r.get(ae).__webglTexture,0,Ie(j)):(Se===n.TEXTURE_2D||Se>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Se<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Oe,Se,r.get(ae).__webglTexture,K),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ne(X,j,ae){if(n.bindRenderbuffer(n.RENDERBUFFER,X),j.depthBuffer&&!j.stencilBuffer){let Oe=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(ae||ve(j)){const Se=j.depthTexture;Se&&Se.isDepthTexture&&(Se.type===zs?Oe=n.DEPTH_COMPONENT32F:Se.type===fl&&(Oe=n.DEPTH_COMPONENT24));const K=Ie(j);ve(j)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,K,Oe,j.width,j.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,K,Oe,j.width,j.height)}else n.renderbufferStorage(n.RENDERBUFFER,Oe,j.width,j.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,X)}else if(j.depthBuffer&&j.stencilBuffer){const Oe=Ie(j);ae&&ve(j)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Oe,n.DEPTH24_STENCIL8,j.width,j.height):ve(j)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Oe,n.DEPTH24_STENCIL8,j.width,j.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,j.width,j.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,X)}else{const Oe=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let Se=0;Se<Oe.length;Se++){const K=Oe[Se],ge=s.convert(K.format,K.colorSpace),Te=s.convert(K.type),Le=b(K.internalFormat,ge,Te,K.colorSpace),Pe=Ie(j);ae&&ve(j)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Pe,Le,j.width,j.height):ve(j)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Pe,Le,j.width,j.height):n.renderbufferStorage(n.RENDERBUFFER,Le,j.width,j.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ue(X,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,X),!(j.depthTexture&&j.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),W(j.depthTexture,0);const Oe=r.get(j.depthTexture).__webglTexture,Se=Ie(j);if(j.depthTexture.format===_c)ve(j)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Oe,0,Se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Oe,0);else if(j.depthTexture.format===kc)ve(j)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Oe,0,Se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Oe,0);else throw new Error("Unknown depthTexture format")}function We(X){const j=r.get(X),ae=X.isWebGLCubeRenderTarget===!0;if(X.depthTexture&&!j.__autoAllocateDepthBuffer){if(ae)throw new Error("target.depthTexture not supported in Cube render targets");Ue(j.__webglFramebuffer,X)}else if(ae){j.__webglDepthbuffer=[];for(let Oe=0;Oe<6;Oe++)t.bindFramebuffer(n.FRAMEBUFFER,j.__webglFramebuffer[Oe]),j.__webglDepthbuffer[Oe]=n.createRenderbuffer(),Ne(j.__webglDepthbuffer[Oe],X,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,j.__webglFramebuffer),j.__webglDepthbuffer=n.createRenderbuffer(),Ne(j.__webglDepthbuffer,X,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Be(X,j,ae){const Oe=r.get(X);j!==void 0&&pe(Oe.__webglFramebuffer,X,X.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ae!==void 0&&We(X)}function J(X){const j=X.texture,ae=r.get(X),Oe=r.get(j);X.addEventListener("dispose",P),X.isWebGLMultipleRenderTargets!==!0&&(Oe.__webglTexture===void 0&&(Oe.__webglTexture=n.createTexture()),Oe.__version=j.version,o.memory.textures++);const Se=X.isWebGLCubeRenderTarget===!0,K=X.isWebGLMultipleRenderTargets===!0,ge=x(X)||a;if(Se){ae.__webglFramebuffer=[];for(let Te=0;Te<6;Te++)if(a&&j.mipmaps&&j.mipmaps.length>0){ae.__webglFramebuffer[Te]=[];for(let Le=0;Le<j.mipmaps.length;Le++)ae.__webglFramebuffer[Te][Le]=n.createFramebuffer()}else ae.__webglFramebuffer[Te]=n.createFramebuffer()}else{if(a&&j.mipmaps&&j.mipmaps.length>0){ae.__webglFramebuffer=[];for(let Te=0;Te<j.mipmaps.length;Te++)ae.__webglFramebuffer[Te]=n.createFramebuffer()}else ae.__webglFramebuffer=n.createFramebuffer();if(K)if(i.drawBuffers){const Te=X.texture;for(let Le=0,Pe=Te.length;Le<Pe;Le++){const De=r.get(Te[Le]);De.__webglTexture===void 0&&(De.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&X.samples>0&&ve(X)===!1){const Te=K?j:[j];ae.__webglMultisampledFramebuffer=n.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ae.__webglMultisampledFramebuffer);for(let Le=0;Le<Te.length;Le++){const Pe=Te[Le];ae.__webglColorRenderbuffer[Le]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ae.__webglColorRenderbuffer[Le]);const De=s.convert(Pe.format,Pe.colorSpace),Ae=s.convert(Pe.type),ht=b(Pe.internalFormat,De,Ae,Pe.colorSpace,X.isXRRenderTarget===!0),Ze=Ie(X);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ze,ht,X.width,X.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Le,n.RENDERBUFFER,ae.__webglColorRenderbuffer[Le])}n.bindRenderbuffer(n.RENDERBUFFER,null),X.depthBuffer&&(ae.__webglDepthRenderbuffer=n.createRenderbuffer(),Ne(ae.__webglDepthRenderbuffer,X,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Se){t.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture),te(n.TEXTURE_CUBE_MAP,j,ge);for(let Te=0;Te<6;Te++)if(a&&j.mipmaps&&j.mipmaps.length>0)for(let Le=0;Le<j.mipmaps.length;Le++)pe(ae.__webglFramebuffer[Te][Le],X,j,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Le);else pe(ae.__webglFramebuffer[Te],X,j,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0);_(j,ge)&&w(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(K){const Te=X.texture;for(let Le=0,Pe=Te.length;Le<Pe;Le++){const De=Te[Le],Ae=r.get(De);t.bindTexture(n.TEXTURE_2D,Ae.__webglTexture),te(n.TEXTURE_2D,De,ge),pe(ae.__webglFramebuffer,X,De,n.COLOR_ATTACHMENT0+Le,n.TEXTURE_2D,0),_(De,ge)&&w(n.TEXTURE_2D)}t.unbindTexture()}else{let Te=n.TEXTURE_2D;if((X.isWebGL3DRenderTarget||X.isWebGLArrayRenderTarget)&&(a?Te=X.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Te,Oe.__webglTexture),te(Te,j,ge),a&&j.mipmaps&&j.mipmaps.length>0)for(let Le=0;Le<j.mipmaps.length;Le++)pe(ae.__webglFramebuffer[Le],X,j,n.COLOR_ATTACHMENT0,Te,Le);else pe(ae.__webglFramebuffer,X,j,n.COLOR_ATTACHMENT0,Te,0);_(j,ge)&&w(Te),t.unbindTexture()}X.depthBuffer&&We(X)}function he(X){const j=x(X)||a,ae=X.isWebGLMultipleRenderTargets===!0?X.texture:[X.texture];for(let Oe=0,Se=ae.length;Oe<Se;Oe++){const K=ae[Oe];if(_(K,j)){const ge=X.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Te=r.get(K).__webglTexture;t.bindTexture(ge,Te),w(ge),t.unbindTexture()}}}function de(X){if(a&&X.samples>0&&ve(X)===!1){const j=X.isWebGLMultipleRenderTargets?X.texture:[X.texture],ae=X.width,Oe=X.height;let Se=n.COLOR_BUFFER_BIT;const K=[],ge=X.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Te=r.get(X),Le=X.isWebGLMultipleRenderTargets===!0;if(Le)for(let Pe=0;Pe<j.length;Pe++)t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Te.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Te.__webglFramebuffer);for(let Pe=0;Pe<j.length;Pe++){K.push(n.COLOR_ATTACHMENT0+Pe),X.depthBuffer&&K.push(ge);const De=Te.__ignoreDepthValues!==void 0?Te.__ignoreDepthValues:!1;if(De===!1&&(X.depthBuffer&&(Se|=n.DEPTH_BUFFER_BIT),X.stencilBuffer&&(Se|=n.STENCIL_BUFFER_BIT)),Le&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Te.__webglColorRenderbuffer[Pe]),De===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[ge]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[ge])),Le){const Ae=r.get(j[Pe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ae,0)}n.blitFramebuffer(0,0,ae,Oe,0,0,ae,Oe,Se,n.NEAREST),u&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,K)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Le)for(let Pe=0;Pe<j.length;Pe++){t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,Te.__webglColorRenderbuffer[Pe]);const De=r.get(j[Pe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,De,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Te.__webglMultisampledFramebuffer)}}function Ie(X){return Math.min(i.maxSamples,X.samples)}function ve(X){const j=r.get(X);return a&&X.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&j.__useRenderToTexture!==!1}function oe(X){const j=o.render.frame;c.get(X)!==j&&(c.set(X,j),X.update())}function ze(X,j){const ae=X.colorSpace,Oe=X.format,Se=X.type;return X.isCompressedTexture===!0||X.isVideoTexture===!0||X.format===c_||ae!==fa&&ae!==_s&&(Fn.getTransfer(ae)===Gn?a===!1?e.has("EXT_sRGB")===!0&&Oe===ki?(X.format=c_,X.minFilter=bn,X.generateMipmaps=!1):j=TR.sRGBToLinear(j):(Oe!==ki||Se!==Oi)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ae)),j}this.allocateTextureUnit=F,this.resetTextureUnits=H,this.setTexture2D=W,this.setTexture2DArray=G,this.setTexture3D=N,this.setTextureCube=B,this.rebindTextures=Be,this.setupRenderTarget=J,this.updateRenderTargetMipmap=he,this.updateMultisampleRenderTarget=de,this.setupDepthRenderbuffer=We,this.setupFrameBufferTexture=pe,this.useMultisampledRTT=ve}function w8(n,e,t){const r=t.isWebGL2;function i(s,o=_s){let a;const l=Fn.getTransfer(o);if(s===Oi)return n.UNSIGNED_BYTE;if(s===gR)return n.UNSIGNED_SHORT_4_4_4_4;if(s===vR)return n.UNSIGNED_SHORT_5_5_5_1;if(s===Vz)return n.BYTE;if(s===Wz)return n.SHORT;if(s===Ew)return n.UNSIGNED_SHORT;if(s===mR)return n.INT;if(s===fl)return n.UNSIGNED_INT;if(s===zs)return n.FLOAT;if(s===Nc)return r?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Hz)return n.ALPHA;if(s===ki)return n.RGBA;if(s===Gz)return n.LUMINANCE;if(s===jz)return n.LUMINANCE_ALPHA;if(s===_c)return n.DEPTH_COMPONENT;if(s===kc)return n.DEPTH_STENCIL;if(s===c_)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===Xz)return n.RED;if(s===yR)return n.RED_INTEGER;if(s===$z)return n.RG;if(s===xR)return n.RG_INTEGER;if(s===_R)return n.RGBA_INTEGER;if(s===d2||s===p2||s===m2||s===g2)if(l===Gn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===d2)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===p2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===m2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===g2)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===d2)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===p2)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===m2)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===g2)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===oT||s===aT||s===lT||s===uT)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===oT)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===aT)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===lT)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===uT)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===wR)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===cT||s===fT)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===cT)return l===Gn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===fT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===hT||s===dT||s===pT||s===mT||s===gT||s===vT||s===yT||s===xT||s===_T||s===wT||s===bT||s===ST||s===ET||s===MT)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===hT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===dT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===pT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===mT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===gT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===vT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===yT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===xT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===_T)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===wT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===bT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===ST)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===ET)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===MT)return l===Gn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===v2||s===TT||s===CT)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===v2)return l===Gn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===TT)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===CT)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===qz||s===AT||s===RT||s===PT)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===v2)return a.COMPRESSED_RED_RGTC1_EXT;if(s===AT)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===RT)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===PT)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ou?r?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class b8 extends ti{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class sp extends Rn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const bne={type:"move"};class EE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new sp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new sp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new sp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const y of e.hand.values()){const x=t.getJointPose(y,r),m=this._getHandJoint(u,y);x!==null&&(m.matrix.fromArray(x.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=x.radius),m.visible=x!==null}const c=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],h=c.position.distanceTo(f.position),d=.02,p=.005;u.inputState.pinching&&h>d+p?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=d-p&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(bne)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new sp;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class Sne extends da{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,u=null,c=null,f=null,h=null,d=null,p=null;const y=t.getContextAttributes();let x=null,m=null;const _=[],w=[],b=new Me;let S=null;const M=new ti;M.layers.enable(1),M.viewport=new Sn;const T=new ti;T.layers.enable(2),T.viewport=new Sn;const P=[M,T],C=new b8;C.layers.enable(1),C.layers.enable(2);let A=null,k=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(te){let se=_[te];return se===void 0&&(se=new EE,_[te]=se),se.getTargetRaySpace()},this.getControllerGrip=function(te){let se=_[te];return se===void 0&&(se=new EE,_[te]=se),se.getGripSpace()},this.getHand=function(te){let se=_[te];return se===void 0&&(se=new EE,_[te]=se),se.getHandSpace()};function L(te){const se=w.indexOf(te.inputSource);if(se===-1)return;const me=_[se];me!==void 0&&(me.update(te.inputSource,te.frame,u||o),me.dispatchEvent({type:te.type,data:te.inputSource}))}function H(){i.removeEventListener("select",L),i.removeEventListener("selectstart",L),i.removeEventListener("selectend",L),i.removeEventListener("squeeze",L),i.removeEventListener("squeezestart",L),i.removeEventListener("squeezeend",L),i.removeEventListener("end",H),i.removeEventListener("inputsourceschange",F);for(let te=0;te<_.length;te++){const se=w[te];se!==null&&(w[te]=null,_[te].disconnect(se))}A=null,k=null,e.setRenderTarget(x),d=null,h=null,f=null,i=null,m=null,ee.stop(),r.isPresenting=!1,e.setPixelRatio(S),e.setSize(b.width,b.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(te){s=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(te){a=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(te){u=te},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return f},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(te){if(i=te,i!==null){if(x=e.getRenderTarget(),i.addEventListener("select",L),i.addEventListener("selectstart",L),i.addEventListener("selectend",L),i.addEventListener("squeeze",L),i.addEventListener("squeezestart",L),i.addEventListener("squeezeend",L),i.addEventListener("end",H),i.addEventListener("inputsourceschange",F),y.xrCompatible!==!0&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(b),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const se={antialias:i.renderState.layers===void 0?y.antialias:!0,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};d=new XRWebGLLayer(i,t,se),i.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),m=new Br(d.framebufferWidth,d.framebufferHeight,{format:ki,type:Oi,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil})}else{let se=null,me=null,_e=null;y.depth&&(_e=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,se=y.stencil?kc:_c,me=y.stencil?ou:fl);const pe={colorFormat:t.RGBA8,depthFormat:_e,scaleFactor:s};f=new XRWebGLBinding(i,t),h=f.createProjectionLayer(pe),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),m=new Br(h.textureWidth,h.textureHeight,{format:ki,type:Oi,depthTexture:new Hv(h.textureWidth,h.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0});const Ne=e.properties.get(m);Ne.__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await i.requestReferenceSpace(a),ee.setContext(i),ee.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function F(te){for(let se=0;se<te.removed.length;se++){const me=te.removed[se],_e=w.indexOf(me);_e>=0&&(w[_e]=null,_[_e].disconnect(me))}for(let se=0;se<te.added.length;se++){const me=te.added[se];let _e=w.indexOf(me);if(_e===-1){for(let Ne=0;Ne<_.length;Ne++)if(Ne>=w.length){w.push(me),_e=Ne;break}else if(w[Ne]===null){w[Ne]=me,_e=Ne;break}if(_e===-1)break}const pe=_[_e];pe&&pe.connect(me)}}const V=new Q,W=new Q;function G(te,se,me){V.setFromMatrixPosition(se.matrixWorld),W.setFromMatrixPosition(me.matrixWorld);const _e=V.distanceTo(W),pe=se.projectionMatrix.elements,Ne=me.projectionMatrix.elements,Ue=pe[14]/(pe[10]-1),We=pe[14]/(pe[10]+1),Be=(pe[9]+1)/pe[5],J=(pe[9]-1)/pe[5],he=(pe[8]-1)/pe[0],de=(Ne[8]+1)/Ne[0],Ie=Ue*he,ve=Ue*de,oe=_e/(-he+de),ze=oe*-he;se.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(ze),te.translateZ(oe),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.copy(te.matrixWorld).invert();const X=Ue+oe,j=We+oe,ae=Ie-ze,Oe=ve+(_e-ze),Se=Be*We/j*X,K=J*We/j*X;te.projectionMatrix.makePerspective(ae,Oe,Se,K,X,j),te.projectionMatrixInverse.copy(te.projectionMatrix).invert()}function N(te,se){se===null?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(se.matrixWorld,te.matrix),te.matrixWorldInverse.copy(te.matrixWorld).invert()}this.updateCamera=function(te){if(i===null)return;C.near=T.near=M.near=te.near,C.far=T.far=M.far=te.far,(A!==C.near||k!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,k=C.far);const se=te.parent,me=C.cameras;N(C,se);for(let _e=0;_e<me.length;_e++)N(me[_e],se);me.length===2?G(C,M,T):C.projectionMatrix.copy(M.projectionMatrix),B(te,C,se)};function B(te,se,me){me===null?te.matrix.copy(se.matrixWorld):(te.matrix.copy(me.matrixWorld),te.matrix.invert(),te.matrix.multiply(se.matrixWorld)),te.matrix.decompose(te.position,te.quaternion,te.scale),te.updateMatrixWorld(!0),te.projectionMatrix.copy(se.projectionMatrix),te.projectionMatrixInverse.copy(se.projectionMatrixInverse),te.isPerspectiveCamera&&(te.fov=$p*2*Math.atan(1/te.projectionMatrix.elements[5]),te.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(h===null&&d===null))return l},this.setFoveation=function(te){l=te,h!==null&&(h.fixedFoveation=te),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=te)};let D=null;function $(te,se){if(c=se.getViewerPose(u||o),p=se,c!==null){const me=c.views;d!==null&&(e.setRenderTargetFramebuffer(m,d.framebuffer),e.setRenderTarget(m));let _e=!1;me.length!==C.cameras.length&&(C.cameras.length=0,_e=!0);for(let pe=0;pe<me.length;pe++){const Ne=me[pe];let Ue=null;if(d!==null)Ue=d.getViewport(Ne);else{const Be=f.getViewSubImage(h,Ne);Ue=Be.viewport,pe===0&&(e.setRenderTargetTextures(m,Be.colorTexture,h.ignoreDepthValues?void 0:Be.depthStencilTexture),e.setRenderTarget(m))}let We=P[pe];We===void 0&&(We=new ti,We.layers.enable(pe),We.viewport=new Sn,P[pe]=We),We.matrix.fromArray(Ne.transform.matrix),We.matrix.decompose(We.position,We.quaternion,We.scale),We.projectionMatrix.fromArray(Ne.projectionMatrix),We.projectionMatrixInverse.copy(We.projectionMatrix).invert(),We.viewport.set(Ue.x,Ue.y,Ue.width,Ue.height),pe===0&&(C.matrix.copy(We.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),_e===!0&&C.cameras.push(We)}}for(let me=0;me<_.length;me++){const _e=w[me],pe=_[me];_e!==null&&pe!==void 0&&pe.update(_e,se,u||o)}D&&D(te,se),se.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:se}),p=null}const ee=new m8;ee.setAnimationLoop($),this.setAnimationLoop=function(te){D=te},this.dispose=function(){}}}function Ene(n,e){function t(x,m){x.matrixAutoUpdate===!0&&x.updateMatrix(),m.value.copy(x.matrix)}function r(x,m){m.color.getRGB(x.fogColor.value,h8(n)),m.isFog?(x.fogNear.value=m.near,x.fogFar.value=m.far):m.isFogExp2&&(x.fogDensity.value=m.density)}function i(x,m,_,w,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(x,m):m.isMeshToonMaterial?(s(x,m),f(x,m)):m.isMeshPhongMaterial?(s(x,m),c(x,m)):m.isMeshStandardMaterial?(s(x,m),h(x,m),m.isMeshPhysicalMaterial&&d(x,m,b)):m.isMeshMatcapMaterial?(s(x,m),p(x,m)):m.isMeshDepthMaterial?s(x,m):m.isMeshDistanceMaterial?(s(x,m),y(x,m)):m.isMeshNormalMaterial?s(x,m):m.isLineBasicMaterial?(o(x,m),m.isLineDashedMaterial&&a(x,m)):m.isPointsMaterial?l(x,m,_,w):m.isSpriteMaterial?u(x,m):m.isShadowMaterial?(x.color.value.copy(m.color),x.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(x,m){x.opacity.value=m.opacity,m.color&&x.diffuse.value.copy(m.color),m.emissive&&x.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(x.map.value=m.map,t(m.map,x.mapTransform)),m.alphaMap&&(x.alphaMap.value=m.alphaMap,t(m.alphaMap,x.alphaMapTransform)),m.bumpMap&&(x.bumpMap.value=m.bumpMap,t(m.bumpMap,x.bumpMapTransform),x.bumpScale.value=m.bumpScale,m.side===ri&&(x.bumpScale.value*=-1)),m.normalMap&&(x.normalMap.value=m.normalMap,t(m.normalMap,x.normalMapTransform),x.normalScale.value.copy(m.normalScale),m.side===ri&&x.normalScale.value.negate()),m.displacementMap&&(x.displacementMap.value=m.displacementMap,t(m.displacementMap,x.displacementMapTransform),x.displacementScale.value=m.displacementScale,x.displacementBias.value=m.displacementBias),m.emissiveMap&&(x.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,x.emissiveMapTransform)),m.specularMap&&(x.specularMap.value=m.specularMap,t(m.specularMap,x.specularMapTransform)),m.alphaTest>0&&(x.alphaTest.value=m.alphaTest);const _=e.get(m).envMap;if(_&&(x.envMap.value=_,x.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=m.reflectivity,x.ior.value=m.ior,x.refractionRatio.value=m.refractionRatio),m.lightMap){x.lightMap.value=m.lightMap;const w=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=m.lightMapIntensity*w,t(m.lightMap,x.lightMapTransform)}m.aoMap&&(x.aoMap.value=m.aoMap,x.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,x.aoMapTransform))}function o(x,m){x.diffuse.value.copy(m.color),x.opacity.value=m.opacity,m.map&&(x.map.value=m.map,t(m.map,x.mapTransform))}function a(x,m){x.dashSize.value=m.dashSize,x.totalSize.value=m.dashSize+m.gapSize,x.scale.value=m.scale}function l(x,m,_,w){x.diffuse.value.copy(m.color),x.opacity.value=m.opacity,x.size.value=m.size*_,x.scale.value=w*.5,m.map&&(x.map.value=m.map,t(m.map,x.uvTransform)),m.alphaMap&&(x.alphaMap.value=m.alphaMap,t(m.alphaMap,x.alphaMapTransform)),m.alphaTest>0&&(x.alphaTest.value=m.alphaTest)}function u(x,m){x.diffuse.value.copy(m.color),x.opacity.value=m.opacity,x.rotation.value=m.rotation,m.map&&(x.map.value=m.map,t(m.map,x.mapTransform)),m.alphaMap&&(x.alphaMap.value=m.alphaMap,t(m.alphaMap,x.alphaMapTransform)),m.alphaTest>0&&(x.alphaTest.value=m.alphaTest)}function c(x,m){x.specular.value.copy(m.specular),x.shininess.value=Math.max(m.shininess,1e-4)}function f(x,m){m.gradientMap&&(x.gradientMap.value=m.gradientMap)}function h(x,m){x.metalness.value=m.metalness,m.metalnessMap&&(x.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,x.metalnessMapTransform)),x.roughness.value=m.roughness,m.roughnessMap&&(x.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,x.roughnessMapTransform)),e.get(m).envMap&&(x.envMapIntensity.value=m.envMapIntensity)}function d(x,m,_){x.ior.value=m.ior,m.sheen>0&&(x.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),x.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(x.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,x.sheenColorMapTransform)),m.sheenRoughnessMap&&(x.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,x.sheenRoughnessMapTransform))),m.clearcoat>0&&(x.clearcoat.value=m.clearcoat,x.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(x.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,x.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(x.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===ri&&x.clearcoatNormalScale.value.negate())),m.iridescence>0&&(x.iridescence.value=m.iridescence,x.iridescenceIOR.value=m.iridescenceIOR,x.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(x.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,x.iridescenceMapTransform)),m.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),m.transmission>0&&(x.transmission.value=m.transmission,x.transmissionSamplerMap.value=_.texture,x.transmissionSamplerSize.value.set(_.width,_.height),m.transmissionMap&&(x.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,x.transmissionMapTransform)),x.thickness.value=m.thickness,m.thicknessMap&&(x.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=m.attenuationDistance,x.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(x.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(x.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=m.specularIntensity,x.specularColor.value.copy(m.specularColor),m.specularColorMap&&(x.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,x.specularColorMapTransform)),m.specularIntensityMap&&(x.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,x.specularIntensityMapTransform))}function p(x,m){m.matcap&&(x.matcap.value=m.matcap)}function y(x,m){const _=e.get(m).light;x.referencePosition.value.setFromMatrixPosition(_.matrixWorld),x.nearDistance.value=_.shadow.camera.near,x.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Mne(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(_,w){const b=w.program;r.uniformBlockBinding(_,b)}function u(_,w){let b=i[_.id];b===void 0&&(p(_),b=c(_),i[_.id]=b,_.addEventListener("dispose",x));const S=w.program;r.updateUBOMapping(_,S);const M=e.render.frame;s[_.id]!==M&&(h(_),s[_.id]=M)}function c(_){const w=f();_.__bindingPointIndex=w;const b=n.createBuffer(),S=_.__size,M=_.usage;return n.bindBuffer(n.UNIFORM_BUFFER,b),n.bufferData(n.UNIFORM_BUFFER,S,M),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,w,b),b}function f(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(_){const w=i[_.id],b=_.uniforms,S=_.__cache;n.bindBuffer(n.UNIFORM_BUFFER,w);for(let M=0,T=b.length;M<T;M++){const P=Array.isArray(b[M])?b[M]:[b[M]];for(let C=0,A=P.length;C<A;C++){const k=P[C];if(d(k,M,C,S)===!0){const L=k.__offset,H=Array.isArray(k.value)?k.value:[k.value];let F=0;for(let V=0;V<H.length;V++){const W=H[V],G=y(W);typeof W=="number"||typeof W=="boolean"?(k.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,L+F,k.__data)):W.isMatrix3?(k.__data[0]=W.elements[0],k.__data[1]=W.elements[1],k.__data[2]=W.elements[2],k.__data[3]=0,k.__data[4]=W.elements[3],k.__data[5]=W.elements[4],k.__data[6]=W.elements[5],k.__data[7]=0,k.__data[8]=W.elements[6],k.__data[9]=W.elements[7],k.__data[10]=W.elements[8],k.__data[11]=0):(W.toArray(k.__data,F),F+=G.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,L,k.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function d(_,w,b,S){const M=_.value,T=w+"_"+b;if(S[T]===void 0)return typeof M=="number"||typeof M=="boolean"?S[T]=M:S[T]=M.clone(),!0;{const P=S[T];if(typeof M=="number"||typeof M=="boolean"){if(P!==M)return S[T]=M,!0}else if(P.equals(M)===!1)return P.copy(M),!0}return!1}function p(_){const w=_.uniforms;let b=0;const S=16;for(let T=0,P=w.length;T<P;T++){const C=Array.isArray(w[T])?w[T]:[w[T]];for(let A=0,k=C.length;A<k;A++){const L=C[A],H=Array.isArray(L.value)?L.value:[L.value];for(let F=0,V=H.length;F<V;F++){const W=H[F],G=y(W),N=b%S;N!==0&&S-N<G.boundary&&(b+=S-N),L.__data=new Float32Array(G.storage/Float32Array.BYTES_PER_ELEMENT),L.__offset=b,b+=G.storage}}}const M=b%S;return M>0&&(b+=S-M),_.__size=b,_.__cache={},this}function y(_){const w={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(w.boundary=4,w.storage=4):_.isVector2?(w.boundary=8,w.storage=8):_.isVector3||_.isColor?(w.boundary=16,w.storage=12):_.isVector4?(w.boundary=16,w.storage=16):_.isMatrix3?(w.boundary=48,w.storage=48):_.isMatrix4?(w.boundary=64,w.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),w}function x(_){const w=_.target;w.removeEventListener("dispose",x);const b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),n.deleteBuffer(i[w.id]),delete i[w.id],delete s[w.id]}function m(){for(const _ in i)n.deleteBuffer(i[_]);o=[],i={},s={}}return{bind:l,update:u,dispose:m}}class xm{constructor(e={}){const{canvas:t=l8(),context:r=null,depth:i=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let h;r!==null?h=r.getContextAttributes().alpha:h=o;const d=new Uint32Array(4),p=new Int32Array(4);let y=null,x=null;const m=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=mn,this._useLegacyLights=!1,this.toneMapping=ka,this.toneMappingExposure=1;const w=this;let b=!1,S=0,M=0,T=null,P=-1,C=null;const A=new Sn,k=new Sn;let L=null;const H=new it(0);let F=0,V=t.width,W=t.height,G=1,N=null,B=null;const D=new Sn(0,0,V,W),$=new Sn(0,0,V,W);let ee=!1;const te=new Wv;let se=!1,me=!1,_e=null;const pe=new Ht,Ne=new Me,Ue=new Q,We={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Be(){return T===null?G:1}let J=r;function he(q,ce){for(let we=0;we<q.length;we++){const xe=q[we],ye=t.getContext(xe,ce);if(ye!==null)return ye}return null}try{const q={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${pm}`),t.addEventListener("webglcontextlost",He,!1),t.addEventListener("webglcontextrestored",re,!1),t.addEventListener("webglcontextcreationerror",je,!1),J===null){const ce=["webgl2","webgl","experimental-webgl"];if(w.isWebGL1Renderer===!0&&ce.shift(),J=he(ce,q),J===null)throw he(ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&J instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),J.getShaderPrecisionFormat===void 0&&(J.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(q){throw console.error("THREE.WebGLRenderer: "+q.message),q}let de,Ie,ve,oe,ze,X,j,ae,Oe,Se,K,ge,Te,Le,Pe,De,Ae,ht,Ze,at,Qe,$e,Dt,Ft;function sn(){de=new Uee(J),Ie=new Nee(J,de,e),de.init(Ie),$e=new w8(J,de,Ie),ve=new _ne(J,de,Ie),oe=new Wee(J),ze=new lne,X=new wne(J,de,ve,ze,Ie,$e,oe),j=new Lee(w),ae=new Bee(w),Oe=new KZ(J,Ie),Dt=new Iee(J,de,Oe,Ie),Se=new zee(J,Oe,oe,Dt),K=new Xee(J,Se,Oe,oe),Ze=new jee(J,Ie,X),De=new kee(ze),ge=new ane(w,j,ae,de,Ie,Dt,De),Te=new Ene(w,ze),Le=new cne,Pe=new gne(de,Ie),ht=new Pee(w,j,ae,ve,K,h,l),Ae=new xne(w,K,Ie),Ft=new Mne(J,oe,Ie,ve),at=new Dee(J,de,oe,Ie),Qe=new Vee(J,de,oe,Ie),oe.programs=ge.programs,w.capabilities=Ie,w.extensions=de,w.properties=ze,w.renderLists=Le,w.shadowMap=Ae,w.state=ve,w.info=oe}sn();const Ke=new Sne(w,J);this.xr=Ke,this.getContext=function(){return J},this.getContextAttributes=function(){return J.getContextAttributes()},this.forceContextLoss=function(){const q=de.get("WEBGL_lose_context");q&&q.loseContext()},this.forceContextRestore=function(){const q=de.get("WEBGL_lose_context");q&&q.restoreContext()},this.getPixelRatio=function(){return G},this.setPixelRatio=function(q){q!==void 0&&(G=q,this.setSize(V,W,!1))},this.getSize=function(q){return q.set(V,W)},this.setSize=function(q,ce,we=!0){if(Ke.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=q,W=ce,t.width=Math.floor(q*G),t.height=Math.floor(ce*G),we===!0&&(t.style.width=q+"px",t.style.height=ce+"px"),this.setViewport(0,0,q,ce)},this.getDrawingBufferSize=function(q){return q.set(V*G,W*G).floor()},this.setDrawingBufferSize=function(q,ce,we){V=q,W=ce,G=we,t.width=Math.floor(q*we),t.height=Math.floor(ce*we),this.setViewport(0,0,q,ce)},this.getCurrentViewport=function(q){return q.copy(A)},this.getViewport=function(q){return q.copy(D)},this.setViewport=function(q,ce,we,xe){q.isVector4?D.set(q.x,q.y,q.z,q.w):D.set(q,ce,we,xe),ve.viewport(A.copy(D).multiplyScalar(G).floor())},this.getScissor=function(q){return q.copy($)},this.setScissor=function(q,ce,we,xe){q.isVector4?$.set(q.x,q.y,q.z,q.w):$.set(q,ce,we,xe),ve.scissor(k.copy($).multiplyScalar(G).floor())},this.getScissorTest=function(){return ee},this.setScissorTest=function(q){ve.setScissorTest(ee=q)},this.setOpaqueSort=function(q){N=q},this.setTransparentSort=function(q){B=q},this.getClearColor=function(q){return q.copy(ht.getClearColor())},this.setClearColor=function(){ht.setClearColor.apply(ht,arguments)},this.getClearAlpha=function(){return ht.getClearAlpha()},this.setClearAlpha=function(){ht.setClearAlpha.apply(ht,arguments)},this.clear=function(q=!0,ce=!0,we=!0){let xe=0;if(q){let ye=!1;if(T!==null){const Je=T.texture.format;ye=Je===_R||Je===xR||Je===yR}if(ye){const Je=T.texture.type,dt=Je===Oi||Je===fl||Je===Ew||Je===ou||Je===gR||Je===vR,Nt=ht.getClearColor(),ct=ht.getClearAlpha(),pt=Nt.r,Pt=Nt.g,Ut=Nt.b;dt?(d[0]=pt,d[1]=Pt,d[2]=Ut,d[3]=ct,J.clearBufferuiv(J.COLOR,0,d)):(p[0]=pt,p[1]=Pt,p[2]=Ut,p[3]=ct,J.clearBufferiv(J.COLOR,0,p))}else xe|=J.COLOR_BUFFER_BIT}ce&&(xe|=J.DEPTH_BUFFER_BIT),we&&(xe|=J.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),J.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",He,!1),t.removeEventListener("webglcontextrestored",re,!1),t.removeEventListener("webglcontextcreationerror",je,!1),Le.dispose(),Pe.dispose(),ze.dispose(),j.dispose(),ae.dispose(),K.dispose(),Dt.dispose(),Ft.dispose(),ge.dispose(),Ke.dispose(),Ke.removeEventListener("sessionstart",ot),Ke.removeEventListener("sessionend",xt),_e&&(_e.dispose(),_e=null),Ge.stop()};function He(q){q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function re(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const q=oe.autoReset,ce=Ae.enabled,we=Ae.autoUpdate,xe=Ae.needsUpdate,ye=Ae.type;sn(),oe.autoReset=q,Ae.enabled=ce,Ae.autoUpdate=we,Ae.needsUpdate=xe,Ae.type=ye}function je(q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",q.statusMessage)}function qe(q){const ce=q.target;ce.removeEventListener("dispose",qe),At(ce)}function At(q){_t(q),ze.remove(q)}function _t(q){const ce=ze.get(q).programs;ce!==void 0&&(ce.forEach(function(we){ge.releaseProgram(we)}),q.isShaderMaterial&&ge.releaseShaderCache(q))}this.renderBufferDirect=function(q,ce,we,xe,ye,Je){ce===null&&(ce=We);const dt=ye.isMesh&&ye.matrixWorld.determinant()<0,Nt=Dn(q,ce,we,xe,ye);ve.setMaterial(xe,dt);let ct=we.index,pt=1;if(xe.wireframe===!0){if(ct=Se.getWireframeAttribute(we),ct===void 0)return;pt=2}const Pt=we.drawRange,Ut=we.attributes.position;let Hn=Pt.start*pt,sr=(Pt.start+Pt.count)*pt;Je!==null&&(Hn=Math.max(Hn,Je.start*pt),sr=Math.min(sr,(Je.start+Je.count)*pt)),ct!==null?(Hn=Math.max(Hn,0),sr=Math.min(sr,ct.count)):Ut!=null&&(Hn=Math.max(Hn,0),sr=Math.min(sr,Ut.count));const dn=sr-Hn;if(dn<0||dn===1/0)return;Dt.setup(ye,xe,Nt,we,ct);let er,Lt=at;if(ct!==null&&(er=Oe.get(ct),Lt=Qe,Lt.setIndex(er)),ye.isMesh)xe.wireframe===!0?(ve.setLineWidth(xe.wireframeLinewidth*Be()),Lt.setMode(J.LINES)):Lt.setMode(J.TRIANGLES);else if(ye.isLine){let nt=xe.linewidth;nt===void 0&&(nt=1),ve.setLineWidth(nt*Be()),ye.isLineSegments?Lt.setMode(J.LINES):ye.isLineLoop?Lt.setMode(J.LINE_LOOP):Lt.setMode(J.LINE_STRIP)}else ye.isPoints?Lt.setMode(J.POINTS):ye.isSprite&&Lt.setMode(J.TRIANGLES);if(ye.isBatchedMesh)Lt.renderMultiDraw(ye._multiDrawStarts,ye._multiDrawCounts,ye._multiDrawCount);else if(ye.isInstancedMesh)Lt.renderInstances(Hn,dn,ye.count);else if(we.isInstancedBufferGeometry){const nt=we._maxInstanceCount!==void 0?we._maxInstanceCount:1/0,Lo=Math.min(we.instanceCount,nt);Lt.renderInstances(Hn,dn,Lo)}else Lt.render(Hn,dn)};function Jt(q,ce,we){q.transparent===!0&&q.side===xs&&q.forceSinglePass===!1?(q.side=ri,q.needsUpdate=!0,In(q,ce,we),q.side=Tl,q.needsUpdate=!0,In(q,ce,we),q.side=xs):In(q,ce,we)}this.compile=function(q,ce,we=null){we===null&&(we=q),x=Pe.get(we),x.init(),_.push(x),we.traverseVisible(function(ye){ye.isLight&&ye.layers.test(ce.layers)&&(x.pushLight(ye),ye.castShadow&&x.pushShadow(ye))}),q!==we&&q.traverseVisible(function(ye){ye.isLight&&ye.layers.test(ce.layers)&&(x.pushLight(ye),ye.castShadow&&x.pushShadow(ye))}),x.setupLights(w._useLegacyLights);const xe=new Set;return q.traverse(function(ye){const Je=ye.material;if(Je)if(Array.isArray(Je))for(let dt=0;dt<Je.length;dt++){const Nt=Je[dt];Jt(Nt,we,ye),xe.add(Nt)}else Jt(Je,we,ye),xe.add(Je)}),_.pop(),x=null,xe},this.compileAsync=function(q,ce,we=null){const xe=this.compile(q,ce,we);return new Promise(ye=>{function Je(){if(xe.forEach(function(dt){ze.get(dt).currentProgram.isReady()&&xe.delete(dt)}),xe.size===0){ye(q);return}setTimeout(Je,10)}de.get("KHR_parallel_shader_compile")!==null?Je():setTimeout(Je,10)})};let cn=null;function ut(q){cn&&cn(q)}function ot(){Ge.stop()}function xt(){Ge.start()}const Ge=new m8;Ge.setAnimationLoop(ut),typeof self<"u"&&Ge.setContext(self),this.setAnimationLoop=function(q){cn=q,Ke.setAnimationLoop(q),q===null?Ge.stop():Ge.start()},Ke.addEventListener("sessionstart",ot),Ke.addEventListener("sessionend",xt),this.render=function(q,ce){if(ce!==void 0&&ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;q.matrixWorldAutoUpdate===!0&&q.updateMatrixWorld(),ce.parent===null&&ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),Ke.enabled===!0&&Ke.isPresenting===!0&&(Ke.cameraAutoUpdate===!0&&Ke.updateCamera(ce),ce=Ke.getCamera()),q.isScene===!0&&q.onBeforeRender(w,q,ce,T),x=Pe.get(q,_.length),x.init(),_.push(x),pe.multiplyMatrices(ce.projectionMatrix,ce.matrixWorldInverse),te.setFromProjectionMatrix(pe),me=this.localClippingEnabled,se=De.init(this.clippingPlanes,me),y=Le.get(q,m.length),y.init(),m.push(y),wt(q,ce,0,w.sortObjects),y.finish(),w.sortObjects===!0&&y.sort(N,B),this.info.render.frame++,se===!0&&De.beginShadows();const we=x.state.shadowsArray;if(Ae.render(we,q,ce),se===!0&&De.endShadows(),this.info.autoReset===!0&&this.info.reset(),ht.render(y,q),x.setupLights(w._useLegacyLights),ce.isArrayCamera){const xe=ce.cameras;for(let ye=0,Je=xe.length;ye<Je;ye++){const dt=xe[ye];Et(y,q,dt,dt.viewport)}}else Et(y,q,ce);T!==null&&(X.updateMultisampleRenderTarget(T),X.updateRenderTargetMipmap(T)),q.isScene===!0&&q.onAfterRender(w,q,ce),Dt.resetDefaultState(),P=-1,C=null,_.pop(),_.length>0?x=_[_.length-1]:x=null,m.pop(),m.length>0?y=m[m.length-1]:y=null};function wt(q,ce,we,xe){if(q.visible===!1)return;if(q.layers.test(ce.layers)){if(q.isGroup)we=q.renderOrder;else if(q.isLOD)q.autoUpdate===!0&&q.update(ce);else if(q.isLight)x.pushLight(q),q.castShadow&&x.pushShadow(q);else if(q.isSprite){if(!q.frustumCulled||te.intersectsSprite(q)){xe&&Ue.setFromMatrixPosition(q.matrixWorld).applyMatrix4(pe);const dt=K.update(q),Nt=q.material;Nt.visible&&y.push(q,dt,Nt,we,Ue.z,null)}}else if((q.isMesh||q.isLine||q.isPoints)&&(!q.frustumCulled||te.intersectsObject(q))){const dt=K.update(q),Nt=q.material;if(xe&&(q.boundingSphere!==void 0?(q.boundingSphere===null&&q.computeBoundingSphere(),Ue.copy(q.boundingSphere.center)):(dt.boundingSphere===null&&dt.computeBoundingSphere(),Ue.copy(dt.boundingSphere.center)),Ue.applyMatrix4(q.matrixWorld).applyMatrix4(pe)),Array.isArray(Nt)){const ct=dt.groups;for(let pt=0,Pt=ct.length;pt<Pt;pt++){const Ut=ct[pt],Hn=Nt[Ut.materialIndex];Hn&&Hn.visible&&y.push(q,dt,Hn,we,Ue.z,Ut)}}else Nt.visible&&y.push(q,dt,Nt,we,Ue.z,null)}}const Je=q.children;for(let dt=0,Nt=Je.length;dt<Nt;dt++)wt(Je[dt],ce,we,xe)}function Et(q,ce,we,xe){const ye=q.opaque,Je=q.transmissive,dt=q.transparent;x.setupLightsView(we),se===!0&&De.setGlobalState(w.clippingPlanes,we),Je.length>0&&kt(ye,Je,ce,we),xe&&ve.viewport(A.copy(xe)),ye.length>0&&Bn(ye,ce,we),Je.length>0&&Bn(Je,ce,we),dt.length>0&&Bn(dt,ce,we),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function kt(q,ce,we,xe){if((we.isScene===!0?we.overrideMaterial:null)!==null)return;const Je=Ie.isWebGL2;_e===null&&(_e=new Br(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?Nc:Oi,minFilter:Dc,samples:Je?4:0})),w.getDrawingBufferSize(Ne),Je?_e.setSize(Ne.x,Ne.y):_e.setSize(f_(Ne.x),f_(Ne.y));const dt=w.getRenderTarget();w.setRenderTarget(_e),w.getClearColor(H),F=w.getClearAlpha(),F<1&&w.setClearColor(16777215,.5),w.clear();const Nt=w.toneMapping;w.toneMapping=ka,Bn(q,we,xe),X.updateMultisampleRenderTarget(_e),X.updateRenderTargetMipmap(_e);let ct=!1;for(let pt=0,Pt=ce.length;pt<Pt;pt++){const Ut=ce[pt],Hn=Ut.object,sr=Ut.geometry,dn=Ut.material,er=Ut.group;if(dn.side===xs&&Hn.layers.test(xe.layers)){const Lt=dn.side;dn.side=ri,dn.needsUpdate=!0,Bt(Hn,we,xe,sr,dn,er),dn.side=Lt,dn.needsUpdate=!0,ct=!0}}ct===!0&&(X.updateMultisampleRenderTarget(_e),X.updateRenderTargetMipmap(_e)),w.setRenderTarget(dt),w.setClearColor(H,F),w.toneMapping=Nt}function Bn(q,ce,we){const xe=ce.isScene===!0?ce.overrideMaterial:null;for(let ye=0,Je=q.length;ye<Je;ye++){const dt=q[ye],Nt=dt.object,ct=dt.geometry,pt=xe===null?dt.material:xe,Pt=dt.group;Nt.layers.test(we.layers)&&Bt(Nt,ce,we,ct,pt,Pt)}}function Bt(q,ce,we,xe,ye,Je){q.onBeforeRender(w,ce,we,xe,ye,Je),q.modelViewMatrix.multiplyMatrices(we.matrixWorldInverse,q.matrixWorld),q.normalMatrix.getNormalMatrix(q.modelViewMatrix),ye.onBeforeRender(w,ce,we,xe,q,Je),ye.transparent===!0&&ye.side===xs&&ye.forceSinglePass===!1?(ye.side=ri,ye.needsUpdate=!0,w.renderBufferDirect(we,ce,xe,ye,q,Je),ye.side=Tl,ye.needsUpdate=!0,w.renderBufferDirect(we,ce,xe,ye,q,Je),ye.side=xs):w.renderBufferDirect(we,ce,xe,ye,q,Je),q.onAfterRender(w,ce,we,xe,ye,Je)}function In(q,ce,we){ce.isScene!==!0&&(ce=We);const xe=ze.get(q),ye=x.state.lights,Je=x.state.shadowsArray,dt=ye.state.version,Nt=ge.getParameters(q,ye.state,Je,ce,we),ct=ge.getProgramCacheKey(Nt);let pt=xe.programs;xe.environment=q.isMeshStandardMaterial?ce.environment:null,xe.fog=ce.fog,xe.envMap=(q.isMeshStandardMaterial?ae:j).get(q.envMap||xe.environment),pt===void 0&&(q.addEventListener("dispose",qe),pt=new Map,xe.programs=pt);let Pt=pt.get(ct);if(Pt!==void 0){if(xe.currentProgram===Pt&&xe.lightsStateVersion===dt)return Ln(q,Nt),Pt}else Nt.uniforms=ge.getUniforms(q),q.onBuild(we,Nt,w),q.onBeforeCompile(Nt,w),Pt=ge.acquireProgram(Nt,ct),pt.set(ct,Pt),xe.uniforms=Nt.uniforms;const Ut=xe.uniforms;return(!q.isShaderMaterial&&!q.isRawShaderMaterial||q.clipping===!0)&&(Ut.clippingPlanes=De.uniform),Ln(q,Nt),xe.needsLights=qr(q),xe.lightsStateVersion=dt,xe.needsLights&&(Ut.ambientLightColor.value=ye.state.ambient,Ut.lightProbe.value=ye.state.probe,Ut.directionalLights.value=ye.state.directional,Ut.directionalLightShadows.value=ye.state.directionalShadow,Ut.spotLights.value=ye.state.spot,Ut.spotLightShadows.value=ye.state.spotShadow,Ut.rectAreaLights.value=ye.state.rectArea,Ut.ltc_1.value=ye.state.rectAreaLTC1,Ut.ltc_2.value=ye.state.rectAreaLTC2,Ut.pointLights.value=ye.state.point,Ut.pointLightShadows.value=ye.state.pointShadow,Ut.hemisphereLights.value=ye.state.hemi,Ut.directionalShadowMap.value=ye.state.directionalShadowMap,Ut.directionalShadowMatrix.value=ye.state.directionalShadowMatrix,Ut.spotShadowMap.value=ye.state.spotShadowMap,Ut.spotLightMatrix.value=ye.state.spotLightMatrix,Ut.spotLightMap.value=ye.state.spotLightMap,Ut.pointShadowMap.value=ye.state.pointShadowMap,Ut.pointShadowMatrix.value=ye.state.pointShadowMatrix),xe.currentProgram=Pt,xe.uniformsList=null,Pt}function ir(q){if(q.uniformsList===null){const ce=q.currentProgram.getUniforms();q.uniformsList=x2.seqWithValue(ce.seq,q.uniforms)}return q.uniformsList}function Ln(q,ce){const we=ze.get(q);we.outputColorSpace=ce.outputColorSpace,we.batching=ce.batching,we.instancing=ce.instancing,we.instancingColor=ce.instancingColor,we.skinning=ce.skinning,we.morphTargets=ce.morphTargets,we.morphNormals=ce.morphNormals,we.morphColors=ce.morphColors,we.morphTargetsCount=ce.morphTargetsCount,we.numClippingPlanes=ce.numClippingPlanes,we.numIntersection=ce.numClipIntersection,we.vertexAlphas=ce.vertexAlphas,we.vertexTangents=ce.vertexTangents,we.toneMapping=ce.toneMapping}function Dn(q,ce,we,xe,ye){ce.isScene!==!0&&(ce=We),X.resetTextureUnits();const Je=ce.fog,dt=xe.isMeshStandardMaterial?ce.environment:null,Nt=T===null?w.outputColorSpace:T.isXRRenderTarget===!0?T.texture.colorSpace:fa,ct=(xe.isMeshStandardMaterial?ae:j).get(xe.envMap||dt),pt=xe.vertexColors===!0&&!!we.attributes.color&&we.attributes.color.itemSize===4,Pt=!!we.attributes.tangent&&(!!xe.normalMap||xe.anisotropy>0),Ut=!!we.morphAttributes.position,Hn=!!we.morphAttributes.normal,sr=!!we.morphAttributes.color;let dn=ka;xe.toneMapped&&(T===null||T.isXRRenderTarget===!0)&&(dn=w.toneMapping);const er=we.morphAttributes.position||we.morphAttributes.normal||we.morphAttributes.color,Lt=er!==void 0?er.length:0,nt=ze.get(xe),Lo=x.state.lights;if(se===!0&&(me===!0||q!==C)){const Ti=q===C&&xe.id===P;De.setState(xe,q,Ti)}let tn=!1;xe.version===nt.__version?(nt.needsLights&&nt.lightsStateVersion!==Lo.state.version||nt.outputColorSpace!==Nt||ye.isBatchedMesh&&nt.batching===!1||!ye.isBatchedMesh&&nt.batching===!0||ye.isInstancedMesh&&nt.instancing===!1||!ye.isInstancedMesh&&nt.instancing===!0||ye.isSkinnedMesh&&nt.skinning===!1||!ye.isSkinnedMesh&&nt.skinning===!0||ye.isInstancedMesh&&nt.instancingColor===!0&&ye.instanceColor===null||ye.isInstancedMesh&&nt.instancingColor===!1&&ye.instanceColor!==null||nt.envMap!==ct||xe.fog===!0&&nt.fog!==Je||nt.numClippingPlanes!==void 0&&(nt.numClippingPlanes!==De.numPlanes||nt.numIntersection!==De.numIntersection)||nt.vertexAlphas!==pt||nt.vertexTangents!==Pt||nt.morphTargets!==Ut||nt.morphNormals!==Hn||nt.morphColors!==sr||nt.toneMapping!==dn||Ie.isWebGL2===!0&&nt.morphTargetsCount!==Lt)&&(tn=!0):(tn=!0,nt.__version=xe.version);let _r=nt.currentProgram;tn===!0&&(_r=In(xe,ce,ye));let ja=!1,Fo=!1,fi=!1;const Rr=_r.getUniforms(),Xa=nt.uniforms;if(ve.useProgram(_r.program)&&(ja=!0,Fo=!0,fi=!0),xe.id!==P&&(P=xe.id,Fo=!0),ja||C!==q){Rr.setValue(J,"projectionMatrix",q.projectionMatrix),Rr.setValue(J,"viewMatrix",q.matrixWorldInverse);const Ti=Rr.map.cameraPosition;Ti!==void 0&&Ti.setValue(J,Ue.setFromMatrixPosition(q.matrixWorld)),Ie.logarithmicDepthBuffer&&Rr.setValue(J,"logDepthBufFC",2/(Math.log(q.far+1)/Math.LN2)),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&Rr.setValue(J,"isOrthographic",q.isOrthographicCamera===!0),C!==q&&(C=q,Fo=!0,fi=!0)}if(ye.isSkinnedMesh){Rr.setOptional(J,ye,"bindMatrix"),Rr.setOptional(J,ye,"bindMatrixInverse");const Ti=ye.skeleton;Ti&&(Ie.floatVertexTextures?(Ti.boneTexture===null&&Ti.computeBoneTexture(),Rr.setValue(J,"boneTexture",Ti.boneTexture,X)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}ye.isBatchedMesh&&(Rr.setOptional(J,ye,"batchingTexture"),Rr.setValue(J,"batchingTexture",ye._matricesTexture,X));const Vh=we.morphAttributes;if((Vh.position!==void 0||Vh.normal!==void 0||Vh.color!==void 0&&Ie.isWebGL2===!0)&&Ze.update(ye,we,_r),(Fo||nt.receiveShadow!==ye.receiveShadow)&&(nt.receiveShadow=ye.receiveShadow,Rr.setValue(J,"receiveShadow",ye.receiveShadow)),xe.isMeshGouraudMaterial&&xe.envMap!==null&&(Xa.envMap.value=ct,Xa.flipEnvMap.value=ct.isCubeTexture&&ct.isRenderTargetTexture===!1?-1:1),Fo&&(Rr.setValue(J,"toneMappingExposure",w.toneMappingExposure),nt.needsLights&&_n(Xa,fi),Je&&xe.fog===!0&&Te.refreshFogUniforms(Xa,Je),Te.refreshMaterialUniforms(Xa,xe,G,W,_e),x2.upload(J,ir(nt),Xa,X)),xe.isShaderMaterial&&xe.uniformsNeedUpdate===!0&&(x2.upload(J,ir(nt),Xa,X),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&Rr.setValue(J,"center",ye.center),Rr.setValue(J,"modelViewMatrix",ye.modelViewMatrix),Rr.setValue(J,"normalMatrix",ye.normalMatrix),Rr.setValue(J,"modelMatrix",ye.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){const Ti=xe.uniformsGroups;for(let Wh=0,no=Ti.length;Wh<no;Wh++)if(Ie.isWebGL2){const dy=Ti[Wh];Ft.update(dy,_r),Ft.bind(dy,_r)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return _r}function _n(q,ce){q.ambientLightColor.needsUpdate=ce,q.lightProbe.needsUpdate=ce,q.directionalLights.needsUpdate=ce,q.directionalLightShadows.needsUpdate=ce,q.pointLights.needsUpdate=ce,q.pointLightShadows.needsUpdate=ce,q.spotLights.needsUpdate=ce,q.spotLightShadows.needsUpdate=ce,q.rectAreaLights.needsUpdate=ce,q.hemisphereLights.needsUpdate=ce}function qr(q){return q.isMeshLambertMaterial||q.isMeshToonMaterial||q.isMeshPhongMaterial||q.isMeshStandardMaterial||q.isShadowMaterial||q.isShaderMaterial&&q.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(q,ce,we){ze.get(q.texture).__webglTexture=ce,ze.get(q.depthTexture).__webglTexture=we;const xe=ze.get(q);xe.__hasExternalTextures=!0,xe.__hasExternalTextures&&(xe.__autoAllocateDepthBuffer=we===void 0,xe.__autoAllocateDepthBuffer||de.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),xe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(q,ce){const we=ze.get(q);we.__webglFramebuffer=ce,we.__useDefaultFramebuffer=ce===void 0},this.setRenderTarget=function(q,ce=0,we=0){T=q,S=ce,M=we;let xe=!0,ye=null,Je=!1,dt=!1;if(q){const ct=ze.get(q);ct.__useDefaultFramebuffer!==void 0?(ve.bindFramebuffer(J.FRAMEBUFFER,null),xe=!1):ct.__webglFramebuffer===void 0?X.setupRenderTarget(q):ct.__hasExternalTextures&&X.rebindTextures(q,ze.get(q.texture).__webglTexture,ze.get(q.depthTexture).__webglTexture);const pt=q.texture;(pt.isData3DTexture||pt.isDataArrayTexture||pt.isCompressedArrayTexture)&&(dt=!0);const Pt=ze.get(q).__webglFramebuffer;q.isWebGLCubeRenderTarget?(Array.isArray(Pt[ce])?ye=Pt[ce][we]:ye=Pt[ce],Je=!0):Ie.isWebGL2&&q.samples>0&&X.useMultisampledRTT(q)===!1?ye=ze.get(q).__webglMultisampledFramebuffer:Array.isArray(Pt)?ye=Pt[we]:ye=Pt,A.copy(q.viewport),k.copy(q.scissor),L=q.scissorTest}else A.copy(D).multiplyScalar(G).floor(),k.copy($).multiplyScalar(G).floor(),L=ee;if(ve.bindFramebuffer(J.FRAMEBUFFER,ye)&&Ie.drawBuffers&&xe&&ve.drawBuffers(q,ye),ve.viewport(A),ve.scissor(k),ve.setScissorTest(L),Je){const ct=ze.get(q.texture);J.framebufferTexture2D(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0,J.TEXTURE_CUBE_MAP_POSITIVE_X+ce,ct.__webglTexture,we)}else if(dt){const ct=ze.get(q.texture),pt=ce||0;J.framebufferTextureLayer(J.FRAMEBUFFER,J.COLOR_ATTACHMENT0,ct.__webglTexture,we||0,pt)}P=-1},this.readRenderTargetPixels=function(q,ce,we,xe,ye,Je,dt){if(!(q&&q.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Nt=ze.get(q).__webglFramebuffer;if(q.isWebGLCubeRenderTarget&&dt!==void 0&&(Nt=Nt[dt]),Nt){ve.bindFramebuffer(J.FRAMEBUFFER,Nt);try{const ct=q.texture,pt=ct.format,Pt=ct.type;if(pt!==ki&&$e.convert(pt)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ut=Pt===Nc&&(de.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&de.has("EXT_color_buffer_float"));if(Pt!==Oi&&$e.convert(Pt)!==J.getParameter(J.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Pt===zs&&(Ie.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float")))&&!Ut){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ce>=0&&ce<=q.width-xe&&we>=0&&we<=q.height-ye&&J.readPixels(ce,we,xe,ye,$e.convert(pt),$e.convert(Pt),Je)}finally{const ct=T!==null?ze.get(T).__webglFramebuffer:null;ve.bindFramebuffer(J.FRAMEBUFFER,ct)}}},this.copyFramebufferToTexture=function(q,ce,we=0){const xe=Math.pow(2,-we),ye=Math.floor(ce.image.width*xe),Je=Math.floor(ce.image.height*xe);X.setTexture2D(ce,0),J.copyTexSubImage2D(J.TEXTURE_2D,we,0,0,q.x,q.y,ye,Je),ve.unbindTexture()},this.copyTextureToTexture=function(q,ce,we,xe=0){const ye=ce.image.width,Je=ce.image.height,dt=$e.convert(we.format),Nt=$e.convert(we.type);X.setTexture2D(we,0),J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,we.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,we.unpackAlignment),ce.isDataTexture?J.texSubImage2D(J.TEXTURE_2D,xe,q.x,q.y,ye,Je,dt,Nt,ce.image.data):ce.isCompressedTexture?J.compressedTexSubImage2D(J.TEXTURE_2D,xe,q.x,q.y,ce.mipmaps[0].width,ce.mipmaps[0].height,dt,ce.mipmaps[0].data):J.texSubImage2D(J.TEXTURE_2D,xe,q.x,q.y,dt,Nt,ce.image),xe===0&&we.generateMipmaps&&J.generateMipmap(J.TEXTURE_2D),ve.unbindTexture()},this.copyTextureToTexture3D=function(q,ce,we,xe,ye=0){if(w.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Je=q.max.x-q.min.x+1,dt=q.max.y-q.min.y+1,Nt=q.max.z-q.min.z+1,ct=$e.convert(xe.format),pt=$e.convert(xe.type);let Pt;if(xe.isData3DTexture)X.setTexture3D(xe,0),Pt=J.TEXTURE_3D;else if(xe.isDataArrayTexture||xe.isCompressedArrayTexture)X.setTexture2DArray(xe,0),Pt=J.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}J.pixelStorei(J.UNPACK_FLIP_Y_WEBGL,xe.flipY),J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),J.pixelStorei(J.UNPACK_ALIGNMENT,xe.unpackAlignment);const Ut=J.getParameter(J.UNPACK_ROW_LENGTH),Hn=J.getParameter(J.UNPACK_IMAGE_HEIGHT),sr=J.getParameter(J.UNPACK_SKIP_PIXELS),dn=J.getParameter(J.UNPACK_SKIP_ROWS),er=J.getParameter(J.UNPACK_SKIP_IMAGES),Lt=we.isCompressedTexture?we.mipmaps[ye]:we.image;J.pixelStorei(J.UNPACK_ROW_LENGTH,Lt.width),J.pixelStorei(J.UNPACK_IMAGE_HEIGHT,Lt.height),J.pixelStorei(J.UNPACK_SKIP_PIXELS,q.min.x),J.pixelStorei(J.UNPACK_SKIP_ROWS,q.min.y),J.pixelStorei(J.UNPACK_SKIP_IMAGES,q.min.z),we.isDataTexture||we.isData3DTexture?J.texSubImage3D(Pt,ye,ce.x,ce.y,ce.z,Je,dt,Nt,ct,pt,Lt.data):we.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),J.compressedTexSubImage3D(Pt,ye,ce.x,ce.y,ce.z,Je,dt,Nt,ct,Lt.data)):J.texSubImage3D(Pt,ye,ce.x,ce.y,ce.z,Je,dt,Nt,ct,pt,Lt),J.pixelStorei(J.UNPACK_ROW_LENGTH,Ut),J.pixelStorei(J.UNPACK_IMAGE_HEIGHT,Hn),J.pixelStorei(J.UNPACK_SKIP_PIXELS,sr),J.pixelStorei(J.UNPACK_SKIP_ROWS,dn),J.pixelStorei(J.UNPACK_SKIP_IMAGES,er),ye===0&&xe.generateMipmaps&&J.generateMipmap(Pt),ve.unbindTexture()},this.initTexture=function(q){q.isCubeTexture?X.setTextureCube(q,0):q.isData3DTexture?X.setTexture3D(q,0):q.isDataArrayTexture||q.isCompressedArrayTexture?X.setTexture2DArray(q,0):X.setTexture2D(q,0),ve.unbindTexture()},this.resetState=function(){S=0,M=0,T=null,ve.reset(),Dt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ra}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Tw?"display-p3":"srgb",t.unpackColorSpace=Fn.workingColorSpace===zv?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===mn?wc:SR}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===wc?mn:fa}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class S8 extends xm{}S8.prototype.isWebGL1Renderer=!0;class Rw{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new it(e),this.density=t}clone(){return new Rw(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Pw{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new it(e),this.near=t,this.far=r}clone(){return new Pw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class mu extends Rn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Iw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Zg,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Co()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Co()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Co()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const fs=new Q;class wh{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)fs.fromBufferAttribute(this,t),fs.applyMatrix4(e),this.setXYZ(t,fs.x,fs.y,fs.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)fs.fromBufferAttribute(this,t),fs.applyNormalMatrix(e),this.setXYZ(t,fs.x,fs.y,fs.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)fs.fromBufferAttribute(this,t),fs.transformDirection(e),this.setXYZ(t,fs.x,fs.y,fs.z);return this}setX(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Zt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Os(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Os(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Os(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Os(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zt(t,this.array),r=Zt(r,this.array),i=Zt(i,this.array),s=Zt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new vn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new wh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class LR extends Mi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new it(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let vd;const s0=new Q,yd=new Q,xd=new Q,_d=new Me,o0=new Me,E8=new Ht,X1=new Q,a0=new Q,$1=new Q,zk=new Me,ME=new Me,Vk=new Me;class M8 extends Rn{constructor(e=new LR){if(super(),this.isSprite=!0,this.type="Sprite",vd===void 0){vd=new qt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Iw(t,5);vd.setIndex([0,1,2,0,2,3]),vd.setAttribute("position",new wh(r,3,0,!1)),vd.setAttribute("uv",new wh(r,2,3,!1))}this.geometry=vd,this.material=e,this.center=new Me(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),yd.setFromMatrixScale(this.matrixWorld),E8.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),xd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&yd.multiplyScalar(-xd.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;q1(X1.set(-.5,-.5,0),xd,o,yd,i,s),q1(a0.set(.5,-.5,0),xd,o,yd,i,s),q1($1.set(.5,.5,0),xd,o,yd,i,s),zk.set(0,0),ME.set(1,0),Vk.set(1,1);let a=e.ray.intersectTriangle(X1,a0,$1,!1,s0);if(a===null&&(q1(a0.set(-.5,.5,0),xd,o,yd,i,s),ME.set(0,1),a=e.ray.intersectTriangle(X1,$1,a0,!1,s0),a===null))return;const l=e.ray.origin.distanceTo(s0);l<e.near||l>e.far||t.push({distance:l,point:s0.clone(),uv:jf.getInterpolation(s0,X1,a0,$1,zk,ME,Vk,new Me),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function q1(n,e,t,r,i,s){_d.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(o0.x=s*_d.x-i*_d.y,o0.y=i*_d.x+s*_d.y):o0.copy(_d),n.copy(e),n.x+=o0.x,n.y+=o0.y,n.applyMatrix4(E8)}const Y1=new Q,Wk=new Q;class T8 extends Rn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){Y1.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(Y1);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Y1.setFromMatrixPosition(e.matrixWorld),Wk.setFromMatrixPosition(this.matrixWorld);const r=Y1.distanceTo(Wk)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const Hk=new Q,Gk=new Sn,jk=new Sn,Tne=new Q,Xk=new Ht,K1=new Q,TE=new ss,$k=new Ht,CE=new vm;class C8 extends Qn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=sT,this.bindMatrix=new Ht,this.bindMatrixInverse=new Ht,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ts),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,K1),this.boundingBox.expandByPoint(K1)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ss),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,K1),this.boundingSphere.expandByPoint(K1)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),TE.copy(this.boundingSphere),TE.applyMatrix4(i),e.ray.intersectsSphere(TE)!==!1&&($k.copy(i).invert(),CE.copy(e.ray).applyMatrix4($k),!(this.boundingBox!==null&&CE.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,CE)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Sn,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===sT?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===zz?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;Gk.fromBufferAttribute(i.attributes.skinIndex,e),jk.fromBufferAttribute(i.attributes.skinWeight,e),Hk.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=jk.getComponent(s);if(o!==0){const a=Gk.getComponent(s);Xk.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(Tne.copy(Hk).applyMatrix4(Xk),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class FR extends Rn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class au extends vr{constructor(e=null,t=1,r=1,i,s,o,a,l,u=kr,c=kr,f,h){super(null,o,a,l,u,c,i,s,f,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const qk=new Ht,Cne=new Ht;class Dw{constructor(e=[],t=[]){this.uuid=Co(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Ht)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Ht;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Cne;qk.multiplyMatrices(a,t[s]),qk.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Dw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new au(t,e,e,ki,zs);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new FR),this.bones.push(o),this.boneInverses.push(new Ht().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Yp extends vn{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const wd=new Ht,Yk=new Ht,Z1=[],Kk=new Ts,Ane=new Ht,l0=new Qn,u0=new ss;class A8 extends Qn{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Yp(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,Ane)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ts),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,wd),Kk.copy(e.boundingBox).applyMatrix4(wd),this.boundingBox.union(Kk)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ss),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,wd),u0.copy(e.boundingSphere).applyMatrix4(wd),this.boundingSphere.union(u0)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(l0.geometry=this.geometry,l0.material=this.material,l0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),u0.copy(this.boundingSphere),u0.applyMatrix4(r),e.ray.intersectsSphere(u0)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,wd),Yk.multiplyMatrices(r,wd),l0.matrixWorld=Yk,l0.raycast(e,Z1);for(let o=0,a=Z1.length;o<a;o++){const l=Z1[o];l.instanceId=s,l.object=this,t.push(l)}Z1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Yp(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Rne(n,e){return n.z-e.z}function Pne(n,e){return e.z-n.z}class Ine{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const bd="batchId",Gu=new Ht,Zk=new Ht,Dne=new Ht,Jk=new Ht,AE=new Wv,J1=new Ts,gf=new ss,c0=new Q,RE=new Ine,qi=new Qn,Q1=[];function Nne(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class R8 extends Qn{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,i){super(new qt,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new au(t,e,e,ki,zs);this._matricesTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:u,itemSize:c,normalized:f}=l,h=new u.constructor(r*c),d=new l.constructor(h,c,f);d.setUsage(l.usage),t.setAttribute(a,d)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new vn(a,1))}const o=i>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(bd,new vn(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(bd))throw new Error(`BatchedMesh: Geometry cannot use attribute "${bd}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(r===bd)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ts);const e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,Gu),this.getBoundingBoxAt(i,J1).applyMatrix4(Gu),t.union(J1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ss);const e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,Gu),this.getBoundingSphereAt(i,gf).applyMatrix4(Gu),t.union(gf))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const u=e.getIndex(),c=u!==null;if(c&&(r===-1?i.indexCount=u.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const f=this._visibility,h=this._active,d=this._matricesTexture,p=this._matricesTexture.image.data;f.push(!0),h.push(!0);const y=this._geometryCount;this._geometryCount++,Dne.toArray(p,y*16),d.needsUpdate=!0,o.push(i),a.push({start:c?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Ts,sphereInitialized:!1,sphere:new ss});const x=this.geometry.getAttribute(bd);for(let m=0;m<i.vertexCount;m++)x.setX(i.vertexStart+m,y);return x.needsUpdate=!0,this.setGeometryAt(y,e),y}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,u=a.vertexCount;for(const d in r.attributes){if(d===bd)continue;const p=t.getAttribute(d),y=r.getAttribute(d);Nne(p,y,l);const x=p.itemSize;for(let m=p.count,_=u;m<_;m++){const w=l+m;for(let b=0;b<x;b++)y.setComponent(w,b,0)}y.needsUpdate=!0}if(i){const d=a.indexStart;for(let p=0;p<o.count;p++)s.setX(d+p,l+o.getX(p));for(let p=o.count,y=a.indexCount;p<y;p++)s.setX(d+p,l);s.needsUpdate=!0}const c=this._bounds[e];t.boundingBox!==null?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,t.boundingSphere!==null?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const f=this._drawRanges[e],h=t.getAttribute("position");return f.count=i?o.count:h.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.box,o=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,u=this._drawRanges[e];for(let c=u.start,f=u.start+u.count;c<f;c++){let h=c;a&&(h=a.getX(h)),s.expandByPoint(c0.fromBufferAttribute(l,h))}i.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,J1),J1.getCenter(s.center);const a=o.index,l=o.attributes.position,u=this._drawRanges[e];let c=0;for(let f=u.start,h=u.start+u.count;f<h;f++){let d=f;a&&(d=a.getX(d)),c0.fromBufferAttribute(l,d),c=Math.max(c,s.center.distanceToSquared(c0))}s.radius=Math.sqrt(c),i.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:t[e]}raycast(e,t){const r=this._visibility,i=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;qi.material=this.material,qi.geometry.index=l.index,qi.geometry.attributes=l.attributes,qi.geometry.boundingBox===null&&(qi.geometry.boundingBox=new Ts),qi.geometry.boundingSphere===null&&(qi.geometry.boundingSphere=new ss);for(let u=0;u<o;u++){if(!r[u]||!i[u])continue;const c=s[u];qi.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(u,qi.matrixWorld).premultiply(a),this.getBoundingBoxAt(u,qi.geometry.boundingBox),this.getBoundingSphereAt(u,qi.geometry.boundingSphere),qi.raycast(e,Q1);for(let f=0,h=Q1.length;f<h;f++){const d=Q1[f];d.object=this,d.batchId=u,t.push(d)}Q1.length=0}qi.material=null,qi.geometry.index=null,qi.geometry.attributes={},qi.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._visibility,u=this._multiDrawStarts,c=this._multiDrawCounts,f=this._drawRanges,h=this.perObjectFrustumCulled;h&&(Jk.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),AE.setFromProjectionMatrix(Jk,e.isWebGPURenderer?Xp:Ra));let d=0;if(this.sortObjects){Zk.copy(this.matrixWorld).invert(),c0.setFromMatrixPosition(r.matrixWorld).applyMatrix4(Zk);for(let x=0,m=l.length;x<m;x++)if(l[x]){this.getMatrixAt(x,Gu),this.getBoundingSphereAt(x,gf).applyMatrix4(Gu);let _=!1;if(h&&(_=!AE.intersectsSphere(gf)),!_){const w=c0.distanceTo(gf.center);RE.push(f[x],w)}}const p=RE.list,y=this.customSort;y===null?p.sort(s.transparent?Pne:Rne):y.call(this,p,r);for(let x=0,m=p.length;x<m;x++){const _=p[x];u[d]=_.start*a,c[d]=_.count,d++}RE.reset()}else for(let p=0,y=l.length;p<y;p++)if(l[p]){let x=!1;if(h&&(this.getMatrixAt(p,Gu),this.getBoundingSphereAt(p,gf).applyMatrix4(Gu),x=!AE.intersectsSphere(gf)),!x){const m=f[p];u[d]=m.start*a,c[d]=m.count,d++}}this._multiDrawCount=d,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class Rs extends Mi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new it(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Qk=new Q,eL=new Q,tL=new Ht,PE=new vm,ex=new ss;class Lc extends Rn{constructor(e=new qt,t=new Rs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)Qk.fromBufferAttribute(t,i-1),eL.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=Qk.distanceTo(eL);e.setAttribute("lineDistance",new St(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),ex.copy(r.boundingSphere),ex.applyMatrix4(i),ex.radius+=s,e.ray.intersectsSphere(ex)===!1)return;tL.copy(i).invert(),PE.copy(e.ray).applyMatrix4(tL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new Q,c=new Q,f=new Q,h=new Q,d=this.isLineSegments?2:1,p=r.index,x=r.attributes.position;if(p!==null){const m=Math.max(0,o.start),_=Math.min(p.count,o.start+o.count);for(let w=m,b=_-1;w<b;w+=d){const S=p.getX(w),M=p.getX(w+1);if(u.fromBufferAttribute(x,S),c.fromBufferAttribute(x,M),PE.distanceSqToSegment(u,c,h,f)>l)continue;h.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(h);P<e.near||P>e.far||t.push({distance:P,point:f.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const m=Math.max(0,o.start),_=Math.min(x.count,o.start+o.count);for(let w=m,b=_-1;w<b;w+=d){if(u.fromBufferAttribute(x,w),c.fromBufferAttribute(x,w+1),PE.distanceSqToSegment(u,c,h,f)>l)continue;h.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(h);M<e.near||M>e.far||t.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const nL=new Q,rL=new Q;class Ua extends Lc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)nL.fromBufferAttribute(t,i),rL.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+nL.distanceTo(rL);e.setAttribute("lineDistance",new St(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class P8 extends Lc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class OR extends Mi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new it(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const iL=new Ht,FT=new vm,tx=new ss,nx=new Q;class I8 extends Rn{constructor(e=new qt,t=new OR){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),tx.copy(r.boundingSphere),tx.applyMatrix4(i),tx.radius+=s,e.ray.intersectsSphere(tx)===!1)return;iL.copy(i).invert(),FT.copy(e.ray).applyMatrix4(iL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=r.index,f=r.attributes.position;if(u!==null){const h=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let p=h,y=d;p<y;p++){const x=u.getX(p);nx.fromBufferAttribute(f,x),sL(nx,x,l,i,e,t,this)}}else{const h=Math.max(0,o.start),d=Math.min(f.count,o.start+o.count);for(let p=h,y=d;p<y;p++)nx.fromBufferAttribute(f,p),sL(nx,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function sL(n,e,t,r,i,s,o){const a=FT.distanceSqToPoint(n);if(a<t){const l=new Q;FT.closestPointToPoint(n,l),l.applyMatrix4(r);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class kne extends vr{constructor(e,t,r,i,s,o,a,l,u){super(e,t,r,i,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:bn,this.magFilter=s!==void 0?s:bn,this.generateMipmaps=!1;const c=this;function f(){c.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Lne extends vr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=kr,this.minFilter=kr,this.generateMipmaps=!1,this.needsUpdate=!0}}class Nw extends vr{constructor(e,t,r,i,s,o,a,l,u,c,f,h){super(null,o,a,l,u,c,i,s,f,h),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Fne extends Nw{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Cr}}class One extends Nw{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,pu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Bne extends vr{constructor(e,t,r,i,s,o,a,l,u){super(e,t,r,i,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class za{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,l=s-1,u;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),u=r[i]-o,u<0)a=i+1;else if(u>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const c=r[i],h=r[i+1]-c,d=(o-c)/h;return(i+d)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Me:new Q);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Q,i=[],s=[],o=[],a=new Q,l=new Ht;for(let d=0;d<=e;d++){const p=d/e;i[d]=this.getTangentAt(p,new Q)}s[0]=new Q,o[0]=new Q;let u=Number.MAX_VALUE;const c=Math.abs(i[0].x),f=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=u&&(u=c,r.set(1,0,0)),f<=u&&(u=f,r.set(0,1,0)),h<=u&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let d=1;d<=e;d++){if(s[d]=s[d-1].clone(),o[d]=o[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Tr(i[d-1].dot(i[d]),-1,1));s[d].applyMatrix4(l.makeRotationAxis(a,p))}o[d].crossVectors(i[d],s[d])}if(t===!0){let d=Math.acos(Tr(s[0].dot(s[e]),-1,1));d/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(d=-d);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],d*p)),o[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class kw extends za{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const r=t||new Me,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),f=Math.sin(this.aRotation),h=l-this.aX,d=u-this.aY;l=h*c-d*f+this.aX,u=h*f+d*c+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class D8 extends kw{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function BR(){let n=0,e=0,t=0,r=0;function i(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){i(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,c,f){let h=(o-s)/u-(a-s)/(u+c)+(a-o)/c,d=(a-o)/c-(l-o)/(c+f)+(l-a)/f;h*=c,d*=c,i(o,a,h,d)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const rx=new Q,IE=new BR,DE=new BR,NE=new BR;class N8 extends za{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Q){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,c;this.closed||a>0?u=i[(a-1)%s]:(rx.subVectors(i[0],i[1]).add(i[0]),u=rx);const f=i[a%s],h=i[(a+1)%s];if(this.closed||a+2<s?c=i[(a+2)%s]:(rx.subVectors(i[s-1],i[s-2]).add(i[s-1]),c=rx),this.curveType==="centripetal"||this.curveType==="chordal"){const d=this.curveType==="chordal"?.5:.25;let p=Math.pow(u.distanceToSquared(f),d),y=Math.pow(f.distanceToSquared(h),d),x=Math.pow(h.distanceToSquared(c),d);y<1e-4&&(y=1),p<1e-4&&(p=y),x<1e-4&&(x=y),IE.initNonuniformCatmullRom(u.x,f.x,h.x,c.x,p,y,x),DE.initNonuniformCatmullRom(u.y,f.y,h.y,c.y,p,y,x),NE.initNonuniformCatmullRom(u.z,f.z,h.z,c.z,p,y,x)}else this.curveType==="catmullrom"&&(IE.initCatmullRom(u.x,f.x,h.x,c.x,this.tension),DE.initCatmullRom(u.y,f.y,h.y,c.y,this.tension),NE.initCatmullRom(u.z,f.z,h.z,c.z,this.tension));return r.set(IE.calc(l),DE.calc(l),NE.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Q().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function oL(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,l=n*a;return(2*t-2*r+s+o)*l+(-3*t+3*r-2*s-o)*a+s*n+t}function Une(n,e){const t=1-n;return t*t*e}function zne(n,e){return 2*(1-n)*n*e}function Vne(n,e){return n*n*e}function Z0(n,e,t,r){return Une(n,e)+zne(n,t)+Vne(n,r)}function Wne(n,e){const t=1-n;return t*t*t*e}function Hne(n,e){const t=1-n;return 3*t*t*n*e}function Gne(n,e){return 3*(1-n)*n*n*e}function jne(n,e){return n*n*n*e}function J0(n,e,t,r,i){return Wne(n,e)+Hne(n,t)+Gne(n,r)+jne(n,i)}class UR extends za{constructor(e=new Me,t=new Me,r=new Me,i=new Me){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Me){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(J0(e,i.x,s.x,o.x,a.x),J0(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class k8 extends za{constructor(e=new Q,t=new Q,r=new Q,i=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Q){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(J0(e,i.x,s.x,o.x,a.x),J0(e,i.y,s.y,o.y,a.y),J0(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zR extends za{constructor(e=new Me,t=new Me){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Me){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Me){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class L8 extends za{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class VR extends za{constructor(e=new Me,t=new Me,r=new Me){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Me){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(Z0(e,i.x,s.x,o.x),Z0(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WR extends za{constructor(e=new Q,t=new Q,r=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Q){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(Z0(e,i.x,s.x,o.x),Z0(e,i.y,s.y,o.y),Z0(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class HR extends za{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Me){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],u=i[o],c=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return r.set(oL(a,l.x,u.x,c.x,f.x),oL(a,l.y,u.y,c.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Me().fromArray(i))}return this}}var h_=Object.freeze({__proto__:null,ArcCurve:D8,CatmullRomCurve3:N8,CubicBezierCurve:UR,CubicBezierCurve3:k8,EllipseCurve:kw,LineCurve:zR,LineCurve3:L8,QuadraticBezierCurve:VR,QuadraticBezierCurve3:WR,SplineCurve:HR});class F8 extends za{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new h_[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const c=l[u];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new h_[i.type]().fromJSON(i))}return this}}class Qg extends F8{constructor(e){super(),this.type="Path",this.currentPoint=new Me,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new zR(this.currentPoint.clone(),new Me(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new VR(this.currentPoint.clone(),new Me(e,t),new Me(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new UR(this.currentPoint.clone(),new Me(e,t),new Me(r,i),new Me(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new HR(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,r,i,s,o,a,l),this}absellipse(e,t,r,i,s,o,a,l){const u=new kw(e,t,r,i,s,o,a,l);if(this.curves.length>0){const f=u.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Gv extends qt{constructor(e=[new Me(0,-.5),new Me(.5,0),new Me(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Tr(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],c=1/t,f=new Q,h=new Me,d=new Q,p=new Q,y=new Q;let x=0,m=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:x=e[_+1].x-e[_].x,m=e[_+1].y-e[_].y,d.x=m*1,d.y=-x,d.z=m*0,y.copy(d),d.normalize(),l.push(d.x,d.y,d.z);break;case e.length-1:l.push(y.x,y.y,y.z);break;default:x=e[_+1].x-e[_].x,m=e[_+1].y-e[_].y,d.x=m*1,d.y=-x,d.z=m*0,p.copy(d),d.x+=y.x,d.y+=y.y,d.z+=y.z,d.normalize(),l.push(d.x,d.y,d.z),y.copy(p)}for(let _=0;_<=t;_++){const w=r+_*c*i,b=Math.sin(w),S=Math.cos(w);for(let M=0;M<=e.length-1;M++){f.x=e[M].x*b,f.y=e[M].y,f.z=e[M].x*S,o.push(f.x,f.y,f.z),h.x=_/t,h.y=M/(e.length-1),a.push(h.x,h.y);const T=l[3*M+0]*b,P=l[3*M+1],C=l[3*M+0]*S;u.push(T,P,C)}}for(let _=0;_<t;_++)for(let w=0;w<e.length-1;w++){const b=w+_*e.length,S=b,M=b+e.length,T=b+e.length+1,P=b+1;s.push(S,M,P),s.push(T,P,M)}this.setIndex(s),this.setAttribute("position",new St(o,3)),this.setAttribute("uv",new St(a,2)),this.setAttribute("normal",new St(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gv(e.points,e.segments,e.phiStart,e.phiLength)}}class Lw extends Gv{constructor(e=1,t=1,r=4,i=8){const s=new Qg;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new Lw(e.radius,e.length,e.capSegments,e.radialSegments)}}class Fw extends qt{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new Q,c=new Me;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,h=3;f<=t;f++,h+=3){const d=r+f/t*i;u.x=e*Math.cos(d),u.y=e*Math.sin(d),o.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(o[h]/e+1)/2,c.y=(o[h+1]/e+1)/2,l.push(c.x,c.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new St(o,3)),this.setAttribute("normal",new St(a,3)),this.setAttribute("uv",new St(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fw(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class _m extends qt{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;i=Math.floor(i),s=Math.floor(s);const c=[],f=[],h=[],d=[];let p=0;const y=[],x=r/2;let m=0;_(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(c),this.setAttribute("position",new St(f,3)),this.setAttribute("normal",new St(h,3)),this.setAttribute("uv",new St(d,2));function _(){const b=new Q,S=new Q;let M=0;const T=(t-e)/r;for(let P=0;P<=s;P++){const C=[],A=P/s,k=A*(t-e)+e;for(let L=0;L<=i;L++){const H=L/i,F=H*l+a,V=Math.sin(F),W=Math.cos(F);S.x=k*V,S.y=-A*r+x,S.z=k*W,f.push(S.x,S.y,S.z),b.set(V,T,W).normalize(),h.push(b.x,b.y,b.z),d.push(H,1-A),C.push(p++)}y.push(C)}for(let P=0;P<i;P++)for(let C=0;C<s;C++){const A=y[C][P],k=y[C+1][P],L=y[C+1][P+1],H=y[C][P+1];c.push(A,k,H),c.push(k,L,H),M+=6}u.addGroup(m,M,0),m+=M}function w(b){const S=p,M=new Me,T=new Q;let P=0;const C=b===!0?e:t,A=b===!0?1:-1;for(let L=1;L<=i;L++)f.push(0,x*A,0),h.push(0,A,0),d.push(.5,.5),p++;const k=p;for(let L=0;L<=i;L++){const F=L/i*l+a,V=Math.cos(F),W=Math.sin(F);T.x=C*W,T.y=x*A,T.z=C*V,f.push(T.x,T.y,T.z),h.push(0,A,0),M.x=V*.5+.5,M.y=W*.5*A+.5,d.push(M.x,M.y),p++}for(let L=0;L<i;L++){const H=S+L,F=k+L;b===!0?c.push(F,F+1,H):c.push(F+1,F,H),P+=3}u.addGroup(m,P,b===!0?1:2),m+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _m(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ow extends _m{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Ow(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Yc extends qt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),u(r),c(),this.setAttribute("position",new St(s,3)),this.setAttribute("normal",new St(s.slice(),3)),this.setAttribute("uv",new St(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(_){const w=new Q,b=new Q,S=new Q;for(let M=0;M<t.length;M+=3)d(t[M+0],w),d(t[M+1],b),d(t[M+2],S),l(w,b,S,_)}function l(_,w,b,S){const M=S+1,T=[];for(let P=0;P<=M;P++){T[P]=[];const C=_.clone().lerp(b,P/M),A=w.clone().lerp(b,P/M),k=M-P;for(let L=0;L<=k;L++)L===0&&P===M?T[P][L]=C:T[P][L]=C.clone().lerp(A,L/k)}for(let P=0;P<M;P++)for(let C=0;C<2*(M-P)-1;C++){const A=Math.floor(C/2);C%2===0?(h(T[P][A+1]),h(T[P+1][A]),h(T[P][A])):(h(T[P][A+1]),h(T[P+1][A+1]),h(T[P+1][A]))}}function u(_){const w=new Q;for(let b=0;b<s.length;b+=3)w.x=s[b+0],w.y=s[b+1],w.z=s[b+2],w.normalize().multiplyScalar(_),s[b+0]=w.x,s[b+1]=w.y,s[b+2]=w.z}function c(){const _=new Q;for(let w=0;w<s.length;w+=3){_.x=s[w+0],_.y=s[w+1],_.z=s[w+2];const b=x(_)/2/Math.PI+.5,S=m(_)/Math.PI+.5;o.push(b,1-S)}p(),f()}function f(){for(let _=0;_<o.length;_+=6){const w=o[_+0],b=o[_+2],S=o[_+4],M=Math.max(w,b,S),T=Math.min(w,b,S);M>.9&&T<.1&&(w<.2&&(o[_+0]+=1),b<.2&&(o[_+2]+=1),S<.2&&(o[_+4]+=1))}}function h(_){s.push(_.x,_.y,_.z)}function d(_,w){const b=_*3;w.x=e[b+0],w.y=e[b+1],w.z=e[b+2]}function p(){const _=new Q,w=new Q,b=new Q,S=new Q,M=new Me,T=new Me,P=new Me;for(let C=0,A=0;C<s.length;C+=9,A+=6){_.set(s[C+0],s[C+1],s[C+2]),w.set(s[C+3],s[C+4],s[C+5]),b.set(s[C+6],s[C+7],s[C+8]),M.set(o[A+0],o[A+1]),T.set(o[A+2],o[A+3]),P.set(o[A+4],o[A+5]),S.copy(_).add(w).add(b).divideScalar(3);const k=x(S);y(M,A+0,_,k),y(T,A+2,w,k),y(P,A+4,b,k)}}function y(_,w,b,S){S<0&&_.x===1&&(o[w]=_.x-1),b.x===0&&b.z===0&&(o[w]=S/2/Math.PI+.5)}function x(_){return Math.atan2(_.z,-_.x)}function m(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yc(e.vertices,e.indices,e.radius,e.details)}}class Bw extends Yc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Bw(e.radius,e.detail)}}const ix=new Q,sx=new Q,kE=new Q,ox=new jf;class O8 extends qt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(nh*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],c=["a","b","c"],f=new Array(3),h={},d=[];for(let p=0;p<l;p+=3){o?(u[0]=o.getX(p),u[1]=o.getX(p+1),u[2]=o.getX(p+2)):(u[0]=p,u[1]=p+1,u[2]=p+2);const{a:y,b:x,c:m}=ox;if(y.fromBufferAttribute(a,u[0]),x.fromBufferAttribute(a,u[1]),m.fromBufferAttribute(a,u[2]),ox.getNormal(kE),f[0]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,f[1]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,f[2]=`${Math.round(m.x*i)},${Math.round(m.y*i)},${Math.round(m.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let _=0;_<3;_++){const w=(_+1)%3,b=f[_],S=f[w],M=ox[c[_]],T=ox[c[w]],P=`${b}_${S}`,C=`${S}_${b}`;C in h&&h[C]?(kE.dot(h[C].normal)<=s&&(d.push(M.x,M.y,M.z),d.push(T.x,T.y,T.z)),h[C]=null):P in h||(h[P]={index0:u[_],index1:u[w],normal:kE.clone()})}}for(const p in h)if(h[p]){const{index0:y,index1:x}=h[p];ix.fromBufferAttribute(a,y),sx.fromBufferAttribute(a,x),d.push(ix.x,ix.y,ix.z),d.push(sx.x,sx.y,sx.z)}this.setAttribute("position",new St(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ih extends Qg{constructor(e){super(e),this.uuid=Co(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new Qg().fromJSON(i))}return this}}const Xne={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=B8(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,c,f,h,d;if(r&&(s=Zne(n,e,s,t)),n.length>80*t){a=u=n[0],l=c=n[1];for(let p=t;p<i;p+=t)f=n[p],h=n[p+1],f<a&&(a=f),h<l&&(l=h),f>u&&(u=f),h>c&&(c=h);d=Math.max(u-a,c-l),d=d!==0?32767/d:0}return ev(s,o,t,a,l,d,0),o}};function B8(n,e,t,r,i){let s,o;if(i===lre(n,e,t,r)>0)for(s=e;s<t;s+=r)o=aL(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=aL(s,n[s],n[s+1],o);return o&&Uw(o,o.next)&&(nv(o),o=o.next),o}function bh(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(Uw(t,t.next)||fr(t.prev,t,t.next)===0)){if(nv(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function ev(n,e,t,r,i,s,o){if(!n)return;!o&&s&&nre(n,r,i,s);let a=n,l,u;for(;n.prev!==n.next;){if(l=n.prev,u=n.next,s?qne(n,r,i,s):$ne(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),nv(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=Yne(bh(n),e,t),ev(n,e,t,r,i,s,2)):o===2&&Kne(n,e,t,r,i,s):ev(bh(n),e,t,r,i,s,1);break}}}function $ne(n){const e=n.prev,t=n,r=n.next;if(fr(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,u=r.y,c=i<s?i<o?i:o:s<o?s:o,f=a<l?a<u?a:u:l<u?l:u,h=i>s?i>o?i:o:s>o?s:o,d=a>l?a>u?a:u:l>u?l:u;let p=r.next;for(;p!==e;){if(p.x>=c&&p.x<=h&&p.y>=f&&p.y<=d&&op(i,a,s,l,o,u,p.x,p.y)&&fr(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function qne(n,e,t,r){const i=n.prev,s=n,o=n.next;if(fr(i,s,o)>=0)return!1;const a=i.x,l=s.x,u=o.x,c=i.y,f=s.y,h=o.y,d=a<l?a<u?a:u:l<u?l:u,p=c<f?c<h?c:h:f<h?f:h,y=a>l?a>u?a:u:l>u?l:u,x=c>f?c>h?c:h:f>h?f:h,m=OT(d,p,e,t,r),_=OT(y,x,e,t,r);let w=n.prevZ,b=n.nextZ;for(;w&&w.z>=m&&b&&b.z<=_;){if(w.x>=d&&w.x<=y&&w.y>=p&&w.y<=x&&w!==i&&w!==o&&op(a,c,l,f,u,h,w.x,w.y)&&fr(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=d&&b.x<=y&&b.y>=p&&b.y<=x&&b!==i&&b!==o&&op(a,c,l,f,u,h,b.x,b.y)&&fr(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=m;){if(w.x>=d&&w.x<=y&&w.y>=p&&w.y<=x&&w!==i&&w!==o&&op(a,c,l,f,u,h,w.x,w.y)&&fr(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=_;){if(b.x>=d&&b.x<=y&&b.y>=p&&b.y<=x&&b!==i&&b!==o&&op(a,c,l,f,u,h,b.x,b.y)&&fr(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Yne(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!Uw(i,s)&&U8(i,r,r.next,s)&&tv(i,s)&&tv(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),nv(r),nv(r.next),r=n=s),r=r.next}while(r!==n);return bh(r)}function Kne(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&sre(o,a)){let l=z8(o,a);o=bh(o,o.next),l=bh(l,l.next),ev(o,e,t,r,i,s,0),ev(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function Zne(n,e,t,r){const i=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,u=B8(n,a,l,r,!1),u===u.next&&(u.steiner=!0),i.push(ire(u));for(i.sort(Jne),s=0;s<i.length;s++)t=Qne(i[s],t);return t}function Jne(n,e){return n.x-e.x}function Qne(n,e){const t=ere(n,e);if(!t)return e;const r=z8(t,n);return bh(r,r.next),bh(t,t.next)}function ere(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>r&&(r=h,i=t.x<t.next.x?t:t.next,h===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,u=i.y;let c=1/0,f;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&op(o<u?s:r,o,l,u,o<u?r:s,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(s-t.x),tv(t,n)&&(f<c||f===c&&(t.x>i.x||t.x===i.x&&tre(i,t)))&&(i=t,c=f)),t=t.next;while(t!==a);return i}function tre(n,e){return fr(n.prev,n,e.prev)<0&&fr(e.next,n,n.next)<0}function nre(n,e,t,r){let i=n;do i.z===0&&(i.z=OT(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,rre(i)}function rre(n){let e,t,r,i,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(l=u;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,u*=2}while(o>1);return n}function OT(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function ire(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function op(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function sre(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!ore(n,e)&&(tv(n,e)&&tv(e,n)&&are(n,e)&&(fr(n.prev,n,e.prev)||fr(n,e.prev,e))||Uw(n,e)&&fr(n.prev,n,n.next)>0&&fr(e.prev,e,e.next)>0)}function fr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Uw(n,e){return n.x===e.x&&n.y===e.y}function U8(n,e,t,r){const i=lx(fr(n,e,t)),s=lx(fr(n,e,r)),o=lx(fr(t,r,n)),a=lx(fr(t,r,e));return!!(i!==s&&o!==a||i===0&&ax(n,t,e)||s===0&&ax(n,r,e)||o===0&&ax(t,n,r)||a===0&&ax(t,e,r))}function ax(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function lx(n){return n>0?1:n<0?-1:0}function ore(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&U8(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function tv(n,e){return fr(n.prev,n,n.next)<0?fr(n,e,n.next)>=0&&fr(n,n.prev,e)>=0:fr(n,e,n.prev)<0||fr(n,n.next,e)<0}function are(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function z8(n,e){const t=new BT(n.i,n.x,n.y),r=new BT(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function aL(n,e,t,r){const i=new BT(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function nv(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function BT(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lre(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class xl{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return xl.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];lL(e),uL(r,e);let o=e.length;t.forEach(lL);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,uL(r,t[l]);const a=Xne.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function lL(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function uL(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class zw extends qt{constructor(e=new ih([new Me(.5,.5),new Me(-.5,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new St(i,3)),this.setAttribute("uv",new St(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,d=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:d-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const m=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:ure;let w,b=!1,S,M,T,P;m&&(w=m.getSpacedPoints(c),b=!0,h=!1,S=m.computeFrenetFrames(c,!1),M=new Q,T=new Q,P=new Q),h||(x=0,d=0,p=0,y=0);const C=a.extractPoints(u);let A=C.shape;const k=C.holes;if(!xl.isClockWise(A)){A=A.reverse();for(let J=0,he=k.length;J<he;J++){const de=k[J];xl.isClockWise(de)&&(k[J]=de.reverse())}}const H=xl.triangulateShape(A,k),F=A;for(let J=0,he=k.length;J<he;J++){const de=k[J];A=A.concat(de)}function V(J,he,de){return he||console.error("THREE.ExtrudeGeometry: vec does not exist"),J.clone().addScaledVector(he,de)}const W=A.length,G=H.length;function N(J,he,de){let Ie,ve,oe;const ze=J.x-he.x,X=J.y-he.y,j=de.x-J.x,ae=de.y-J.y,Oe=ze*ze+X*X,Se=ze*ae-X*j;if(Math.abs(Se)>Number.EPSILON){const K=Math.sqrt(Oe),ge=Math.sqrt(j*j+ae*ae),Te=he.x-X/K,Le=he.y+ze/K,Pe=de.x-ae/ge,De=de.y+j/ge,Ae=((Pe-Te)*ae-(De-Le)*j)/(ze*ae-X*j);Ie=Te+ze*Ae-J.x,ve=Le+X*Ae-J.y;const ht=Ie*Ie+ve*ve;if(ht<=2)return new Me(Ie,ve);oe=Math.sqrt(ht/2)}else{let K=!1;ze>Number.EPSILON?j>Number.EPSILON&&(K=!0):ze<-Number.EPSILON?j<-Number.EPSILON&&(K=!0):Math.sign(X)===Math.sign(ae)&&(K=!0),K?(Ie=-X,ve=ze,oe=Math.sqrt(Oe)):(Ie=ze,ve=X,oe=Math.sqrt(Oe/2))}return new Me(Ie/oe,ve/oe)}const B=[];for(let J=0,he=F.length,de=he-1,Ie=J+1;J<he;J++,de++,Ie++)de===he&&(de=0),Ie===he&&(Ie=0),B[J]=N(F[J],F[de],F[Ie]);const D=[];let $,ee=B.concat();for(let J=0,he=k.length;J<he;J++){const de=k[J];$=[];for(let Ie=0,ve=de.length,oe=ve-1,ze=Ie+1;Ie<ve;Ie++,oe++,ze++)oe===ve&&(oe=0),ze===ve&&(ze=0),$[Ie]=N(de[Ie],de[oe],de[ze]);D.push($),ee=ee.concat($)}for(let J=0;J<x;J++){const he=J/x,de=d*Math.cos(he*Math.PI/2),Ie=p*Math.sin(he*Math.PI/2)+y;for(let ve=0,oe=F.length;ve<oe;ve++){const ze=V(F[ve],B[ve],Ie);pe(ze.x,ze.y,-de)}for(let ve=0,oe=k.length;ve<oe;ve++){const ze=k[ve];$=D[ve];for(let X=0,j=ze.length;X<j;X++){const ae=V(ze[X],$[X],Ie);pe(ae.x,ae.y,-de)}}}const te=p+y;for(let J=0;J<W;J++){const he=h?V(A[J],ee[J],te):A[J];b?(T.copy(S.normals[0]).multiplyScalar(he.x),M.copy(S.binormals[0]).multiplyScalar(he.y),P.copy(w[0]).add(T).add(M),pe(P.x,P.y,P.z)):pe(he.x,he.y,0)}for(let J=1;J<=c;J++)for(let he=0;he<W;he++){const de=h?V(A[he],ee[he],te):A[he];b?(T.copy(S.normals[J]).multiplyScalar(de.x),M.copy(S.binormals[J]).multiplyScalar(de.y),P.copy(w[J]).add(T).add(M),pe(P.x,P.y,P.z)):pe(de.x,de.y,f/c*J)}for(let J=x-1;J>=0;J--){const he=J/x,de=d*Math.cos(he*Math.PI/2),Ie=p*Math.sin(he*Math.PI/2)+y;for(let ve=0,oe=F.length;ve<oe;ve++){const ze=V(F[ve],B[ve],Ie);pe(ze.x,ze.y,f+de)}for(let ve=0,oe=k.length;ve<oe;ve++){const ze=k[ve];$=D[ve];for(let X=0,j=ze.length;X<j;X++){const ae=V(ze[X],$[X],Ie);b?pe(ae.x,ae.y+w[c-1].y,w[c-1].x+de):pe(ae.x,ae.y,f+de)}}}se(),me();function se(){const J=i.length/3;if(h){let he=0,de=W*he;for(let Ie=0;Ie<G;Ie++){const ve=H[Ie];Ne(ve[2]+de,ve[1]+de,ve[0]+de)}he=c+x*2,de=W*he;for(let Ie=0;Ie<G;Ie++){const ve=H[Ie];Ne(ve[0]+de,ve[1]+de,ve[2]+de)}}else{for(let he=0;he<G;he++){const de=H[he];Ne(de[2],de[1],de[0])}for(let he=0;he<G;he++){const de=H[he];Ne(de[0]+W*c,de[1]+W*c,de[2]+W*c)}}r.addGroup(J,i.length/3-J,0)}function me(){const J=i.length/3;let he=0;_e(F,he),he+=F.length;for(let de=0,Ie=k.length;de<Ie;de++){const ve=k[de];_e(ve,he),he+=ve.length}r.addGroup(J,i.length/3-J,1)}function _e(J,he){let de=J.length;for(;--de>=0;){const Ie=de;let ve=de-1;ve<0&&(ve=J.length-1);for(let oe=0,ze=c+x*2;oe<ze;oe++){const X=W*oe,j=W*(oe+1),ae=he+Ie+X,Oe=he+ve+X,Se=he+ve+j,K=he+Ie+j;Ue(ae,Oe,Se,K)}}}function pe(J,he,de){l.push(J),l.push(he),l.push(de)}function Ne(J,he,de){We(J),We(he),We(de);const Ie=i.length/3,ve=_.generateTopUV(r,i,Ie-3,Ie-2,Ie-1);Be(ve[0]),Be(ve[1]),Be(ve[2])}function Ue(J,he,de,Ie){We(J),We(he),We(Ie),We(he),We(de),We(Ie);const ve=i.length/3,oe=_.generateSideWallUV(r,i,ve-6,ve-3,ve-2,ve-1);Be(oe[0]),Be(oe[1]),Be(oe[3]),Be(oe[1]),Be(oe[2]),Be(oe[3])}function We(J){i.push(l[J*3+0]),i.push(l[J*3+1]),i.push(l[J*3+2])}function Be(J){s.push(J.x),s.push(J.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return cre(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new h_[i.type]().fromJSON(i)),new zw(r,e.options)}}const ure={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],l=e[r*3+1],u=e[i*3],c=e[i*3+1];return[new Me(s,o),new Me(a,l),new Me(u,c)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[r*3],c=e[r*3+1],f=e[r*3+2],h=e[i*3],d=e[i*3+1],p=e[i*3+2],y=e[s*3],x=e[s*3+1],m=e[s*3+2];return Math.abs(a-c)<Math.abs(o-u)?[new Me(o,1-l),new Me(u,1-f),new Me(h,1-p),new Me(y,1-m)]:[new Me(a,1-l),new Me(c,1-f),new Me(d,1-p),new Me(x,1-m)]}};function cre(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Vw extends Yc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Vw(e.radius,e.detail)}}class jv extends Yc{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jv(e.radius,e.detail)}}class Ww extends qt{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],u=[],c=[];let f=e;const h=(t-e)/i,d=new Q,p=new Me;for(let y=0;y<=i;y++){for(let x=0;x<=r;x++){const m=s+x/r*o;d.x=f*Math.cos(m),d.y=f*Math.sin(m),l.push(d.x,d.y,d.z),u.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}f+=h}for(let y=0;y<i;y++){const x=y*(r+1);for(let m=0;m<r;m++){const _=m+x,w=_,b=_+r+1,S=_+r+2,M=_+1;a.push(w,b,M),a.push(b,S,M)}}this.setIndex(a),this.setAttribute("position",new St(l,3)),this.setAttribute("normal",new St(u,3)),this.setAttribute("uv",new St(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ww(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Hw extends qt{constructor(e=new ih([new Me(0,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(a,l,c),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new St(i,3)),this.setAttribute("normal",new St(s,3)),this.setAttribute("uv",new St(o,2));function u(c){const f=i.length/3,h=c.extractPoints(t);let d=h.shape;const p=h.holes;xl.isClockWise(d)===!1&&(d=d.reverse());for(let x=0,m=p.length;x<m;x++){const _=p[x];xl.isClockWise(_)===!0&&(p[x]=_.reverse())}const y=xl.triangulateShape(d,p);for(let x=0,m=p.length;x<m;x++){const _=p[x];d=d.concat(_)}for(let x=0,m=d.length;x<m;x++){const _=d[x];i.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let x=0,m=y.length;x<m;x++){const _=y[x],w=_[0]+f,b=_[1]+f,S=_[2]+f;r.push(w,b,S),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return fre(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new Hw(r,e.curveSegments)}}function fre(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class Xv extends qt{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let u=0;const c=[],f=new Q,h=new Q,d=[],p=[],y=[],x=[];for(let m=0;m<=r;m++){const _=[],w=m/r;let b=0;m===0&&o===0?b=.5/t:m===r&&l===Math.PI&&(b=-.5/t);for(let S=0;S<=t;S++){const M=S/t;f.x=-e*Math.cos(i+M*s)*Math.sin(o+w*a),f.y=e*Math.cos(o+w*a),f.z=e*Math.sin(i+M*s)*Math.sin(o+w*a),p.push(f.x,f.y,f.z),h.copy(f).normalize(),y.push(h.x,h.y,h.z),x.push(M+b,1-w),_.push(u++)}c.push(_)}for(let m=0;m<r;m++)for(let _=0;_<t;_++){const w=c[m][_+1],b=c[m][_],S=c[m+1][_],M=c[m+1][_+1];(m!==0||o>0)&&d.push(w,b,M),(m!==r-1||l<Math.PI)&&d.push(b,S,M)}this.setIndex(d),this.setAttribute("position",new St(p,3)),this.setAttribute("normal",new St(y,3)),this.setAttribute("uv",new St(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xv(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Gw extends Yc{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Gw(e.radius,e.detail)}}class jw extends qt{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],u=[],c=new Q,f=new Q,h=new Q;for(let d=0;d<=r;d++)for(let p=0;p<=i;p++){const y=p/i*s,x=d/r*Math.PI*2;f.x=(e+t*Math.cos(x))*Math.cos(y),f.y=(e+t*Math.cos(x))*Math.sin(y),f.z=t*Math.sin(x),a.push(f.x,f.y,f.z),c.x=e*Math.cos(y),c.y=e*Math.sin(y),h.subVectors(f,c).normalize(),l.push(h.x,h.y,h.z),u.push(p/i),u.push(d/r)}for(let d=1;d<=r;d++)for(let p=1;p<=i;p++){const y=(i+1)*d+p-1,x=(i+1)*(d-1)+p-1,m=(i+1)*(d-1)+p,_=(i+1)*d+p;o.push(y,x,_),o.push(x,m,_)}this.setIndex(o),this.setAttribute("position",new St(a,3)),this.setAttribute("normal",new St(l,3)),this.setAttribute("uv",new St(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jw(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Xw extends qt{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],u=[],c=[],f=new Q,h=new Q,d=new Q,p=new Q,y=new Q,x=new Q,m=new Q;for(let w=0;w<=r;++w){const b=w/r*s*Math.PI*2;_(b,s,o,e,d),_(b+.01,s,o,e,p),x.subVectors(p,d),m.addVectors(p,d),y.crossVectors(x,m),m.crossVectors(y,x),y.normalize(),m.normalize();for(let S=0;S<=i;++S){const M=S/i*Math.PI*2,T=-t*Math.cos(M),P=t*Math.sin(M);f.x=d.x+(T*m.x+P*y.x),f.y=d.y+(T*m.y+P*y.y),f.z=d.z+(T*m.z+P*y.z),l.push(f.x,f.y,f.z),h.subVectors(f,d).normalize(),u.push(h.x,h.y,h.z),c.push(w/r),c.push(S/i)}}for(let w=1;w<=r;w++)for(let b=1;b<=i;b++){const S=(i+1)*(w-1)+(b-1),M=(i+1)*w+(b-1),T=(i+1)*w+b,P=(i+1)*(w-1)+b;a.push(S,M,P),a.push(M,T,P)}this.setIndex(a),this.setAttribute("position",new St(l,3)),this.setAttribute("normal",new St(u,3)),this.setAttribute("uv",new St(c,2));function _(w,b,S,M,T){const P=Math.cos(w),C=Math.sin(w),A=S/b*w,k=Math.cos(A);T.x=M*(2+k)*.5*P,T.y=M*(2+k)*C*.5,T.z=M*Math.sin(A)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xw(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class $w extends qt{constructor(e=new WR(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Q,l=new Q,u=new Me;let c=new Q;const f=[],h=[],d=[],p=[];y(),this.setIndex(p),this.setAttribute("position",new St(f,3)),this.setAttribute("normal",new St(h,3)),this.setAttribute("uv",new St(d,2));function y(){for(let w=0;w<t;w++)x(w);x(s===!1?t:0),_(),m()}function x(w){c=e.getPointAt(w/t,c);const b=o.normals[w],S=o.binormals[w];for(let M=0;M<=i;M++){const T=M/i*Math.PI*2,P=Math.sin(T),C=-Math.cos(T);l.x=C*b.x+P*S.x,l.y=C*b.y+P*S.y,l.z=C*b.z+P*S.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=c.x+r*l.x,a.y=c.y+r*l.y,a.z=c.z+r*l.z,f.push(a.x,a.y,a.z)}}function m(){for(let w=1;w<=t;w++)for(let b=1;b<=i;b++){const S=(i+1)*(w-1)+(b-1),M=(i+1)*w+(b-1),T=(i+1)*w+b,P=(i+1)*(w-1)+b;p.push(S,M,P),p.push(M,T,P)}}function _(){for(let w=0;w<=t;w++)for(let b=0;b<=i;b++)u.x=w/t,u.y=b/i,d.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new $w(new h_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class V8 extends qt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new Q,s=new Q;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,c=l.length;u<c;++u){const f=l[u],h=f.start,d=f.count;for(let p=h,y=h+d;p<y;p+=3)for(let x=0;x<3;x++){const m=a.getX(p+x),_=a.getX(p+(x+1)%3);i.fromBufferAttribute(o,m),s.fromBufferAttribute(o,_),cL(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const c=3*a+u,f=3*a+(u+1)%3;i.fromBufferAttribute(o,c),s.fromBufferAttribute(o,f),cL(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new St(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function cL(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var fL=Object.freeze({__proto__:null,BoxGeometry:Ih,CapsuleGeometry:Lw,CircleGeometry:Fw,ConeGeometry:Ow,CylinderGeometry:_m,DodecahedronGeometry:Bw,EdgesGeometry:O8,ExtrudeGeometry:zw,IcosahedronGeometry:Vw,LatheGeometry:Gv,OctahedronGeometry:jv,PlaneGeometry:yl,PolyhedronGeometry:Yc,RingGeometry:Ww,ShapeGeometry:Hw,SphereGeometry:Xv,TetrahedronGeometry:Gw,TorusGeometry:jw,TorusKnotGeometry:Xw,TubeGeometry:$w,WireframeGeometry:V8});class W8 extends Mi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new it(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class ap extends $r{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qw extends Mi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new it(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class H8 extends qw{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Me(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Tr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new it(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new it(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new it(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class G8 extends Mi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new it(16777215),this.specular=new it(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class j8 extends Mi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new it(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class X8 extends Mi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class $8 extends Mi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new it(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class q8 extends Mi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new it(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xc,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Y8 extends Rs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Xf(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function K8(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Z8(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function UT(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=n[a+l]}return i}function GR(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function hre(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],c=u.getValueSize(),f=[],h=[];for(let d=0;d<u.times.length;++d){const p=u.times[d]*i;if(!(p<t||p>=r)){f.push(u.times[d]);for(let y=0;y<c;++y)h.push(u.values[d*c+y])}}f.length!==0&&(u.times=Xf(f,u.times.constructor),u.values=Xf(h,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function dre(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=n.tracks.find(function(m){return m.name===a.name&&m.ValueTypeName===l});if(u===void 0)continue;let c=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=f/3);let h=0;const d=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=d/3);const p=a.times.length-1;let y;if(s<=a.times[0]){const m=c,_=f-c;y=a.values.slice(m,_)}else if(s>=a.times[p]){const m=p*f+c,_=m+f-c;y=a.values.slice(m,_)}else{const m=a.createInterpolant(),_=c,w=f-c;m.evaluate(s),y=m.resultBuffer.slice(_,w)}l==="quaternion"&&new Xs().fromArray(y).normalize().conjugate().toArray(y);const x=u.times.length;for(let m=0;m<x;++m){const _=m*d+h;if(l==="quaternion")Xs.multiplyQuaternionsFlat(u.values,_,y,0,u.values,_);else{const w=d-h*2;for(let b=0;b<w;++b)u.values[_+b]-=y[b]}}}return n.blendMode=bR,n}const pre={convertArray:Xf,isTypedArray:K8,getKeyframeOrder:Z8,sortedArray:UT,flattenJSON:GR,subclip:hre,makeClipAdditive:dre};class $v{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class J8 extends $v{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Wf,endingEnd:Wf}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Hf:s=e,a=2*t-r;break;case $g:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case Hf:o=e,l=2*r-t;break;case $g:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=t}const u=(r-t)*.5,c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-r),this._offsetPrev=s*c,this._offsetNext=o*c}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,f=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),y=p*p,x=y*p,m=-h*x+2*h*y-h*p,_=(1+h)*x+(-1.5-2*h)*y+(-.5+h)*p+1,w=(-1-d)*x+(1.5+d)*y+.5*p,b=d*x-d*y;for(let S=0;S!==a;++S)s[S]=m*o[c+S]+_*o[u+S]+w*o[l+S]+b*o[f+S];return s}}class jR extends $v{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(r-t)/(i-t),f=1-c;for(let h=0;h!==a;++h)s[h]=o[u+h]*f+o[l+h]*c;return s}}class Q8 extends $v{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Va{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Xf(t,this.TimeBufferType),this.values=Xf(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Xf(e.times,Array),values:Xf(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Q8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new jR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new J8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jg:t=this.InterpolantFactoryMethodDiscrete;break;case Xg:t=this.InterpolantFactoryMethodLinear;break;case y2:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jg;case this.InterpolantFactoryMethodLinear:return Xg;case this.InterpolantFactoryMethodSmooth:return y2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&K8(i))for(let a=0,l=i.length;a!==l;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===y2,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],c=e[a+1];if(u!==c&&(a!==1||u!==e[0]))if(i)l=!0;else{const f=a*r,h=f-r,d=f+r;for(let p=0;p!==r;++p){const y=t[f+p];if(y!==t[h+p]||y!==t[d+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*r,h=o*r;for(let d=0;d!==r;++d)t[h+d]=t[f+d]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,u=0;u!==r;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Va.prototype.TimeBufferType=Float32Array;Va.prototype.ValueBufferType=Float32Array;Va.prototype.DefaultInterpolation=Xg;class Dh extends Va{}Dh.prototype.ValueTypeName="bool";Dh.prototype.ValueBufferType=Array;Dh.prototype.DefaultInterpolation=jg;Dh.prototype.InterpolantFactoryMethodLinear=void 0;Dh.prototype.InterpolantFactoryMethodSmooth=void 0;class XR extends Va{}XR.prototype.ValueTypeName="color";class rv extends Va{}rv.prototype.ValueTypeName="number";class eV extends $v{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-t)/(i-t);let u=e*a;for(let c=u+a;u!==c;u+=4)Xs.slerpFlat(s,0,o,u-a,o,u,l);return s}}class wm extends Va{InterpolantFactoryMethodLinear(e){return new eV(this.times,this.values,this.getValueSize(),e)}}wm.prototype.ValueTypeName="quaternion";wm.prototype.DefaultInterpolation=Xg;wm.prototype.InterpolantFactoryMethodSmooth=void 0;class Nh extends Va{}Nh.prototype.ValueTypeName="string";Nh.prototype.ValueBufferType=Array;Nh.prototype.DefaultInterpolation=jg;Nh.prototype.InterpolantFactoryMethodLinear=void 0;Nh.prototype.InterpolantFactoryMethodSmooth=void 0;class iv extends Va{}iv.prototype.ValueTypeName="vector";class sv{constructor(e,t=-1,r,i=Mw){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Co(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(gre(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(Va.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const c=Z8(l);l=UT(l,1,c),u=UT(u,1,c),!i&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new rv(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(s);if(c&&c.length>1){const f=c[1];let h=i[f];h||(i[f]=h=[]),h.push(u)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,h,d,p,y){if(d.length!==0){const x=[],m=[];GR(d,x,m,p),x.length!==0&&y.push(new f(h,x,m))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const h=u[f].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const d={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let y=0;y<h[p].morphTargets.length;y++)d[h[p].morphTargets[y]]=-1;for(const y in d){const x=[],m=[];for(let _=0;_!==h[p].morphTargets.length;++_){const w=h[p];x.push(w.time),m.push(w.morphTarget===y?1:0)}i.push(new rv(".morphTargetInfluence["+y+"]",x,m))}l=d.length*o}else{const d=".bones["+t[f].name+"]";r(iv,d+".position",h,"pos",i),r(wm,d+".quaternion",h,"rot",i),r(iv,d+".scale",h,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function mre(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rv;case"vector":case"vector2":case"vector3":case"vector4":return iv;case"color":return XR;case"quaternion":return wm;case"bool":case"boolean":return Dh;case"string":return Nh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function gre(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=mre(n.type);if(n.times===void 0){const t=[],r=[];GR(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const nu={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class $R{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,s===!1&&i.onStart!==void 0&&i.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,i.onProgress!==void 0&&i.onProgress(c,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,f){return u.push(c,f),this},this.removeHandler=function(c){const f=u.indexOf(c);return f!==-1&&u.splice(f,2),this},this.getHandler=function(c){for(let f=0,h=u.length;f<h;f+=2){const d=u[f],p=u[f+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}}const tV=new $R;let to=class{constructor(e){this.manager=e!==void 0?e:tV,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};to.DEFAULT_MATERIAL_NAME="__DEFAULT";const Gl={};class vre extends Error{constructor(e,t){super(e),this.response=t}}class gu extends to{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=nu.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Gl[e]!==void 0){Gl[e].push({onLoad:t,onProgress:r,onError:i});return}Gl[e]=[],Gl[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=Gl[e],f=u.body.getReader(),h=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0;let y=0;const x=new ReadableStream({start(m){_();function _(){f.read().then(({done:w,value:b})=>{if(w)m.close();else{y+=b.byteLength;const S=new ProgressEvent("progress",{lengthComputable:p,loaded:y,total:d});for(let M=0,T=c.length;M<T;M++){const P=c[M];P.onProgress&&P.onProgress(S)}m.enqueue(b),_()}})}}});return new Response(x)}else throw new vre(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return u.json();default:if(a===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),h=f&&f[1]?f[1].toLowerCase():void 0,d=new TextDecoder(h);return u.arrayBuffer().then(p=>d.decode(p))}}}).then(u=>{nu.add(e,u);const c=Gl[e];delete Gl[e];for(let f=0,h=c.length;f<h;f++){const d=c[f];d.onLoad&&d.onLoad(u)}}).catch(u=>{const c=Gl[e];if(c===void 0)throw this.manager.itemError(e),u;delete Gl[e];for(let f=0,h=c.length;f<h;f++){const d=c[f];d.onError&&d.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class yre extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new gu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=sv.parse(e[r]);t.push(i)}return t}}class xre extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],a=new Nw,l=new gu(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function c(f){l.load(e[f],function(h){const d=s.parse(h,!0);o[f]={width:d.width,height:d.height,format:d.format,mipmaps:d.mipmaps},u+=1,u===6&&(d.mipmapCount===1&&(a.minFilter=bn),a.image=o,a.format=d.format,a.needsUpdate=!0,t&&t(a))},r,i)}if(Array.isArray(e))for(let f=0,h=e.length;f<h;++f)c(f);else l.load(e,function(f){const h=s.parse(f,!0);if(h.isCubemap){const d=h.mipmaps.length/h.mipmapCount;for(let p=0;p<d;p++){o[p]={mipmaps:[]};for(let y=0;y<h.mipmapCount;y++)o[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+y]),o[p].format=h.format,o[p].width=h.width,o[p].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=bn),a.format=h.format,a.needsUpdate=!0,t&&t(a)},r,i);return a}}class ov extends to{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=nu.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Jg("img");function l(){c(),nu.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(f){c(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class _re extends to{constructor(e){super(e)}load(e,t,r,i){const s=new Vv;s.colorSpace=mn;const o=new ov(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(c){s.images[u]=c,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)l(u);return s}}class wre extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new au,a=new gu(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let u;try{u=s.parse(l)}catch(c){if(i!==void 0)i(c);else{console.error(c);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:Cr,o.wrapT=u.wrapT!==void 0?u.wrapT:Cr,o.magFilter=u.magFilter!==void 0?u.magFilter:bn,o.minFilter=u.minFilter!==void 0?u.minFilter:bn,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0?o.colorSpace=u.colorSpace:u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=Dc),u.mipmapCount===1&&(o.minFilter=bn),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,t&&t(o,u)},r,i),o}}class nV extends to{constructor(e){super(e)}load(e,t,r,i){const s=new vr,o=new ov(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class Kc extends Rn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new it(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class rV extends Kc{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new it(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const LE=new Ht,hL=new Q,dL=new Q;class qR{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Me(512,512),this.map=null,this.mapPass=null,this.matrix=new Ht,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Wv,this._frameExtents=new Me(1,1),this._viewportCount=1,this._viewports=[new Sn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;hL.setFromMatrixPosition(e.matrixWorld),t.position.copy(hL),dL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(dL),t.updateMatrixWorld(),LE.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(LE),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(LE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class bre extends qR{constructor(){super(new ti(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=$p*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class iV extends Kc{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.target=new Rn,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new bre}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const pL=new Ht,f0=new Q,FE=new Q;class Sre extends qR{constructor(){super(new ti(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Me(4,2),this._viewportCount=6,this._viewports=[new Sn(2,1,1,1),new Sn(0,1,1,1),new Sn(3,1,1,1),new Sn(1,1,1,1),new Sn(3,0,1,1),new Sn(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),f0.setFromMatrixPosition(e.matrixWorld),r.position.copy(f0),FE.copy(r.position),FE.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(FE),r.updateMatrixWorld(),i.makeTranslation(-f0.x,-f0.y,-f0.z),pL.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pL)}}class sV extends Kc{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Sre}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Ere extends qR{constructor(){super(new qc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class oV extends Kc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rn.DEFAULT_UP),this.updateMatrix(),this.target=new Rn,this.shadow=new Ere}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class aV extends Kc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class lV extends Kc{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class uV{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class cV extends Kc{constructor(e=new uV,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Yw extends to{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new gu(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=Yw.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new it().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new it().setHex(o.value);break;case"v2":i.uniforms[s].value=new Me().fromArray(o.value);break;case"v3":i.uniforms[s].value=new Q().fromArray(o.value);break;case"v4":i.uniforms[s].value=new Sn().fromArray(o.value);break;case"m3":i.uniforms[s].value=new en().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Ht().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Me().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Me().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:W8,SpriteMaterial:LR,RawShaderMaterial:ap,ShaderMaterial:$r,PointsMaterial:OR,MeshPhysicalMaterial:H8,MeshStandardMaterial:qw,MeshPhongMaterial:G8,MeshToonMaterial:j8,MeshNormalMaterial:X8,MeshLambertMaterial:$8,MeshDepthMaterial:NR,MeshDistanceMaterial:kR,MeshBasicMaterial:$c,MeshMatcapMaterial:q8,LineDashedMaterial:Y8,LineBasicMaterial:Rs,Material:Mi};return new t[e]}}class zT{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class fV extends qt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class hV extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new gu(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(d,p){if(t[p]!==void 0)return t[p];const x=d.interleavedBuffers[p],m=s(d,x.buffer),_=np(x.type,m),w=new Iw(_,x.stride);return w.uuid=x.uuid,t[p]=w,w}function s(d,p){if(r[p]!==void 0)return r[p];const x=d.arrayBuffers[p],m=new Uint32Array(x).buffer;return r[p]=m,m}const o=e.isInstancedBufferGeometry?new fV:new qt,a=e.data.index;if(a!==void 0){const d=np(a.type,a.array);o.setIndex(new vn(d,1))}const l=e.data.attributes;for(const d in l){const p=l[d];let y;if(p.isInterleavedBufferAttribute){const x=i(e.data,p.data);y=new wh(x,p.itemSize,p.offset,p.normalized)}else{const x=np(p.type,p.array),m=p.isInstancedBufferAttribute?Yp:vn;y=new m(x,p.itemSize,p.normalized)}p.name!==void 0&&(y.name=p.name),p.usage!==void 0&&y.setUsage(p.usage),o.setAttribute(d,y)}const u=e.data.morphAttributes;if(u)for(const d in u){const p=u[d],y=[];for(let x=0,m=p.length;x<m;x++){const _=p[x];let w;if(_.isInterleavedBufferAttribute){const b=i(e.data,_.data);w=new wh(b,_.itemSize,_.offset,_.normalized)}else{const b=np(_.type,_.array);w=new vn(b,_.itemSize,_.normalized)}_.name!==void 0&&(w.name=_.name),y.push(w)}o.morphAttributes[d]=y}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let d=0,p=f.length;d!==p;++d){const y=f[d];o.addGroup(y.start,y.count,y.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const d=new Q;h.center!==void 0&&d.fromArray(h.center),o.boundingSphere=new ss(d,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Mre extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?zT.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new gu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const c=u.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?zT.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new gu(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,r),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),t!==void 0){let f=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(u)}return u}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new ih().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new Dw().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new hV;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in fL?a=fL[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new Yw;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=sv.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:r.resourcePath+u;return o(c)}else return l.data?{data:np(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new $R(t);s=new ov(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,c=e.length;u<c;u++){const f=e[u],h=f.url;if(Array.isArray(h)){const d=[];for(let p=0,y=h.length;p<y;p++){const x=h[p],m=a(x);m!==null&&(m instanceof HTMLImageElement?d.push(m):d.push(new au(m.data,m.width,m.height)))}i[f.uuid]=new Gf(d)}else{const d=a(f.url);i[f.uuid]=new Gf(d)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:np(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new ov(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const c=[];for(let f=0,h=u.length;f<h;f++){const d=u[f],p=await s(d);p!==null&&(p instanceof HTMLImageElement?c.push(p):c.push(new au(p.data,p.width,p.height)))}r[l.uuid]=new Gf(c)}else{const c=await s(l.url);r[l.uuid]=new Gf(c)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],u=l.data;let c;Array.isArray(u)?(c=new Vv,u.length===6&&(c.needsUpdate=!0)):(u&&u.data?c=new au:c=new vr,u&&(c.needsUpdate=!0)),c.source=l,c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=r(a.mapping,Tre)),a.channel!==void 0&&(c.channel=a.channel),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=r(a.wrap[0],mL),c.wrapT=r(a.wrap[1],mL)),a.format!==void 0&&(c.format=a.format),a.internalFormat!==void 0&&(c.internalFormat=a.internalFormat),a.type!==void 0&&(c.type=a.type),a.colorSpace!==void 0&&(c.colorSpace=a.colorSpace),a.encoding!==void 0&&(c.encoding=a.encoding),a.minFilter!==void 0&&(c.minFilter=r(a.minFilter,gL)),a.magFilter!==void 0&&(c.magFilter=r(a.magFilter,gL)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.generateMipmaps!==void 0&&(c.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(c.compareFunction=a.compareFunction),a.userData!==void 0&&(c.userData=a.userData),i[a.uuid]=c}return i}parseObject(e,t,r,i,s){let o;function a(h){return t[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const d=[];for(let p=0,y=h.length;p<y;p++){const x=h[p];r[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),d.push(r[x])}return d}return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),r[h]}}function u(h){return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),i[h]}let c,f;switch(e.type){case"Scene":o=new mu,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new it(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Pw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Rw(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new ti(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new qc(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new aV(e.color,e.intensity);break;case"DirectionalLight":o=new oV(e.color,e.intensity);break;case"PointLight":o=new sV(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new lV(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new iV(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new rV(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new cV().fromJSON(e);break;case"SkinnedMesh":c=a(e.geometry),f=l(e.material),o=new C8(c,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":c=a(e.geometry),f=l(e.material),o=new Qn(c,f);break;case"InstancedMesh":c=a(e.geometry),f=l(e.material);const h=e.count,d=e.instanceMatrix,p=e.instanceColor;o=new A8(c,f,h),o.instanceMatrix=new Yp(new Float32Array(d.array),16),p!==void 0&&(o.instanceColor=new Yp(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":c=a(e.geometry),f=l(e.material),o=new R8(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=c,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(y=>{const x=new Ts;x.min.fromArray(y.boxMin),x.max.fromArray(y.boxMax);const m=new ss;return m.radius=y.sphereRadius,m.center.fromArray(y.sphereCenter),{boxInitialized:y.boxInitialized,box:x,sphereInitialized:y.sphereInitialized,sphere:m}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":o=new T8;break;case"Line":o=new Lc(a(e.geometry),l(e.material));break;case"LineLoop":o=new P8(a(e.geometry),l(e.material));break;case"LineSegments":o=new Ua(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new I8(a(e.geometry),l(e.material));break;case"Sprite":o=new M8(l(e.material));break;case"Group":o=new sp;break;case"Bone":o=new FR;break;default:o=new Rn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let d=0;d<h.length;d++)o.add(this.parseObject(h[d],t,r,i,s))}if(e.animations!==void 0){const h=e.animations;for(let d=0;d<h.length;d++){const p=h[d];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let d=0;d<h.length;d++){const p=h[d],y=o.getObjectByProperty("uuid",p.object);y!==void 0&&o.addLevel(y,p.distance,p.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const Tre={UVMapping:Sw,CubeReflectionMapping:pu,CubeRefractionMapping:Ic,EquirectangularReflectionMapping:Vg,EquirectangularRefractionMapping:Wg,CubeUVReflectionMapping:mm},mL={RepeatWrapping:Hg,ClampToEdgeWrapping:Cr,MirroredRepeatWrapping:Gg},gL={NearestFilter:kr,NearestMipmapNearestFilter:u_,NearestMipmapLinearFilter:q0,LinearFilter:bn,LinearMipmapNearestFilter:pR,LinearMipmapLinearFilter:Dc};class Cre extends to{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=nu.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{i&&i(u)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return nu.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){i&&i(u),nu.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});nu.add(e,l),s.manager.itemStart(e)}}let ux;class YR{static getContext(){return ux===void 0&&(ux=new(window.AudioContext||window.webkitAudioContext)),ux}static setContext(e){ux=e}}class Are extends to{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new gu(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);YR.getContext().decodeAudioData(u,function(f){t(f)}).catch(a)}catch(u){a(u)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const vL=new Ht,yL=new Ht,vf=new Ht;class Rre{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ti,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ti,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,vf.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(nh*t.fov*.5)/t.zoom;let a,l;yL.elements[12]=-i,vL.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,vf.elements[0]=2*t.near/(l-a),vf.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(vf),a=-o*t.aspect-s,l=o*t.aspect-s,vf.elements[0]=2*t.near/(l-a),vf.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(vf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(yL),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(vL)}}class Kw{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=xL(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=xL();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function xL(){return(typeof performance>"u"?Date:performance).now()}const yf=new Q,_L=new Xs,Pre=new Q,xf=new Q;class Ire extends Rn{constructor(){super(),this.type="AudioListener",this.context=YR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Kw}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(yf,_L,Pre),xf.set(0,0,-1).applyQuaternion(_L),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(yf.x,i),t.positionY.linearRampToValueAtTime(yf.y,i),t.positionZ.linearRampToValueAtTime(yf.z,i),t.forwardX.linearRampToValueAtTime(xf.x,i),t.forwardY.linearRampToValueAtTime(xf.y,i),t.forwardZ.linearRampToValueAtTime(xf.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(yf.x,yf.y,yf.z),t.setOrientation(xf.x,xf.y,xf.z,r.x,r.y,r.z)}}class dV extends Rn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const _f=new Q,wL=new Xs,Dre=new Q,wf=new Q;class Nre extends dV{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_f,wL,Dre),wf.set(0,0,1).applyQuaternion(wL);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(_f.x,r),t.positionY.linearRampToValueAtTime(_f.y,r),t.positionZ.linearRampToValueAtTime(_f.z,r),t.orientationX.linearRampToValueAtTime(wf.x,r),t.orientationY.linearRampToValueAtTime(wf.y,r),t.orientationZ.linearRampToValueAtTime(wf.z,r)}else t.setPosition(_f.x,_f.y,_f.z),t.setOrientation(wf.x,wf.y,wf.z)}}class kre{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class pV{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,u=t+t;l!==u;++l)if(r[l]!==r[l+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Xs.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Xs.multiplyQuaternionsFlat(e,o,e,t,e,r),Xs.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const KR="\\[\\]\\.:\\/",Lre=new RegExp("["+KR+"]","g"),ZR="[^"+KR+"]",Fre="[^"+KR.replace("\\.","")+"]",Ore=/((?:WC+[\/:])*)/.source.replace("WC",ZR),Bre=/(WCOD+)?/.source.replace("WCOD",Fre),Ure=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ZR),zre=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ZR),Vre=new RegExp("^"+Ore+Bre+Ure+zre+"$"),Wre=["material","materials","bones","map"];class Hre{constructor(e,t,r){const i=r||wn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class wn{constructor(e,t,r){this.path=t,this.parsedPath=r||wn.parseTrackName(t),this.node=wn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new wn.Composite(e,t,r):new wn(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Lre,"")}static parseTrackName(e){const t=Vre.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);Wre.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=wn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[i];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}wn.Composite=Hre;wn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};wn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};wn.prototype.GetterByBindingType=[wn.prototype._getValue_direct,wn.prototype._getValue_array,wn.prototype._getValue_arrayElement,wn.prototype._getValue_toArray];wn.prototype.SetterByBindingTypeAndVersioning=[[wn.prototype._setValue_direct,wn.prototype._setValue_direct_setNeedsUpdate,wn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_array,wn.prototype._setValue_array_setNeedsUpdate,wn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_arrayElement,wn.prototype._setValue_arrayElement_setNeedsUpdate,wn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_fromArray,wn.prototype._setValue_fromArray_setNeedsUpdate,wn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Gre{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Co(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let c=0,f=arguments.length;c!==f;++c){const h=arguments[c],d=h.uuid;let p=t[d];if(p===void 0){p=l++,t[d]=p,e.push(h);for(let y=0,x=o;y!==x;++y)s[y].push(new wn(h,r[y],i[y]))}else if(p<u){a=e[p];const y=--u,x=e[y];t[x.uuid]=p,e[p]=x,t[d]=y,e[y]=h;for(let m=0,_=o;m!==_;++m){const w=s[m],b=w[y];let S=w[p];w[p]=b,S===void 0&&(S=new wn(h,r[m],i[m])),w[y]=S}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,c=t[u];if(c!==void 0&&c>=s){const f=s++,h=e[f];t[h.uuid]=c,e[c]=h,t[u]=f,e[f]=l;for(let d=0,p=i;d!==p;++d){const y=r[d],x=y[f],m=y[c];y[c]=x,y[f]=m}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],c=u.uuid,f=t[c];if(f!==void 0)if(delete t[c],f<s){const h=--s,d=e[h],p=--o,y=e[p];t[d.uuid]=f,e[f]=d,t[y.uuid]=h,e[h]=y,e.pop();for(let x=0,m=i;x!==m;++x){const _=r[x],w=_[h],b=_[p];_[f]=w,_[h]=b,_.pop()}}else{const h=--o,d=e[h];h>0&&(t[d.uuid]=f),e[f]=d,e.pop();for(let p=0,y=i;p!==y;++p){const x=r[p];x[f]=x[h],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,c=this.nCachedObjects_,f=new Array(u);i=s.length,r[e]=i,o.push(e),a.push(t),s.push(f);for(let h=c,d=l.length;h!==d;++h){const p=l[h];f[h]=new wn(p,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];t[u]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class mV{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Wf,endingEnd:Wf};for(let u=0;u!==o;++u){const c=s[u].createInterpolant(null);a[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Kz,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+r,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case bR:for(let c=0,f=l.length;c!==f;++c)l[c].evaluate(o),u[c].accumulateAdditive(a);break;case Mw:default:for(let c=0,f=l.length;c!==f;++c)l[c].evaluate(o),u[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===Zz;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===Yz){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=Hf,i.endingEnd=Hf):(e?i.endingStart=this.zeroSlopeAtStart?Hf:Wf:i.endingStart=$g,t?i.endingEnd=this.zeroSlopeAtEnd?Hf:Wf:i.endingEnd=$g)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=r,this}}const jre=new Float32Array(1);class Xre extends da{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let f=0;f!==s;++f){const h=i[f],d=h.name;let p=c[d];if(p!==void 0)++p.referenceCount,o[f]=p;else{if(p=o[f],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,d));continue}const y=t&&t._propertyBindings[f].binding.parsedPath;p=new pV(wn.create(r,d,y),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,d),o[f]=p}a[f].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete f[h],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],u=e._cacheIndex;l._cacheIndex=u,t[u]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new jR(new Float32Array(2),new Float32Array(2),1,jre),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?sv.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(r===void 0&&(o!==null?r=o.blendMode:r=Mw),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const c=new mV(this,o,t,r);return this._bindAction(c,u),this._addInactiveAction(c,a,s),c}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?sv.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==r;++u)t[u]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const c=u._cacheIndex,f=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,f._cacheIndex=c,t[c]=f,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class yn{constructor(e){this.value=e}clone(){return new yn(this.value.clone===void 0?this.value:this.value.clone())}}let $re=0;class qre extends da{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:$re++}),this.name="",this.usage=Zg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Yre extends Iw{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Kre{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class gV{constructor(e,t,r=0,i=1/0){this.ray=new vm(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new rh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return VT(e,this,r,t),r.sort(bL),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)VT(e[i],this,r,t);return r.sort(bL),r}}function bL(n,e){return n.distance-e.distance}function VT(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)VT(i[s],e,t,!0)}}class Zre{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Tr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Jre{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const SL=new Me;class Qre{constructor(e=new Me(1/0,1/0),t=new Me(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=SL.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,SL).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const EL=new Q,cx=new Q;class eie{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){EL.subVectors(e,this.start),cx.subVectors(this.end,this.start);const r=cx.dot(cx);let s=cx.dot(EL)/r;return t&&(s=Tr(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ML=new Q;class tie extends Rn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new qt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,c=a/l*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new St(i,3));const s=new Rs({fog:!1,toneMapped:!1});this.cone=new Ua(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),ML.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ML),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ju=new Q,fx=new Ht,OE=new Ht;class nie extends Ua{constructor(e){const t=vV(e),r=new qt,i=[],s=[],o=new it(0,0,1),a=new it(0,1,0);for(let u=0;u<t.length;u++){const c=t[u];c.parent&&c.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new St(i,3)),r.setAttribute("color",new St(s,3));const l=new Rs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");OE.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(fx.multiplyMatrices(OE,a.matrixWorld),ju.setFromMatrixPosition(fx),i.setXYZ(o,ju.x,ju.y,ju.z),fx.multiplyMatrices(OE,a.parent.matrixWorld),ju.setFromMatrixPosition(fx),i.setXYZ(o+1,ju.x,ju.y,ju.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function vV(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,vV(n.children[t]));return e}class rie extends Qn{constructor(e,t,r){const i=new Xv(t,4,2),s=new $c({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const iie=new Q,TL=new it,CL=new it;class sie extends Rn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new jv(t);i.rotateY(Math.PI*.5),this.material=new $c({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new vn(o,3)),this.add(new Qn(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");TL.copy(this.light.color),CL.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?TL:CL;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(iie.setFromMatrixPosition(this.light.matrixWorld).negate())}}class oie extends Ua{constructor(e=10,t=10,r=4473924,i=8947848){r=new it(r),i=new it(i);const s=t/2,o=e/t,a=e/2,l=[],u=[];for(let h=0,d=0,p=-a;h<=t;h++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const y=h===s?r:i;y.toArray(u,d),d+=3,y.toArray(u,d),d+=3,y.toArray(u,d),d+=3,y.toArray(u,d),d+=3}const c=new qt;c.setAttribute("position",new St(l,3)),c.setAttribute("color",new St(u,3));const f=new Rs({vertexColors:!0,toneMapped:!1});super(c,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class aie extends Ua{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new it(s),o=new it(o);const a=[],l=[];if(t>1)for(let f=0;f<t;f++){const h=f/t*(Math.PI*2),d=Math.sin(h)*e,p=Math.cos(h)*e;a.push(0,0,0),a.push(d,0,p);const y=f&1?s:o;l.push(y.r,y.g,y.b),l.push(y.r,y.g,y.b)}for(let f=0;f<r;f++){const h=f&1?s:o,d=e-e/r*f;for(let p=0;p<i;p++){let y=p/i*(Math.PI*2),x=Math.sin(y)*d,m=Math.cos(y)*d;a.push(x,0,m),l.push(h.r,h.g,h.b),y=(p+1)/i*(Math.PI*2),x=Math.sin(y)*d,m=Math.cos(y)*d,a.push(x,0,m),l.push(h.r,h.g,h.b)}}const u=new qt;u.setAttribute("position",new St(a,3)),u.setAttribute("color",new St(l,3));const c=new Rs({vertexColors:!0,toneMapped:!1});super(u,c),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const AL=new Q,hx=new Q,RL=new Q;class lie extends Rn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new qt;i.setAttribute("position",new St([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Rs({fog:!1,toneMapped:!1});this.lightPlane=new Lc(i,s),this.add(this.lightPlane),i=new qt,i.setAttribute("position",new St([0,0,0,0,0,1],3)),this.targetLine=new Lc(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),AL.setFromMatrixPosition(this.light.matrixWorld),hx.setFromMatrixPosition(this.light.target.matrixWorld),RL.subVectors(hx,AL),this.lightPlane.lookAt(hx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(hx),this.targetLine.scale.z=RL.length()}}const dx=new Q,br=new _h;class uie extends Ua{constructor(e){const t=new qt,r=new Rs({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,y){l(p),l(y)}function l(p){i.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(i.length/3-1)}t.setAttribute("position",new St(i,3)),t.setAttribute("color",new St(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new it(16755200),c=new it(16711680),f=new it(43775),h=new it(16777215),d=new it(3355443);this.setColors(u,c,f,h,d)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;br.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ir("c",t,e,br,0,0,-1),Ir("t",t,e,br,0,0,1),Ir("n1",t,e,br,-r,-i,-1),Ir("n2",t,e,br,r,-i,-1),Ir("n3",t,e,br,-r,i,-1),Ir("n4",t,e,br,r,i,-1),Ir("f1",t,e,br,-r,-i,1),Ir("f2",t,e,br,r,-i,1),Ir("f3",t,e,br,-r,i,1),Ir("f4",t,e,br,r,i,1),Ir("u1",t,e,br,r*.7,i*1.1,-1),Ir("u2",t,e,br,-r*.7,i*1.1,-1),Ir("u3",t,e,br,0,i*2,-1),Ir("cf1",t,e,br,-r,0,1),Ir("cf2",t,e,br,r,0,1),Ir("cf3",t,e,br,0,-i,1),Ir("cf4",t,e,br,0,i,1),Ir("cn1",t,e,br,-r,0,-1),Ir("cn2",t,e,br,r,0,-1),Ir("cn3",t,e,br,0,-i,-1),Ir("cn4",t,e,br,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ir(n,e,t,r,i,s,o){dx.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],dx.x,dx.y,dx.z)}}const px=new Ts;class cie extends Ua{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new qt;s.setIndex(new vn(r,1)),s.setAttribute("position",new vn(i,3)),super(s,new Rs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&px.setFromObject(this.object),px.isEmpty())return;const t=px.min,r=px.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class fie extends Ua{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new qt;s.setIndex(new vn(r,1)),s.setAttribute("position",new St(i,3)),super(s,new Rs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class hie extends Lc{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new qt;o.setAttribute("position",new St(s,3)),o.computeBoundingSphere(),super(o,new Rs({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new qt;l.setAttribute("position",new St(a,3)),l.computeBoundingSphere(),this.add(new Qn(l,new $c({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const PL=new Q;let mx,BE;class die extends Rn{constructor(e=new Q(0,0,1),t=new Q(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",mx===void 0&&(mx=new qt,mx.setAttribute("position",new St([0,0,0,0,1,0],3)),BE=new _m(0,.5,1,5,1),BE.translate(0,-.5,0)),this.position.copy(t),this.line=new Lc(mx,new Rs({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qn(BE,new $c({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{PL.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(PL,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class pie extends Ua{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new qt;i.setAttribute("position",new St(t,3)),i.setAttribute("color",new St(r,3));const s=new Rs({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new it,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mie{constructor(){this.type="ShapePath",this.color=new it,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Qg,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(m){const _=[];for(let w=0,b=m.length;w<b;w++){const S=m[w],M=new ih;M.curves=S.curves,_.push(M)}return _}function r(m,_){const w=_.length;let b=!1;for(let S=w-1,M=0;M<w;S=M++){let T=_[S],P=_[M],C=P.x-T.x,A=P.y-T.y;if(Math.abs(A)>Number.EPSILON){if(A<0&&(T=_[M],C=-C,P=_[S],A=-A),m.y<T.y||m.y>P.y)continue;if(m.y===T.y){if(m.x===T.x)return!0}else{const k=A*(m.x-T.x)-C*(m.y-T.y);if(k===0)return!0;if(k<0)continue;b=!b}}else{if(m.y!==T.y)continue;if(P.x<=m.x&&m.x<=T.x||T.x<=m.x&&m.x<=P.x)return!0}}return b}const i=xl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new ih,l.curves=a.curves,u.push(l),u;let c=!i(s[0].getPoints());c=e?!c:c;const f=[],h=[];let d=[],p=0,y;h[p]=void 0,d[p]=[];for(let m=0,_=s.length;m<_;m++)a=s[m],y=a.getPoints(),o=i(y),o=e?!o:o,o?(!c&&h[p]&&p++,h[p]={s:new ih,p:y},h[p].s.curves=a.curves,c&&p++,d[p]=[]):d[p].push({h:a,p:y[0]});if(!h[0])return t(s);if(h.length>1){let m=!1,_=0;for(let w=0,b=h.length;w<b;w++)f[w]=[];for(let w=0,b=h.length;w<b;w++){const S=d[w];for(let M=0;M<S.length;M++){const T=S[M];let P=!0;for(let C=0;C<h.length;C++)r(T.p,h[C].p)&&(w!==C&&_++,P?(P=!1,f[C].push(T)):m=!0);P&&f[w].push(T)}}_>0&&m===!1&&(d=f)}let x;for(let m=0,_=h.length;m<_;m++){l=h[m].s,u.push(l),x=d[m];for(let w=0,b=x.length;w<b;w++)l.holes.push(x[w].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:pm}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=pm);const gie=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:dR,AddEquation:nc,AddOperation:kz,AdditiveAnimationBlendMode:bR,AdditiveBlending:o_,AgXToneMapping:Uz,AlphaFormat:Hz,AlwaysCompare:o8,AlwaysDepth:hR,AlwaysStencilFunc:IT,AmbientLight:aV,AnimationAction:mV,AnimationClip:sv,AnimationLoader:yre,AnimationMixer:Xre,AnimationObjectGroup:Gre,AnimationUtils:pre,ArcCurve:D8,ArrayCamera:b8,ArrowHelper:die,AttachedBindMode:sT,Audio:dV,AudioAnalyser:kre,AudioContext:YR,AudioListener:Ire,AudioLoader:Are,AxesHelper:pie,BackSide:ri,BasicDepthPacking:gm,BasicShadowMap:cz,BatchedMesh:R8,Bone:FR,BooleanKeyframeTrack:Dh,Box2:Qre,Box3:Ts,Box3Helper:fie,BoxGeometry:Ih,BoxHelper:cie,BufferAttribute:vn,BufferGeometry:qt,BufferGeometryLoader:hV,ByteType:Vz,Cache:nu,Camera:_h,CameraHelper:uie,CanvasTexture:Bne,CapsuleGeometry:Lw,CatmullRomCurve3:N8,CineonToneMapping:Oz,CircleGeometry:Fw,ClampToEdgeWrapping:Cr,Clock:Kw,Color:it,ColorKeyframeTrack:XR,ColorManagement:Fn,CompressedArrayTexture:Fne,CompressedCubeTexture:One,CompressedTexture:Nw,CompressedTextureLoader:xre,ConeGeometry:Ow,ConstantAlphaFactor:Mz,ConstantColorFactor:Sz,CubeCamera:d8,CubeReflectionMapping:pu,CubeRefractionMapping:Ic,CubeTexture:Vv,CubeTextureLoader:_re,CubeUVReflectionMapping:mm,CubicBezierCurve:UR,CubicBezierCurve3:k8,CubicInterpolant:J8,CullFaceBack:eT,CullFaceFront:uz,CullFaceFrontBack:TK,CullFaceNone:lz,Curve:za,CurvePath:F8,CustomBlending:fz,CustomToneMapping:Bz,CylinderGeometry:_m,Cylindrical:Jre,Data3DTexture:CR,DataArrayTexture:Cw,DataTexture:au,DataTextureLoader:wre,DataUtils:LZ,DecrementStencilOp:BK,DecrementWrapStencilOp:zK,DefaultLoadingManager:tV,DepthFormat:_c,DepthStencilFormat:kc,DepthTexture:Hv,DetachedBindMode:zz,DirectionalLight:oV,DirectionalLightHelper:lie,DiscreteInterpolant:Q8,DisplayP3ColorSpace:Tw,DodecahedronGeometry:Bw,DoubleSide:xs,DstAlphaFactor:yz,DstColorFactor:_z,DynamicCopyUsage:tZ,DynamicDrawUsage:YK,DynamicReadUsage:JK,EdgesGeometry:O8,EllipseCurve:kw,EqualCompare:n8,EqualDepth:Rz,EqualStencilFunc:GK,EquirectangularReflectionMapping:Vg,EquirectangularRefractionMapping:Wg,Euler:AR,EventDispatcher:da,ExtrudeGeometry:zw,FileLoader:gu,Float16BufferAttribute:VZ,Float32BufferAttribute:St,Float64BufferAttribute:WZ,FloatType:zs,Fog:Pw,FogExp2:Rw,FramebufferTexture:Lne,FrontSide:Tl,Frustum:Wv,GLBufferAttribute:Kre,GLSL1:rZ,GLSL3:DT,GreaterCompare:r8,GreaterDepth:Iz,GreaterEqualCompare:s8,GreaterEqualDepth:Pz,GreaterEqualStencilFunc:qK,GreaterStencilFunc:XK,GridHelper:oie,Group:sp,HalfFloatType:Nc,HemisphereLight:rV,HemisphereLightHelper:sie,IcosahedronGeometry:Vw,ImageBitmapLoader:Cre,ImageLoader:ov,ImageUtils:TR,IncrementStencilOp:OK,IncrementWrapStencilOp:UK,InstancedBufferAttribute:Yp,InstancedBufferGeometry:fV,InstancedInterleavedBuffer:Yre,InstancedMesh:A8,Int16BufferAttribute:UZ,Int32BufferAttribute:zZ,Int8BufferAttribute:FZ,IntType:mR,InterleavedBuffer:Iw,InterleavedBufferAttribute:wh,Interpolant:$v,InterpolateDiscrete:jg,InterpolateLinear:Xg,InterpolateSmooth:y2,InvertStencilOp:VK,KeepStencilOp:Af,KeyframeTrack:Va,LOD:T8,LatheGeometry:Gv,Layers:rh,LessCompare:t8,LessDepth:Az,LessEqualCompare:ER,LessEqualDepth:zg,LessEqualStencilFunc:jK,LessStencilFunc:HK,Light:Kc,LightProbe:cV,Line:Lc,Line3:eie,LineBasicMaterial:Rs,LineCurve:zR,LineCurve3:L8,LineDashedMaterial:Y8,LineLoop:P8,LineSegments:Ua,LinearDisplayP3ColorSpace:zv,LinearEncoding:SR,LinearFilter:bn,LinearInterpolant:jR,LinearMipMapLinearFilter:IK,LinearMipMapNearestFilter:PK,LinearMipmapLinearFilter:Dc,LinearMipmapNearestFilter:pR,LinearSRGBColorSpace:fa,LinearToneMapping:Lz,LinearTransfer:qg,Loader:to,LoaderUtils:zT,LoadingManager:$R,LoopOnce:Yz,LoopPingPong:Zz,LoopRepeat:Kz,LuminanceAlphaFormat:jz,LuminanceFormat:Gz,MOUSE:EK,Material:Mi,MaterialLoader:Yw,MathUtils:uo,Matrix3:en,Matrix4:Ht,MaxEquation:iT,Mesh:Qn,MeshBasicMaterial:$c,MeshDepthMaterial:NR,MeshDistanceMaterial:kR,MeshLambertMaterial:$8,MeshMatcapMaterial:q8,MeshNormalMaterial:X8,MeshPhongMaterial:G8,MeshPhysicalMaterial:H8,MeshStandardMaterial:qw,MeshToonMaterial:j8,MinEquation:rT,MirroredRepeatWrapping:Gg,MixOperation:Nz,MultiplyBlending:nT,MultiplyOperation:Uv,NearestFilter:kr,NearestMipMapLinearFilter:RK,NearestMipMapNearestFilter:AK,NearestMipmapLinearFilter:q0,NearestMipmapNearestFilter:u_,NeverCompare:e8,NeverDepth:Cz,NeverStencilFunc:WK,NoBlending:Ms,NoColorSpace:_s,NoToneMapping:ka,NormalAnimationBlendMode:Mw,NormalBlending:th,NotEqualCompare:i8,NotEqualDepth:Dz,NotEqualStencilFunc:$K,NumberKeyframeTrack:rv,Object3D:Rn,ObjectLoader:Mre,ObjectSpaceNormalMap:Qz,OctahedronGeometry:jv,OneFactor:mz,OneMinusConstantAlphaFactor:Tz,OneMinusConstantColorFactor:Ez,OneMinusDstAlphaFactor:xz,OneMinusDstColorFactor:wz,OneMinusSrcAlphaFactor:l_,OneMinusSrcColorFactor:vz,OrthographicCamera:qc,P3Primaries:Kg,PCFShadowMap:bw,PCFSoftShadowMap:$0,PMREMGenerator:kT,Path:Qg,PerspectiveCamera:ti,Plane:Qu,PlaneGeometry:yl,PlaneHelper:hie,PointLight:sV,PointLightHelper:rie,Points:I8,PointsMaterial:OR,PolarGridHelper:aie,PolyhedronGeometry:Yc,PositionalAudio:Nre,PropertyBinding:wn,PropertyMixer:pV,QuadraticBezierCurve:VR,QuadraticBezierCurve3:WR,Quaternion:Xs,QuaternionKeyframeTrack:wm,QuaternionLinearInterpolant:eV,RED_GREEN_RGTC2_Format:RT,RED_RGTC1_Format:qz,REVISION:pm,RGBADepthPacking:Jz,RGBAFormat:ki,RGBAIntegerFormat:_R,RGBA_ASTC_10x10_Format:ST,RGBA_ASTC_10x5_Format:_T,RGBA_ASTC_10x6_Format:wT,RGBA_ASTC_10x8_Format:bT,RGBA_ASTC_12x10_Format:ET,RGBA_ASTC_12x12_Format:MT,RGBA_ASTC_4x4_Format:hT,RGBA_ASTC_5x4_Format:dT,RGBA_ASTC_5x5_Format:pT,RGBA_ASTC_6x5_Format:mT,RGBA_ASTC_6x6_Format:gT,RGBA_ASTC_8x5_Format:vT,RGBA_ASTC_8x6_Format:yT,RGBA_ASTC_8x8_Format:xT,RGBA_BPTC_Format:v2,RGBA_ETC2_EAC_Format:fT,RGBA_PVRTC_2BPPV1_Format:uT,RGBA_PVRTC_4BPPV1_Format:lT,RGBA_S3TC_DXT1_Format:p2,RGBA_S3TC_DXT3_Format:m2,RGBA_S3TC_DXT5_Format:g2,RGB_BPTC_SIGNED_Format:TT,RGB_BPTC_UNSIGNED_Format:CT,RGB_ETC1_Format:wR,RGB_ETC2_Format:cT,RGB_PVRTC_2BPPV1_Format:aT,RGB_PVRTC_4BPPV1_Format:oT,RGB_S3TC_DXT1_Format:d2,RGFormat:$z,RGIntegerFormat:xR,RawShaderMaterial:ap,Ray:vm,Raycaster:gV,Rec709Primaries:Yg,RectAreaLight:lV,RedFormat:Xz,RedIntegerFormat:yR,ReinhardToneMapping:Fz,RenderTarget:u8,RepeatWrapping:Hg,ReplaceStencilOp:FK,ReverseSubtractEquation:dz,RingGeometry:Ww,SIGNED_RED_GREEN_RGTC2_Format:PT,SIGNED_RED_RGTC1_Format:AT,SRGBColorSpace:mn,SRGBTransfer:Gn,Scene:mu,ShaderChunk:Kt,ShaderLib:Ko,ShaderMaterial:$r,ShadowMaterial:W8,Shape:ih,ShapeGeometry:Hw,ShapePath:mie,ShapeUtils:xl,ShortType:Wz,Skeleton:Dw,SkeletonHelper:nie,SkinnedMesh:C8,Source:Gf,Sphere:ss,SphereGeometry:Xv,Spherical:Zre,SphericalHarmonics3:uV,SplineCurve:HR,SpotLight:iV,SpotLightHelper:tie,Sprite:M8,SpriteMaterial:LR,SrcAlphaFactor:a_,SrcAlphaSaturateFactor:bz,SrcColorFactor:gz,StaticCopyUsage:eZ,StaticDrawUsage:Zg,StaticReadUsage:ZK,StereoCamera:Rre,StreamCopyUsage:nZ,StreamDrawUsage:KK,StreamReadUsage:QK,StringKeyframeTrack:Nh,SubtractEquation:hz,SubtractiveBlending:tT,TOUCH:MK,TangentSpaceNormalMap:Xc,TetrahedronGeometry:Gw,Texture:vr,TextureLoader:nV,TorusGeometry:jw,TorusKnotGeometry:Xw,Triangle:jf,TriangleFanDrawMode:kK,TriangleStripDrawMode:NK,TrianglesDrawMode:DK,TubeGeometry:$w,TwoPassDoubleSide:CK,UVMapping:Sw,Uint16BufferAttribute:RR,Uint32BufferAttribute:PR,Uint8BufferAttribute:OZ,Uint8ClampedBufferAttribute:BZ,Uniform:yn,UniformsGroup:qre,UniformsLib:et,UniformsUtils:IR,UnsignedByteType:Oi,UnsignedInt248Type:ou,UnsignedIntType:fl,UnsignedShort4444Type:gR,UnsignedShort5551Type:vR,UnsignedShortType:Ew,VSMShadowMap:Ma,Vector2:Me,Vector3:Q,Vector4:Sn,VectorKeyframeTrack:iv,VideoTexture:kne,WebGL1Renderer:S8,WebGL3DRenderTarget:SZ,WebGLArrayRenderTarget:bZ,WebGLCoordinateSystem:Ra,WebGLCubeRenderTarget:p8,WebGLMultipleRenderTargets:EZ,WebGLRenderTarget:Br,WebGLRenderer:xm,WebGLUtils:w8,WebGPUCoordinateSystem:Xp,WireframeGeometry:V8,WrapAroundEnding:$g,ZeroCurvatureEnding:Wf,ZeroFactor:pz,ZeroSlopeEnding:Hf,ZeroStencilOp:LK,_SRGBAFormat:c_,createCanvasElement:l8,sRGBEncoding:wc},Symbol.toStringTag,{value:"Module"})),vie=`
uniform float time;
varying vec2 vUv;
varying vec3 vPosition;

void main() {
  vUv = uv;
  vPosition = position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,yie=`
uniform sampler2D uDataTexture;
uniform sampler2D uTexture;
uniform vec4 resolution;
varying vec2 vUv;

void main() {
  vec2 uv = vUv;
  vec4 offset = texture2D(uDataTexture, vUv);
  gl_FragColor = texture2D(uTexture, uv - 0.02 * offset.rg);
}`,xie=({grid:n=15,mouse:e=.1,strength:t=.15,relaxation:r=.9,imageSrc:i,className:s=""})=>{const o=U.useRef(null),a=U.useRef(null),l=U.useRef(null),u=U.useRef(null),c=U.useRef(null),f=U.useRef(1),h=U.useRef(null),d=U.useRef(null);return U.useEffect(()=>{if(!o.current)return;const p=o.current,y=new mu;a.current=y;const x=new xm({antialias:!0,alpha:!0,powerPreference:"high-performance"});x.setPixelRatio(Math.min(window.devicePixelRatio,2)),x.setClearColor(0,0),l.current=x,p.innerHTML="",p.appendChild(x.domElement);const m=new qc(0,0,0,0,-1e3,1e3);m.position.z=2,u.current=m;const _={time:{value:0},resolution:{value:new Sn},uTexture:{value:null},uDataTexture:{value:null}};new nV().load(i,V=>{V.minFilter=bn,V.magFilter=bn,V.wrapS=Cr,V.wrapT=Cr,f.current=V.image.width/V.image.height,_.uTexture.value=V,A()});const b=n,S=new Float32Array(4*b*b);for(let V=0;V<b*b;V++)S[V*4]=Math.random()*255-125,S[V*4+1]=Math.random()*255-125;const M=new au(S,b,b,ki,zs);M.needsUpdate=!0,_.uDataTexture.value=M;const T=new $r({side:xs,uniforms:_,vertexShader:vie,fragmentShader:yie,transparent:!0}),P=new yl(1,1,b-1,b-1),C=new Qn(P,T);c.current=C,y.add(C);const A=()=>{if(!p||!x||!m)return;const V=p.getBoundingClientRect(),W=V.width,G=V.height;if(W===0||G===0)return;const N=W/G;x.setSize(W,G),C&&C.scale.set(N,1,1);const B=1,D=B*N;m.left=-D/2,m.right=D/2,m.top=B/2,m.bottom=-B/2,m.updateProjectionMatrix(),_.resolution.value.set(W,G,1,1)};if(window.ResizeObserver){const V=new ResizeObserver(()=>{A()});V.observe(p),d.current=V}else window.addEventListener("resize",A);const k={x:0,y:0,prevX:0,prevY:0,vX:0,vY:0},L=V=>{const W=p.getBoundingClientRect(),G=(V.clientX-W.left)/W.width,N=1-(V.clientY-W.top)/W.height;k.vX=G-k.prevX,k.vY=N-k.prevY,Object.assign(k,{x:G,y:N,prevX:G,prevY:N})},H=()=>{M&&(M.needsUpdate=!0),Object.assign(k,{x:0,y:0,prevX:0,prevY:0,vX:0,vY:0})};p.addEventListener("mousemove",L),p.addEventListener("mouseleave",H),A();const F=()=>{if(h.current=requestAnimationFrame(F),!x||!y||!m)return;_.time.value+=.05;const V=M.image.data;for(let B=0;B<b*b;B++)V[B*4]*=r,V[B*4+1]*=r;const W=b*k.x,G=b*k.y,N=b*e;for(let B=0;B<b;B++)for(let D=0;D<b;D++){const $=Math.pow(W-B,2)+Math.pow(G-D,2);if($<N*N){const ee=4*(B+b*D),te=Math.min(N/Math.sqrt($),10);V[ee]+=t*100*k.vX*te,V[ee+1]-=t*100*k.vY*te}}M.needsUpdate=!0,x.render(y,m)};return F(),()=>{h.current&&cancelAnimationFrame(h.current),d.current?d.current.disconnect():window.removeEventListener("resize",A),p.removeEventListener("mousemove",L),p.removeEventListener("mouseleave",H),x&&(x.dispose(),p.contains(x.domElement)&&p.removeChild(x.domElement)),P&&P.dispose(),T&&T.dispose(),M&&M.dispose(),_.uTexture.value&&_.uTexture.value.dispose(),a.current=null,l.current=null,u.current=null,c.current=null}},[n,e,t,r,i]),z.jsx("div",{ref:o,className:`relative overflow-hidden ${s}`,style:{width:"100%",height:"100%",minWidth:"0",minHeight:"0"}})};function ql(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function yV(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Ao={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Kp={duration:.5,overwrite:!1,delay:0},JR,Bi,rr,na=1e8,Wn=1/na,WT=Math.PI*2,_ie=WT/4,wie=0,xV=Math.sqrt,bie=Math.cos,Sie=Math.sin,Si=function(e){return typeof e=="string"},Ar=function(e){return typeof e=="function"},vu=function(e){return typeof e=="number"},QR=function(e){return typeof e>"u"},Cl=function(e){return typeof e=="object"},$s=function(e){return e!==!1},eP=function(){return typeof window<"u"},gx=function(e){return Ar(e)||Si(e)},_V=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},os=Array.isArray,Eie=/random\([^)]+\)/g,Mie=/,\s*/g,IL=/(?:-?\.?\d|\.)+/gi,wV=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,lp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,UE=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,bV=/[+-]=-?[.\d]+/,Tie=/[^,'"\[\]\s]+/gi,Cie=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ur,il,HT,tP,Io={},d_={},SV,EV=function(e){return(d_=Zp(e,Io))&&Js},nP=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},av=function(e,t){return!t&&console.warn(e)},MV=function(e,t){return e&&(Io[e]=t)&&d_&&(d_[e]=t)||Io},lv=function(){return 0},Aie={suppressEvents:!0,isStart:!0,kill:!1},_2={suppressEvents:!0,kill:!1},Rie={suppressEvents:!0},rP={},bc=[],GT={},TV,po={},zE={},DL=30,w2=[],iP="",sP=function(e){var t=e[0],r,i;if(Cl(t)||Ar(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(i=w2.length;i--&&!w2[i].targetTest(t););r=w2[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new KV(e[i],r)))||e.splice(i,1);return e},sh=function(e){return e._gsap||sP(ra(e))[0]._gsap},CV=function(e,t,r){return(r=e[t])&&Ar(r)?e[t]():QR(r)&&e.getAttribute&&e.getAttribute(t)||r},qs=function(e,t){return(e=e.split(",")).forEach(t)||e},Nr=function(e){return Math.round(e*1e5)/1e5||0},ar=function(e){return Math.round(e*1e7)/1e7||0},Ep=function(e,t){var r=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),r==="+"?e+i:r==="-"?e-i:r==="*"?e*i:e/i},Pie=function(e,t){for(var r=t.length,i=0;e.indexOf(t[i])<0&&++i<r;);return i<r},p_=function(){var e=bc.length,t=bc.slice(0),r,i;for(GT={},bc.length=0,r=0;r<e;r++)i=t[r],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},oP=function(e){return!!(e._initted||e._startAt||e.add)},AV=function(e,t,r,i){bc.length&&!Bi&&p_(),e.render(t,r,!!(Bi&&t<0&&oP(e))),bc.length&&!Bi&&p_()},RV=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Tie).length<2?t:Si(e)?e.trim():e},PV=function(e){return e},Do=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},Iie=function(e){return function(t,r){for(var i in r)i in t||i==="duration"&&e||i==="ease"||(t[i]=r[i])}},Zp=function(e,t){for(var r in t)e[r]=t[r];return e},NL=function n(e,t){for(var r in t)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(e[r]=Cl(t[r])?n(e[r]||(e[r]={}),t[r]):t[r]);return e},m_=function(e,t){var r={},i;for(i in e)i in t||(r[i]=e[i]);return r},Q0=function(e){var t=e.parent||ur,r=e.keyframes?Iie(os(e.keyframes)):Do;if($s(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},Die=function(e,t){for(var r=e.length,i=r===t.length;i&&r--&&e[r]===t[r];);return r<0},IV=function(e,t,r,i,s){var o=e[i],a;if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[i]=t,t._prev=o,t.parent=t._dp=e,t},Zw=function(e,t,r,i){r===void 0&&(r="_first"),i===void 0&&(i="_last");var s=t._prev,o=t._next;s?s._next=o:e[r]===t&&(e[r]=o),o?o._prev=s:e[i]===t&&(e[i]=s),t._next=t._prev=t.parent=null},Fc=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},oh=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},Nie=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},jT=function(e,t,r,i){return e._startAt&&(Bi?e._startAt.revert(_2):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},kie=function n(e){return!e||e._ts&&n(e.parent)},kL=function(e){return e._repeat?Jp(e._tTime,e=e.duration()+e._rDelay)*e:0},Jp=function(e,t){var r=Math.floor(e=ar(e/t));return e&&r===e?r-1:r},g_=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Jw=function(e){return e._end=ar(e._start+(e._tDur/Math.abs(e._ts||e._rts||Wn)||0))},Qw=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=ar(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Jw(e),r._dirty||oh(r,e)),e},DV=function(e,t){var r;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(r=g_(e.rawTime(),t),(!t._dur||qv(0,t.totalDuration(),r)-t._tTime>Wn)&&t.render(r,!0)),oh(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-Wn}},ll=function(e,t,r,i){return t.parent&&Fc(t),t._start=ar((vu(r)?r:r||e!==ur?Xo(e,r,t):e._time)+t._delay),t._end=ar(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),IV(e,t,"_first","_last",e._sort?"_start":0),XT(t)||(e._recent=t),i||DV(e,t),e._ts<0&&Qw(e,e._tTime),e},NV=function(e,t){return(Io.ScrollTrigger||nP("scrollTrigger",t))&&Io.ScrollTrigger.create(t,e)},kV=function(e,t,r,i,s){if(lP(e,t,s),!e._initted)return 1;if(!r&&e._pt&&!Bi&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&TV!==yo.frame)return bc.push(e),e._lazy=[s,i],1},Lie=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},XT=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},Fie=function(e,t,r,i){var s=e.ratio,o=t<0||!t&&(!e._start&&Lie(e)&&!(!e._initted&&XT(e))||(e._ts<0||e._dp._ts<0)&&!XT(e))?0:1,a=e._rDelay,l=0,u,c,f;if(a&&e._repeat&&(l=qv(0,e._tDur,t),c=Jp(l,a),e._yoyo&&c&1&&(o=1-o),c!==Jp(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Bi||i||e._zTime===Wn||!t&&e._zTime){if(!e._initted&&kV(e,t,i,r,l))return;for(f=e._zTime,e._zTime=t||(r?Wn:0),r||(r=t&&!f),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,u=e._pt;u;)u.r(o,u.d),u=u._next;t<0&&jT(e,t,r,!0),e._onUpdate&&!r&&wo(e,"onUpdate"),l&&e._repeat&&!r&&e.parent&&wo(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Fc(e,1),!r&&!Bi&&(wo(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Oie=function(e,t,r){var i;if(r>t)for(i=e._first;i&&i._start<=r;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=r;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},Qp=function(e,t,r,i){var s=e._repeat,o=ar(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:ar(o*(s+1)+e._rDelay*s):o,a>0&&!i&&Qw(e,e._tTime=e._tDur*a),e.parent&&Jw(e),r||oh(e.parent,e),e},LL=function(e){return e instanceof ws?oh(e):Qp(e,e._dur)},Bie={_start:0,endTime:lv,totalDuration:lv},Xo=function n(e,t,r){var i=e.labels,s=e._recent||Bie,o=e.duration()>=na?s.endTime(!1):e._dur,a,l,u;return Si(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),u=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(u?(a<0?s:r).totalDuration()/100:1)):a<0?(t in i||(i[t]=o),i[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),u&&r&&(l=l/100*(os(r)?r[0]:r).totalDuration()),a>1?n(e,t.substr(0,a-1),r)+l:o+l)):t==null?o:+t},eg=function(e,t,r){var i=vu(t[1]),s=(i?2:1)+(e<2?0:1),o=t[s],a,l;if(i&&(o.duration=t[1]),o.parent=r,e){for(a=o,l=r;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=$s(l.vars.inherit)&&l.parent;o.immediateRender=$s(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new Gr(t[0],o,t[s+1])},Zc=function(e,t){return e||e===0?t(e):t},qv=function(e,t,r){return r<e?e:r>t?t:r},es=function(e,t){return!Si(e)||!(t=Cie.exec(e))?"":t[1]},Uie=function(e,t,r){return Zc(r,function(i){return qv(e,t,i)})},$T=[].slice,LV=function(e,t){return e&&Cl(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Cl(e[0]))&&!e.nodeType&&e!==il},zie=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(i){var s;return Si(i)&&!t||LV(i,1)?(s=r).push.apply(s,ra(i)):r.push(i)})||r},ra=function(e,t,r){return rr&&!t&&rr.selector?rr.selector(e):Si(e)&&!r&&(HT||!em())?$T.call((t||tP).querySelectorAll(e),0):os(e)?zie(e,r):LV(e)?$T.call(e,0):e?[e]:[]},qT=function(e){return e=ra(e)[0]||av("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return ra(t,r.querySelectorAll?r:r===e?av("Invalid scope")||tP.createElement("div"):e)}},FV=function(e){return e.sort(function(){return .5-Math.random()})},OV=function(e){if(Ar(e))return e;var t=Cl(e)?e:{each:e},r=ah(t.ease),i=t.from||0,s=parseFloat(t.base)||0,o={},a=i>0&&i<1,l=isNaN(i)||a,u=t.axis,c=i,f=i;return Si(i)?c=f={center:.5,edges:.5,end:1}[i]||0:!a&&l&&(c=i[0],f=i[1]),function(h,d,p){var y=(p||t).length,x=o[y],m,_,w,b,S,M,T,P,C;if(!x){if(C=t.grid==="auto"?0:(t.grid||[1,na])[1],!C){for(T=-na;T<(T=p[C++].getBoundingClientRect().left)&&C<y;);C<y&&C--}for(x=o[y]=[],m=l?Math.min(C,y)*c-.5:i%C,_=C===na?0:l?y*f/C-.5:i/C|0,T=0,P=na,M=0;M<y;M++)w=M%C-m,b=_-(M/C|0),x[M]=S=u?Math.abs(u==="y"?b:w):xV(w*w+b*b),S>T&&(T=S),S<P&&(P=S);i==="random"&&FV(x),x.max=T-P,x.min=P,x.v=y=(parseFloat(t.amount)||parseFloat(t.each)*(C>y?y-1:u?u==="y"?y/C:C:Math.max(C,y/C))||0)*(i==="edges"?-1:1),x.b=y<0?s-y:s,x.u=es(t.amount||t.each)||0,r=r&&y<0?$V(r):r}return y=(x[h]-x.min)/x.max||0,ar(x.b+(r?r(y):y)*x.v)+x.u}},YT=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var i=ar(Math.round(parseFloat(r)/e)*e*t);return(i-i%1)/t+(vu(r)?0:es(r))}},BV=function(e,t){var r=os(e),i,s;return!r&&Cl(e)&&(i=r=e.radius||na,e.values?(e=ra(e.values),(s=!vu(e[0]))&&(i*=i)):e=YT(e.increment)),Zc(t,r?Ar(e)?function(o){return s=e(o),Math.abs(s-o)<=i?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),u=na,c=0,f=e.length,h,d;f--;)s?(h=e[f].x-a,d=e[f].y-l,h=h*h+d*d):h=Math.abs(e[f]-a),h<u&&(u=h,c=f);return c=!i||u<=i?e[c]:o,s||c===o||vu(o)?c:c+es(o)}:YT(e))},UV=function(e,t,r,i){return Zc(os(e)?!t:r===!0?!!(r=0):!i,function(){return os(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*i)/i})},Vie=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduce(function(s,o){return o(s)},i)}},Wie=function(e,t){return function(r){return e(parseFloat(r))+(t||es(r))}},Hie=function(e,t,r){return VV(e,t,0,1,r)},zV=function(e,t,r){return Zc(r,function(i){return e[~~t(i)]})},Gie=function n(e,t,r){var i=t-e;return os(e)?zV(e,n(0,e.length),t):Zc(r,function(s){return(i+(s-e)%i)%i+e})},jie=function n(e,t,r){var i=t-e,s=i*2;return os(e)?zV(e,n(0,e.length-1),t):Zc(r,function(o){return o=(s+(o-e)%s)%s||0,e+(o>i?s-o:o)})},uv=function(e){return e.replace(Eie,function(t){var r=t.indexOf("[")+1,i=t.substring(r||7,r?t.indexOf("]"):t.length-1).split(Mie);return UV(r?i:+i[0],r?0:+i[1],+i[2]||1e-5)})},VV=function(e,t,r,i,s){var o=t-e,a=i-r;return Zc(s,function(l){return r+((l-e)/o*a||0)})},Xie=function n(e,t,r,i){var s=isNaN(e+t)?0:function(d){return(1-d)*e+d*t};if(!s){var o=Si(e),a={},l,u,c,f,h;if(r===!0&&(i=1)&&(r=null),o)e={p:e},t={p:t};else if(os(e)&&!os(t)){for(c=[],f=e.length,h=f-2,u=1;u<f;u++)c.push(n(e[u-1],e[u]));f--,s=function(p){p*=f;var y=Math.min(h,~~p);return c[y](p-y)},r=t}else i||(e=Zp(os(e)?[]:{},e));if(!c){for(l in t)aP.call(a,e,l,"get",t[l]);s=function(p){return fP(p,a)||(o?e.p:e)}}}return Zc(r,s)},FL=function(e,t,r){var i=e.labels,s=na,o,a,l;for(o in i)a=i[o]-t,a<0==!!r&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},wo=function(e,t,r){var i=e.vars,s=i[t],o=rr,a=e._ctx,l,u,c;if(s)return l=i[t+"Params"],u=i.callbackScope||e,r&&bc.length&&p_(),a&&(rr=a),c=l?s.apply(u,l):s.call(u),rr=o,c},P0=function(e){return Fc(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Bi),e.progress()<1&&wo(e,"onInterrupt"),e},up,WV=[],HV=function(e){if(e)if(e=!e.name&&e.default||e,eP()||e.headless){var t=e.name,r=Ar(e),i=t&&!r&&e.init?function(){this._props=[]}:e,s={init:lv,render:fP,add:aP,kill:lse,modifier:ase,rawVars:0},o={targetTest:0,get:0,getSetter:cP,aliases:{},register:0};if(em(),e!==i){if(po[t])return;Do(i,Do(m_(e,s),o)),Zp(i.prototype,Zp(s,m_(e,o))),po[i.prop=t]=i,e.targetTest&&(w2.push(i),rP[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}MV(t,i),e.register&&e.register(Js,i,Ys)}else WV.push(e)},Vn=255,I0={aqua:[0,Vn,Vn],lime:[0,Vn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Vn],navy:[0,0,128],white:[Vn,Vn,Vn],olive:[128,128,0],yellow:[Vn,Vn,0],orange:[Vn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Vn,0,0],pink:[Vn,192,203],cyan:[0,Vn,Vn],transparent:[Vn,Vn,Vn,0]},VE=function(e,t,r){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*Vn+.5|0},GV=function(e,t,r){var i=e?vu(e)?[e>>16,e>>8&Vn,e&Vn]:0:I0.black,s,o,a,l,u,c,f,h,d,p;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),I0[e])i=I0[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&Vn,i&Vn,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&Vn,e&Vn]}else if(e.substr(0,3)==="hsl"){if(i=p=e.match(IL),!t)l=+i[0]%360/360,u=+i[1]/100,c=+i[2]/100,o=c<=.5?c*(u+1):c+u-c*u,s=c*2-o,i.length>3&&(i[3]*=1),i[0]=VE(l+1/3,s,o),i[1]=VE(l,s,o),i[2]=VE(l-1/3,s,o);else if(~e.indexOf("="))return i=e.match(wV),r&&i.length<4&&(i[3]=1),i}else i=e.match(IL)||I0.transparent;i=i.map(Number)}return t&&!p&&(s=i[0]/Vn,o=i[1]/Vn,a=i[2]/Vn,f=Math.max(s,o,a),h=Math.min(s,o,a),c=(f+h)/2,f===h?l=u=0:(d=f-h,u=c>.5?d/(2-f-h):d/(f+h),l=f===s?(o-a)/d+(o<a?6:0):f===o?(a-s)/d+2:(s-o)/d+4,l*=60),i[0]=~~(l+.5),i[1]=~~(u*100+.5),i[2]=~~(c*100+.5)),r&&i.length<4&&(i[3]=1),i},jV=function(e){var t=[],r=[],i=-1;return e.split(Sc).forEach(function(s){var o=s.match(lp)||[];t.push.apply(t,o),r.push(i+=o.length+1)}),t.c=r,t},OL=function(e,t,r){var i="",s=(e+i).match(Sc),o=t?"hsla(":"rgba(",a=0,l,u,c,f;if(!s)return e;if(s=s.map(function(h){return(h=GV(h,t,1))&&o+(t?h[0]+","+h[1]+"%,"+h[2]+"%,"+h[3]:h.join(","))+")"}),r&&(c=jV(e),l=r.c,l.join(i)!==c.c.join(i)))for(u=e.replace(Sc,"1").split(lp),f=u.length-1;a<f;a++)i+=u[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(c.length?c:s.length?s:r).shift());if(!u)for(u=e.split(Sc),f=u.length-1;a<f;a++)i+=u[a]+s[a];return i+u[f]},Sc=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in I0)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),$ie=/hsl[a]?\(/,XV=function(e){var t=e.join(" "),r;if(Sc.lastIndex=0,Sc.test(t))return r=$ie.test(t),e[1]=OL(e[1],r),e[0]=OL(e[0],r,jV(e[1])),!0},cv,yo=function(){var n=Date.now,e=500,t=33,r=n(),i=r,s=1e3/240,o=s,a=[],l,u,c,f,h,d,p=function y(x){var m=n()-i,_=x===!0,w,b,S,M;if((m>e||m<0)&&(r+=m-t),i+=m,S=i-r,w=S-o,(w>0||_)&&(M=++f.frame,h=S-f.time*1e3,f.time=S=S/1e3,o+=w+(w>=s?4:s-w),b=1),_||(l=u(y)),b)for(d=0;d<a.length;d++)a[d](S,h,M,x)};return f={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(x){return h/(1e3/(x||60))},wake:function(){SV&&(!HT&&eP()&&(il=HT=window,tP=il.document||{},Io.gsap=Js,(il.gsapVersions||(il.gsapVersions=[])).push(Js.version),EV(d_||il.GreenSockGlobals||!il.gsap&&il||{}),WV.forEach(HV)),c=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&f.sleep(),u=c||function(x){return setTimeout(x,o-f.time*1e3+1|0)},cv=1,p(2))},sleep:function(){(c?cancelAnimationFrame:clearTimeout)(l),cv=0,u=lv},lagSmoothing:function(x,m){e=x||1/0,t=Math.min(m||33,e)},fps:function(x){s=1e3/(x||240),o=f.time*1e3+s},add:function(x,m,_){var w=m?function(b,S,M,T){x(b,S,M,T),f.remove(w)}:x;return f.remove(x),a[_?"unshift":"push"](w),em(),w},remove:function(x,m){~(m=a.indexOf(x))&&a.splice(m,1)&&d>=m&&d--},_listeners:a},f}(),em=function(){return!cv&&yo.wake()},gn={},qie=/^[\d.\-M][\d.\-,\s]/,Yie=/["']/g,Kie=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),i=r[0],s=1,o=r.length,a,l,u;s<o;s++)l=r[s],a=s!==o-1?l.lastIndexOf(","):l.length,u=l.substr(0,a),t[i]=isNaN(u)?u.replace(Yie,"").trim():+u,i=l.substr(a+1).trim();return t},Zie=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<r?e.indexOf(")",r+1):r)},Jie=function(e){var t=(e+"").split("("),r=gn[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[Kie(t[1])]:Zie(e).split(",").map(RV)):gn._CE&&qie.test(e)?gn._CE("",e):r},$V=function(e){return function(t){return 1-e(1-t)}},qV=function n(e,t){for(var r=e._first,i;r;)r instanceof ws?n(r,t):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==t&&(r.timeline?n(r.timeline,t):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=t)),r=r._next},ah=function(e,t){return e&&(Ar(e)?e:gn[e]||Jie(e))||t},kh=function(e,t,r,i){r===void 0&&(r=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:r,easeInOut:i},o;return qs(e,function(a){gn[a]=Io[a]=s,gn[o=a.toLowerCase()]=r;for(var l in s)gn[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=gn[a+"."+l]=s[l]}),s},YV=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},WE=function n(e,t,r){var i=t>=1?t:1,s=(r||(e?.3:.45))/(t<1?t:1),o=s/WT*(Math.asin(1/i)||0),a=function(c){return c===1?1:i*Math.pow(2,-10*c)*Sie((c-o)*s)+1},l=e==="out"?a:e==="in"?function(u){return 1-a(1-u)}:YV(a);return s=WT/s,l.config=function(u,c){return n(e,u,c)},l},HE=function n(e,t){t===void 0&&(t=1.70158);var r=function(o){return o?--o*o*((t+1)*o+t)+1:0},i=e==="out"?r:e==="in"?function(s){return 1-r(1-s)}:YV(r);return i.config=function(s){return n(e,s)},i};qs("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;kh(n+",Power"+(t-1),e?function(r){return Math.pow(r,t)}:function(r){return r},function(r){return 1-Math.pow(1-r,t)},function(r){return r<.5?Math.pow(r*2,t)/2:1-Math.pow((1-r)*2,t)/2})});gn.Linear.easeNone=gn.none=gn.Linear.easeIn;kh("Elastic",WE("in"),WE("out"),WE());(function(n,e){var t=1/e,r=2*t,i=2.5*t,s=function(a){return a<t?n*a*a:a<r?n*Math.pow(a-1.5/e,2)+.75:a<i?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};kh("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);kh("Expo",function(n){return Math.pow(2,10*(n-1))*n+n*n*n*n*n*n*(1-n)});kh("Circ",function(n){return-(xV(1-n*n)-1)});kh("Sine",function(n){return n===1?1:-bie(n*_ie)+1});kh("Back",HE("in"),HE("out"),HE());gn.SteppedEase=gn.steps=Io.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,i=e+(t?0:1),s=t?1:0,o=1-Wn;return function(a){return((i*qv(0,o,a)|0)+s)*r}}};Kp.ease=gn["quad.out"];qs("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return iP+=n+","+n+"Params,"});var KV=function(e,t){this.id=wie++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:CV,this.set=t?t.getSetter:cP},fv=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Qp(this,+t.duration,1,1),this.data=t.data,rr&&(this._ctx=rr,rr.data.push(this)),cv||yo.wake()}var e=n.prototype;return e.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},e.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},e.totalDuration=function(r){return arguments.length?(this._dirty=0,Qp(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(r,i){if(em(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Qw(this,r),!s._dp||s.parent||DV(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&ll(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===Wn||!this._initted&&this._dur&&r||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),AV(this,r,i)),this},e.time=function(r,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+kL(this))%(this._dur+this._rDelay)||(r?this._dur:0),i):this._time},e.totalProgress=function(r,i){return arguments.length?this.totalTime(this.totalDuration()*r,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(r,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+kL(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(r,i){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*s,i):this._repeat?Jp(this._tTime,s)+1:1},e.timeScale=function(r,i){if(!arguments.length)return this._rts===-Wn?0:this._rts;if(this._rts===r)return this;var s=this.parent&&this._ts?g_(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-Wn?0:this._rts,this.totalTime(qv(-Math.abs(this._delay),this.totalDuration(),s),i!==!1),Jw(this),Nie(this)},e.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(em(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Wn&&(this._tTime-=Wn)))),this):this._ps},e.startTime=function(r){if(arguments.length){this._start=ar(r);var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&ll(i,this,this._start-this._delay),this}return this._start},e.endTime=function(r){return this._start+($s(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(r){var i=this.parent||this._dp;return i?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?g_(i.rawTime(r),this):this._tTime:this._tTime},e.revert=function(r){r===void 0&&(r=Rie);var i=Bi;return Bi=r,oP(this)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),Bi=i,this},e.globalTime=function(r){for(var i=this,s=arguments.length?r:i.rawTime();i;)s=i._start+s/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(r):s},e.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,LL(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(r){if(arguments.length){var i=this._time;return this._rDelay=r,LL(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},e.seek=function(r,i){return this.totalTime(Xo(this,r),$s(i))},e.restart=function(r,i){return this.play().totalTime(r?-this._delay:0,$s(i)),this._dur||(this._zTime=-Wn),this},e.play=function(r,i){return r!=null&&this.seek(r,i),this.reversed(!1).paused(!1)},e.reverse=function(r,i){return r!=null&&this.seek(r||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(r,i){return r!=null&&this.seek(r,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-Wn:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Wn,this},e.isActive=function(){var r=this.parent||this._dp,i=this._start,s;return!!(!r||this._ts&&this._initted&&r.isActive()&&(s=r.rawTime(!0))>=i&&s<this.endTime(!0)-Wn)},e.eventCallback=function(r,i,s){var o=this.vars;return arguments.length>1?(i?(o[r]=i,s&&(o[r+"Params"]=s),r==="onUpdate"&&(this._onUpdate=i)):delete o[r],this):o[r]},e.then=function(r){var i=this,s=i._prom;return new Promise(function(o){var a=Ar(r)?r:PV,l=function(){var c=i.then;i.then=null,s&&s(),Ar(a)&&(a=a(i))&&(a.then||a===i)&&(i.then=c),o(a),i.then=c};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?l():i._prom=l})},e.kill=function(){P0(this)},n}();Do(fv.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Wn,_prom:0,_ps:!1,_rts:1});var ws=function(n){yV(e,n);function e(r,i){var s;return r===void 0&&(r={}),s=n.call(this,r)||this,s.labels={},s.smoothChildTiming=!!r.smoothChildTiming,s.autoRemoveChildren=!!r.autoRemoveChildren,s._sort=$s(r.sortChildren),ur&&ll(r.parent||ur,ql(s),i),r.reversed&&s.reverse(),r.paused&&s.paused(!0),r.scrollTrigger&&NV(ql(s),r.scrollTrigger),s}var t=e.prototype;return t.to=function(i,s,o){return eg(0,arguments,this),this},t.from=function(i,s,o){return eg(1,arguments,this),this},t.fromTo=function(i,s,o,a){return eg(2,arguments,this),this},t.set=function(i,s,o){return s.duration=0,s.parent=this,Q0(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Gr(i,s,Xo(this,o),1),this},t.call=function(i,s,o){return ll(this,Gr.delayedCall(0,i,s),o)},t.staggerTo=function(i,s,o,a,l,u,c){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=u,o.onCompleteParams=c,o.parent=this,new Gr(i,o,Xo(this,l)),this},t.staggerFrom=function(i,s,o,a,l,u,c){return o.runBackwards=1,Q0(o).immediateRender=$s(o.immediateRender),this.staggerTo(i,s,o,a,l,u,c)},t.staggerFromTo=function(i,s,o,a,l,u,c,f){return a.startAt=o,Q0(a).immediateRender=$s(a.immediateRender),this.staggerTo(i,s,a,l,u,c,f)},t.render=function(i,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,u=this._dur,c=i<=0?0:ar(i),f=this._zTime<0!=i<0&&(this._initted||!u),h,d,p,y,x,m,_,w,b,S,M,T;if(this!==ur&&c>l&&i>=0&&(c=l),c!==this._tTime||o||f){if(a!==this._time&&u&&(c+=this._time-a,i+=this._time-a),h=c,b=this._start,w=this._ts,m=!w,f&&(u||(a=this._zTime),(i||!s)&&(this._zTime=i)),this._repeat){if(M=this._yoyo,x=u+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(x*100+i,s,o);if(h=ar(c%x),c===l?(y=this._repeat,h=u):(S=ar(c/x),y=~~S,y&&y===S&&(h=u,y--),h>u&&(h=u)),S=Jp(this._tTime,x),!a&&this._tTime&&S!==y&&this._tTime-S*x-this._dur<=0&&(S=y),M&&y&1&&(h=u-h,T=1),y!==S&&!this._lock){var P=M&&S&1,C=P===(M&&y&1);if(y<S&&(P=!P),a=P?0:c%u?u:c,this._lock=1,this.render(a||(T?0:ar(y*x)),s,!u)._lock=0,this._tTime=c,!s&&this.parent&&wo(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1,S=y),a&&a!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(u=this._dur,l=this._tDur,C&&(this._lock=2,a=P?u:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;qV(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=Oie(this,ar(a),ar(h)),_&&(c-=h-(h=_._start))),this._tTime=c,this._time=h,this._act=!w,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,a=0),!a&&c&&u&&!s&&!S&&(wo(this,"onStart"),this._tTime!==c))return this;if(h>=a&&i>=0)for(d=this._first;d;){if(p=d._next,(d._act||h>=d._start)&&d._ts&&_!==d){if(d.parent!==this)return this.render(i,s,o);if(d.render(d._ts>0?(h-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(h-d._start)*d._ts,s,o),h!==this._time||!this._ts&&!m){_=0,p&&(c+=this._zTime=-Wn);break}}d=p}else{d=this._last;for(var A=i<0?i:h;d;){if(p=d._prev,(d._act||A<=d._end)&&d._ts&&_!==d){if(d.parent!==this)return this.render(i,s,o);if(d.render(d._ts>0?(A-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(A-d._start)*d._ts,s,o||Bi&&oP(d)),h!==this._time||!this._ts&&!m){_=0,p&&(c+=this._zTime=A?-Wn:Wn);break}}d=p}}if(_&&!s&&(this.pause(),_.render(h>=a?0:-Wn)._zTime=h>=a?1:-1,this._ts))return this._start=b,Jw(this),this.render(i,s,o);this._onUpdate&&!s&&wo(this,"onUpdate",!0),(c===l&&this._tTime>=this.totalDuration()||!c&&a)&&(b===this._start||Math.abs(w)!==Math.abs(this._ts))&&(this._lock||((i||!u)&&(c===l&&this._ts>0||!c&&this._ts<0)&&Fc(this,1),!s&&!(i<0&&!a)&&(c||a||!l)&&(wo(this,c===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,s){var o=this;if(vu(s)||(s=Xo(this,s,i)),!(i instanceof fv)){if(os(i))return i.forEach(function(a){return o.add(a,s)}),this;if(Si(i))return this.addLabel(i,s);if(Ar(i))i=Gr.delayedCall(0,i);else return this}return this!==i?ll(this,i,s):this},t.getChildren=function(i,s,o,a){i===void 0&&(i=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-na);for(var l=[],u=this._first;u;)u._start>=a&&(u instanceof Gr?s&&l.push(u):(o&&l.push(u),i&&l.push.apply(l,u.getChildren(!0,s,o)))),u=u._next;return l},t.getById=function(i){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===i)return s[o]},t.remove=function(i){return Si(i)?this.removeLabel(i):Ar(i)?this.killTweensOf(i):(i.parent===this&&Zw(this,i),i===this._recent&&(this._recent=this._last),oh(this))},t.totalTime=function(i,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ar(yo.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),n.prototype.totalTime.call(this,i,s),this._forcing=0,this):this._tTime},t.addLabel=function(i,s){return this.labels[i]=Xo(this,s),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,s,o){var a=Gr.delayedCall(0,s||lv,o);return a.data="isPause",this._hasPause=1,ll(this,a,Xo(this,i))},t.removePause=function(i){var s=this._first;for(i=Xo(this,i);s;)s._start===i&&s.data==="isPause"&&Fc(s),s=s._next},t.killTweensOf=function(i,s,o){for(var a=this.getTweensOf(i,o),l=a.length;l--;)sc!==a[l]&&a[l].kill(i,s);return this},t.getTweensOf=function(i,s){for(var o=[],a=ra(i),l=this._first,u=vu(s),c;l;)l instanceof Gr?Pie(l._targets,a)&&(u?(!sc||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(c=l.getTweensOf(a,s)).length&&o.push.apply(o,c),l=l._next;return o},t.tweenTo=function(i,s){s=s||{};var o=this,a=Xo(o,i),l=s,u=l.startAt,c=l.onStart,f=l.onStartParams,h=l.immediateRender,d,p=Gr.to(o,Do({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(u&&"time"in u?u.time:o._time))/o.timeScale())||Wn,onStart:function(){if(o.pause(),!d){var x=s.duration||Math.abs((a-(u&&"time"in u?u.time:o._time))/o.timeScale());p._dur!==x&&Qp(p,x,0,1).render(p._time,!0,!0),d=1}c&&c.apply(p,f||[])}},s));return h?p.render(0):p},t.tweenFromTo=function(i,s,o){return this.tweenTo(s,Do({startAt:{time:Xo(this,i)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),FL(this,Xo(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),FL(this,Xo(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+Wn)},t.shiftChildren=function(i,s,o){o===void 0&&(o=0);var a=this._first,l=this.labels,u;for(i=ar(i);a;)a._start>=o&&(a._start+=i,a._end+=i),a=a._next;if(s)for(u in l)l[u]>=o&&(l[u]+=i);return oh(this)},t.invalidate=function(i){var s=this._first;for(this._lock=0;s;)s.invalidate(i),s=s._next;return n.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),oh(this)},t.totalDuration=function(i){var s=0,o=this,a=o._last,l=na,u,c,f;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-i:i));if(o._dirty){for(f=o.parent;a;)u=a._prev,a._dirty&&a.totalDuration(),c=a._start,c>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,ll(o,a,c-a._delay,1)._lock=0):l=c,c<0&&a._ts&&(s-=c,(!f&&!o._dp||f&&f.smoothChildTiming)&&(o._start+=ar(c/o._ts),o._time-=c,o._tTime-=c),o.shiftChildren(-c,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=u;Qp(o,o===ur&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(i){if(ur._ts&&(AV(ur,g_(i,ur)),TV=yo.frame),yo.frame>=DL){DL+=Ao.autoSleep||120;var s=ur._first;if((!s||!s._ts)&&Ao.autoSleep&&yo._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||yo.sleep()}}},e}(fv);Do(ws.prototype,{_lock:0,_hasPause:0,_forcing:0});var Qie=function(e,t,r,i,s,o,a){var l=new Ys(this._pt,e,t,0,1,n7,null,s),u=0,c=0,f,h,d,p,y,x,m,_;for(l.b=r,l.e=i,r+="",i+="",(m=~i.indexOf("random("))&&(i=uv(i)),o&&(_=[r,i],o(_,e,t),r=_[0],i=_[1]),h=r.match(UE)||[];f=UE.exec(i);)p=f[0],y=i.substring(u,f.index),d?d=(d+1)%5:y.substr(-5)==="rgba("&&(d=1),p!==h[c++]&&(x=parseFloat(h[c-1])||0,l._pt={_next:l._pt,p:y||c===1?y:",",s:x,c:p.charAt(1)==="="?Ep(x,p)-x:parseFloat(p)-x,m:d&&d<4?Math.round:0},u=UE.lastIndex);return l.c=u<i.length?i.substring(u,i.length):"",l.fp=a,(bV.test(i)||m)&&(l.e=0),this._pt=l,l},aP=function(e,t,r,i,s,o,a,l,u,c){Ar(i)&&(i=i(s||0,e,o));var f=e[t],h=r!=="get"?r:Ar(f)?u?e[t.indexOf("set")||!Ar(e["get"+t.substr(3)])?t:"get"+t.substr(3)](u):e[t]():f,d=Ar(f)?u?ise:e7:uP,p;if(Si(i)&&(~i.indexOf("random(")&&(i=uv(i)),i.charAt(1)==="="&&(p=Ep(h,i)+(es(h)||0),(p||p===0)&&(i=p))),!c||h!==i||KT)return!isNaN(h*i)&&i!==""?(p=new Ys(this._pt,e,t,+h||0,i-(h||0),typeof f=="boolean"?ose:t7,0,d),u&&(p.fp=u),a&&p.modifier(a,this,e),this._pt=p):(!f&&!(t in e)&&nP(t,i),Qie.call(this,e,t,h,i,d,l||Ao.stringFilter,u))},ese=function(e,t,r,i,s){if(Ar(e)&&(e=tg(e,s,t,r,i)),!Cl(e)||e.style&&e.nodeType||os(e)||_V(e))return Si(e)?tg(e,s,t,r,i):e;var o={},a;for(a in e)o[a]=tg(e[a],s,t,r,i);return o},ZV=function(e,t,r,i,s,o){var a,l,u,c;if(po[e]&&(a=new po[e]).init(s,a.rawVars?t[e]:ese(t[e],i,s,o,r),r,i,o)!==!1&&(r._pt=l=new Ys(r._pt,s,e,0,1,a.render,a,0,a.priority),r!==up))for(u=r._ptLookup[r._targets.indexOf(s)],c=a._props.length;c--;)u[a._props[c]]=l;return a},sc,KT,lP=function n(e,t,r){var i=e.vars,s=i.ease,o=i.startAt,a=i.immediateRender,l=i.lazy,u=i.onUpdate,c=i.runBackwards,f=i.yoyoEase,h=i.keyframes,d=i.autoRevert,p=e._dur,y=e._startAt,x=e._targets,m=e.parent,_=m&&m.data==="nested"?m.vars.targets:x,w=e._overwrite==="auto"&&!JR,b=e.timeline,S,M,T,P,C,A,k,L,H,F,V,W,G;if(b&&(!h||!s)&&(s="none"),e._ease=ah(s,Kp.ease),e._yEase=f?$V(ah(f===!0?s:f,Kp.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!b&&!!i.runBackwards,!b||h&&!i.stagger){if(L=x[0]?sh(x[0]).harness:0,W=L&&i[L.prop],S=m_(i,rP),y&&(y._zTime<0&&y.progress(1),t<0&&c&&a&&!d?y.render(-1,!0):y.revert(c&&p?_2:Aie),y._lazy=0),o){if(Fc(e._startAt=Gr.set(x,Do({data:"isStart",overwrite:!1,parent:m,immediateRender:!0,lazy:!y&&$s(l),startAt:null,delay:0,onUpdate:u&&function(){return wo(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Bi||!a&&!d)&&e._startAt.revert(_2),a&&p&&t<=0&&r<=0){t&&(e._zTime=t);return}}else if(c&&p&&!y){if(t&&(a=!1),T=Do({overwrite:!1,data:"isFromStart",lazy:a&&!y&&$s(l),immediateRender:a,stagger:0,parent:m},S),W&&(T[L.prop]=W),Fc(e._startAt=Gr.set(x,T)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Bi?e._startAt.revert(_2):e._startAt.render(-1,!0)),e._zTime=t,!a)n(e._startAt,Wn,Wn);else if(!t)return}for(e._pt=e._ptCache=0,l=p&&$s(l)||l&&!p,M=0;M<x.length;M++){if(C=x[M],k=C._gsap||sP(x)[M]._gsap,e._ptLookup[M]=F={},GT[k.id]&&bc.length&&p_(),V=_===x?M:_.indexOf(C),L&&(H=new L).init(C,W||S,e,V,_)!==!1&&(e._pt=P=new Ys(e._pt,C,H.name,0,1,H.render,H,0,H.priority),H._props.forEach(function(N){F[N]=P}),H.priority&&(A=1)),!L||W)for(T in S)po[T]&&(H=ZV(T,S,e,V,C,_))?H.priority&&(A=1):F[T]=P=aP.call(e,C,T,"get",S[T],V,_,0,i.stringFilter);e._op&&e._op[M]&&e.kill(C,e._op[M]),w&&e._pt&&(sc=e,ur.killTweensOf(C,F,e.globalTime(t)),G=!e.parent,sc=0),e._pt&&l&&(GT[k.id]=1)}A&&r7(e),e._onInit&&e._onInit(e)}e._onUpdate=u,e._initted=(!e._op||e._pt)&&!G,h&&t<=0&&b.render(na,!0,!0)},tse=function(e,t,r,i,s,o,a,l){var u=(e._pt&&e._ptCache||(e._ptCache={}))[t],c,f,h,d;if(!u)for(u=e._ptCache[t]=[],h=e._ptLookup,d=e._targets.length;d--;){if(c=h[d][t],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==t&&c.fp!==t;)c=c._next;if(!c)return KT=1,e.vars[t]="+=0",lP(e,a),KT=0,l?av(t+" not eligible for reset"):1;u.push(c)}for(d=u.length;d--;)f=u[d],c=f._pt||f,c.s=(i||i===0)&&!s?i:c.s+(i||0)+o*c.c,c.c=r-c.s,f.e&&(f.e=Nr(r)+es(f.e)),f.b&&(f.b=c.s+es(f.b))},nse=function(e,t){var r=e[0]?sh(e[0]).harness:0,i=r&&r.aliases,s,o,a,l;if(!i)return t;s=Zp({},t);for(o in i)if(o in s)for(l=i[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},rse=function(e,t,r,i){var s=t.ease||i||"power1.inOut",o,a;if(os(t))a=r[e]||(r[e]=[]),t.forEach(function(l,u){return a.push({t:u/(t.length-1)*100,v:l,e:s})});else for(o in t)a=r[o]||(r[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:s})},tg=function(e,t,r,i,s){return Ar(e)?e.call(t,r,i,s):Si(e)&&~e.indexOf("random(")?uv(e):e},JV=iP+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",QV={};qs(JV+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return QV[n]=1});var Gr=function(n){yV(e,n);function e(r,i,s,o){var a;typeof i=="number"&&(s.duration=i,i=s,s=null),a=n.call(this,o?i:Q0(i))||this;var l=a.vars,u=l.duration,c=l.delay,f=l.immediateRender,h=l.stagger,d=l.overwrite,p=l.keyframes,y=l.defaults,x=l.scrollTrigger,m=l.yoyoEase,_=i.parent||ur,w=(os(r)||_V(r)?vu(r[0]):"length"in i)?[r]:ra(r),b,S,M,T,P,C,A,k;if(a._targets=w.length?sP(w):av("GSAP target "+r+" not found. https://gsap.com",!Ao.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=d,p||h||gx(u)||gx(c)){if(i=a.vars,b=a.timeline=new ws({data:"nested",defaults:y||{},targets:_&&_.data==="nested"?_.vars.targets:w}),b.kill(),b.parent=b._dp=ql(a),b._start=0,h||gx(u)||gx(c)){if(T=w.length,A=h&&OV(h),Cl(h))for(P in h)~JV.indexOf(P)&&(k||(k={}),k[P]=h[P]);for(S=0;S<T;S++)M=m_(i,QV),M.stagger=0,m&&(M.yoyoEase=m),k&&Zp(M,k),C=w[S],M.duration=+tg(u,ql(a),S,C,w),M.delay=(+tg(c,ql(a),S,C,w)||0)-a._delay,!h&&T===1&&M.delay&&(a._delay=c=M.delay,a._start+=c,M.delay=0),b.to(C,M,A?A(S,C,w):0),b._ease=gn.none;b.duration()?u=c=0:a.timeline=0}else if(p){Q0(Do(b.vars.defaults,{ease:"none"})),b._ease=ah(p.ease||i.ease||"none");var L=0,H,F,V;if(os(p))p.forEach(function(W){return b.to(w,W,">")}),b.duration();else{M={};for(P in p)P==="ease"||P==="easeEach"||rse(P,p[P],M,p.easeEach);for(P in M)for(H=M[P].sort(function(W,G){return W.t-G.t}),L=0,S=0;S<H.length;S++)F=H[S],V={ease:F.e,duration:(F.t-(S?H[S-1].t:0))/100*u},V[P]=F.v,b.to(w,V,L),L+=V.duration;b.duration()<u&&b.to({},{duration:u-b.duration()})}}u||a.duration(u=b.duration())}else a.timeline=0;return d===!0&&!JR&&(sc=ql(a),ur.killTweensOf(w),sc=0),ll(_,ql(a),s),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(f||!u&&!p&&a._start===ar(_._time)&&$s(f)&&kie(ql(a))&&_.data!=="nested")&&(a._tTime=-Wn,a.render(Math.max(0,-c)||0)),x&&NV(ql(a),x),a}var t=e.prototype;return t.render=function(i,s,o){var a=this._time,l=this._tDur,u=this._dur,c=i<0,f=i>l-Wn&&!c?l:i<Wn?0:i,h,d,p,y,x,m,_,w,b;if(!u)Fie(this,i,s,o);else if(f!==this._tTime||!i||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c||this._lazy){if(h=f,w=this.timeline,this._repeat){if(y=u+this._rDelay,this._repeat<-1&&c)return this.totalTime(y*100+i,s,o);if(h=ar(f%y),f===l?(p=this._repeat,h=u):(x=ar(f/y),p=~~x,p&&p===x?(h=u,p--):h>u&&(h=u)),m=this._yoyo&&p&1,m&&(b=this._yEase,h=u-h),x=Jp(this._tTime,y),h===a&&!o&&this._initted&&p===x)return this._tTime=f,this;p!==x&&(w&&this._yEase&&qV(w,m),this.vars.repeatRefresh&&!m&&!this._lock&&h!==y&&this._initted&&(this._lock=o=1,this.render(ar(y*p),!0).invalidate()._lock=0))}if(!this._initted){if(kV(this,c?i:h,o,s,f))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&p!==x))return this;if(u!==this._dur)return this.render(i,s,o)}if(this._tTime=f,this._time=h,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(b||this._ease)(h/u),this._from&&(this.ratio=_=1-_),!a&&f&&!s&&!x&&(wo(this,"onStart"),this._tTime!==f))return this;for(d=this._pt;d;)d.r(_,d.d),d=d._next;w&&w.render(i<0?i:w._dur*w._ease(h/this._dur),s,o)||this._startAt&&(this._zTime=i),this._onUpdate&&!s&&(c&&jT(this,i,s,o),wo(this,"onUpdate")),this._repeat&&p!==x&&this.vars.onRepeat&&!s&&this.parent&&wo(this,"onRepeat"),(f===this._tDur||!f)&&this._tTime===f&&(c&&!this._onUpdate&&jT(this,i,!0,!0),(i||!u)&&(f===this._tDur&&this._ts>0||!f&&this._ts<0)&&Fc(this,1),!s&&!(c&&!a)&&(f||a||m)&&(wo(this,f===l?"onComplete":"onReverseComplete",!0),this._prom&&!(f<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),n.prototype.invalidate.call(this,i)},t.resetTo=function(i,s,o,a,l){cv||yo.wake(),this._ts||this.play();var u=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||lP(this,u),c=this._ease(u/this._dur),tse(this,i,s,o,a,c,u,l)?this.resetTo(i,s,o,a,1):(Qw(this,0),this.parent||IV(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,s){if(s===void 0&&(s="all"),!i&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?P0(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Bi),this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(i,s,sc&&sc.vars.overwrite!==!0)._first||P0(this),this.parent&&o!==this.timeline.totalDuration()&&Qp(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=i?ra(i):a,u=this._ptLookup,c=this._pt,f,h,d,p,y,x,m;if((!s||s==="all")&&Die(a,l))return s==="all"&&(this._pt=0),P0(this);for(f=this._op=this._op||[],s!=="all"&&(Si(s)&&(y={},qs(s,function(_){return y[_]=1}),s=y),s=nse(a,s)),m=a.length;m--;)if(~l.indexOf(a[m])){h=u[m],s==="all"?(f[m]=s,p=h,d={}):(d=f[m]=f[m]||{},p=s);for(y in p)x=h&&h[y],x&&((!("kill"in x.d)||x.d.kill(y)===!0)&&Zw(this,x,"_pt"),delete h[y]),d!=="all"&&(d[y]=1)}return this._initted&&!this._pt&&c&&P0(this),this},e.to=function(i,s){return new e(i,s,arguments[2])},e.from=function(i,s){return eg(1,arguments)},e.delayedCall=function(i,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(i,s,o){return eg(2,arguments)},e.set=function(i,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(i,s)},e.killTweensOf=function(i,s,o){return ur.killTweensOf(i,s,o)},e}(fv);Do(Gr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});qs("staggerTo,staggerFrom,staggerFromTo",function(n){Gr[n]=function(){var e=new ws,t=$T.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var uP=function(e,t,r){return e[t]=r},e7=function(e,t,r){return e[t](r)},ise=function(e,t,r,i){return e[t](i.fp,r)},sse=function(e,t,r){return e.setAttribute(t,r)},cP=function(e,t){return Ar(e[t])?e7:QR(e[t])&&e.setAttribute?sse:uP},t7=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},ose=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},n7=function(e,t){var r=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+i,r=r._next;i+=t.c}t.set(t.t,t.p,i,t)},fP=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},ase=function(e,t,r,i){for(var s=this._pt,o;s;)o=s._next,s.p===i&&s.modifier(e,t,r),s=o},lse=function(e){for(var t=this._pt,r,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?Zw(this,t,"_pt"):t.dep||(r=1),t=i;return!r},use=function(e,t,r,i){i.mSet(e,t,i.m.call(i.tween,r,i.mt),i)},r7=function(e){for(var t=e._pt,r,i,s,o;t;){for(r=t._next,i=s;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:o)?t._prev._next=t:s=t,(t._next=i)?i._prev=t:o=t,t=r}e._pt=s},Ys=function(){function n(t,r,i,s,o,a,l,u,c){this.t=r,this.s=s,this.c=o,this.p=i,this.r=a||t7,this.d=l||this,this.set=u||uP,this.pr=c||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(r,i,s){this.mSet=this.mSet||this.set,this.set=use,this.m=r,this.mt=s,this.tween=i},n}();qs(iP+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return rP[n]=1});Io.TweenMax=Io.TweenLite=Gr;Io.TimelineLite=Io.TimelineMax=ws;ur=new ws({sortChildren:!1,defaults:Kp,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ao.stringFilter=XV;var lh=[],b2={},cse=[],BL=0,fse=0,GE=function(e){return(b2[e]||cse).map(function(t){return t()})},ZT=function(){var e=Date.now(),t=[];e-BL>2&&(GE("matchMediaInit"),lh.forEach(function(r){var i=r.queries,s=r.conditions,o,a,l,u;for(a in i)o=il.matchMedia(i[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,u=1);u&&(r.revert(),l&&t.push(r))}),GE("matchMediaRevert"),t.forEach(function(r){return r.onMatch(r,function(i){return r.add(null,i)})}),BL=e,GE("matchMedia"))},i7=function(){function n(t,r){this.selector=r&&qT(r),this.data=[],this._r=[],this.isReverted=!1,this.id=fse++,t&&this.add(t)}var e=n.prototype;return e.add=function(r,i,s){Ar(r)&&(s=i,i=r,r=Ar);var o=this,a=function(){var u=rr,c=o.selector,f;return u&&u!==o&&u.data.push(o),s&&(o.selector=qT(s)),rr=o,f=i.apply(o,arguments),Ar(f)&&o._r.push(f),rr=u,o.selector=c,o.isReverted=!1,f};return o.last=a,r===Ar?a(o,function(l){return o.add(null,l)}):r?o[r]=a:a},e.ignore=function(r){var i=rr;rr=null,r(this),rr=i},e.getTweens=function(){var r=[];return this.data.forEach(function(i){return i instanceof n?r.push.apply(r,i.getTweens()):i instanceof Gr&&!(i.parent&&i.parent.data==="nested")&&r.push(i)}),r},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(r,i){var s=this;if(r?function(){for(var a=s.getTweens(),l=s.data.length,u;l--;)u=s.data[l],u.data==="isFlip"&&(u.revert(),u.getChildren(!0,!0,!1).forEach(function(c){return a.splice(a.indexOf(c),1)}));for(a.map(function(c){return{g:c._dur||c._delay||c._sat&&!c._sat.vars.immediateRender?c.globalTime(0):-1/0,t:c}}).sort(function(c,f){return f.g-c.g||-1/0}).forEach(function(c){return c.t.revert(r)}),l=s.data.length;l--;)u=s.data[l],u instanceof ws?u.data!=="nested"&&(u.scrollTrigger&&u.scrollTrigger.revert(),u.kill()):!(u instanceof Gr)&&u.revert&&u.revert(r);s._r.forEach(function(c){return c(r,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),i)for(var o=lh.length;o--;)lh[o].id===this.id&&lh.splice(o,1)},e.revert=function(r){this.kill(r||{})},n}(),hse=function(){function n(t){this.contexts=[],this.scope=t,rr&&rr.data.push(this)}var e=n.prototype;return e.add=function(r,i,s){Cl(r)||(r={matches:r});var o=new i7(0,s||this.scope),a=o.conditions={},l,u,c;rr&&!o.selector&&(o.selector=rr.selector),this.contexts.push(o),i=o.add("onMatch",i),o.queries=r;for(u in r)u==="all"?c=1:(l=il.matchMedia(r[u]),l&&(lh.indexOf(o)<0&&lh.push(o),(a[u]=l.matches)&&(c=1),l.addListener?l.addListener(ZT):l.addEventListener("change",ZT)));return c&&i(o,function(f){return o.add(null,f)}),this},e.revert=function(r){this.kill(r||{})},e.kill=function(r){this.contexts.forEach(function(i){return i.kill(r,!0)})},n}(),v_={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(i){return HV(i)})},timeline:function(e){return new ws(e)},getTweensOf:function(e,t){return ur.getTweensOf(e,t)},getProperty:function(e,t,r,i){Si(e)&&(e=ra(e)[0]);var s=sh(e||{}).get,o=r?PV:RV;return r==="native"&&(r=""),e&&(t?o((po[t]&&po[t].get||s)(e,t,r,i)):function(a,l,u){return o((po[a]&&po[a].get||s)(e,a,l,u))})},quickSetter:function(e,t,r){if(e=ra(e),e.length>1){var i=e.map(function(c){return Js.quickSetter(c,t,r)}),s=i.length;return function(c){for(var f=s;f--;)i[f](c)}}e=e[0]||{};var o=po[t],a=sh(e),l=a.harness&&(a.harness.aliases||{})[t]||t,u=o?function(c){var f=new o;up._pt=0,f.init(e,r?c+r:c,up,0,[e]),f.render(1,f),up._pt&&fP(1,up)}:a.set(e,l);return o?u:function(c){return u(e,l,r?c+r:c,a,1)}},quickTo:function(e,t,r){var i,s=Js.to(e,Do((i={},i[t]="+=0.1",i.paused=!0,i.stagger=0,i),r||{})),o=function(l,u,c){return s.resetTo(t,l,u,c)};return o.tween=s,o},isTweening:function(e){return ur.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=ah(e.ease,Kp.ease)),NL(Kp,e||{})},config:function(e){return NL(Ao,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,i=e.plugins,s=e.defaults,o=e.extendTimeline;(i||"").split(",").forEach(function(a){return a&&!po[a]&&!Io[a]&&av(t+" effect requires "+a+" plugin.")}),zE[t]=function(a,l,u){return r(ra(a),Do(l||{},s),u)},o&&(ws.prototype[t]=function(a,l,u){return this.add(zE[t](a,Cl(l)?l:(u=l)&&{},this),u)})},registerEase:function(e,t){gn[e]=ah(t)},parseEase:function(e,t){return arguments.length?ah(e,t):gn},getById:function(e){return ur.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new ws(e),i,s;for(r.smoothChildTiming=$s(e.smoothChildTiming),ur.remove(r),r._dp=0,r._time=r._tTime=ur._time,i=ur._first;i;)s=i._next,(t||!(!i._dur&&i instanceof Gr&&i.vars.onComplete===i._targets[0]))&&ll(r,i,i._start-i._delay),i=s;return ll(ur,r,0),r},context:function(e,t){return e?new i7(e,t):rr},matchMedia:function(e){return new hse(e)},matchMediaRefresh:function(){return lh.forEach(function(e){var t=e.conditions,r,i;for(i in t)t[i]&&(t[i]=!1,r=1);r&&e.revert()})||ZT()},addEventListener:function(e,t){var r=b2[e]||(b2[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=b2[e],i=r&&r.indexOf(t);i>=0&&r.splice(i,1)},utils:{wrap:Gie,wrapYoyo:jie,distribute:OV,random:UV,snap:BV,normalize:Hie,getUnit:es,clamp:Uie,splitColor:GV,toArray:ra,selector:qT,mapRange:VV,pipe:Vie,unitize:Wie,interpolate:Xie,shuffle:FV},install:EV,effects:zE,ticker:yo,updateRoot:ws.updateRoot,plugins:po,globalTimeline:ur,core:{PropTween:Ys,globals:MV,Tween:Gr,Timeline:ws,Animation:fv,getCache:sh,_removeLinkedListItem:Zw,reverting:function(){return Bi},context:function(e){return e&&rr&&(rr.data.push(e),e._ctx=rr),rr},suppressOverwrites:function(e){return JR=e}}};qs("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return v_[n]=Gr[n]});yo.add(ws.updateRoot);up=v_.to({},{duration:0});var dse=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},pse=function(e,t){var r=e._targets,i,s,o;for(i in t)for(s=r.length;s--;)o=e._ptLookup[s][i],o&&(o=o.d)&&(o._pt&&(o=dse(o,i)),o&&o.modifier&&o.modifier(t[i],e,r[s],i))},jE=function(e,t){return{name:e,headless:1,rawVars:1,init:function(i,s,o){o._onInit=function(a){var l,u;if(Si(s)&&(l={},qs(s,function(c){return l[c]=1}),s=l),t){l={};for(u in s)l[u]=t(s[u]);s=l}pse(a,s)}}}},Js=v_.registerPlugin({name:"attr",init:function(e,t,r,i,s){var o,a,l;this.tween=r;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],i,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var r=t._pt;r;)Bi?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",headless:1,init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},jE("roundProps",YT),jE("modifiers"),jE("snap",BV))||v_;Gr.version=ws.version=Js.version="3.14.2";SV=1;eP()&&em();gn.Power0;gn.Power1;gn.Power2;gn.Power3;gn.Power4;gn.Linear;gn.Quad;gn.Cubic;gn.Quart;gn.Quint;gn.Strong;gn.Elastic;gn.Back;gn.SteppedEase;gn.Bounce;gn.Sine;gn.Expo;gn.Circ;/*!
 * CSSPlugin 3.14.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var UL,oc,Mp,hP,$f,zL,dP,mse=function(){return typeof window<"u"},yu={},If=180/Math.PI,Tp=Math.PI/180,Sd=Math.atan2,VL=1e8,pP=/([A-Z])/g,gse=/(left|right|width|margin|padding|x)/i,vse=/[\s,\(]\S/,hl={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},JT=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},yse=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},xse=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},_se=function(e,t){return t.set(t.t,t.p,e===1?t.e:e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},wse=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},s7=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},o7=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},bse=function(e,t,r){return e.style[t]=r},Sse=function(e,t,r){return e.style.setProperty(t,r)},Ese=function(e,t,r){return e._gsap[t]=r},Mse=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},Tse=function(e,t,r,i,s){var o=e._gsap;o.scaleX=o.scaleY=r,o.renderTransform(s,o)},Cse=function(e,t,r,i,s){var o=e._gsap;o[t]=r,o.renderTransform(s,o)},hr="transform",Ks=hr+"Origin",Ase=function n(e,t){var r=this,i=this.target,s=i.style,o=i._gsap;if(e in yu&&s){if(this.tfm=this.tfm||{},e!=="transform")e=hl[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return r.tfm[a]=Kl(i,a)}):this.tfm[e]=o.x?o[e]:Kl(i,e),e===Ks&&(this.tfm.zOrigin=o.zOrigin);else return hl.transform.split(",").forEach(function(a){return n.call(r,a,t)});if(this.props.indexOf(hr)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(Ks,t,"")),e=hr}(s||t)&&this.props.push(e,t,s[e])},a7=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Rse=function(){var e=this.props,t=this.target,r=t.style,i=t._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?r[e[s]]=e[s+2]:r.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(pP,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)i[o]=this.tfm[o];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=dP(),(!s||!s.isStart)&&!r[hr]&&(a7(r),i.zOrigin&&r[Ks]&&(r[Ks]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},l7=function(e,t){var r={target:e,props:[],revert:Rse,save:Ase};return e._gsap||Js.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(i){return r.save(i)}),r},u7,QT=function(e,t){var r=oc.createElementNS?oc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):oc.createElement(e);return r&&r.style?r:oc.createElement(e)},bo=function n(e,t,r){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(pP,"-$1").toLowerCase())||i.getPropertyValue(t)||!r&&n(e,tm(t)||t,1)||""},WL="O,Moz,ms,Ms,Webkit".split(","),tm=function(e,t,r){var i=t||$f,s=i.style,o=5;if(e in s&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(WL[o]+e in s););return o<0?null:(o===3?"ms":o>=0?WL[o]:"")+e},eC=function(){mse()&&window.document&&(UL=window,oc=UL.document,Mp=oc.documentElement,$f=QT("div")||{style:{}},QT("div"),hr=tm(hr),Ks=hr+"Origin",$f.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",u7=!!tm("perspective"),dP=Js.core.reverting,hP=1)},HL=function(e){var t=e.ownerSVGElement,r=QT("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=e.cloneNode(!0),s;i.style.display="block",r.appendChild(i),Mp.appendChild(r);try{s=i.getBBox()}catch{}return r.removeChild(i),Mp.removeChild(r),s},GL=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},c7=function(e){var t,r;try{t=e.getBBox()}catch{t=HL(e),r=1}return t&&(t.width||t.height)||r||(t=HL(e)),t&&!t.width&&!t.x&&!t.y?{x:+GL(e,["x","cx","x1"])||0,y:+GL(e,["y","cy","y1"])||0,width:0,height:0}:t},f7=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&c7(e))},Oc=function(e,t){if(t){var r=e.style,i;t in yu&&t!==Ks&&(t=hr),r.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(i==="--"?t:t.replace(pP,"-$1").toLowerCase())):r.removeAttribute(t)}},ac=function(e,t,r,i,s,o){var a=new Ys(e._pt,t,r,0,1,o?o7:s7);return e._pt=a,a.b=i,a.e=s,e._props.push(r),a},jL={deg:1,rad:1,turn:1},Pse={grid:1,flex:1},Bc=function n(e,t,r,i){var s=parseFloat(r)||0,o=(r+"").trim().substr((s+"").length)||"px",a=$f.style,l=gse.test(t),u=e.tagName.toLowerCase()==="svg",c=(u?"client":"offset")+(l?"Width":"Height"),f=100,h=i==="px",d=i==="%",p,y,x,m;if(i===o||!s||jL[i]||jL[o])return s;if(o!=="px"&&!h&&(s=n(e,t,r,"px")),m=e.getCTM&&f7(e),(d||o==="%")&&(yu[t]||~t.indexOf("adius")))return p=m?e.getBBox()[l?"width":"height"]:e[c],Nr(d?s/p*f:s/100*p);if(a[l?"width":"height"]=f+(h?o:i),y=i!=="rem"&&~t.indexOf("adius")||i==="em"&&e.appendChild&&!u?e:e.parentNode,m&&(y=(e.ownerSVGElement||{}).parentNode),(!y||y===oc||!y.appendChild)&&(y=oc.body),x=y._gsap,x&&d&&x.width&&l&&x.time===yo.time&&!x.uncache)return Nr(s/x.width*f);if(d&&(t==="height"||t==="width")){var _=e.style[t];e.style[t]=f+i,p=e[c],_?e.style[t]=_:Oc(e,t)}else(d||o==="%")&&!Pse[bo(y,"display")]&&(a.position=bo(e,"position")),y===e&&(a.position="static"),y.appendChild($f),p=$f[c],y.removeChild($f),a.position="absolute";return l&&d&&(x=sh(y),x.time=yo.time,x.width=y[c]),Nr(h?p*s/f:p&&s?f/p*s:0)},Kl=function(e,t,r,i){var s;return hP||eC(),t in hl&&t!=="transform"&&(t=hl[t],~t.indexOf(",")&&(t=t.split(",")[0])),yu[t]&&t!=="transform"?(s=dv(e,i),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:x_(bo(e,Ks))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||i||~(s+"").indexOf("calc("))&&(s=y_[t]&&y_[t](e,t,r)||bo(e,t)||CV(e,t)||(t==="opacity"?1:0))),r&&!~(s+"").trim().indexOf(" ")?Bc(e,t,s,r)+r:s},Ise=function(e,t,r,i){if(!r||r==="none"){var s=tm(t,e,1),o=s&&bo(e,s,1);o&&o!==r?(t=s,r=o):t==="borderColor"&&(r=bo(e,"borderTopColor"))}var a=new Ys(this._pt,e.style,t,0,1,n7),l=0,u=0,c,f,h,d,p,y,x,m,_,w,b,S;if(a.b=r,a.e=i,r+="",i+="",i.substring(0,6)==="var(--"&&(i=bo(e,i.substring(4,i.indexOf(")")))),i==="auto"&&(y=e.style[t],e.style[t]=i,i=bo(e,t)||i,y?e.style[t]=y:Oc(e,t)),c=[r,i],XV(c),r=c[0],i=c[1],h=r.match(lp)||[],S=i.match(lp)||[],S.length){for(;f=lp.exec(i);)x=f[0],_=i.substring(l,f.index),p?p=(p+1)%5:(_.substr(-5)==="rgba("||_.substr(-5)==="hsla(")&&(p=1),x!==(y=h[u++]||"")&&(d=parseFloat(y)||0,b=y.substr((d+"").length),x.charAt(1)==="="&&(x=Ep(d,x)+b),m=parseFloat(x),w=x.substr((m+"").length),l=lp.lastIndex-w.length,w||(w=w||Ao.units[t]||b,l===i.length&&(i+=w,a.e+=w)),b!==w&&(d=Bc(e,t,y,w)||0),a._pt={_next:a._pt,p:_||u===1?_:",",s:d,c:m-d,m:p&&p<4||t==="zIndex"?Math.round:0});a.c=l<i.length?i.substring(l,i.length):""}else a.r=t==="display"&&i==="none"?o7:s7;return bV.test(i)&&(a.e=0),this._pt=a,a},XL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Dse=function(e){var t=e.split(" "),r=t[0],i=t[1]||"50%";return(r==="top"||r==="bottom"||i==="left"||i==="right")&&(e=r,r=i,i=e),t[0]=XL[r]||r,t[1]=XL[i]||i,t.join(" ")},Nse=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,i=r.style,s=t.u,o=r._gsap,a,l,u;if(s==="all"||s===!0)i.cssText="",l=1;else for(s=s.split(","),u=s.length;--u>-1;)a=s[u],yu[a]&&(l=1,a=a==="transformOrigin"?Ks:hr),Oc(r,a);l&&(Oc(r,hr),o&&(o.svg&&r.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",dv(r,1),o.uncache=1,a7(i)))}},y_={clearProps:function(e,t,r,i,s){if(s.data!=="isFromStart"){var o=e._pt=new Ys(e._pt,t,r,0,0,Nse);return o.u=i,o.pr=-10,o.tween=s,e._props.push(r),1}}},hv=[1,0,0,1,0,0],h7={},d7=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},$L=function(e){var t=bo(e,hr);return d7(t)?hv:t.substr(7).match(wV).map(Nr)},mP=function(e,t){var r=e._gsap||sh(e),i=e.style,s=$L(e),o,a,l,u;return r.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?hv:s):(s===hv&&!e.offsetParent&&e!==Mp&&!r.svg&&(l=i.display,i.display="block",o=e.parentNode,(!o||!e.offsetParent&&!e.getBoundingClientRect().width)&&(u=1,a=e.nextElementSibling,Mp.appendChild(e)),s=$L(e),l?i.display=l:Oc(e,"display"),u&&(a?o.insertBefore(e,a):o?o.appendChild(e):Mp.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},tC=function(e,t,r,i,s,o){var a=e._gsap,l=s||mP(e,!0),u=a.xOrigin||0,c=a.yOrigin||0,f=a.xOffset||0,h=a.yOffset||0,d=l[0],p=l[1],y=l[2],x=l[3],m=l[4],_=l[5],w=t.split(" "),b=parseFloat(w[0])||0,S=parseFloat(w[1])||0,M,T,P,C;r?l!==hv&&(T=d*x-p*y)&&(P=b*(x/T)+S*(-y/T)+(y*_-x*m)/T,C=b*(-p/T)+S*(d/T)-(d*_-p*m)/T,b=P,S=C):(M=c7(e),b=M.x+(~w[0].indexOf("%")?b/100*M.width:b),S=M.y+(~(w[1]||w[0]).indexOf("%")?S/100*M.height:S)),i||i!==!1&&a.smooth?(m=b-u,_=S-c,a.xOffset=f+(m*d+_*y)-m,a.yOffset=h+(m*p+_*x)-_):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=S,a.smooth=!!i,a.origin=t,a.originIsAbsolute=!!r,e.style[Ks]="0px 0px",o&&(ac(o,a,"xOrigin",u,b),ac(o,a,"yOrigin",c,S),ac(o,a,"xOffset",f,a.xOffset),ac(o,a,"yOffset",h,a.yOffset)),e.setAttribute("data-svg-origin",b+" "+S)},dv=function(e,t){var r=e._gsap||new KV(e);if("x"in r&&!t&&!r.uncache)return r;var i=e.style,s=r.scaleX<0,o="px",a="deg",l=getComputedStyle(e),u=bo(e,Ks)||"0",c,f,h,d,p,y,x,m,_,w,b,S,M,T,P,C,A,k,L,H,F,V,W,G,N,B,D,$,ee,te,se,me;return c=f=h=y=x=m=_=w=b=0,d=p=1,r.svg=!!(e.getCTM&&f7(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[hr]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[hr]!=="none"?l[hr]:"")),i.scale=i.rotate=i.translate="none"),T=mP(e,r.svg),r.svg&&(r.uncache?(N=e.getBBox(),u=r.xOrigin-N.x+"px "+(r.yOrigin-N.y)+"px",G=""):G=!t&&e.getAttribute("data-svg-origin"),tC(e,G||u,!!G||r.originIsAbsolute,r.smooth!==!1,T)),S=r.xOrigin||0,M=r.yOrigin||0,T!==hv&&(k=T[0],L=T[1],H=T[2],F=T[3],c=V=T[4],f=W=T[5],T.length===6?(d=Math.sqrt(k*k+L*L),p=Math.sqrt(F*F+H*H),y=k||L?Sd(L,k)*If:0,_=H||F?Sd(H,F)*If+y:0,_&&(p*=Math.abs(Math.cos(_*Tp))),r.svg&&(c-=S-(S*k+M*H),f-=M-(S*L+M*F))):(me=T[6],te=T[7],D=T[8],$=T[9],ee=T[10],se=T[11],c=T[12],f=T[13],h=T[14],P=Sd(me,ee),x=P*If,P&&(C=Math.cos(-P),A=Math.sin(-P),G=V*C+D*A,N=W*C+$*A,B=me*C+ee*A,D=V*-A+D*C,$=W*-A+$*C,ee=me*-A+ee*C,se=te*-A+se*C,V=G,W=N,me=B),P=Sd(-H,ee),m=P*If,P&&(C=Math.cos(-P),A=Math.sin(-P),G=k*C-D*A,N=L*C-$*A,B=H*C-ee*A,se=F*A+se*C,k=G,L=N,H=B),P=Sd(L,k),y=P*If,P&&(C=Math.cos(P),A=Math.sin(P),G=k*C+L*A,N=V*C+W*A,L=L*C-k*A,W=W*C-V*A,k=G,V=N),x&&Math.abs(x)+Math.abs(y)>359.9&&(x=y=0,m=180-m),d=Nr(Math.sqrt(k*k+L*L+H*H)),p=Nr(Math.sqrt(W*W+me*me)),P=Sd(V,W),_=Math.abs(P)>2e-4?P*If:0,b=se?1/(se<0?-se:se):0),r.svg&&(G=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!d7(bo(e,hr)),G&&e.setAttribute("transform",G))),Math.abs(_)>90&&Math.abs(_)<270&&(s?(d*=-1,_+=y<=0?180:-180,y+=y<=0?180:-180):(p*=-1,_+=_<=0?180:-180)),t=t||r.uncache,r.x=c-((r.xPercent=c&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-c)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+o,r.y=f-((r.yPercent=f&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-f)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+o,r.z=h+o,r.scaleX=Nr(d),r.scaleY=Nr(p),r.rotation=Nr(y)+a,r.rotationX=Nr(x)+a,r.rotationY=Nr(m)+a,r.skewX=_+a,r.skewY=w+a,r.transformPerspective=b+o,(r.zOrigin=parseFloat(u.split(" ")[2])||!t&&r.zOrigin||0)&&(i[Ks]=x_(u)),r.xOffset=r.yOffset=0,r.force3D=Ao.force3D,r.renderTransform=r.svg?Lse:u7?p7:kse,r.uncache=0,r},x_=function(e){return(e=e.split(" "))[0]+" "+e[1]},XE=function(e,t,r){var i=es(t);return Nr(parseFloat(t)+parseFloat(Bc(e,"x",r+"px",i)))+i},kse=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,p7(e,t)},bf="0deg",h0="0px",Sf=") ",p7=function(e,t){var r=t||this,i=r.xPercent,s=r.yPercent,o=r.x,a=r.y,l=r.z,u=r.rotation,c=r.rotationY,f=r.rotationX,h=r.skewX,d=r.skewY,p=r.scaleX,y=r.scaleY,x=r.transformPerspective,m=r.force3D,_=r.target,w=r.zOrigin,b="",S=m==="auto"&&e&&e!==1||m===!0;if(w&&(f!==bf||c!==bf)){var M=parseFloat(c)*Tp,T=Math.sin(M),P=Math.cos(M),C;M=parseFloat(f)*Tp,C=Math.cos(M),o=XE(_,o,T*C*-w),a=XE(_,a,-Math.sin(M)*-w),l=XE(_,l,P*C*-w+w)}x!==h0&&(b+="perspective("+x+Sf),(i||s)&&(b+="translate("+i+"%, "+s+"%) "),(S||o!==h0||a!==h0||l!==h0)&&(b+=l!==h0||S?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Sf),u!==bf&&(b+="rotate("+u+Sf),c!==bf&&(b+="rotateY("+c+Sf),f!==bf&&(b+="rotateX("+f+Sf),(h!==bf||d!==bf)&&(b+="skew("+h+", "+d+Sf),(p!==1||y!==1)&&(b+="scale("+p+", "+y+Sf),_.style[hr]=b||"translate(0, 0)"},Lse=function(e,t){var r=t||this,i=r.xPercent,s=r.yPercent,o=r.x,a=r.y,l=r.rotation,u=r.skewX,c=r.skewY,f=r.scaleX,h=r.scaleY,d=r.target,p=r.xOrigin,y=r.yOrigin,x=r.xOffset,m=r.yOffset,_=r.forceCSS,w=parseFloat(o),b=parseFloat(a),S,M,T,P,C;l=parseFloat(l),u=parseFloat(u),c=parseFloat(c),c&&(c=parseFloat(c),u+=c,l+=c),l||u?(l*=Tp,u*=Tp,S=Math.cos(l)*f,M=Math.sin(l)*f,T=Math.sin(l-u)*-h,P=Math.cos(l-u)*h,u&&(c*=Tp,C=Math.tan(u-c),C=Math.sqrt(1+C*C),T*=C,P*=C,c&&(C=Math.tan(c),C=Math.sqrt(1+C*C),S*=C,M*=C)),S=Nr(S),M=Nr(M),T=Nr(T),P=Nr(P)):(S=f,P=h,M=T=0),(w&&!~(o+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(w=Bc(d,"x",o,"px"),b=Bc(d,"y",a,"px")),(p||y||x||m)&&(w=Nr(w+p-(p*S+y*T)+x),b=Nr(b+y-(p*M+y*P)+m)),(i||s)&&(C=d.getBBox(),w=Nr(w+i/100*C.width),b=Nr(b+s/100*C.height)),C="matrix("+S+","+M+","+T+","+P+","+w+","+b+")",d.setAttribute("transform",C),_&&(d.style[hr]=C)},Fse=function(e,t,r,i,s){var o=360,a=Si(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?If:1),u=l-i,c=i+u+"deg",f,h;return a&&(f=s.split("_")[1],f==="short"&&(u%=o,u!==u%(o/2)&&(u+=u<0?o:-o)),f==="cw"&&u<0?u=(u+o*VL)%o-~~(u/o)*o:f==="ccw"&&u>0&&(u=(u-o*VL)%o-~~(u/o)*o)),e._pt=h=new Ys(e._pt,t,r,i,u,yse),h.e=c,h.u="deg",e._props.push(r),h},qL=function(e,t){for(var r in t)e[r]=t[r];return e},Ose=function(e,t,r){var i=qL({},r._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=r.style,a,l,u,c,f,h,d,p;i.svg?(u=r.getAttribute("transform"),r.setAttribute("transform",""),o[hr]=t,a=dv(r,1),Oc(r,hr),r.setAttribute("transform",u)):(u=getComputedStyle(r)[hr],o[hr]=t,a=dv(r,1),o[hr]=u);for(l in yu)u=i[l],c=a[l],u!==c&&s.indexOf(l)<0&&(d=es(u),p=es(c),f=d!==p?Bc(r,l,u,p):parseFloat(u),h=parseFloat(c),e._pt=new Ys(e._pt,a,l,f,h-f,JT),e._pt.u=p||0,e._props.push(l));qL(a,i)};qs("padding,margin,Width,Radius",function(n,e){var t="Top",r="Right",i="Bottom",s="Left",o=(e<3?[t,r,i,s]:[t+s,t+r,i+r,i+s]).map(function(a){return e<2?n+a:"border"+a+n});y_[e>1?"border"+n:n]=function(a,l,u,c,f){var h,d;if(arguments.length<4)return h=o.map(function(p){return Kl(a,p,u)}),d=h.join(" "),d.split(h[0]).length===5?h[0]:d;h=(c+"").split(" "),d={},o.forEach(function(p,y){return d[p]=h[y]=h[y]||h[(y-1)/2|0]}),a.init(l,d,f)}});var m7={name:"css",register:eC,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,i,s){var o=this._props,a=e.style,l=r.vars.startAt,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P,C;hP||eC(),this.styles=this.styles||l7(e),P=this.styles.props,this.tween=r;for(y in t)if(y!=="autoRound"&&(c=t[y],!(po[y]&&ZV(y,t,r,i,e,s)))){if(d=typeof c,p=y_[y],d==="function"&&(c=c.call(r,i,e,s),d=typeof c),d==="string"&&~c.indexOf("random(")&&(c=uv(c)),p)p(this,e,y,c,r)&&(T=1);else if(y.substr(0,2)==="--")u=(getComputedStyle(e).getPropertyValue(y)+"").trim(),c+="",Sc.lastIndex=0,Sc.test(u)||(x=es(u),m=es(c),m?x!==m&&(u=Bc(e,y,u,m)+m):x&&(c+=x)),this.add(a,"setProperty",u,c,i,s,0,0,y),o.push(y),P.push(y,0,a[y]);else if(d!=="undefined"){if(l&&y in l?(u=typeof l[y]=="function"?l[y].call(r,i,e,s):l[y],Si(u)&&~u.indexOf("random(")&&(u=uv(u)),es(u+"")||u==="auto"||(u+=Ao.units[y]||es(Kl(e,y))||""),(u+"").charAt(1)==="="&&(u=Kl(e,y))):u=Kl(e,y),h=parseFloat(u),_=d==="string"&&c.charAt(1)==="="&&c.substr(0,2),_&&(c=c.substr(2)),f=parseFloat(c),y in hl&&(y==="autoAlpha"&&(h===1&&Kl(e,"visibility")==="hidden"&&f&&(h=0),P.push("visibility",0,a.visibility),ac(this,a,"visibility",h?"inherit":"hidden",f?"inherit":"hidden",!f)),y!=="scale"&&y!=="transform"&&(y=hl[y],~y.indexOf(",")&&(y=y.split(",")[0]))),w=y in yu,w){if(this.styles.save(y),C=c,d==="string"&&c.substring(0,6)==="var(--"){if(c=bo(e,c.substring(4,c.indexOf(")"))),c.substring(0,5)==="calc("){var A=e.style.perspective;e.style.perspective=c,c=bo(e,"perspective"),A?e.style.perspective=A:Oc(e,"perspective")}f=parseFloat(c)}if(b||(S=e._gsap,S.renderTransform&&!t.parseTransform||dv(e,t.parseTransform),M=t.smoothOrigin!==!1&&S.smooth,b=this._pt=new Ys(this._pt,a,hr,0,1,S.renderTransform,S,0,-1),b.dep=1),y==="scale")this._pt=new Ys(this._pt,S,"scaleY",S.scaleY,(_?Ep(S.scaleY,_+f):f)-S.scaleY||0,JT),this._pt.u=0,o.push("scaleY",y),y+="X";else if(y==="transformOrigin"){P.push(Ks,0,a[Ks]),c=Dse(c),S.svg?tC(e,c,0,M,0,this):(m=parseFloat(c.split(" ")[2])||0,m!==S.zOrigin&&ac(this,S,"zOrigin",S.zOrigin,m),ac(this,a,y,x_(u),x_(c)));continue}else if(y==="svgOrigin"){tC(e,c,1,M,0,this);continue}else if(y in h7){Fse(this,S,y,h,_?Ep(h,_+c):c);continue}else if(y==="smoothOrigin"){ac(this,S,"smooth",S.smooth,c);continue}else if(y==="force3D"){S[y]=c;continue}else if(y==="transform"){Ose(this,c,e);continue}}else y in a||(y=tm(y)||y);if(w||(f||f===0)&&(h||h===0)&&!vse.test(c)&&y in a)x=(u+"").substr((h+"").length),f||(f=0),m=es(c)||(y in Ao.units?Ao.units[y]:x),x!==m&&(h=Bc(e,y,u,m)),this._pt=new Ys(this._pt,w?S:a,y,h,(_?Ep(h,_+f):f)-h,!w&&(m==="px"||y==="zIndex")&&t.autoRound!==!1?wse:JT),this._pt.u=m||0,w&&C!==c?(this._pt.b=u,this._pt.e=C,this._pt.r=_se):x!==m&&m!=="%"&&(this._pt.b=u,this._pt.r=xse);else if(y in a)Ise.call(this,e,y,u,_?_+c:c);else if(y in e)this.add(e,y,u||e[y],_?_+c:c,i,s);else if(y!=="parseTransform"){nP(y,c);continue}w||(y in a?P.push(y,0,a[y]):typeof e[y]=="function"?P.push(y,2,e[y]()):P.push(y,1,u||e[y])),o.push(y)}}T&&r7(this)},render:function(e,t){if(t.tween._time||!dP())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:Kl,aliases:hl,getSetter:function(e,t,r){var i=hl[t];return i&&i.indexOf(",")<0&&(t=i),t in yu&&t!==Ks&&(e._gsap.x||Kl(e,"x"))?r&&zL===r?t==="scale"?Mse:Ese:(zL=r||{})&&(t==="scale"?Tse:Cse):e.style&&!QR(e.style[t])?bse:~t.indexOf("-")?Sse:cP(e,t)},core:{_removeProperty:Oc,_getMatrix:mP}};Js.utils.checkPrefix=tm;Js.core.getStyleSaver=l7;(function(n,e,t,r){var i=qs(n+","+e+","+t,function(s){yu[s]=1});qs(e,function(s){Ao.units[s]="deg",h7[s]=1}),hl[i[13]]=n+","+e,qs(r,function(s){var o=s.split(":");hl[o[1]]=i[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");qs("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Ao.units[n]="px"});Js.registerPlugin(m7);var Wt=Js.registerPlugin(m7)||Js;Wt.core.Tween;function Bse(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Use(n,e,t){return e&&Bse(n.prototype,e),n}/*!
 * Observer 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Li,S2,xo,lc,uc,Cp,g7,Df,ng,v7,ru,ba,y7,x7=function(){return Li||typeof window<"u"&&(Li=window.gsap)&&Li.registerPlugin&&Li},_7=1,cp=[],an=[],_l=[],rg=Date.now,nC=function(e,t){return t},zse=function(){var e=ng.core,t=e.bridge||{},r=e._scrollers,i=e._proxies;r.push.apply(r,an),i.push.apply(i,_l),an=r,_l=i,nC=function(o,a){return t[o](a)}},Ec=function(e,t){return~_l.indexOf(e)&&_l[_l.indexOf(e)+1][t]},ig=function(e){return!!~v7.indexOf(e)},ds=function(e,t,r,i,s){return e.addEventListener(t,r,{passive:i!==!1,capture:!!s})},hs=function(e,t,r,i){return e.removeEventListener(t,r,!!i)},vx="scrollLeft",yx="scrollTop",rC=function(){return ru&&ru.isPressed||an.cache++},__=function(e,t){var r=function i(s){if(s||s===0){_7&&(xo.history.scrollRestoration="manual");var o=ru&&ru.isPressed;s=i.v=Math.round(s)||(ru&&ru.iOS?1:0),e(s),i.cacheID=an.cache,o&&nC("ss",s)}else(t||an.cache!==i.cacheID||nC("ref"))&&(i.cacheID=an.cache,i.v=e());return i.v+i.offset};return r.offset=0,e&&r},bs={s:vx,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:__(function(n){return arguments.length?xo.scrollTo(n,ei.sc()):xo.pageXOffset||lc[vx]||uc[vx]||Cp[vx]||0})},ei={s:yx,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:bs,sc:__(function(n){return arguments.length?xo.scrollTo(bs.sc(),n):xo.pageYOffset||lc[yx]||uc[yx]||Cp[yx]||0})},ks=function(e,t){return(t&&t._ctx&&t._ctx.selector||Li.utils.toArray)(e)[0]||(typeof e=="string"&&Li.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},Vse=function(e,t){for(var r=t.length;r--;)if(t[r]===e||t[r].contains(e))return!0;return!1},Uc=function(e,t){var r=t.s,i=t.sc;ig(e)&&(e=lc.scrollingElement||uc);var s=an.indexOf(e),o=i===ei.sc?1:2;!~s&&(s=an.push(e)-1),an[s+o]||ds(e,"scroll",rC);var a=an[s+o],l=a||(an[s+o]=__(Ec(e,r),!0)||(ig(e)?i:__(function(u){return arguments.length?e[r]=u:e[r]})));return l.target=e,a||(l.smooth=Li.getProperty(e,"scrollBehavior")==="smooth"),l},iC=function(e,t,r){var i=e,s=e,o=rg(),a=o,l=t||50,u=Math.max(500,l*3),c=function(p,y){var x=rg();y||x-o>l?(s=i,i=p,a=o,o=x):r?i+=p:i=s+(p-s)/(x-a)*(o-a)},f=function(){s=i=r?0:i,a=o=0},h=function(p){var y=a,x=s,m=rg();return(p||p===0)&&p!==i&&c(p),o===a||m-a>u?0:(i+(r?x:-x))/((r?m:o)-y)*1e3};return{update:c,reset:f,getVelocity:h}},d0=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},YL=function(e){var t=Math.max.apply(Math,e),r=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(r)?t:r},w7=function(){ng=Li.core.globals().ScrollTrigger,ng&&ng.core&&zse()},b7=function(e){return Li=e||x7(),!S2&&Li&&typeof document<"u"&&document.body&&(xo=window,lc=document,uc=lc.documentElement,Cp=lc.body,v7=[xo,lc,uc,Cp],Li.utils.clamp,y7=Li.core.context||function(){},Df="onpointerenter"in Cp?"pointer":"mouse",g7=Fr.isTouch=xo.matchMedia&&xo.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in xo||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,ba=Fr.eventTypes=("ontouchstart"in uc?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in uc?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return _7=0},500),w7(),S2=1),S2};bs.op=ei;an.cache=0;var Fr=function(){function n(t){this.init(t)}var e=n.prototype;return e.init=function(r){S2||b7(Li)||console.warn("Please gsap.registerPlugin(Observer)"),ng||w7();var i=r.tolerance,s=r.dragMinimum,o=r.type,a=r.target,l=r.lineHeight,u=r.debounce,c=r.preventDefault,f=r.onStop,h=r.onStopDelay,d=r.ignore,p=r.wheelSpeed,y=r.event,x=r.onDragStart,m=r.onDragEnd,_=r.onDrag,w=r.onPress,b=r.onRelease,S=r.onRight,M=r.onLeft,T=r.onUp,P=r.onDown,C=r.onChangeX,A=r.onChangeY,k=r.onChange,L=r.onToggleX,H=r.onToggleY,F=r.onHover,V=r.onHoverEnd,W=r.onMove,G=r.ignoreCheck,N=r.isNormalizer,B=r.onGestureStart,D=r.onGestureEnd,$=r.onWheel,ee=r.onEnable,te=r.onDisable,se=r.onClick,me=r.scrollSpeed,_e=r.capture,pe=r.allowClicks,Ne=r.lockAxis,Ue=r.onLockAxis;this.target=a=ks(a)||uc,this.vars=r,d&&(d=Li.utils.toArray(d)),i=i||1e-9,s=s||0,p=p||1,me=me||1,o=o||"wheel,touch,pointer",u=u!==!1,l||(l=parseFloat(xo.getComputedStyle(Cp).lineHeight)||22);var We,Be,J,he,de,Ie,ve,oe=this,ze=0,X=0,j=r.passive||!c&&r.passive!==!1,ae=Uc(a,bs),Oe=Uc(a,ei),Se=ae(),K=Oe(),ge=~o.indexOf("touch")&&!~o.indexOf("pointer")&&ba[0]==="pointerdown",Te=ig(a),Le=a.ownerDocument||lc,Pe=[0,0,0],De=[0,0,0],Ae=0,ht=function(){return Ae=rg()},Ze=function(ot,xt){return(oe.event=ot)&&d&&Vse(ot.target,d)||xt&&ge&&ot.pointerType!=="touch"||G&&G(ot,xt)},at=function(){oe._vx.reset(),oe._vy.reset(),Be.pause(),f&&f(oe)},Qe=function(){var ot=oe.deltaX=YL(Pe),xt=oe.deltaY=YL(De),Ge=Math.abs(ot)>=i,wt=Math.abs(xt)>=i;k&&(Ge||wt)&&k(oe,ot,xt,Pe,De),Ge&&(S&&oe.deltaX>0&&S(oe),M&&oe.deltaX<0&&M(oe),C&&C(oe),L&&oe.deltaX<0!=ze<0&&L(oe),ze=oe.deltaX,Pe[0]=Pe[1]=Pe[2]=0),wt&&(P&&oe.deltaY>0&&P(oe),T&&oe.deltaY<0&&T(oe),A&&A(oe),H&&oe.deltaY<0!=X<0&&H(oe),X=oe.deltaY,De[0]=De[1]=De[2]=0),(he||J)&&(W&&W(oe),J&&(x&&J===1&&x(oe),_&&_(oe),J=0),he=!1),Ie&&!(Ie=!1)&&Ue&&Ue(oe),de&&($(oe),de=!1),We=0},$e=function(ot,xt,Ge){Pe[Ge]+=ot,De[Ge]+=xt,oe._vx.update(ot),oe._vy.update(xt),u?We||(We=requestAnimationFrame(Qe)):Qe()},Dt=function(ot,xt){Ne&&!ve&&(oe.axis=ve=Math.abs(ot)>Math.abs(xt)?"x":"y",Ie=!0),ve!=="y"&&(Pe[2]+=ot,oe._vx.update(ot,!0)),ve!=="x"&&(De[2]+=xt,oe._vy.update(xt,!0)),u?We||(We=requestAnimationFrame(Qe)):Qe()},Ft=function(ot){if(!Ze(ot,1)){ot=d0(ot,c);var xt=ot.clientX,Ge=ot.clientY,wt=xt-oe.x,Et=Ge-oe.y,kt=oe.isDragging;oe.x=xt,oe.y=Ge,(kt||(wt||Et)&&(Math.abs(oe.startX-xt)>=s||Math.abs(oe.startY-Ge)>=s))&&(J||(J=kt?2:1),kt||(oe.isDragging=!0),Dt(wt,Et))}},sn=oe.onPress=function(ut){Ze(ut,1)||ut&&ut.button||(oe.axis=ve=null,Be.pause(),oe.isPressed=!0,ut=d0(ut),ze=X=0,oe.startX=oe.x=ut.clientX,oe.startY=oe.y=ut.clientY,oe._vx.reset(),oe._vy.reset(),ds(N?a:Le,ba[1],Ft,j,!0),oe.deltaX=oe.deltaY=0,w&&w(oe))},Ke=oe.onRelease=function(ut){if(!Ze(ut,1)){hs(N?a:Le,ba[1],Ft,!0);var ot=!isNaN(oe.y-oe.startY),xt=oe.isDragging,Ge=xt&&(Math.abs(oe.x-oe.startX)>3||Math.abs(oe.y-oe.startY)>3),wt=d0(ut);!Ge&&ot&&(oe._vx.reset(),oe._vy.reset(),c&&pe&&Li.delayedCall(.08,function(){if(rg()-Ae>300&&!ut.defaultPrevented){if(ut.target.click)ut.target.click();else if(Le.createEvent){var Et=Le.createEvent("MouseEvents");Et.initMouseEvent("click",!0,!0,xo,1,wt.screenX,wt.screenY,wt.clientX,wt.clientY,!1,!1,!1,!1,0,null),ut.target.dispatchEvent(Et)}}})),oe.isDragging=oe.isGesturing=oe.isPressed=!1,f&&xt&&!N&&Be.restart(!0),J&&Qe(),m&&xt&&m(oe),b&&b(oe,Ge)}},He=function(ot){return ot.touches&&ot.touches.length>1&&(oe.isGesturing=!0)&&B(ot,oe.isDragging)},re=function(){return(oe.isGesturing=!1)||D(oe)},je=function(ot){if(!Ze(ot)){var xt=ae(),Ge=Oe();$e((xt-Se)*me,(Ge-K)*me,1),Se=xt,K=Ge,f&&Be.restart(!0)}},qe=function(ot){if(!Ze(ot)){ot=d0(ot,c),$&&(de=!0);var xt=(ot.deltaMode===1?l:ot.deltaMode===2?xo.innerHeight:1)*p;$e(ot.deltaX*xt,ot.deltaY*xt,0),f&&!N&&Be.restart(!0)}},At=function(ot){if(!Ze(ot)){var xt=ot.clientX,Ge=ot.clientY,wt=xt-oe.x,Et=Ge-oe.y;oe.x=xt,oe.y=Ge,he=!0,f&&Be.restart(!0),(wt||Et)&&Dt(wt,Et)}},_t=function(ot){oe.event=ot,F(oe)},Jt=function(ot){oe.event=ot,V(oe)},cn=function(ot){return Ze(ot)||d0(ot,c)&&se(oe)};Be=oe._dc=Li.delayedCall(h||.25,at).pause(),oe.deltaX=oe.deltaY=0,oe._vx=iC(0,50,!0),oe._vy=iC(0,50,!0),oe.scrollX=ae,oe.scrollY=Oe,oe.isDragging=oe.isGesturing=oe.isPressed=!1,y7(this),oe.enable=function(ut){return oe.isEnabled||(ds(Te?Le:a,"scroll",rC),o.indexOf("scroll")>=0&&ds(Te?Le:a,"scroll",je,j,_e),o.indexOf("wheel")>=0&&ds(a,"wheel",qe,j,_e),(o.indexOf("touch")>=0&&g7||o.indexOf("pointer")>=0)&&(ds(a,ba[0],sn,j,_e),ds(Le,ba[2],Ke),ds(Le,ba[3],Ke),pe&&ds(a,"click",ht,!0,!0),se&&ds(a,"click",cn),B&&ds(Le,"gesturestart",He),D&&ds(Le,"gestureend",re),F&&ds(a,Df+"enter",_t),V&&ds(a,Df+"leave",Jt),W&&ds(a,Df+"move",At)),oe.isEnabled=!0,oe.isDragging=oe.isGesturing=oe.isPressed=he=J=!1,oe._vx.reset(),oe._vy.reset(),Se=ae(),K=Oe(),ut&&ut.type&&sn(ut),ee&&ee(oe)),oe},oe.disable=function(){oe.isEnabled&&(cp.filter(function(ut){return ut!==oe&&ig(ut.target)}).length||hs(Te?Le:a,"scroll",rC),oe.isPressed&&(oe._vx.reset(),oe._vy.reset(),hs(N?a:Le,ba[1],Ft,!0)),hs(Te?Le:a,"scroll",je,_e),hs(a,"wheel",qe,_e),hs(a,ba[0],sn,_e),hs(Le,ba[2],Ke),hs(Le,ba[3],Ke),hs(a,"click",ht,!0),hs(a,"click",cn),hs(Le,"gesturestart",He),hs(Le,"gestureend",re),hs(a,Df+"enter",_t),hs(a,Df+"leave",Jt),hs(a,Df+"move",At),oe.isEnabled=oe.isPressed=oe.isDragging=!1,te&&te(oe))},oe.kill=oe.revert=function(){oe.disable();var ut=cp.indexOf(oe);ut>=0&&cp.splice(ut,1),ru===oe&&(ru=0)},cp.push(oe),N&&ig(a)&&(ru=oe),oe.enable(y)},Use(n,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),n}();Fr.version="3.14.2";Fr.create=function(n){return new Fr(n)};Fr.register=b7;Fr.getAll=function(){return cp.slice()};Fr.getById=function(n){return cp.filter(function(e){return e.vars.id===n})[0]};x7()&&Li.registerPlugin(Fr);/*!
 * ScrollTrigger 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gt,Ld,on,jn,go,Nn,gP,w_,pv,sg,D0,xx,Yi,eb,sC,vs,KL,ZL,Fd,S7,$E,E7,ms,oC,M7,T7,Yu,aC,vP,Ap,yP,og,lC,qE,_x=1,Ki=Date.now,YE=Ki(),aa=0,N0=0,JL=function(e,t,r){var i=ho(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return r["_"+t+"Clamp"]=i,i?e.substr(6,e.length-7):e},QL=function(e,t){return t&&(!ho(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},Wse=function n(){return N0&&requestAnimationFrame(n)},eF=function(){return eb=1},tF=function(){return eb=0},sl=function(e){return e},k0=function(e){return Math.round(e*1e5)/1e5||0},C7=function(){return typeof window<"u"},A7=function(){return gt||C7()&&(gt=window.gsap)&&gt.registerPlugin&&gt},Sh=function(e){return!!~gP.indexOf(e)},R7=function(e){return(e==="Height"?yP:on["inner"+e])||go["client"+e]||Nn["client"+e]},P7=function(e){return Ec(e,"getBoundingClientRect")||(Sh(e)?function(){return A2.width=on.innerWidth,A2.height=yP,A2}:function(){return Jl(e)})},Hse=function(e,t,r){var i=r.d,s=r.d2,o=r.a;return(o=Ec(e,"getBoundingClientRect"))?function(){return o()[i]}:function(){return(t?R7(s):e["client"+s])||0}},Gse=function(e,t){return!t||~_l.indexOf(e)?P7(e):function(){return A2}},dl=function(e,t){var r=t.s,i=t.d2,s=t.d,o=t.a;return Math.max(0,(r="scroll"+i)&&(o=Ec(e,r))?o()-P7(e)()[s]:Sh(e)?(go[r]||Nn[r])-R7(i):e[r]-e["offset"+i])},wx=function(e,t){for(var r=0;r<Fd.length;r+=3)(!t||~t.indexOf(Fd[r+1]))&&e(Fd[r],Fd[r+1],Fd[r+2])},ho=function(e){return typeof e=="string"},ts=function(e){return typeof e=="function"},L0=function(e){return typeof e=="number"},Nf=function(e){return typeof e=="object"},p0=function(e,t,r){return e&&e.progress(t?0:1)&&r&&e.pause()},KE=function(e,t){if(e.enabled){var r=e._ctx?e._ctx.add(function(){return t(e)}):t(e);r&&r.totalTime&&(e.callbackAnimation=r)}},Ed=Math.abs,I7="left",D7="top",xP="right",_P="bottom",uh="width",ch="height",ag="Right",lg="Left",ug="Top",cg="Bottom",Wr="padding",Zo="margin",nm="Width",wP="Height",Kr="px",Jo=function(e){return on.getComputedStyle(e)},jse=function(e){var t=Jo(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},nF=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},Jl=function(e,t){var r=t&&Jo(e)[sC]!=="matrix(1, 0, 0, 1, 0, 0)"&&gt.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=e.getBoundingClientRect();return r&&r.progress(0).kill(),i},b_=function(e,t){var r=t.d2;return e["offset"+r]||e["client"+r]||0},N7=function(e){var t=[],r=e.labels,i=e.duration(),s;for(s in r)t.push(r[s]/i);return t},Xse=function(e){return function(t){return gt.utils.snap(N7(e),t)}},bP=function(e){var t=gt.utils.snap(e),r=Array.isArray(e)&&e.slice(0).sort(function(i,s){return i-s});return r?function(i,s,o){o===void 0&&(o=.001);var a;if(!s)return t(i);if(s>0){for(i-=o,a=0;a<r.length;a++)if(r[a]>=i)return r[a];return r[a-1]}else for(a=r.length,i+=o;a--;)if(r[a]<=i)return r[a];return r[0]}:function(i,s,o){o===void 0&&(o=.001);var a=t(i);return!s||Math.abs(a-i)<o||a-i<0==s<0?a:t(s<0?i-e:i+e)}},$se=function(e){return function(t,r){return bP(N7(e))(t,r.direction)}},bx=function(e,t,r,i){return r.split(",").forEach(function(s){return e(t,s,i)})},vi=function(e,t,r,i,s){return e.addEventListener(t,r,{passive:!i,capture:!!s})},gi=function(e,t,r,i){return e.removeEventListener(t,r,!!i)},Sx=function(e,t,r){r=r&&r.wheelHandler,r&&(e(t,"wheel",r),e(t,"touchmove",r))},rF={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Ex={toggleActions:"play",anticipatePin:0},S_={top:0,left:0,center:.5,bottom:1,right:1},E2=function(e,t){if(ho(e)){var r=e.indexOf("="),i=~r?+(e.charAt(r-1)+1)*parseFloat(e.substr(r+1)):0;~r&&(e.indexOf("%")>r&&(i*=t/100),e=e.substr(0,r-1)),e=i+(e in S_?S_[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Mx=function(e,t,r,i,s,o,a,l){var u=s.startColor,c=s.endColor,f=s.fontSize,h=s.indent,d=s.fontWeight,p=jn.createElement("div"),y=Sh(r)||Ec(r,"pinType")==="fixed",x=e.indexOf("scroller")!==-1,m=y?Nn:r,_=e.indexOf("start")!==-1,w=_?u:c,b="border-color:"+w+";font-size:"+f+";color:"+w+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return b+="position:"+((x||l)&&y?"fixed;":"absolute;"),(x||l||!y)&&(b+=(i===ei?xP:_P)+":"+(o+parseFloat(h))+"px;"),a&&(b+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),p._isStart=_,p.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),p.style.cssText=b,p.innerText=t||t===0?e+"-"+t:e,m.children[0]?m.insertBefore(p,m.children[0]):m.appendChild(p),p._offset=p["offset"+i.op.d2],M2(p,0,i,_),p},M2=function(e,t,r,i){var s={display:"block"},o=r[i?"os2":"p2"],a=r[i?"p2":"os2"];e._isFlipped=i,s[r.a+"Percent"]=i?-100:0,s[r.a]=i?"1px":0,s["border"+o+nm]=1,s["border"+a+nm]=0,s[r.p]=t+"px",gt.set(e,s)},rn=[],uC={},mv,iF=function(){return Ki()-aa>34&&(mv||(mv=requestAnimationFrame(lu)))},Md=function(){(!ms||!ms.isPressed||ms.startX>Nn.clientWidth)&&(an.cache++,ms?mv||(mv=requestAnimationFrame(lu)):lu(),aa||Mh("scrollStart"),aa=Ki())},ZE=function(){T7=on.innerWidth,M7=on.innerHeight},F0=function(e){an.cache++,(e===!0||!Yi&&!E7&&!jn.fullscreenElement&&!jn.webkitFullscreenElement&&(!oC||T7!==on.innerWidth||Math.abs(on.innerHeight-M7)>on.innerHeight*.25))&&w_.restart(!0)},Eh={},qse=[],k7=function n(){return gi(un,"scrollEnd",n)||qf(!0)},Mh=function(e){return Eh[e]&&Eh[e].map(function(t){return t()})||qse},co=[],L7=function(e){for(var t=0;t<co.length;t+=5)(!e||co[t+4]&&co[t+4].query===e)&&(co[t].style.cssText=co[t+1],co[t].getBBox&&co[t].setAttribute("transform",co[t+2]||""),co[t+3].uncache=1)},F7=function(){return an.forEach(function(e){return ts(e)&&++e.cacheID&&(e.rec=e())})},SP=function(e,t){var r;for(vs=0;vs<rn.length;vs++)r=rn[vs],r&&(!t||r._ctx===t)&&(e?r.kill(1):r.revert(!0,!0));og=!0,t&&L7(t),t||Mh("revert")},O7=function(e,t){an.cache++,(t||!ys)&&an.forEach(function(r){return ts(r)&&r.cacheID++&&(r.rec=0)}),ho(e)&&(on.history.scrollRestoration=vP=e)},ys,fh=0,sF,Yse=function(){if(sF!==fh){var e=sF=fh;requestAnimationFrame(function(){return e===fh&&qf(!0)})}},B7=function(){Nn.appendChild(Ap),yP=!ms&&Ap.offsetHeight||on.innerHeight,Nn.removeChild(Ap)},oF=function(e){return pv(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},qf=function(e,t){if(go=jn.documentElement,Nn=jn.body,gP=[on,jn,go,Nn],aa&&!e&&!og){vi(un,"scrollEnd",k7);return}B7(),ys=un.isRefreshing=!0,og||F7();var r=Mh("refreshInit");S7&&un.sort(),t||SP(),an.forEach(function(i){ts(i)&&(i.smooth&&(i.target.style.scrollBehavior="auto"),i(0))}),rn.slice(0).forEach(function(i){return i.refresh()}),og=!1,rn.forEach(function(i){if(i._subPinOffset&&i.pin){var s=i.vars.horizontal?"offsetWidth":"offsetHeight",o=i.pin[s];i.revert(!0,1),i.adjustPinSpacing(i.pin[s]-o),i.refresh()}}),lC=1,oF(!0),rn.forEach(function(i){var s=dl(i.scroller,i._dir),o=i.vars.end==="max"||i._endClamp&&i.end>s,a=i._startClamp&&i.start>=s;(o||a)&&i.setPositions(a?s-1:i.start,o?Math.max(a?s:i.start+1,s):i.end,!0)}),oF(!1),lC=0,r.forEach(function(i){return i&&i.render&&i.render(-1)}),an.forEach(function(i){ts(i)&&(i.smooth&&requestAnimationFrame(function(){return i.target.style.scrollBehavior="smooth"}),i.rec&&i(i.rec))}),O7(vP,1),w_.pause(),fh++,ys=2,lu(2),rn.forEach(function(i){return ts(i.vars.onRefresh)&&i.vars.onRefresh(i)}),ys=un.isRefreshing=!1,Mh("refresh")},cC=0,T2=1,fg,lu=function(e){if(e===2||!ys&&!og){un.isUpdating=!0,fg&&fg.update(0);var t=rn.length,r=Ki(),i=r-YE>=50,s=t&&rn[0].scroll();if(T2=cC>s?-1:1,ys||(cC=s),i&&(aa&&!eb&&r-aa>200&&(aa=0,Mh("scrollEnd")),D0=YE,YE=r),T2<0){for(vs=t;vs-- >0;)rn[vs]&&rn[vs].update(0,i);T2=1}else for(vs=0;vs<t;vs++)rn[vs]&&rn[vs].update(0,i);un.isUpdating=!1}mv=0},fC=[I7,D7,_P,xP,Zo+cg,Zo+ag,Zo+ug,Zo+lg,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],C2=fC.concat([uh,ch,"boxSizing","max"+nm,"max"+wP,"position",Zo,Wr,Wr+ug,Wr+ag,Wr+cg,Wr+lg]),Kse=function(e,t,r){Rp(r);var i=e._gsap;if(i.spacerIsNative)Rp(i.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},JE=function(e,t,r,i){if(!e._gsap.swappedIn){for(var s=fC.length,o=t.style,a=e.style,l;s--;)l=fC[s],o[l]=r[l];o.position=r.position==="absolute"?"absolute":"relative",r.display==="inline"&&(o.display="inline-block"),a[_P]=a[xP]="auto",o.flexBasis=r.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[uh]=b_(e,bs)+Kr,o[ch]=b_(e,ei)+Kr,o[Wr]=a[Zo]=a[D7]=a[I7]="0",Rp(i),a[uh]=a["max"+nm]=r[uh],a[ch]=a["max"+wP]=r[ch],a[Wr]=r[Wr],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},Zse=/([A-Z])/g,Rp=function(e){if(e){var t=e.t.style,r=e.length,i=0,s,o;for((e.t._gsap||gt.core.getCache(e.t)).uncache=1;i<r;i+=2)o=e[i+1],s=e[i],o?t[s]=o:t[s]&&t.removeProperty(s.replace(Zse,"-$1").toLowerCase())}},Tx=function(e){for(var t=C2.length,r=e.style,i=[],s=0;s<t;s++)i.push(C2[s],r[C2[s]]);return i.t=e,i},Jse=function(e,t,r){for(var i=[],s=e.length,o=r?8:0,a;o<s;o+=2)a=e[o],i.push(a,a in t?t[a]:e[o+1]);return i.t=e.t,i},A2={left:0,top:0},aF=function(e,t,r,i,s,o,a,l,u,c,f,h,d,p){ts(e)&&(e=e(l)),ho(e)&&e.substr(0,3)==="max"&&(e=h+(e.charAt(4)==="="?E2("0"+e.substr(3),r):0));var y=d?d.time():0,x,m,_;if(d&&d.seek(0),isNaN(e)||(e=+e),L0(e))d&&(e=gt.utils.mapRange(d.scrollTrigger.start,d.scrollTrigger.end,0,h,e)),a&&M2(a,r,i,!0);else{ts(t)&&(t=t(l));var w=(e||"0").split(" "),b,S,M,T;_=ks(t,l)||Nn,b=Jl(_)||{},(!b||!b.left&&!b.top)&&Jo(_).display==="none"&&(T=_.style.display,_.style.display="block",b=Jl(_),T?_.style.display=T:_.style.removeProperty("display")),S=E2(w[0],b[i.d]),M=E2(w[1]||"0",r),e=b[i.p]-u[i.p]-c+S+s-M,a&&M2(a,M,i,r-M<20||a._isStart&&M>20),r-=r-M}if(p&&(l[p]=e||-.001,e<0&&(e=0)),o){var P=e+r,C=o._isStart;x="scroll"+i.d2,M2(o,P,i,C&&P>20||!C&&(f?Math.max(Nn[x],go[x]):o.parentNode[x])<=P+1),f&&(u=Jl(a),f&&(o.style[i.op.p]=u[i.op.p]-i.op.m-o._offset+Kr))}return d&&_&&(x=Jl(_),d.seek(h),m=Jl(_),d._caScrollDist=x[i.p]-m[i.p],e=e/d._caScrollDist*h),d&&d.seek(y),d?e:Math.round(e)},Qse=/(webkit|moz|length|cssText|inset)/i,lF=function(e,t,r,i){if(e.parentNode!==t){var s=e.style,o,a;if(t===Nn){e._stOrig=s.cssText,a=Jo(e);for(o in a)!+o&&!Qse.test(o)&&a[o]&&typeof s[o]=="string"&&o!=="0"&&(s[o]=a[o]);s.top=r,s.left=i}else s.cssText=e._stOrig;gt.core.getCache(e).uncache=1,t.appendChild(e)}},U7=function(e,t,r){var i=t,s=i;return function(o){var a=Math.round(e());return a!==i&&a!==s&&Math.abs(a-i)>3&&Math.abs(a-s)>3&&(o=a,r&&r()),s=i,i=Math.round(o),i}},Cx=function(e,t,r){var i={};i[t.p]="+="+r,gt.set(e,i)},uF=function(e,t){var r=Uc(e,t),i="_scroll"+t.p2,s=function o(a,l,u,c,f){var h=o.tween,d=l.onComplete,p={};u=u||r();var y=U7(r,u,function(){h.kill(),o.tween=0});return f=c&&f||0,c=c||a-u,h&&h.kill(),l[i]=a,l.inherit=!1,l.modifiers=p,p[i]=function(){return y(u+c*h.ratio+f*h.ratio*h.ratio)},l.onUpdate=function(){an.cache++,o.tween&&lu()},l.onComplete=function(){o.tween=0,d&&d.call(h)},h=o.tween=gt.to(e,l),h};return e[i]=r,r.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},vi(e,"wheel",r.wheelHandler),un.isTouch&&vi(e,"touchmove",r.wheelHandler),s},un=function(){function n(t,r){Ld||n.register(gt)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),aC(this),this.init(t,r)}var e=n.prototype;return e.init=function(r,i){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!N0){this.update=this.refresh=this.kill=sl;return}r=nF(ho(r)||L0(r)||r.nodeType?{trigger:r}:r,Ex);var s=r,o=s.onUpdate,a=s.toggleClass,l=s.id,u=s.onToggle,c=s.onRefresh,f=s.scrub,h=s.trigger,d=s.pin,p=s.pinSpacing,y=s.invalidateOnRefresh,x=s.anticipatePin,m=s.onScrubComplete,_=s.onSnapComplete,w=s.once,b=s.snap,S=s.pinReparent,M=s.pinSpacer,T=s.containerAnimation,P=s.fastScrollEnd,C=s.preventOverlaps,A=r.horizontal||r.containerAnimation&&r.horizontal!==!1?bs:ei,k=!f&&f!==0,L=ks(r.scroller||on),H=gt.core.getCache(L),F=Sh(L),V=("pinType"in r?r.pinType:Ec(L,"pinType")||F&&"fixed")==="fixed",W=[r.onEnter,r.onLeave,r.onEnterBack,r.onLeaveBack],G=k&&r.toggleActions.split(" "),N="markers"in r?r.markers:Ex.markers,B=F?0:parseFloat(Jo(L)["border"+A.p2+nm])||0,D=this,$=r.onRefreshInit&&function(){return r.onRefreshInit(D)},ee=Hse(L,F,A),te=Gse(L,F),se=0,me=0,_e=0,pe=Uc(L,A),Ne,Ue,We,Be,J,he,de,Ie,ve,oe,ze,X,j,ae,Oe,Se,K,ge,Te,Le,Pe,De,Ae,ht,Ze,at,Qe,$e,Dt,Ft,sn,Ke,He,re,je,qe,At,_t,Jt;if(D._startClamp=D._endClamp=!1,D._dir=A,x*=45,D.scroller=L,D.scroll=T?T.time.bind(T):pe,Be=pe(),D.vars=r,i=i||r.animation,"refreshPriority"in r&&(S7=1,r.refreshPriority===-9999&&(fg=D)),H.tweenScroll=H.tweenScroll||{top:uF(L,ei),left:uF(L,bs)},D.tweenTo=Ne=H.tweenScroll[A.p],D.scrubDuration=function(Ge){He=L0(Ge)&&Ge,He?Ke?Ke.duration(Ge):Ke=gt.to(i,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:He,paused:!0,onComplete:function(){return m&&m(D)}}):(Ke&&Ke.progress(1).kill(),Ke=0)},i&&(i.vars.lazy=!1,i._initted&&!D.isReverted||i.vars.immediateRender!==!1&&r.immediateRender!==!1&&i.duration()&&i.render(0,!0,!0),D.animation=i.pause(),i.scrollTrigger=D,D.scrubDuration(f),Ft=0,l||(l=i.vars.id)),b&&((!Nf(b)||b.push)&&(b={snapTo:b}),"scrollBehavior"in Nn.style&&gt.set(F?[Nn,go]:L,{scrollBehavior:"auto"}),an.forEach(function(Ge){return ts(Ge)&&Ge.target===(F?jn.scrollingElement||go:L)&&(Ge.smooth=!1)}),We=ts(b.snapTo)?b.snapTo:b.snapTo==="labels"?Xse(i):b.snapTo==="labelsDirectional"?$se(i):b.directional!==!1?function(Ge,wt){return bP(b.snapTo)(Ge,Ki()-me<500?0:wt.direction)}:gt.utils.snap(b.snapTo),re=b.duration||{min:.1,max:2},re=Nf(re)?sg(re.min,re.max):sg(re,re),je=gt.delayedCall(b.delay||He/2||.1,function(){var Ge=pe(),wt=Ki()-me<500,Et=Ne.tween;if((wt||Math.abs(D.getVelocity())<10)&&!Et&&!eb&&se!==Ge){var kt=(Ge-he)/ae,Bn=i&&!k?i.totalProgress():kt,Bt=wt?0:(Bn-sn)/(Ki()-D0)*1e3||0,In=gt.utils.clamp(-kt,1-kt,Ed(Bt/2)*Bt/.185),ir=kt+(b.inertia===!1?0:In),Ln,Dn,_n=b,qr=_n.onStart,q=_n.onInterrupt,ce=_n.onComplete;if(Ln=We(ir,D),L0(Ln)||(Ln=ir),Dn=Math.max(0,Math.round(he+Ln*ae)),Ge<=de&&Ge>=he&&Dn!==Ge){if(Et&&!Et._initted&&Et.data<=Ed(Dn-Ge))return;b.inertia===!1&&(In=Ln-kt),Ne(Dn,{duration:re(Ed(Math.max(Ed(ir-Bn),Ed(Ln-Bn))*.185/Bt/.05||0)),ease:b.ease||"power3",data:Ed(Dn-Ge),onInterrupt:function(){return je.restart(!0)&&q&&q(D)},onComplete:function(){D.update(),se=pe(),i&&!k&&(Ke?Ke.resetTo("totalProgress",Ln,i._tTime/i._tDur):i.progress(Ln)),Ft=sn=i&&!k?i.totalProgress():D.progress,_&&_(D),ce&&ce(D)}},Ge,In*ae,Dn-Ge-In*ae),qr&&qr(D,Ne.tween)}}else D.isActive&&se!==Ge&&je.restart(!0)}).pause()),l&&(uC[l]=D),h=D.trigger=ks(h||d!==!0&&d),Jt=h&&h._gsap&&h._gsap.stRevert,Jt&&(Jt=Jt(D)),d=d===!0?h:ks(d),ho(a)&&(a={targets:h,className:a}),d&&(p===!1||p===Zo||(p=!p&&d.parentNode&&d.parentNode.style&&Jo(d.parentNode).display==="flex"?!1:Wr),D.pin=d,Ue=gt.core.getCache(d),Ue.spacer?Oe=Ue.pinState:(M&&(M=ks(M),M&&!M.nodeType&&(M=M.current||M.nativeElement),Ue.spacerIsNative=!!M,M&&(Ue.spacerState=Tx(M))),Ue.spacer=ge=M||jn.createElement("div"),ge.classList.add("pin-spacer"),l&&ge.classList.add("pin-spacer-"+l),Ue.pinState=Oe=Tx(d)),r.force3D!==!1&&gt.set(d,{force3D:!0}),D.spacer=ge=Ue.spacer,Dt=Jo(d),ht=Dt[p+A.os2],Le=gt.getProperty(d),Pe=gt.quickSetter(d,A.a,Kr),JE(d,ge,Dt),K=Tx(d)),N){X=Nf(N)?nF(N,rF):rF,oe=Mx("scroller-start",l,L,A,X,0),ze=Mx("scroller-end",l,L,A,X,0,oe),Te=oe["offset"+A.op.d2];var cn=ks(Ec(L,"content")||L);Ie=this.markerStart=Mx("start",l,cn,A,X,Te,0,T),ve=this.markerEnd=Mx("end",l,cn,A,X,Te,0,T),T&&(_t=gt.quickSetter([Ie,ve],A.a,Kr)),!V&&!(_l.length&&Ec(L,"fixedMarkers")===!0)&&(jse(F?Nn:L),gt.set([oe,ze],{force3D:!0}),at=gt.quickSetter(oe,A.a,Kr),$e=gt.quickSetter(ze,A.a,Kr))}if(T){var ut=T.vars.onUpdate,ot=T.vars.onUpdateParams;T.eventCallback("onUpdate",function(){D.update(0,0,1),ut&&ut.apply(T,ot||[])})}if(D.previous=function(){return rn[rn.indexOf(D)-1]},D.next=function(){return rn[rn.indexOf(D)+1]},D.revert=function(Ge,wt){if(!wt)return D.kill(!0);var Et=Ge!==!1||!D.enabled,kt=Yi;Et!==D.isReverted&&(Et&&(qe=Math.max(pe(),D.scroll.rec||0),_e=D.progress,At=i&&i.progress()),Ie&&[Ie,ve,oe,ze].forEach(function(Bn){return Bn.style.display=Et?"none":"block"}),Et&&(Yi=D,D.update(Et)),d&&(!S||!D.isActive)&&(Et?Kse(d,ge,Oe):JE(d,ge,Jo(d),Ze)),Et||D.update(Et),Yi=kt,D.isReverted=Et)},D.refresh=function(Ge,wt,Et,kt){if(!((Yi||!D.enabled)&&!wt)){if(d&&Ge&&aa){vi(n,"scrollEnd",k7);return}!ys&&$&&$(D),Yi=D,Ne.tween&&!Et&&(Ne.tween.kill(),Ne.tween=0),Ke&&Ke.pause(),y&&i&&(i.revert({kill:!1}).invalidate(),i.getChildren?i.getChildren(!0,!0,!1).forEach(function(nt){return nt.vars.immediateRender&&nt.render(0,!0,!0)}):i.vars.immediateRender&&i.render(0,!0,!0)),D.isReverted||D.revert(!0,!0),D._subPinOffset=!1;var Bn=ee(),Bt=te(),In=T?T.duration():dl(L,A),ir=ae<=.01||!ae,Ln=0,Dn=kt||0,_n=Nf(Et)?Et.end:r.end,qr=r.endTrigger||h,q=Nf(Et)?Et.start:r.start||(r.start===0||!h?0:d?"0 0":"0 100%"),ce=D.pinnedContainer=r.pinnedContainer&&ks(r.pinnedContainer,D),we=h&&Math.max(0,rn.indexOf(D))||0,xe=we,ye,Je,dt,Nt,ct,pt,Pt,Ut,Hn,sr,dn,er,Lt;for(N&&Nf(Et)&&(er=gt.getProperty(oe,A.p),Lt=gt.getProperty(ze,A.p));xe-- >0;)pt=rn[xe],pt.end||pt.refresh(0,1)||(Yi=D),Pt=pt.pin,Pt&&(Pt===h||Pt===d||Pt===ce)&&!pt.isReverted&&(sr||(sr=[]),sr.unshift(pt),pt.revert(!0,!0)),pt!==rn[xe]&&(we--,xe--);for(ts(q)&&(q=q(D)),q=JL(q,"start",D),he=aF(q,h,Bn,A,pe(),Ie,oe,D,Bt,B,V,In,T,D._startClamp&&"_startClamp")||(d?-.001:0),ts(_n)&&(_n=_n(D)),ho(_n)&&!_n.indexOf("+=")&&(~_n.indexOf(" ")?_n=(ho(q)?q.split(" ")[0]:"")+_n:(Ln=E2(_n.substr(2),Bn),_n=ho(q)?q:(T?gt.utils.mapRange(0,T.duration(),T.scrollTrigger.start,T.scrollTrigger.end,he):he)+Ln,qr=h)),_n=JL(_n,"end",D),de=Math.max(he,aF(_n||(qr?"100% 0":In),qr,Bn,A,pe()+Ln,ve,ze,D,Bt,B,V,In,T,D._endClamp&&"_endClamp"))||-.001,Ln=0,xe=we;xe--;)pt=rn[xe]||{},Pt=pt.pin,Pt&&pt.start-pt._pinPush<=he&&!T&&pt.end>0&&(ye=pt.end-(D._startClamp?Math.max(0,pt.start):pt.start),(Pt===h&&pt.start-pt._pinPush<he||Pt===ce)&&isNaN(q)&&(Ln+=ye*(1-pt.progress)),Pt===d&&(Dn+=ye));if(he+=Ln,de+=Ln,D._startClamp&&(D._startClamp+=Ln),D._endClamp&&!ys&&(D._endClamp=de||-.001,de=Math.min(de,dl(L,A))),ae=de-he||(he-=.01)&&.001,ir&&(_e=gt.utils.clamp(0,1,gt.utils.normalize(he,de,qe))),D._pinPush=Dn,Ie&&Ln&&(ye={},ye[A.a]="+="+Ln,ce&&(ye[A.p]="-="+pe()),gt.set([Ie,ve],ye)),d&&!(lC&&D.end>=dl(L,A)))ye=Jo(d),Nt=A===ei,dt=pe(),De=parseFloat(Le(A.a))+Dn,!In&&de>1&&(dn=(F?jn.scrollingElement||go:L).style,dn={style:dn,value:dn["overflow"+A.a.toUpperCase()]},F&&Jo(Nn)["overflow"+A.a.toUpperCase()]!=="scroll"&&(dn.style["overflow"+A.a.toUpperCase()]="scroll")),JE(d,ge,ye),K=Tx(d),Je=Jl(d,!0),Ut=V&&Uc(L,Nt?bs:ei)(),p?(Ze=[p+A.os2,ae+Dn+Kr],Ze.t=ge,xe=p===Wr?b_(d,A)+ae+Dn:0,xe&&(Ze.push(A.d,xe+Kr),ge.style.flexBasis!=="auto"&&(ge.style.flexBasis=xe+Kr)),Rp(Ze),ce&&rn.forEach(function(nt){nt.pin===ce&&nt.vars.pinSpacing!==!1&&(nt._subPinOffset=!0)}),V&&pe(qe)):(xe=b_(d,A),xe&&ge.style.flexBasis!=="auto"&&(ge.style.flexBasis=xe+Kr)),V&&(ct={top:Je.top+(Nt?dt-he:Ut)+Kr,left:Je.left+(Nt?Ut:dt-he)+Kr,boxSizing:"border-box",position:"fixed"},ct[uh]=ct["max"+nm]=Math.ceil(Je.width)+Kr,ct[ch]=ct["max"+wP]=Math.ceil(Je.height)+Kr,ct[Zo]=ct[Zo+ug]=ct[Zo+ag]=ct[Zo+cg]=ct[Zo+lg]="0",ct[Wr]=ye[Wr],ct[Wr+ug]=ye[Wr+ug],ct[Wr+ag]=ye[Wr+ag],ct[Wr+cg]=ye[Wr+cg],ct[Wr+lg]=ye[Wr+lg],Se=Jse(Oe,ct,S),ys&&pe(0)),i?(Hn=i._initted,$E(1),i.render(i.duration(),!0,!0),Ae=Le(A.a)-De+ae+Dn,Qe=Math.abs(ae-Ae)>1,V&&Qe&&Se.splice(Se.length-2,2),i.render(0,!0,!0),Hn||i.invalidate(!0),i.parent||i.totalTime(i.totalTime()),$E(0)):Ae=ae,dn&&(dn.value?dn.style["overflow"+A.a.toUpperCase()]=dn.value:dn.style.removeProperty("overflow-"+A.a));else if(h&&pe()&&!T)for(Je=h.parentNode;Je&&Je!==Nn;)Je._pinOffset&&(he-=Je._pinOffset,de-=Je._pinOffset),Je=Je.parentNode;sr&&sr.forEach(function(nt){return nt.revert(!1,!0)}),D.start=he,D.end=de,Be=J=ys?qe:pe(),!T&&!ys&&(Be<qe&&pe(qe),D.scroll.rec=0),D.revert(!1,!0),me=Ki(),je&&(se=-1,je.restart(!0)),Yi=0,i&&k&&(i._initted||At)&&i.progress()!==At&&i.progress(At||0,!0).render(i.time(),!0,!0),(ir||_e!==D.progress||T||y||i&&!i._initted)&&(i&&!k&&(i._initted||_e||i.vars.immediateRender!==!1)&&i.totalProgress(T&&he<-.001&&!_e?gt.utils.normalize(he,de,0):_e,!0),D.progress=ir||(Be-he)/ae===_e?0:_e),d&&p&&(ge._pinOffset=Math.round(D.progress*Ae)),Ke&&Ke.invalidate(),isNaN(er)||(er-=gt.getProperty(oe,A.p),Lt-=gt.getProperty(ze,A.p),Cx(oe,A,er),Cx(Ie,A,er-(kt||0)),Cx(ze,A,Lt),Cx(ve,A,Lt-(kt||0))),ir&&!ys&&D.update(),c&&!ys&&!j&&(j=!0,c(D),j=!1)}},D.getVelocity=function(){return(pe()-J)/(Ki()-D0)*1e3||0},D.endAnimation=function(){p0(D.callbackAnimation),i&&(Ke?Ke.progress(1):i.paused()?k||p0(i,D.direction<0,1):p0(i,i.reversed()))},D.labelToScroll=function(Ge){return i&&i.labels&&(he||D.refresh()||he)+i.labels[Ge]/i.duration()*ae||0},D.getTrailing=function(Ge){var wt=rn.indexOf(D),Et=D.direction>0?rn.slice(0,wt).reverse():rn.slice(wt+1);return(ho(Ge)?Et.filter(function(kt){return kt.vars.preventOverlaps===Ge}):Et).filter(function(kt){return D.direction>0?kt.end<=he:kt.start>=de})},D.update=function(Ge,wt,Et){if(!(T&&!Et&&!Ge)){var kt=ys===!0?qe:D.scroll(),Bn=Ge?0:(kt-he)/ae,Bt=Bn<0?0:Bn>1?1:Bn||0,In=D.progress,ir,Ln,Dn,_n,qr,q,ce,we;if(wt&&(J=Be,Be=T?pe():kt,b&&(sn=Ft,Ft=i&&!k?i.totalProgress():Bt)),x&&d&&!Yi&&!_x&&aa&&(!Bt&&he<kt+(kt-J)/(Ki()-D0)*x?Bt=1e-4:Bt===1&&de>kt+(kt-J)/(Ki()-D0)*x&&(Bt=.9999)),Bt!==In&&D.enabled){if(ir=D.isActive=!!Bt&&Bt<1,Ln=!!In&&In<1,q=ir!==Ln,qr=q||!!Bt!=!!In,D.direction=Bt>In?1:-1,D.progress=Bt,qr&&!Yi&&(Dn=Bt&&!In?0:Bt===1?1:In===1?2:3,k&&(_n=!q&&G[Dn+1]!=="none"&&G[Dn+1]||G[Dn],we=i&&(_n==="complete"||_n==="reset"||_n in i))),C&&(q||we)&&(we||f||!i)&&(ts(C)?C(D):D.getTrailing(C).forEach(function(dt){return dt.endAnimation()})),k||(Ke&&!Yi&&!_x?(Ke._dp._time-Ke._start!==Ke._time&&Ke.render(Ke._dp._time-Ke._start),Ke.resetTo?Ke.resetTo("totalProgress",Bt,i._tTime/i._tDur):(Ke.vars.totalProgress=Bt,Ke.invalidate().restart())):i&&i.totalProgress(Bt,!!(Yi&&(me||Ge)))),d){if(Ge&&p&&(ge.style[p+A.os2]=ht),!V)Pe(k0(De+Ae*Bt));else if(qr){if(ce=!Ge&&Bt>In&&de+1>kt&&kt+1>=dl(L,A),S)if(!Ge&&(ir||ce)){var xe=Jl(d,!0),ye=kt-he;lF(d,Nn,xe.top+(A===ei?ye:0)+Kr,xe.left+(A===ei?0:ye)+Kr)}else lF(d,ge);Rp(ir||ce?Se:K),Qe&&Bt<1&&ir||Pe(De+(Bt===1&&!ce?Ae:0))}}b&&!Ne.tween&&!Yi&&!_x&&je.restart(!0),a&&(q||w&&Bt&&(Bt<1||!qE))&&pv(a.targets).forEach(function(dt){return dt.classList[ir||w?"add":"remove"](a.className)}),o&&!k&&!Ge&&o(D),qr&&!Yi?(k&&(we&&(_n==="complete"?i.pause().totalProgress(1):_n==="reset"?i.restart(!0).pause():_n==="restart"?i.restart(!0):i[_n]()),o&&o(D)),(q||!qE)&&(u&&q&&KE(D,u),W[Dn]&&KE(D,W[Dn]),w&&(Bt===1?D.kill(!1,1):W[Dn]=0),q||(Dn=Bt===1?1:3,W[Dn]&&KE(D,W[Dn]))),P&&!ir&&Math.abs(D.getVelocity())>(L0(P)?P:2500)&&(p0(D.callbackAnimation),Ke?Ke.progress(1):p0(i,_n==="reverse"?1:!Bt,1))):k&&o&&!Yi&&o(D)}if($e){var Je=T?kt/T.duration()*(T._caScrollDist||0):kt;at(Je+(oe._isFlipped?1:0)),$e(Je)}_t&&_t(-kt/T.duration()*(T._caScrollDist||0))}},D.enable=function(Ge,wt){D.enabled||(D.enabled=!0,vi(L,"resize",F0),F||vi(L,"scroll",Md),$&&vi(n,"refreshInit",$),Ge!==!1&&(D.progress=_e=0,Be=J=se=pe()),wt!==!1&&D.refresh())},D.getTween=function(Ge){return Ge&&Ne?Ne.tween:Ke},D.setPositions=function(Ge,wt,Et,kt){if(T){var Bn=T.scrollTrigger,Bt=T.duration(),In=Bn.end-Bn.start;Ge=Bn.start+In*Ge/Bt,wt=Bn.start+In*wt/Bt}D.refresh(!1,!1,{start:QL(Ge,Et&&!!D._startClamp),end:QL(wt,Et&&!!D._endClamp)},kt),D.update()},D.adjustPinSpacing=function(Ge){if(Ze&&Ge){var wt=Ze.indexOf(A.d)+1;Ze[wt]=parseFloat(Ze[wt])+Ge+Kr,Ze[1]=parseFloat(Ze[1])+Ge+Kr,Rp(Ze)}},D.disable=function(Ge,wt){if(Ge!==!1&&D.revert(!0,!0),D.enabled&&(D.enabled=D.isActive=!1,wt||Ke&&Ke.pause(),qe=0,Ue&&(Ue.uncache=1),$&&gi(n,"refreshInit",$),je&&(je.pause(),Ne.tween&&Ne.tween.kill()&&(Ne.tween=0)),!F)){for(var Et=rn.length;Et--;)if(rn[Et].scroller===L&&rn[Et]!==D)return;gi(L,"resize",F0),F||gi(L,"scroll",Md)}},D.kill=function(Ge,wt){D.disable(Ge,wt),Ke&&!wt&&Ke.kill(),l&&delete uC[l];var Et=rn.indexOf(D);Et>=0&&rn.splice(Et,1),Et===vs&&T2>0&&vs--,Et=0,rn.forEach(function(kt){return kt.scroller===D.scroller&&(Et=1)}),Et||ys||(D.scroll.rec=0),i&&(i.scrollTrigger=null,Ge&&i.revert({kill:!1}),wt||i.kill()),Ie&&[Ie,ve,oe,ze].forEach(function(kt){return kt.parentNode&&kt.parentNode.removeChild(kt)}),fg===D&&(fg=0),d&&(Ue&&(Ue.uncache=1),Et=0,rn.forEach(function(kt){return kt.pin===d&&Et++}),Et||(Ue.spacer=0)),r.onKill&&r.onKill(D)},rn.push(D),D.enable(!1,!1),Jt&&Jt(D),i&&i.add&&!ae){var xt=D.update;D.update=function(){D.update=xt,an.cache++,he||de||D.refresh()},gt.delayedCall(.01,D.update),ae=.01,he=de=0}else D.refresh();d&&Yse()},n.register=function(r){return Ld||(gt=r||A7(),C7()&&window.document&&n.enable(),Ld=N0),Ld},n.defaults=function(r){if(r)for(var i in r)Ex[i]=r[i];return Ex},n.disable=function(r,i){N0=0,rn.forEach(function(o){return o[i?"kill":"disable"](r)}),gi(on,"wheel",Md),gi(jn,"scroll",Md),clearInterval(xx),gi(jn,"touchcancel",sl),gi(Nn,"touchstart",sl),bx(gi,jn,"pointerdown,touchstart,mousedown",eF),bx(gi,jn,"pointerup,touchend,mouseup",tF),w_.kill(),wx(gi);for(var s=0;s<an.length;s+=3)Sx(gi,an[s],an[s+1]),Sx(gi,an[s],an[s+2])},n.enable=function(){if(on=window,jn=document,go=jn.documentElement,Nn=jn.body,gt&&(pv=gt.utils.toArray,sg=gt.utils.clamp,aC=gt.core.context||sl,$E=gt.core.suppressOverwrites||sl,vP=on.history.scrollRestoration||"auto",cC=on.pageYOffset||0,gt.core.globals("ScrollTrigger",n),Nn)){N0=1,Ap=document.createElement("div"),Ap.style.height="100vh",Ap.style.position="absolute",B7(),Wse(),Fr.register(gt),n.isTouch=Fr.isTouch,Yu=Fr.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),oC=Fr.isTouch===1,vi(on,"wheel",Md),gP=[on,jn,go,Nn],gt.matchMedia?(n.matchMedia=function(u){var c=gt.matchMedia(),f;for(f in u)c.add(f,u[f]);return c},gt.addEventListener("matchMediaInit",function(){F7(),SP()}),gt.addEventListener("matchMediaRevert",function(){return L7()}),gt.addEventListener("matchMedia",function(){qf(0,1),Mh("matchMedia")}),gt.matchMedia().add("(orientation: portrait)",function(){return ZE(),ZE})):console.warn("Requires GSAP 3.11.0 or later"),ZE(),vi(jn,"scroll",Md);var r=Nn.hasAttribute("style"),i=Nn.style,s=i.borderTopStyle,o=gt.core.Animation.prototype,a,l;for(o.revert||Object.defineProperty(o,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",a=Jl(Nn),ei.m=Math.round(a.top+ei.sc())||0,bs.m=Math.round(a.left+bs.sc())||0,s?i.borderTopStyle=s:i.removeProperty("border-top-style"),r||(Nn.setAttribute("style",""),Nn.removeAttribute("style")),xx=setInterval(iF,250),gt.delayedCall(.5,function(){return _x=0}),vi(jn,"touchcancel",sl),vi(Nn,"touchstart",sl),bx(vi,jn,"pointerdown,touchstart,mousedown",eF),bx(vi,jn,"pointerup,touchend,mouseup",tF),sC=gt.utils.checkPrefix("transform"),C2.push(sC),Ld=Ki(),w_=gt.delayedCall(.2,qf).pause(),Fd=[jn,"visibilitychange",function(){var u=on.innerWidth,c=on.innerHeight;jn.hidden?(KL=u,ZL=c):(KL!==u||ZL!==c)&&F0()},jn,"DOMContentLoaded",qf,on,"load",qf,on,"resize",F0],wx(vi),rn.forEach(function(u){return u.enable(0,1)}),l=0;l<an.length;l+=3)Sx(gi,an[l],an[l+1]),Sx(gi,an[l],an[l+2])}},n.config=function(r){"limitCallbacks"in r&&(qE=!!r.limitCallbacks);var i=r.syncInterval;i&&clearInterval(xx)||(xx=i)&&setInterval(iF,i),"ignoreMobileResize"in r&&(oC=n.isTouch===1&&r.ignoreMobileResize),"autoRefreshEvents"in r&&(wx(gi)||wx(vi,r.autoRefreshEvents||"none"),E7=(r.autoRefreshEvents+"").indexOf("resize")===-1)},n.scrollerProxy=function(r,i){var s=ks(r),o=an.indexOf(s),a=Sh(s);~o&&an.splice(o,a?6:2),i&&(a?_l.unshift(on,i,Nn,i,go,i):_l.unshift(s,i))},n.clearMatchMedia=function(r){rn.forEach(function(i){return i._ctx&&i._ctx.query===r&&i._ctx.kill(!0,!0)})},n.isInViewport=function(r,i,s){var o=(ho(r)?ks(r):r).getBoundingClientRect(),a=o[s?uh:ch]*i||0;return s?o.right-a>0&&o.left+a<on.innerWidth:o.bottom-a>0&&o.top+a<on.innerHeight},n.positionInViewport=function(r,i,s){ho(r)&&(r=ks(r));var o=r.getBoundingClientRect(),a=o[s?uh:ch],l=i==null?a/2:i in S_?S_[i]*a:~i.indexOf("%")?parseFloat(i)*a/100:parseFloat(i)||0;return s?(o.left+l)/on.innerWidth:(o.top+l)/on.innerHeight},n.killAll=function(r){if(rn.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),r!==!0){var i=Eh.killAll||[];Eh={},i.forEach(function(s){return s()})}},n}();un.version="3.14.2";un.saveStyles=function(n){return n?pv(n).forEach(function(e){if(e&&e.style){var t=co.indexOf(e);t>=0&&co.splice(t,5),co.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),gt.core.getCache(e),aC())}}):co};un.revert=function(n,e){return SP(!n,e)};un.create=function(n,e){return new un(n,e)};un.refresh=function(n){return n?F0(!0):(Ld||un.register())&&qf(!0)};un.update=function(n){return++an.cache&&lu(n===!0?2:0)};un.clearScrollMemory=O7;un.maxScroll=function(n,e){return dl(n,e?bs:ei)};un.getScrollFunc=function(n,e){return Uc(ks(n),e?bs:ei)};un.getById=function(n){return uC[n]};un.getAll=function(){return rn.filter(function(n){return n.vars.id!=="ScrollSmoother"})};un.isScrolling=function(){return!!aa};un.snapDirectional=bP;un.addEventListener=function(n,e){var t=Eh[n]||(Eh[n]=[]);~t.indexOf(e)||t.push(e)};un.removeEventListener=function(n,e){var t=Eh[n],r=t&&t.indexOf(e);r>=0&&t.splice(r,1)};un.batch=function(n,e){var t=[],r={},i=e.interval||.016,s=e.batchMax||1e9,o=function(u,c){var f=[],h=[],d=gt.delayedCall(i,function(){c(f,h),f=[],h=[]}).pause();return function(p){f.length||d.restart(!0),f.push(p.trigger),h.push(p),s<=f.length&&d.progress(1)}},a;for(a in e)r[a]=a.substr(0,2)==="on"&&ts(e[a])&&a!=="onRefreshInit"?o(a,e[a]):e[a];return ts(s)&&(s=s(),vi(un,"refresh",function(){return s=e.batchMax()})),pv(n).forEach(function(l){var u={};for(a in r)u[a]=r[a];u.trigger=l,t.push(un.create(u))}),t};var cF=function(e,t,r,i){return t>i?e(i):t<0&&e(0),r>i?(i-t)/(r-t):r<0?t/(t-r):1},QE=function n(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Fr.isTouch?" pinch-zoom":""):"none",e===go&&n(Nn,t)},Ax={auto:1,scroll:1},eoe=function(e){var t=e.event,r=e.target,i=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,o=s._gsap||gt.core.getCache(s),a=Ki(),l;if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s!==Nn&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(Ax[(l=Jo(s)).overflowY]||Ax[l.overflowX]));)s=s.parentNode;o._isScroll=s&&s!==r&&!Sh(s)&&(Ax[(l=Jo(s)).overflowY]||Ax[l.overflowX]),o._isScrollT=a}(o._isScroll||i==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},z7=function(e,t,r,i){return Fr.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:i=i&&eoe,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return r&&vi(jn,Fr.eventTypes[0],hF,!1,!0)},onDisable:function(){return gi(jn,Fr.eventTypes[0],hF,!0)}})},toe=/(input|label|select|textarea)/i,fF,hF=function(e){var t=toe.test(e.target.tagName);(t||fF)&&(e._gsapAllow=!0,fF=t)},noe=function(e){Nf(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,r=t.normalizeScrollX,i=t.momentum,s=t.allowNestedScroll,o=t.onRelease,a,l,u=ks(e.target)||go,c=gt.core.globals().ScrollSmoother,f=c&&c.get(),h=Yu&&(e.content&&ks(e.content)||f&&e.content!==!1&&!f.smooth()&&f.content()),d=Uc(u,ei),p=Uc(u,bs),y=1,x=(Fr.isTouch&&on.visualViewport?on.visualViewport.scale*on.visualViewport.width:on.outerWidth)/on.innerWidth,m=0,_=ts(i)?function(){return i(a)}:function(){return i||2.8},w,b,S=z7(u,e.type,!0,s),M=function(){return b=!1},T=sl,P=sl,C=function(){l=dl(u,ei),P=sg(Yu?1:0,l),r&&(T=sg(0,dl(u,bs))),w=fh},A=function(){h._gsap.y=k0(parseFloat(h._gsap.y)+d.offset)+"px",h.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(h._gsap.y)+", 0, 1)",d.offset=d.cacheID=0},k=function(){if(b){requestAnimationFrame(M);var N=k0(a.deltaY/2),B=P(d.v-N);if(h&&B!==d.v+d.offset){d.offset=B-d.v;var D=k0((parseFloat(h&&h._gsap.y)||0)-d.offset);h.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+D+", 0, 1)",h._gsap.y=D+"px",d.cacheID=an.cache,lu()}return!0}d.offset&&A(),b=!0},L,H,F,V,W=function(){C(),L.isActive()&&L.vars.scrollY>l&&(d()>l?L.progress(1)&&d(l):L.resetTo("scrollY",l))};return h&&gt.set(h,{y:"+=0"}),e.ignoreCheck=function(G){return Yu&&G.type==="touchmove"&&k()||y>1.05&&G.type!=="touchstart"||a.isGesturing||G.touches&&G.touches.length>1},e.onPress=function(){b=!1;var G=y;y=k0((on.visualViewport&&on.visualViewport.scale||1)/x),L.pause(),G!==y&&QE(u,y>1.01?!0:r?!1:"x"),H=p(),F=d(),C(),w=fh},e.onRelease=e.onGestureStart=function(G,N){if(d.offset&&A(),!N)V.restart(!0);else{an.cache++;var B=_(),D,$;r&&(D=p(),$=D+B*.05*-G.velocityX/.227,B*=cF(p,D,$,dl(u,bs)),L.vars.scrollX=T($)),D=d(),$=D+B*.05*-G.velocityY/.227,B*=cF(d,D,$,dl(u,ei)),L.vars.scrollY=P($),L.invalidate().duration(B).play(.01),(Yu&&L.vars.scrollY>=l||D>=l-1)&&gt.to({},{onUpdate:W,duration:B})}o&&o(G)},e.onWheel=function(){L._ts&&L.pause(),Ki()-m>1e3&&(w=0,m=Ki())},e.onChange=function(G,N,B,D,$){if(fh!==w&&C(),N&&r&&p(T(D[2]===N?H+(G.startX-G.x):p()+N-D[1])),B){d.offset&&A();var ee=$[2]===B,te=ee?F+G.startY-G.y:d()+B-$[1],se=P(te);ee&&te!==se&&(F+=se-te),d(se)}(B||N)&&lu()},e.onEnable=function(){QE(u,r?!1:"x"),un.addEventListener("refresh",W),vi(on,"resize",W),d.smooth&&(d.target.style.scrollBehavior="auto",d.smooth=p.smooth=!1),S.enable()},e.onDisable=function(){QE(u,!0),gi(on,"resize",W),un.removeEventListener("refresh",W),S.kill()},e.lockAxis=e.lockAxis!==!1,a=new Fr(e),a.iOS=Yu,Yu&&!d()&&d(1),Yu&&gt.ticker.add(sl),V=a._dc,L=gt.to(a,{ease:"power4",paused:!0,inherit:!1,scrollX:r?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:U7(d,d(),function(){return L.pause()})},onUpdate:lu,onComplete:V.vars.onComplete}),a};un.sort=function(n){if(ts(n))return rn.sort(n);var e=on.pageYOffset||0;return un.getAll().forEach(function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+on.innerHeight}),rn.sort(n||function(t,r){return(t.vars.refreshPriority||0)*-1e6+(t.vars.containerAnimation?1e6:t._sortY)-((r.vars.containerAnimation?1e6:r._sortY)+(r.vars.refreshPriority||0)*-1e6)})};un.observe=function(n){return new Fr(n)};un.normalizeScroll=function(n){if(typeof n>"u")return ms;if(n===!0&&ms)return ms.enable();if(n===!1){ms&&ms.kill(),ms=n;return}var e=n instanceof Fr?n:noe(n);return ms&&ms.target===e.target&&ms.kill(),Sh(e.target)&&(ms=e),e};un.core={_getVelocityProp:iC,_inputObserver:z7,_scrollers:an,_proxies:_l,bridge:{ss:function(){aa||Mh("scrollStart"),aa=Ki()},ref:function(){return Yi}}};A7()&&gt.registerPlugin(un);/*!
 * SplitText 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2025, GreenSock. All rights reserved. Subject to the terms at https://gsap.com/standard-license.
 * @author: Jack Doyle
 */let m0,Td,dF=typeof Symbol=="function"?Symbol():"_split",hC,roe=()=>hC||EP.register(window.gsap),pF=typeof Intl<"u"&&"Segmenter"in Intl?new Intl.Segmenter:0,gv=n=>typeof n=="string"?gv(document.querySelectorAll(n)):"length"in n?Array.from(n).reduce((e,t)=>(typeof t=="string"?e.push(...gv(t)):e.push(t),e),[]):[n],mF=n=>gv(n).filter(e=>e instanceof HTMLElement),dC=[],e3=function(){},ioe={add:n=>n()},soe=/\s+/g,gF=new RegExp("\\p{RI}\\p{RI}|\\p{Emoji}(\\p{EMod}|\\u{FE0F}\\u{20E3}?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?(\\u{200D}\\p{Emoji}(\\p{EMod}|\\u{FE0F}\\u{20E3}?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?)*|.","gu"),E_={left:0,top:0,width:0,height:0},ooe=(n,e)=>{for(;++e<n.length&&n[e]===E_;);return n[e]||E_},vF=({element:n,html:e,ariaL:t,ariaH:r})=>{n.innerHTML=e,t?n.setAttribute("aria-label",t):n.removeAttribute("aria-label"),r?n.setAttribute("aria-hidden",r):n.removeAttribute("aria-hidden")},yF=(n,e)=>{if(e){let t=new Set(n.join("").match(e)||dC),r=n.length,i,s,o,a;if(t.size)for(;--r>-1;){s=n[r];for(o of t)if(o.startsWith(s)&&o.length>s.length){for(i=0,a=s;o.startsWith(a+=n[r+ ++i])&&a.length<o.length;);if(i&&a.length===o.length){n[r]=o,n.splice(r+1,i);break}}}}return n},xF=n=>window.getComputedStyle(n).display==="inline"&&(n.style.display="inline-block"),Cd=(n,e,t)=>e.insertBefore(typeof n=="string"?document.createTextNode(n):n,t),pC=(n,e,t)=>{let r=e[n+"sClass"]||"",{tag:i="div",aria:s="auto",propIndex:o=!1}=e,a=n==="line"?"block":"inline-block",l=r.indexOf("++")>-1,u=c=>{let f=document.createElement(i),h=t.length+1;return r&&(f.className=r+(l?" "+r+h:"")),o&&f.style.setProperty("--"+n,h+""),s!=="none"&&f.setAttribute("aria-hidden","true"),i!=="span"&&(f.style.position="relative",f.style.display=a),f.textContent=c,t.push(f),f};return l&&(r=r.replace("++","")),u.collection=t,u},aoe=(n,e,t,r)=>{let i=pC("line",t,r),s=window.getComputedStyle(n).textAlign||"left";return(o,a)=>{let l=i("");for(l.style.textAlign=s,n.insertBefore(l,e[o]);o<a;o++)l.appendChild(e[o]);l.normalize()}},V7=(n,e,t,r,i,s,o,a,l,u)=>{var c;let f=Array.from(n.childNodes),h=0,{wordDelimiter:d,reduceWhiteSpace:p=!0,prepareText:y}=e,x=n.getBoundingClientRect(),m=x,_=!p&&window.getComputedStyle(n).whiteSpace.substring(0,3)==="pre",w=0,b=t.collection,S,M,T,P,C,A,k,L,H,F,V,W,G,N,B,D,$,ee;for(typeof d=="object"?(T=d.delimiter||d,M=d.replaceWith||""):M=d===""?"":d||" ",S=M!==" ";h<f.length;h++)if(P=f[h],P.nodeType===3){for(B=P.textContent||"",p?B=B.replace(soe," "):_&&(B=B.replace(/\n/g,M+`
`)),y&&(B=y(B,n)),P.textContent=B,C=M||T?B.split(T||M):B.match(a)||dC,$=C[C.length-1],L=S?$.slice(-1)===" ":!$,$||C.pop(),m=x,k=S?C[0].charAt(0)===" ":!C[0],k&&Cd(" ",n,P),C[0]||C.shift(),yF(C,l),s&&u||(P.textContent=""),H=1;H<=C.length;H++)if(D=C[H-1],!p&&_&&D.charAt(0)===`
`&&((c=P.previousSibling)==null||c.remove(),Cd(document.createElement("br"),n,P),D=D.slice(1)),!p&&D==="")Cd(M,n,P);else if(D===" ")n.insertBefore(document.createTextNode(" "),P);else{if(S&&D.charAt(0)===" "&&Cd(" ",n,P),w&&H===1&&!k&&b.indexOf(w.parentNode)>-1?(A=b[b.length-1],A.appendChild(document.createTextNode(r?"":D))):(A=t(r?"":D),Cd(A,n,P),w&&H===1&&!k&&A.insertBefore(w,A.firstChild)),r)for(V=pF?yF([...pF.segment(D)].map(te=>te.segment),l):D.match(a)||dC,ee=0;ee<V.length;ee++)A.appendChild(V[ee]===" "?document.createTextNode(" "):r(V[ee]));if(s&&u){if(B=P.textContent=B.substring(D.length+1,B.length),F=A.getBoundingClientRect(),F.top>m.top&&F.left<=m.left){for(W=n.cloneNode(),G=n.childNodes[0];G&&G!==A;)N=G,G=G.nextSibling,W.appendChild(N);n.parentNode.insertBefore(W,n),i&&xF(W)}m=F}(H<C.length||L)&&Cd(H>=C.length?" ":S&&D.slice(-1)===" "?" "+M:M,n,P)}n.removeChild(P),w=0}else P.nodeType===1&&(o&&o.indexOf(P)>-1?(b.indexOf(P.previousSibling)>-1&&b[b.length-1].appendChild(P),w=P):(V7(P,e,t,r,i,s,o,a,l,!0),w=0),i&&xF(P))};const W7=class H7{constructor(e,t){this.isSplit=!1,roe(),this.elements=mF(e),this.chars=[],this.words=[],this.lines=[],this.masks=[],this.vars=t,this.elements.forEach(o=>{var a;t.overwrite!==!1&&((a=o[dF])==null||a._data.orig.filter(({element:l})=>l===o).forEach(vF)),o[dF]=this}),this._split=()=>this.isSplit&&this.split(this.vars);let r=[],i,s=()=>{let o=r.length,a;for(;o--;){a=r[o];let l=a.element.offsetWidth;if(l!==a.width){a.width=l,this._split();return}}};this._data={orig:r,obs:typeof ResizeObserver<"u"&&new ResizeObserver(()=>{clearTimeout(i),i=setTimeout(s,200)})},e3(this),this.split(t)}split(e){return(this._ctx||ioe).add(()=>{this.isSplit&&this.revert(),this.vars=e=e||this.vars||{};let{type:t="chars,words,lines",aria:r="auto",deepSlice:i=!0,smartWrap:s,onSplit:o,autoSplit:a=!1,specialChars:l,mask:u}=this.vars,c=t.indexOf("lines")>-1,f=t.indexOf("chars")>-1,h=t.indexOf("words")>-1,d=f&&!h&&!c,p=l&&("push"in l?new RegExp("(?:"+l.join("|")+")","gu"):l),y=p?new RegExp(p.source+"|"+gF.source,"gu"):gF,x=!!e.ignore&&mF(e.ignore),{orig:m,animTime:_,obs:w}=this._data,b;(f||h||c)&&(this.elements.forEach((S,M)=>{m[M]={element:S,html:S.innerHTML,ariaL:S.getAttribute("aria-label"),ariaH:S.getAttribute("aria-hidden")},r==="auto"?S.setAttribute("aria-label",(S.textContent||"").trim()):r==="hidden"&&S.setAttribute("aria-hidden","true");let T=[],P=[],C=[],A=f?pC("char",e,T):null,k=pC("word",e,P),L,H,F,V;if(V7(S,e,k,A,d,i&&(c||d),x,y,p,!1),c){let W=gv(S.childNodes),G=aoe(S,W,e,C),N,B=[],D=0,$=W.map(se=>se.nodeType===1?se.getBoundingClientRect():E_),ee=E_,te;for(L=0;L<W.length;L++)N=W[L],N.nodeType===1&&(N.nodeName==="BR"?((!L||W[L-1].nodeName!=="BR")&&(B.push(N),G(D,L+1)),D=L+1,ee=ooe($,L)):(te=$[L],L&&te.top>ee.top&&te.left<ee.left+ee.width-1&&(G(D,L),D=L),ee=te));D<L&&G(D,L),B.forEach(se=>{var me;return(me=se.parentNode)==null?void 0:me.removeChild(se)})}if(!h){for(L=0;L<P.length;L++)if(H=P[L],f||!H.nextSibling||H.nextSibling.nodeType!==3)if(s&&!c){for(F=document.createElement("span"),F.style.whiteSpace="nowrap";H.firstChild;)F.appendChild(H.firstChild);H.replaceWith(F)}else H.replaceWith(...H.childNodes);else V=H.nextSibling,V&&V.nodeType===3&&(V.textContent=(H.textContent||"")+(V.textContent||""),H.remove());P.length=0,S.normalize()}this.lines.push(...C),this.words.push(...P),this.chars.push(...T)}),u&&this[u]&&this.masks.push(...this[u].map(S=>{let M=S.cloneNode();return S.replaceWith(M),M.appendChild(S),S.className&&(M.className=S.className.trim()+"-mask"),M.style.overflow="clip",M}))),this.isSplit=!0,Td&&c&&(a?Td.addEventListener("loadingdone",this._split):Td.status==="loading"&&console.warn("SplitText called before fonts loaded")),(b=o&&o(this))&&b.totalTime&&(this._data.anim=_?b.totalTime(_):b),c&&a&&this.elements.forEach((S,M)=>{m[M].width=S.offsetWidth,w&&w.observe(S)})}),this}kill(){let{obs:e}=this._data;e&&e.disconnect(),Td==null||Td.removeEventListener("loadingdone",this._split)}revert(){var e,t;if(this.isSplit){let{orig:r,anim:i}=this._data;this.kill(),r.forEach(vF),this.chars.length=this.words.length=this.lines.length=r.length=this.masks.length=0,this.isSplit=!1,i&&(this._data.animTime=i.totalTime(),i.revert()),(t=(e=this.vars).onRevert)==null||t.call(e,this)}return this}static create(e,t){return new H7(e,t)}static register(e){m0=m0||e||window.gsap,m0&&(gv=m0.utils.toArray,e3=m0.core.context||e3),!hC&&window.innerWidth>0&&(Td=document.fonts,hC=!0)}};W7.version="3.14.2";let EP=W7;/*!
 * @gsap/react 2.1.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let _F=typeof document<"u"?U.useLayoutEffect:U.useEffect,wF=n=>n&&!Array.isArray(n)&&typeof n=="object",Rx=[],loe={},G7=Wt;const tb=(n,e=Rx)=>{let t=loe;wF(n)?(t=n,n=null,e="dependencies"in t?t.dependencies:Rx):wF(e)&&(t=e,e="dependencies"in t?t.dependencies:Rx),n&&typeof n!="function"&&console.warn("First parameter must be a function or config object");const{scope:r,revertOnUpdate:i}=t,s=U.useRef(!1),o=U.useRef(G7.context(()=>{},r)),a=U.useRef(u=>o.current.add(null,u)),l=e&&e.length&&!i;return l&&_F(()=>(s.current=!0,()=>o.current.revert()),Rx),_F(()=>{if(n&&o.current.add(n,r),!l||!s.current)return()=>o.current.revert()},e),{context:o.current,contextSafe:a.current}};tb.register=n=>{G7=n};tb.headless=!0;Wt.registerPlugin(un,EP,tb);const j7=({text:n,as:e="div",typingSpeed:t=50,initialDelay:r=0,pauseDuration:i=2e3,deletingSpeed:s=30,loop:o=!0,className:a="",showCursor:l=!0,hideCursorWhileTyping:u=!1,cursorCharacter:c="|",cursorClassName:f="",cursorBlinkDuration:h=.5,textColors:d=[],variableSpeed:p,onSentenceComplete:y,startOnVisible:x=!1,reverseMode:m=!1,..._})=>{const[w,b]=U.useState(""),[S,M]=U.useState(0),[T,P]=U.useState(!1),[C,A]=U.useState(0),[k,L]=U.useState(!x),H=U.useRef(null),F=U.useRef(null),V=U.useMemo(()=>Array.isArray(n)?n:[n],[n]),W=U.useCallback(()=>{if(!p)return t;const{min:B,max:D}=p;return Math.random()*(D-B)+B},[p,t]),G=()=>{if(d.length!==0)return d[C%d.length]};U.useEffect(()=>{if(!x||!F.current)return;const B=new IntersectionObserver(D=>{D.forEach($=>{$.isIntersecting&&L(!0)})},{threshold:.1});return B.observe(F.current),()=>B.disconnect()},[x]),U.useEffect(()=>{l&&H.current&&(Wt.set(H.current,{opacity:1}),Wt.to(H.current,{opacity:0,duration:h,repeat:-1,yoyo:!0,ease:"power2.inOut"}))},[l,h]),U.useEffect(()=>{if(!k)return;let B;const D=V[C],$=m?D.split("").reverse().join(""):D,ee=()=>{if(T)if(w===""){if(P(!1),C===V.length-1&&!o)return;y&&y(V[C],C),A(te=>(te+1)%V.length),M(0),B=setTimeout(()=>{},i)}else B=setTimeout(()=>{b(te=>te.slice(0,-1))},s);else if(S<$.length)B=setTimeout(()=>{b(te=>te+$[S]),M(te=>te+1)},p?W():t);else if(V.length>=1){if(!o&&C===V.length-1)return;B=setTimeout(()=>{P(!0)},i)}};return S===0&&!T&&w===""?B=setTimeout(ee,r):ee(),()=>clearTimeout(B)},[S,w,T,t,s,i,V,C,o,r,k,m,p,y]);const N=u&&(S<V[C].length||T);return U.createElement(e,{ref:F,className:`inline-block whitespace-pre-wrap tracking-tight ${a}`,..._},z.jsx("span",{className:"inline",style:{color:G()||"inherit"},children:w}),l&&z.jsx("span",{ref:H,className:`ml-1 inline-block opacity-100 ${N?"hidden":""} ${f}`,children:c}))};Wt.registerPlugin(un,EP,tb);const MP=U.createContext({});function Yv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const TP=typeof window<"u",CP=TP?U.useLayoutEffect:U.useEffect,nb=U.createContext(null);function AP(n,e){n.indexOf(e)===-1&&n.push(e)}function RP(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const xu=(n,e,t)=>t>e?e:t<n?n:t;let PP=()=>{};const _u={},X7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function $7(n){return typeof n=="object"&&n!==null}const q7=n=>/^0[^.\s]+$/u.test(n);function IP(n){let e;return()=>(e===void 0&&(e=n()),e)}const la=n=>n,uoe=(n,e)=>t=>e(n(t)),Kv=(...n)=>n.reduce(uoe),vv=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class DP{constructor(){this.subscriptions=[]}add(e){return AP(this.subscriptions,e),()=>RP(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const wl=n=>n*1e3,ia=n=>n/1e3;function Y7(n,e){return e?n*(1e3/e):0}const K7=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,coe=1e-7,foe=12;function hoe(n,e,t,r,i){let s,o,a=0;do o=e+(t-e)/2,s=K7(o,r,i)-n,s>0?t=o:e=o;while(Math.abs(s)>coe&&++a<foe);return o}function Zv(n,e,t,r){if(n===e&&t===r)return la;const i=s=>hoe(s,0,1,n,t);return s=>s===0||s===1?s:K7(i(s),e,r)}const Z7=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,J7=n=>e=>1-n(1-e),Q7=Zv(.33,1.53,.69,.99),NP=J7(Q7),e9=Z7(NP),t9=n=>(n*=2)<1?.5*NP(n):.5*(2-Math.pow(2,-10*(n-1))),kP=n=>1-Math.sin(Math.acos(n)),n9=J7(kP),r9=Z7(kP),doe=Zv(.42,0,1,1),poe=Zv(0,0,.58,1),i9=Zv(.42,0,.58,1),moe=n=>Array.isArray(n)&&typeof n[0]!="number",s9=n=>Array.isArray(n)&&typeof n[0]=="number",goe={linear:la,easeIn:doe,easeInOut:i9,easeOut:poe,circIn:kP,circInOut:r9,circOut:n9,backIn:NP,backInOut:e9,backOut:Q7,anticipate:t9},voe=n=>typeof n=="string",bF=n=>{if(s9(n)){PP(n.length===4);const[e,t,r,i]=n;return Zv(e,t,r,i)}else if(voe(n))return goe[n];return n},Px=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function yoe(n,e){let t=new Set,r=new Set,i=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(c){o.has(c)&&(u.schedule(c),n()),c(a)}const u={schedule:(c,f=!1,h=!1)=>{const p=h&&i?t:r;return f&&o.add(c),p.has(c)||p.add(c),c},cancel:c=>{r.delete(c),o.delete(c)},process:c=>{if(a=c,i){s=!0;return}i=!0,[t,r]=[r,t],t.forEach(l),t.clear(),i=!1,s&&(s=!1,u.process(c))}};return u}const xoe=40;function o9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Px.reduce((w,b)=>(w[b]=yoe(s),w),{}),{setup:a,read:l,resolveKeyframes:u,preUpdate:c,update:f,preRender:h,render:d,postRender:p}=o,y=()=>{const w=_u.useManualTiming?i.timestamp:performance.now();t=!1,_u.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(w-i.timestamp,xoe),1)),i.timestamp=w,i.isProcessing=!0,a.process(i),l.process(i),u.process(i),c.process(i),f.process(i),h.process(i),d.process(i),p.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},x=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:Px.reduce((w,b)=>{const S=o[b];return w[b]=(M,T=!1,P=!1)=>(t||x(),S.schedule(M,T,P)),w},{}),cancel:w=>{for(let b=0;b<Px.length;b++)o[Px[b]].cancel(w)},state:i,steps:o}}const{schedule:$n,cancel:wu,state:Ri,steps:t3}=o9(typeof requestAnimationFrame<"u"?requestAnimationFrame:la,!0);let R2;function _oe(){R2=void 0}const Vs={now:()=>(R2===void 0&&Vs.set(Ri.isProcessing||_u.useManualTiming?Ri.timestamp:performance.now()),R2),set:n=>{R2=n,queueMicrotask(_oe)}},a9=n=>e=>typeof e=="string"&&e.startsWith(n),l9=a9("--"),woe=a9("var(--"),LP=n=>woe(n)?boe.test(n.split("/*")[0].trim()):!1,boe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,bm={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},yv={...bm,transform:n=>xu(0,1,n)},Ix={...bm,default:1},hg=n=>Math.round(n*1e5)/1e5,FP=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Soe(n){return n==null}const Eoe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,OP=(n,e)=>t=>!!(typeof t=="string"&&Eoe.test(t)&&t.startsWith(n)||e&&!Soe(t)&&Object.prototype.hasOwnProperty.call(t,e)),u9=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,o,a]=r.match(FP);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Moe=n=>xu(0,255,n),n3={...bm,transform:n=>Math.round(Moe(n))},Yf={test:OP("rgb","red"),parse:u9("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+n3.transform(n)+", "+n3.transform(e)+", "+n3.transform(t)+", "+hg(yv.transform(r))+")"};function Toe(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const mC={test:OP("#"),parse:Toe,transform:Yf.transform},Jv=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Ku=Jv("deg"),bl=Jv("%"),zt=Jv("px"),Coe=Jv("vh"),Aoe=Jv("vw"),SF={...bl,parse:n=>bl.parse(n)/100,transform:n=>bl.transform(n*100)},fp={test:OP("hsl","hue"),parse:u9("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+bl.transform(hg(e))+", "+bl.transform(hg(t))+", "+hg(yv.transform(r))+")"},Hr={test:n=>Yf.test(n)||mC.test(n)||fp.test(n),parse:n=>Yf.test(n)?Yf.parse(n):fp.test(n)?fp.parse(n):mC.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Yf.transform(n):fp.transform(n),getAnimatableNone:n=>{const e=Hr.parse(n);return e.alpha=0,Hr.transform(e)}},Roe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Poe(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(FP))==null?void 0:e.length)||0)+(((t=n.match(Roe))==null?void 0:t.length)||0)>0}const c9="number",f9="color",Ioe="var",Doe="var(",EF="${}",Noe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function xv(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(Noe,l=>(Hr.test(l)?(r.color.push(s),i.push(f9),t.push(Hr.parse(l))):l.startsWith(Doe)?(r.var.push(s),i.push(Ioe),t.push(l)):(r.number.push(s),i.push(c9),t.push(parseFloat(l))),++s,EF)).split(EF);return{values:t,split:a,indexes:r,types:i}}function h9(n){return xv(n).values}function d9(n){const{split:e,types:t}=xv(n),r=e.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=e[o],i[o]!==void 0){const a=t[o];a===c9?s+=hg(i[o]):a===f9?s+=Hr.transform(i[o]):s+=i[o]}return s}}const koe=n=>typeof n=="number"?0:Hr.test(n)?Hr.getAnimatableNone(n):n;function Loe(n){const e=h9(n);return d9(n)(e.map(koe))}const zc={test:Poe,parse:h9,createTransformer:d9,getAnimatableNone:Loe};function r3(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Foe({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,o=0;if(!e)i=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=r3(l,a,n+1/3),s=r3(l,a,n),o=r3(l,a,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function M_(n,e){return t=>t>0?e:n}const dr=(n,e,t)=>n+(e-n)*t,i3=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Ooe=[mC,Yf,fp],Boe=n=>Ooe.find(e=>e.test(n));function MF(n){const e=Boe(n);if(!e)return!1;let t=e.parse(n);return e===fp&&(t=Foe(t)),t}const TF=(n,e)=>{const t=MF(n),r=MF(e);if(!t||!r)return M_(n,e);const i={...t};return s=>(i.red=i3(t.red,r.red,s),i.green=i3(t.green,r.green,s),i.blue=i3(t.blue,r.blue,s),i.alpha=dr(t.alpha,r.alpha,s),Yf.transform(i))},gC=new Set(["none","hidden"]);function Uoe(n,e){return gC.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function zoe(n,e){return t=>dr(n,e,t)}function BP(n){return typeof n=="number"?zoe:typeof n=="string"?LP(n)?M_:Hr.test(n)?TF:Hoe:Array.isArray(n)?p9:typeof n=="object"?Hr.test(n)?TF:Voe:M_}function p9(n,e){const t=[...n],r=t.length,i=n.map((s,o)=>BP(s)(s,e[o]));return s=>{for(let o=0;o<r;o++)t[o]=i[o](s);return t}}function Voe(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=BP(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Woe(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const s=e.types[i],o=n.indexes[s][r[s]],a=n.values[o]??0;t[i]=a,r[s]++}return t}const Hoe=(n,e)=>{const t=zc.createTransformer(e),r=xv(n),i=xv(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?gC.has(n)&&!i.values.length||gC.has(e)&&!r.values.length?Uoe(n,e):Kv(p9(Woe(r,i),i.values),t):M_(n,e)};function m9(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?dr(n,e,t):BP(n)(n,e)}const Goe=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>$n.update(e,t),stop:()=>wu(e),now:()=>Ri.isProcessing?Ri.timestamp:Vs.now()}},g9=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=Math.round(n(s/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},T_=2e4;function UP(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<T_;)e+=t,r=n.next(e);return e>=T_?1/0:e}function joe(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(UP(r),T_);return{type:"keyframes",ease:s=>r.next(i*s).value/e,duration:ia(i)}}const Xoe=5;function v9(n,e,t){const r=Math.max(e-Xoe,0);return Y7(t-n(r),e-r)}const Er={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},s3=.001;function $oe({duration:n=Er.duration,bounce:e=Er.bounce,velocity:t=Er.velocity,mass:r=Er.mass}){let i,s,o=1-e;o=xu(Er.minDamping,Er.maxDamping,o),n=xu(Er.minDuration,Er.maxDuration,ia(n)),o<1?(i=u=>{const c=u*o,f=c*n,h=c-t,d=vC(u,o),p=Math.exp(-f);return s3-h/d*p},s=u=>{const f=u*o*n,h=f*t+t,d=Math.pow(o,2)*Math.pow(u,2)*n,p=Math.exp(-f),y=vC(Math.pow(u,2),o);return(-i(u)+s3>0?-1:1)*((h-d)*p)/y}):(i=u=>{const c=Math.exp(-u*n),f=(u-t)*n+1;return-s3+c*f},s=u=>{const c=Math.exp(-u*n),f=(t-u)*(n*n);return c*f});const a=5/n,l=Yoe(i,s,a);if(n=wl(n),isNaN(l))return{stiffness:Er.stiffness,damping:Er.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:n}}}const qoe=12;function Yoe(n,e,t){let r=t;for(let i=1;i<qoe;i++)r=r-n(r)/e(r);return r}function vC(n,e){return n*Math.sqrt(1-e*e)}const Koe=["duration","bounce"],Zoe=["stiffness","damping","mass"];function CF(n,e){return e.some(t=>n[t]!==void 0)}function Joe(n){let e={velocity:Er.velocity,stiffness:Er.stiffness,damping:Er.damping,mass:Er.mass,isResolvedFromDuration:!1,...n};if(!CF(n,Zoe)&&CF(n,Koe))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*xu(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Er.mass,stiffness:i,damping:s}}else{const t=$oe(n);e={...e,...t,mass:Er.mass},e.isResolvedFromDuration=!0}return e}function C_(n=Er.visualDuration,e=Er.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:f,velocity:h,isResolvedFromDuration:d}=Joe({...t,velocity:-ia(t.velocity||0)}),p=h||0,y=u/(2*Math.sqrt(l*c)),x=o-s,m=ia(Math.sqrt(l/c)),_=Math.abs(x)<5;r||(r=_?Er.restSpeed.granular:Er.restSpeed.default),i||(i=_?Er.restDelta.granular:Er.restDelta.default);let w;if(y<1){const S=vC(m,y);w=M=>{const T=Math.exp(-y*m*M);return o-T*((p+y*m*x)/S*Math.sin(S*M)+x*Math.cos(S*M))}}else if(y===1)w=S=>o-Math.exp(-m*S)*(x+(p+m*x)*S);else{const S=m*Math.sqrt(y*y-1);w=M=>{const T=Math.exp(-y*m*M),P=Math.min(S*M,300);return o-T*((p+y*m*x)*Math.sinh(P)+S*x*Math.cosh(P))/S}}const b={calculatedDuration:d&&f||null,next:S=>{const M=w(S);if(d)a.done=S>=f;else{let T=S===0?p:0;y<1&&(T=S===0?wl(p):v9(w,S,M));const P=Math.abs(T)<=r,C=Math.abs(o-M)<=i;a.done=P&&C}return a.value=a.done?o:M,a},toString:()=>{const S=Math.min(UP(b),T_),M=g9(T=>b.next(S*T).value,S,30);return S+"ms "+M},toTransition:()=>{}};return b}C_.applyToOptions=n=>{const e=joe(n,100,C_);return n.ease=e.ease,n.duration=wl(e.duration),n.type="keyframes",n};function yC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:u=.5,restSpeed:c}){const f=n[0],h={done:!1,value:f},d=P=>a!==void 0&&P<a||l!==void 0&&P>l,p=P=>a===void 0?l:l===void 0||Math.abs(a-P)<Math.abs(l-P)?a:l;let y=t*e;const x=f+y,m=o===void 0?x:o(x);m!==x&&(y=m-f);const _=P=>-y*Math.exp(-P/r),w=P=>m+_(P),b=P=>{const C=_(P),A=w(P);h.done=Math.abs(C)<=u,h.value=h.done?m:A};let S,M;const T=P=>{d(h.value)&&(S=P,M=C_({keyframes:[h.value,p(h.value)],velocity:v9(w,P,h.value),damping:i,stiffness:s,restDelta:u,restSpeed:c}))};return T(0),{calculatedDuration:null,next:P=>{let C=!1;return!M&&S===void 0&&(C=!0,b(P),T(P)),S!==void 0&&P>=S?M.next(P-S):(!C&&b(P),h)}}}function Qoe(n,e,t){const r=[],i=t||_u.mix||m9,s=n.length-1;for(let o=0;o<s;o++){let a=i(n[o],n[o+1]);if(e){const l=Array.isArray(e)?e[o]||la:e;a=Kv(l,a)}r.push(a)}return r}function y9(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(PP(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Qoe(e,r,i),l=a.length,u=c=>{if(o&&c<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(c<n[f+1]);f++);const h=vv(n[f],n[f+1],c);return a[f](h)};return t?c=>u(xu(n[0],n[s-1],c)):u}function eae(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=vv(0,e,r);n.push(dr(t,1,i))}}function tae(n){const e=[0];return eae(e,n.length-1),e}function nae(n,e){return n.map(t=>t*e)}function rae(n,e){return n.map(()=>e||i9).splice(0,n.length-1)}function dg({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=moe(r)?r.map(bF):bF(r),s={done:!1,value:e[0]},o=nae(t&&t.length===e.length?t:tae(e),n),a=y9(o,e,{ease:Array.isArray(i)?i:rae(e,i)});return{calculatedDuration:n,next:l=>(s.value=a(l),s.done=l>=n,s)}}const iae=n=>n!==null;function zP(n,{repeat:e,repeatType:t="loop"},r,i=1){const s=n.filter(iae),a=i<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!a||r===void 0?s[a]:r}const sae={decay:yC,inertia:yC,tween:dg,keyframes:dg,spring:C_};function x9(n){typeof n.type=="string"&&(n.type=sae[n.type])}class VP{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const oae=n=>n/100;class rb extends VP{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,i;const{motionValue:t}=this.options;t&&t.updatedAt!==Vs.now()&&this.tick(Vs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(r=this.options).onStop)==null||i.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;x9(e);const{type:t=dg,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const l=t||dg;l!==dg&&typeof a[0]!="number"&&(this.mixKeyframes=Kv(oae,m9(a[0],a[1])),a=[0,100]);const u=l({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=UP(u));const{calculatedDuration:c}=u;this.calculatedDuration=c,this.resolvedDuration=c+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=u}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:c,repeat:f,repeatType:h,repeatDelay:d,type:p,onUpdate:y,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const m=this.currentTime-u*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?m<0:m>i;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let w=this.currentTime,b=r;if(f){const P=Math.min(this.currentTime,i)/a;let C=Math.floor(P),A=P%1;!A&&P>=1&&(A=1),A===1&&C--,C=Math.min(C,f+1),!!(C%2)&&(h==="reverse"?(A=1-A,d&&(A-=d/a)):h==="mirror"&&(b=o)),w=xu(0,1,A)*a}const S=_?{done:!1,value:c[0]}:b.next(w);s&&(S.value=s(S.value));let{done:M}=S;!_&&l!==null&&(M=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return T&&p!==yC&&(S.value=zP(c,this.options,x,this.speed)),y&&y(S.value),T&&this.finish(),S}then(e,t){return this.finished.then(e,t)}get duration(){return ia(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ia(e)}get time(){return ia(this.currentTime)}set time(e){var t;e=wl(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Vs.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ia(this.currentTime))}play(){var i,s;if(this.isStopped)return;const{driver:e=Goe,startTime:t}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(s=(i=this.options).onPlay)==null||s.call(i);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Vs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function aae(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Kf=n=>n*180/Math.PI,xC=n=>{const e=Kf(Math.atan2(n[1],n[0]));return _C(e)},lae={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:xC,rotateZ:xC,skewX:n=>Kf(Math.atan(n[1])),skewY:n=>Kf(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},_C=n=>(n=n%360,n<0&&(n+=360),n),AF=xC,RF=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),PF=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),uae={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:RF,scaleY:PF,scale:n=>(RF(n)+PF(n))/2,rotateX:n=>_C(Kf(Math.atan2(n[6],n[5]))),rotateY:n=>_C(Kf(Math.atan2(-n[2],n[0]))),rotateZ:AF,rotate:AF,skewX:n=>Kf(Math.atan(n[4])),skewY:n=>Kf(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function wC(n){return n.includes("scale")?1:0}function bC(n,e){if(!n||n==="none")return wC(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=uae,i=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=lae,i=a}if(!i)return wC(e);const s=r[e],o=i[1].split(",").map(fae);return typeof s=="function"?s(o):o[s]}const cae=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return bC(t,e)};function fae(n){return parseFloat(n.trim())}const Sm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Em=new Set(Sm),IF=n=>n===bm||n===zt,hae=new Set(["x","y","z"]),dae=Sm.filter(n=>!hae.has(n));function pae(n){const e=[];return dae.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const hh={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>bC(e,"x"),y:(n,{transform:e})=>bC(e,"y")};hh.translateX=hh.x;hh.translateY=hh.y;const dh=new Set;let SC=!1,EC=!1,MC=!1;function _9(){if(EC){const n=Array.from(dh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=pae(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,o])=>{var a;(a=r.getValue(s))==null||a.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}EC=!1,SC=!1,dh.forEach(n=>n.complete(MC)),dh.clear()}function w9(){dh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(EC=!0)})}function mae(){MC=!0,w9(),_9(),MC=!1}class WP{constructor(e,t,r,i,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(dh.add(this),SC||(SC=!0,$n.read(w9),$n.resolveKeyframes(_9))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const s=i==null?void 0:i.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const a=r.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),i&&s===void 0&&i.set(e[0])}aae(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),dh.delete(this)}cancel(){this.state==="scheduled"&&(dh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const gae=n=>n.startsWith("--");function vae(n,e,t){gae(e)?n.style.setProperty(e,t):n.style[e]=t}const yae=IP(()=>window.ScrollTimeline!==void 0),xae={};function _ae(n,e){const t=IP(n);return()=>xae[e]??t()}const b9=_ae(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),O0=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,DF={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:O0([0,.65,.55,1]),circOut:O0([.55,0,1,.45]),backIn:O0([.31,.01,.66,-.59]),backOut:O0([.33,1.53,.69,.99])};function S9(n,e){if(n)return typeof n=="function"?b9()?g9(n,e):"ease-out":s9(n)?O0(n):Array.isArray(n)?n.map(t=>S9(t,e)||DF.easeOut):DF[n]}function wae(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:l}={},u=void 0){const c={[e]:t};l&&(c.offset=l);const f=S9(a,i);Array.isArray(f)&&(c.easing=f);const h={delay:r,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),n.animate(c,h)}function E9(n){return typeof n=="function"&&"applyToOptions"in n}function bae({type:n,...e}){return E9(n)&&b9()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Sae extends VP{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,PP(typeof e.type!="string");const u=bae(e);this.animation=wae(t,r,i,u,s),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const c=zP(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(c):vae(t,r,c),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,r;const e=((r=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:r.call(t).duration)||0;return ia(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ia(e)}get time(){return ia(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=wl(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&yae()?(this.animation.timeline=e,la):t(this)}}const M9={anticipate:t9,backInOut:e9,circInOut:r9};function Eae(n){return n in M9}function Mae(n){typeof n.ease=="string"&&Eae(n.ease)&&(n.ease=M9[n.ease])}const NF=10;class Tae extends Sae{constructor(e){Mae(e),x9(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:s,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new rb({...o,autoplay:!1}),l=wl(this.finishedTime??this.time);t.setWithVelocity(a.sample(l-NF).value,a.sample(l).value,NF),a.stop()}}const kF=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(zc.test(n)||n==="0")&&!n.startsWith("url("));function Cae(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Aae(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=kF(i,e),a=kF(s,e);return!o||!a?!1:Cae(n)||(t==="spring"||E9(t))&&r}function TC(n){n.duration=0,n.type="keyframes"}const Rae=new Set(["opacity","clipPath","filter","transform"]),Pae=IP(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Iae(n){var c;const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:s,type:o}=n;if(!(((c=e==null?void 0:e.owner)==null?void 0:c.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return Pae()&&t&&Rae.has(t)&&(t!=="transform"||!u)&&!l&&!r&&i!=="mirror"&&s!==0&&o!=="inertia"}const Dae=40;class Nae extends VP{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:l,motionValue:u,element:c,...f}){var p;super(),this.stop=()=>{var y,x;this._animation&&(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)),(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=Vs.now();const h={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:o,name:l,motionValue:u,element:c,...f},d=(c==null?void 0:c.KeyframeResolver)||WP;this.keyframeResolver=new d(a,(y,x,m)=>this.onKeyframesResolved(y,x,h,!m),l,u,c),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:l,isHandoff:u,onUpdate:c}=r;this.resolvedAt=Vs.now(),Aae(e,s,o,a)||((_u.instantAnimations||!l)&&(c==null||c(zP(e,r,t))),e[0]=e[e.length-1],TC(r),r.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Dae?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},d=!u&&Iae(h)?new Tae({...h,element:h.motionValue.owner.current}):new rb(h);d.finished.then(()=>this.notifyFinished()).catch(la),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),mae()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const kae=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Lae(n){const e=kae.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function T9(n,e,t=1){const[r,i]=Lae(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return X7(o)?parseFloat(o):o}return LP(i)?T9(i,e,t+1):i}function HP(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const C9=new Set(["width","height","top","left","right","bottom",...Sm]),Fae={test:n=>n==="auto",parse:n=>n},A9=n=>e=>e.test(n),R9=[bm,zt,bl,Ku,Aoe,Coe,Fae],LF=n=>R9.find(A9(n));function Oae(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||q7(n):!0}const Bae=new Set(["brightness","contrast","saturate","opacity"]);function Uae(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(FP)||[];if(!r)return n;const i=t.replace(r,"");let s=Bae.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const zae=/\b([a-z-]*)\(.*?\)/gu,CC={...zc,getAnimatableNone:n=>{const e=n.match(zae);return e?e.map(Uae).join(" "):n}},FF={...bm,transform:Math.round},Vae={rotate:Ku,rotateX:Ku,rotateY:Ku,rotateZ:Ku,scale:Ix,scaleX:Ix,scaleY:Ix,scaleZ:Ix,skew:Ku,skewX:Ku,skewY:Ku,distance:zt,translateX:zt,translateY:zt,translateZ:zt,x:zt,y:zt,z:zt,perspective:zt,transformPerspective:zt,opacity:yv,originX:SF,originY:SF,originZ:zt},GP={borderWidth:zt,borderTopWidth:zt,borderRightWidth:zt,borderBottomWidth:zt,borderLeftWidth:zt,borderRadius:zt,radius:zt,borderTopLeftRadius:zt,borderTopRightRadius:zt,borderBottomRightRadius:zt,borderBottomLeftRadius:zt,width:zt,maxWidth:zt,height:zt,maxHeight:zt,top:zt,right:zt,bottom:zt,left:zt,padding:zt,paddingTop:zt,paddingRight:zt,paddingBottom:zt,paddingLeft:zt,margin:zt,marginTop:zt,marginRight:zt,marginBottom:zt,marginLeft:zt,backgroundPositionX:zt,backgroundPositionY:zt,...Vae,zIndex:FF,fillOpacity:yv,strokeOpacity:yv,numOctaves:FF},Wae={...GP,color:Hr,backgroundColor:Hr,outlineColor:Hr,fill:Hr,stroke:Hr,borderColor:Hr,borderTopColor:Hr,borderRightColor:Hr,borderBottomColor:Hr,borderLeftColor:Hr,filter:CC,WebkitFilter:CC},P9=n=>Wae[n];function I9(n,e){let t=P9(n);return t!==CC&&(t=zc),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Hae=new Set(["auto","none","0"]);function Gae(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Hae.has(s)&&xv(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=I9(t,i)}class jae extends WP{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),LP(u))){const c=T9(u,t.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!C9.has(r)||e.length!==2)return;const[i,s]=e,o=LF(i),a=LF(s);if(o!==a)if(IF(o)&&IF(a))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else hh[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Oae(e[i]))&&r.push(i);r.length&&Gae(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hh[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var a;const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,o=r[s];r[s]=hh[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function Xae(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=(t==null?void 0:t[n])??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const D9=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function N9(n){return $7(n)&&"offsetHeight"in n}const OF=30,$ae=n=>!isNaN(parseFloat(n)),pg={current:void 0};class qae{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var s;const i=Vs.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Vs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=$ae(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new DP);const r=this.events[e].add(t);return e==="change"?()=>{r(),$n.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return pg.current&&pg.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Vs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>OF)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,OF);return Y7(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Th(n,e){return new qae(n,e)}const{schedule:jP}=o9(queueMicrotask,!1),Sa={x:!1,y:!1};function k9(){return Sa.x||Sa.y}function Yae(n){return n==="x"||n==="y"?Sa[n]?null:(Sa[n]=!0,()=>{Sa[n]=!1}):Sa.x||Sa.y?null:(Sa.x=Sa.y=!0,()=>{Sa.x=Sa.y=!1})}function L9(n,e){const t=Xae(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function BF(n){return!(n.pointerType==="touch"||k9())}function Kae(n,e,t={}){const[r,i,s]=L9(n,t),o=a=>{if(!BF(a))return;const{target:l}=a,u=e(l,a);if(typeof u!="function"||!l)return;const c=f=>{BF(f)&&(u(f),l.removeEventListener("pointerleave",c))};l.addEventListener("pointerleave",c,i)};return r.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const F9=(n,e)=>e?n===e?!0:F9(n,e.parentElement):!1,XP=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Zae=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Jae(n){return Zae.has(n.tagName)||n.tabIndex!==-1}const P2=new WeakSet;function UF(n){return e=>{e.key==="Enter"&&n(e)}}function o3(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Qae=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=UF(()=>{if(P2.has(t))return;o3(t,"down");const i=UF(()=>{o3(t,"up")}),s=()=>o3(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function zF(n){return XP(n)&&!k9()}function ele(n,e,t={}){const[r,i,s]=L9(n,t),o=a=>{const l=a.currentTarget;if(!zF(a))return;P2.add(l);const u=e(l,a),c=(d,p)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),P2.has(l)&&P2.delete(l),zF(d)&&typeof u=="function"&&u(d,{success:p})},f=d=>{c(d,l===window||l===document||t.useGlobalTarget||F9(l,d.target))},h=d=>{c(d,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return r.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),N9(a)&&(a.addEventListener("focus",u=>Qae(u,i)),!Jae(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function O9(n){return $7(n)&&"ownerSVGElement"in n}function tle(n){return O9(n)&&n.tagName==="svg"}function nle(...n){const e=!Array.isArray(n[0]),t=e?0:-1,r=n[0+t],i=n[1+t],s=n[2+t],o=n[3+t],a=y9(i,s,o);return e?a(r):a}const _i=n=>!!(n&&n.getVelocity);function rle(n,e,t){const r=n.get();let i=null,s=r,o;const a=typeof r=="string"?r.replace(/[\d.-]/g,""):void 0,l=()=>{i&&(i.stop(),i=null)},u=()=>{l(),i=new rb({keyframes:[WF(n.get()),WF(s)],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:o})};if(n.attach((c,f)=>{s=c,o=h=>f(VF(h,a)),$n.postRender(u)},l),_i(e)){const c=e.on("change",h=>n.set(VF(h,a))),f=n.on("destroy",c);return()=>{c(),f()}}return l}function VF(n,e){return e?n+e:n}function WF(n){return typeof n=="number"?n:parseFloat(n)}const ile=[...R9,Hr,zc],sle=n=>ile.find(A9(n)),Qv=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function HF(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function ole(...n){return e=>{let t=!1;const r=n.map(i=>{const s=HF(i,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():HF(n[i],null)}}}}function ale(...n){return U.useCallback(ole(...n),n)}class lle extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=N9(r)&&r.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=i-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ule({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),s=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=U.useContext(Qv),l=ale(s,n==null?void 0:n.ref);return U.useInsertionEffect(()=>{const{width:u,height:c,top:f,left:h,right:d}=o.current;if(e||!s.current||!u||!c)return;const p=t==="left"?`left: ${h}`:`right: ${d}`;s.current.dataset.motionPopId=i;const y=document.createElement("style");a&&(y.nonce=a);const x=r??document.head;return x.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${c}px !important;
            ${p}px !important;
            top: ${f}px !important;
          }
        `),()=>{x.contains(y)&&x.removeChild(y)}},[e]),z.jsx(lle,{isPresent:e,childRef:s,sizeRef:o,children:U.cloneElement(n,{ref:l})})}const cle=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o,anchorX:a,root:l})=>{const u=Yv(fle),c=U.useId();let f=!0,h=U.useMemo(()=>(f=!1,{id:c,initial:e,isPresent:t,custom:i,onExitComplete:d=>{u.set(d,!0);for(const p of u.values())if(!p)return;r&&r()},register:d=>(u.set(d,!1),()=>u.delete(d))}),[t,u,r]);return s&&f&&(h={...h}),U.useMemo(()=>{u.forEach((d,p)=>u.set(p,!1))},[t]),U.useEffect(()=>{!t&&!u.size&&r&&r()},[t]),o==="popLayout"&&(n=z.jsx(ule,{isPresent:t,anchorX:a,root:l,children:n})),z.jsx(nb.Provider,{value:h,children:n})};function fle(){return new Map}function B9(n=!0){const e=U.useContext(nb);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=U.useId();U.useEffect(()=>{if(n)return i(s)},[n]);const o=U.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,o]:[!0]}const Dx=n=>n.key||"";function GF(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const hle=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1,anchorX:a="left",root:l})=>{const[u,c]=B9(o),f=U.useMemo(()=>GF(n),[n]),h=o&&!u?[]:f.map(Dx),d=U.useRef(!0),p=U.useRef(f),y=Yv(()=>new Map),[x,m]=U.useState(f),[_,w]=U.useState(f);CP(()=>{d.current=!1,p.current=f;for(let M=0;M<_.length;M++){const T=Dx(_[M]);h.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[_,h.length,h.join("-")]);const b=[];if(f!==x){let M=[...f];for(let T=0;T<_.length;T++){const P=_[T],C=Dx(P);h.includes(C)||(M.splice(T,0,P),b.push(P))}return s==="wait"&&b.length&&(M=b),w(GF(M)),m(f),null}const{forceRender:S}=U.useContext(MP);return z.jsx(z.Fragment,{children:_.map(M=>{const T=Dx(M),P=o&&!u?!1:f===_||h.includes(T),C=()=>{if(y.has(T))y.set(T,!0);else return;let A=!0;y.forEach(k=>{k||(A=!1)}),A&&(S==null||S(),w(p.current),o&&(c==null||c()),r&&r())};return z.jsx(cle,{isPresent:P,initial:!d.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:s,root:l,onExitComplete:P?void 0:C,anchorX:a,children:M},T)})})},U9=U.createContext({strict:!1}),jF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rm={};for(const n in jF)rm[n]={isEnabled:e=>jF[n].some(t=>!!e[t])};function dle(n){for(const e in n)rm[e]={...rm[e],...n[e]}}const ple=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function A_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||ple.has(n)}let z9=n=>!A_(n);function mle(n){typeof n=="function"&&(z9=e=>e.startsWith("on")?!A_(e):n(e))}try{mle(require("@emotion/is-prop-valid").default)}catch{}function gle(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(z9(i)||t===!0&&A_(i)||!e&&!A_(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const ib=U.createContext({});function sb(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function _v(n){return typeof n=="string"||Array.isArray(n)}const $P=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],qP=["initial",...$P];function ob(n){return sb(n.animate)||qP.some(e=>_v(n[e]))}function V9(n){return!!(ob(n)||n.variants)}function vle(n,e){if(ob(n)){const{initial:t,animate:r}=n;return{initial:t===!1||_v(t)?t:void 0,animate:_v(r)?r:void 0}}return n.inherit!==!1?e:{}}function yle(n){const{initial:e,animate:t}=vle(n,U.useContext(ib));return U.useMemo(()=>({initial:e,animate:t}),[XF(e),XF(t)])}function XF(n){return Array.isArray(n)?n.join(" "):n}function $F(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const g0={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(zt.test(n))n=parseFloat(n);else return n;const t=$F(n,e.target.x),r=$F(n,e.target.y);return`${t}% ${r}%`}},xle={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=zc.parse(n);if(i.length>5)return r;const s=zc.createTransformer(n),o=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const u=dr(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),s(i)}},AC={borderRadius:{...g0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:g0,borderTopRightRadius:g0,borderBottomLeftRadius:g0,borderBottomRightRadius:g0,boxShadow:xle};function W9(n,{layout:e,layoutId:t}){return Em.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!AC[n]||n==="opacity")}const _le={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},wle=Sm.length;function ble(n,e,t){let r="",i=!0;for(let s=0;s<wle;s++){const o=Sm[s],a=n[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||t){const u=D9(a,GP[o]);if(!l){i=!1;const c=_le[o]||o;r+=`${c}(${u}) `}t&&(e[o]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function YP(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let o=!1,a=!1;for(const l in e){const u=e[l];if(Em.has(l)){o=!0;continue}else if(l9(l)){i[l]=u;continue}else{const c=D9(u,GP[l]);l.startsWith("origin")?(a=!0,s[l]=c):r[l]=c}}if(e.transform||(o||t?r.transform=ble(e,n.transform,t):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;r.transformOrigin=`${l} ${u} ${c}`}}const KP=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function H9(n,e,t){for(const r in e)!_i(e[r])&&!W9(r,t)&&(n[r]=e[r])}function Sle({transformTemplate:n},e){return U.useMemo(()=>{const t=KP();return YP(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Ele(n,e){const t=n.style||{},r={};return H9(r,t,n),Object.assign(r,Sle(n,e)),r}function Mle(n,e){const t={},r=Ele(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const Tle={offset:"stroke-dashoffset",array:"stroke-dasharray"},Cle={offset:"strokeDashoffset",array:"strokeDasharray"};function Ale(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Tle:Cle;n[s.offset]=zt.transform(-r);const o=zt.transform(e),a=zt.transform(t);n[s.array]=`${o} ${a}`}function G9(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:o=0,...a},l,u,c){if(YP(n,a,u),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:f,style:h}=n;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),t!==void 0&&(f.y=t),r!==void 0&&(f.scale=r),i!==void 0&&Ale(f,i,s,o,!1)}const j9=()=>({...KP(),attrs:{}}),X9=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Rle(n,e,t,r){const i=U.useMemo(()=>{const s=j9();return G9(s,e,X9(r),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};H9(s,n.style,n),i.style={...s,...i.style}}return i}const Ple=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ZP(n){return typeof n!="string"||n.includes("-")?!1:!!(Ple.indexOf(n)>-1||/[A-Z]/u.test(n))}function Ile(n,e,t,{latestValues:r},i,s=!1){const a=(ZP(n)?Rle:Mle)(e,r,i,n),l=gle(e,typeof n=="string",s),u=n!==U.Fragment?{...l,...a,ref:t}:{},{children:c}=e,f=U.useMemo(()=>_i(c)?c.get():c,[c]);return U.createElement(n,{...u,children:f})}function qF(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function JP(n,e,t,r){if(typeof e=="function"){const[i,s]=qF(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=qF(r);e=e(t!==void 0?t:n.custom,i,s)}return e}function I2(n){return _i(n)?n.get():n}function Dle({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:Nle(t,r,i,n),renderState:e()}}function Nle(n,e,t,r){const i={},s=r(n,{});for(const h in s)i[h]=I2(s[h]);let{initial:o,animate:a}=n;const l=ob(n),u=V9(n);e&&u&&!l&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let c=t?t.initial===!1:!1;c=c||o===!1;const f=c?a:o;if(f&&typeof f!="boolean"&&!sb(f)){const h=Array.isArray(f)?f:[f];for(let d=0;d<h.length;d++){const p=JP(n,h[d]);if(p){const{transitionEnd:y,transition:x,...m}=p;for(const _ in m){let w=m[_];if(Array.isArray(w)){const b=c?w.length-1:0;w=w[b]}w!==null&&(i[_]=w)}for(const _ in y)i[_]=y[_]}}}return i}const $9=n=>(e,t)=>{const r=U.useContext(ib),i=U.useContext(nb),s=()=>Dle(n,e,r,i);return t?s():Yv(s)};function QP(n,e,t){var s;const{style:r}=n,i={};for(const o in r)(_i(r[o])||e.style&&_i(e.style[o])||W9(o,n)||((s=t==null?void 0:t.getValue(o))==null?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return i}const kle=$9({scrapeMotionValuesFromProps:QP,createRenderState:KP});function q9(n,e,t){const r=QP(n,e,t);for(const i in n)if(_i(n[i])||_i(e[i])){const s=Sm.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}const Lle=$9({scrapeMotionValuesFromProps:q9,createRenderState:j9}),Fle=Symbol.for("motionComponentSymbol");function hp(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Ole(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):hp(t)&&(t.current=r))},[e])}const e4=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ble="framerAppearId",Y9="data-"+e4(Ble),K9=U.createContext({});function Ule(n,e,t,r,i){var y,x;const{visualElement:s}=U.useContext(ib),o=U.useContext(U9),a=U.useContext(nb),l=U.useContext(Qv).reducedMotion,u=U.useRef(null);r=r||o.renderer,!u.current&&r&&(u.current=r(n,{visualState:e,parent:s,props:t,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const c=u.current,f=U.useContext(K9);c&&!c.projection&&i&&(c.type==="html"||c.type==="svg")&&zle(u.current,t,i,f);const h=U.useRef(!1);U.useInsertionEffect(()=>{c&&h.current&&c.update(t,a)});const d=t[Y9],p=U.useRef(!!d&&!((y=window.MotionHandoffIsComplete)!=null&&y.call(window,d))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,d)));return CP(()=>{c&&(h.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),p.current&&c.animationState&&c.animationState.animateChanges())}),U.useEffect(()=>{c&&(!p.current&&c.animationState&&c.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var m;(m=window.MotionHandoffMarkAsComplete)==null||m.call(window,d)}),p.current=!1),c.enteringChildren=void 0)}),c}function zle(n,e,t,r){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Z9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&hp(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:u})}function Z9(n){if(n)return n.options.allowProjection!==!1?n.projection:Z9(n.parent)}function a3(n,{forwardMotionProps:e=!1}={},t,r){t&&dle(t);const i=ZP(n)?Lle:kle;function s(a,l){let u;const c={...U.useContext(Qv),...a,layoutId:Vle(a)},{isStatic:f}=c,h=yle(a),d=i(a,f);if(!f&&TP){Wle();const p=Hle(c);u=p.MeasureLayout,h.visualElement=Ule(n,d,c,r,p.ProjectionNode)}return z.jsxs(ib.Provider,{value:h,children:[u&&h.visualElement?z.jsx(u,{visualElement:h.visualElement,...c}):null,Ile(n,a,Ole(d,h.visualElement,l),d,f,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(s);return o[Fle]=n,o}function Vle({layoutId:n}){const e=U.useContext(MP).id;return e&&n!==void 0?e+"-"+n:n}function Wle(n,e){U.useContext(U9).strict}function Hle(n){const{drag:e,layout:t}=rm;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Gle(n,e){if(typeof Proxy>"u")return a3;const t=new Map,r=(s,o)=>a3(s,o,n,e),i=(s,o)=>r(s,o);return new Proxy(i,{get:(s,o)=>o==="create"?r:(t.has(o)||t.set(o,a3(o,void 0,n,e)),t.get(o))})}function J9({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function jle({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Xle(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function l3(n){return n===void 0||n===1}function RC({scale:n,scaleX:e,scaleY:t}){return!l3(n)||!l3(e)||!l3(t)}function kf(n){return RC(n)||Q9(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Q9(n){return YF(n.x)||YF(n.y)}function YF(n){return n&&n!=="0%"}function R_(n,e,t){const r=n-t,i=e*r;return t+i}function KF(n,e,t,r,i){return i!==void 0&&(n=R_(n,i,r)),R_(n,t,r)+e}function PC(n,e=0,t=1,r,i){n.min=KF(n.min,e,t,r,i),n.max=KF(n.max,e,t,r,i)}function eW(n,{x:e,y:t}){PC(n.x,e.translate,e.scale,e.originPoint),PC(n.y,t.translate,t.scale,t.originPoint)}const ZF=.999999999999,JF=1.0000000000001;function $le(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=t[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&pp(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,eW(n,o)),r&&kf(s.latestValues)&&pp(n,s.latestValues))}e.x<JF&&e.x>ZF&&(e.x=1),e.y<JF&&e.y>ZF&&(e.y=1)}function dp(n,e){n.min=n.min+e,n.max=n.max+e}function QF(n,e,t,r,i=.5){const s=dr(n.min,n.max,i);PC(n,e,t,s,r)}function pp(n,e){QF(n.x,e.x,e.scaleX,e.scale,e.originX),QF(n.y,e.y,e.scaleY,e.scale,e.originY)}function tW(n,e){return J9(Xle(n.getBoundingClientRect(),e))}function qle(n,e,t){const r=tW(n,t),{scroll:i}=e;return i&&(dp(r.x,i.offset.x),dp(r.y,i.offset.y)),r}const eO=()=>({translate:0,scale:1,origin:0,originPoint:0}),mp=()=>({x:eO(),y:eO()}),tO=()=>({min:0,max:0}),Jr=()=>({x:tO(),y:tO()}),IC={current:null},nW={current:!1};function Yle(){if(nW.current=!0,!!TP)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>IC.current=n.matches;n.addEventListener("change",e),e()}else IC.current=!1}const Kle=new WeakMap;function Zle(n,e,t){for(const r in e){const i=e[r],s=t[r];if(_i(i))n.addValue(r,i);else if(_i(s))n.addValue(r,Th(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,Th(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const nO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Jle{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=WP,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Vs.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,$n.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=ob(t),this.isVariantNode=V9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const h in f){const d=f[h];l[h]!==void 0&&_i(d)&&d.set(l[h])}}mount(e){var t;this.current=e,Kle.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),nW.current||Yle(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:IC.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),wu(this.notifyUpdate),wu(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Em.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&$n.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in rm){const t=rm[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Jr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<nO.length;r++){const i=nO[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Zle(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Th(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(X7(r)||q7(r))?r=parseFloat(r):!sle(r)&&zc.test(t)&&(r=I9(e,t)),this.setBaseTarget(e,_i(r)?r.get():r)),_i(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var s;const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const o=JP(this.props,t,(s=this.presenceContext)==null?void 0:s.custom);o&&(r=o[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!_i(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new DP),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){jP.render(this.render)}}class rW extends Jle{constructor(){super(...arguments),this.KeyframeResolver=jae}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;_i(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function iW(n,{style:e,vars:t},r,i){const s=n.style;let o;for(o in e)s[o]=e[o];i==null||i.applyProjectionStyles(s,r);for(o in t)s.setProperty(o,t[o])}function Qle(n){return window.getComputedStyle(n)}class eue extends rW{constructor(){super(...arguments),this.type="html",this.renderInstance=iW}readValueFromInstance(e,t){var r;if(Em.has(t))return(r=this.projection)!=null&&r.isProjecting?wC(t):cae(e,t);{const i=Qle(e),s=(l9(t)?i.getPropertyValue(t):i[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return tW(e,t)}build(e,t,r){YP(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return QP(e,t,r)}}const sW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tue(n,e,t,r){iW(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(sW.has(i)?i:e4(i),e.attrs[i])}class nue extends rW{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Jr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Em.has(t)){const r=P9(t);return r&&r.default||0}return t=sW.has(t)?t:e4(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return q9(e,t,r)}build(e,t,r){G9(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){tue(e,t,r,i)}mount(e){this.isSVGTag=X9(e.tagName),super.mount(e)}}const rue=(n,e)=>ZP(n)?new nue(e):new eue(e,{allowProjection:n!==U.Fragment});function Pp(n,e,t){const r=n.getProps();return JP(r,e,t!==void 0?t:r.custom,n)}const DC=n=>Array.isArray(n);function iue(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Th(t))}function sue(n){return DC(n)?n[n.length-1]||0:n}function oue(n,e){const t=Pp(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const o in s){const a=sue(s[o]);iue(n,o,a)}}function aue(n){return!!(_i(n)&&n.add)}function NC(n,e){const t=n.getValue("willChange");if(aue(t))return t.add(e);if(!t&&_u.WillChange){const r=new _u.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function oW(n){return n.props[Y9]}const lue=n=>n!==null;function uue(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(lue),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[s]}const cue={type:"spring",stiffness:500,damping:25,restSpeed:10},fue=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),hue={type:"keyframes",duration:.8},due={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},pue=(n,{keyframes:e})=>e.length>2?hue:Em.has(n)?n.startsWith("scale")?fue(e[1]):cue:due;function mue({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const t4=(n,e,t,r={},i,s)=>o=>{const a=HP(r,n)||{},l=a.delay||r.delay||0;let{elapsed:u=0}=r;u=u-wl(l);const c={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:i};mue(a)||Object.assign(c,pue(n,c)),c.duration&&(c.duration=wl(c.duration)),c.repeatDelay&&(c.repeatDelay=wl(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let f=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(TC(c),c.delay===0&&(f=!0)),(_u.instantAnimations||_u.skipAnimations)&&(f=!0,TC(c),c.delay=0),c.allowFlatten=!a.type&&!a.ease,f&&!s&&e.get()!==void 0){const h=uue(c.keyframes,a);if(h!==void 0){$n.update(()=>{c.onUpdate(h),c.onComplete()});return}}return a.isSync?new rb(c):new Nae(c)};function gue({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function aW(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:o,...a}=e;r&&(s=r);const l=[],u=i&&n.animationState&&n.animationState.getState()[i];for(const c in a){const f=n.getValue(c,n.latestValues[c]??null),h=a[c];if(h===void 0||u&&gue(u,c))continue;const d={delay:t,...HP(s||{},c)},p=f.get();if(p!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===p&&!d.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const m=oW(n);if(m){const _=window.MotionHandoffAnimation(m,c,$n);_!==null&&(d.startTime=_,y=!0)}}NC(n,c),f.start(t4(c,f,h,n.shouldReduceMotion&&C9.has(c)?{type:!1}:d,n,y));const x=f.animation;x&&l.push(x)}return o&&Promise.all(l).then(()=>{$n.update(()=>{o&&oue(n,o)})}),l}function lW(n,e,t,r=0,i=1){const s=Array.from(n).sort((u,c)=>u.sortNodePosition(c)).indexOf(e),o=n.size,a=(o-1)*r;return typeof t=="function"?t(s,o):i===1?s*r:a-s*r}function kC(n,e,t={}){var l;const r=Pp(n,e,t.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const s=r?()=>Promise.all(aW(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:f,staggerDirection:h}=i;return vue(n,e,u,c,f,h,t)}:()=>Promise.resolve(),{when:a}=i;if(a){const[u,c]=a==="beforeChildren"?[s,o]:[o,s];return u().then(()=>c())}else return Promise.all([s(),o(t.delay)])}function vue(n,e,t=0,r=0,i=0,s=1,o){const a=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),a.push(kC(l,e,{...o,delay:t+(typeof r=="function"?0:r)+lW(n.variantChildren,l,r,i,s)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function yue(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>kC(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=kC(n,e,t);else{const i=typeof e=="function"?Pp(n,e,t.custom):e;r=Promise.all(aW(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function uW(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const xue=qP.length;function cW(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?cW(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<xue;t++){const r=qP[t],i=n.props[r];(_v(i)||i===!1)&&(e[r]=i)}return e}const _ue=[...$P].reverse(),wue=$P.length;function bue(n){return e=>Promise.all(e.map(({animation:t,options:r})=>yue(n,t,r)))}function Sue(n){let e=bue(n),t=rO(),r=!0;const i=l=>(u,c)=>{var h;const f=Pp(n,c,l==="exit"?(h=n.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:d,transitionEnd:p,...y}=f;u={...u,...y,...p}}return u};function s(l){e=l(n)}function o(l){const{props:u}=n,c=cW(n.parent)||{},f=[],h=new Set;let d={},p=1/0;for(let x=0;x<wue;x++){const m=_ue[x],_=t[m],w=u[m]!==void 0?u[m]:c[m],b=_v(w),S=m===l?_.isActive:null;S===!1&&(p=x);let M=w===c[m]&&w!==u[m]&&b;if(M&&r&&n.manuallyAnimateOnMount&&(M=!1),_.protectedKeys={...d},!_.isActive&&S===null||!w&&!_.prevProp||sb(w)||typeof w=="boolean")continue;const T=Eue(_.prevProp,w);let P=T||m===l&&_.isActive&&!M&&b||x>p&&b,C=!1;const A=Array.isArray(w)?w:[w];let k=A.reduce(i(m),{});S===!1&&(k={});const{prevResolvedValues:L={}}=_,H={...L,...k},F=G=>{P=!0,h.has(G)&&(C=!0,h.delete(G)),_.needsAnimating[G]=!0;const N=n.getValue(G);N&&(N.liveStyle=!1)};for(const G in H){const N=k[G],B=L[G];if(d.hasOwnProperty(G))continue;let D=!1;DC(N)&&DC(B)?D=!uW(N,B):D=N!==B,D?N!=null?F(G):h.add(G):N!==void 0&&h.has(G)?F(G):_.protectedKeys[G]=!0}_.prevProp=w,_.prevResolvedValues=k,_.isActive&&(d={...d,...k}),r&&n.blockInitialAnimation&&(P=!1);const V=M&&T;P&&(!V||C)&&f.push(...A.map(G=>{const N={type:m};if(typeof G=="string"&&r&&!V&&n.manuallyAnimateOnMount&&n.parent){const{parent:B}=n,D=Pp(B,G);if(B.enteringChildren&&D){const{delayChildren:$}=D.transition||{};N.delay=lW(B.enteringChildren,n,$)}}return{animation:G,options:N}}))}if(h.size){const x={};if(typeof u.initial!="boolean"){const m=Pp(n,Array.isArray(u.initial)?u.initial[0]:u.initial);m&&m.transition&&(x.transition=m.transition)}h.forEach(m=>{const _=n.getBaseTarget(m),w=n.getValue(m);w&&(w.liveStyle=!0),x[m]=_??null}),f.push({animation:x})}let y=!!f.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(y=!1),r=!1,y?e(f):Promise.resolve()}function a(l,u){var f;if(t[l].isActive===u)return Promise.resolve();(f=n.variantChildren)==null||f.forEach(h=>{var d;return(d=h.animationState)==null?void 0:d.setActive(l,u)}),t[l].isActive=u;const c=o(l);for(const h in t)t[h].protectedKeys={};return c}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=rO()}}}function Eue(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!uW(e,n):!1}function Ef(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rO(){return{animate:Ef(!0),whileInView:Ef(),whileHover:Ef(),whileTap:Ef(),whileDrag:Ef(),whileFocus:Ef(),exit:Ef()}}class Jc{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Mue extends Jc{constructor(e){super(e),e.animationState||(e.animationState=Sue(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();sb(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Tue=0;class Cue extends Jc{constructor(){super(...arguments),this.id=Tue++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Aue={animation:{Feature:Mue},exit:{Feature:Cue}};function wv(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function ey(n){return{point:{x:n.pageX,y:n.pageY}}}const Rue=n=>e=>XP(e)&&n(e,ey(e));function mg(n,e,t,r){return wv(n,e,Rue(t),r)}const fW=1e-4,Pue=1-fW,Iue=1+fW,hW=.01,Due=0-hW,Nue=0+hW;function Ss(n){return n.max-n.min}function kue(n,e,t){return Math.abs(n-e)<=t}function iO(n,e,t,r=.5){n.origin=r,n.originPoint=dr(e.min,e.max,n.origin),n.scale=Ss(t)/Ss(e),n.translate=dr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Pue&&n.scale<=Iue||isNaN(n.scale))&&(n.scale=1),(n.translate>=Due&&n.translate<=Nue||isNaN(n.translate))&&(n.translate=0)}function gg(n,e,t,r){iO(n.x,e.x,t.x,r?r.originX:void 0),iO(n.y,e.y,t.y,r?r.originY:void 0)}function sO(n,e,t){n.min=t.min+e.min,n.max=n.min+Ss(e)}function Lue(n,e,t){sO(n.x,e.x,t.x),sO(n.y,e.y,t.y)}function oO(n,e,t){n.min=e.min-t.min,n.max=n.min+Ss(e)}function P_(n,e,t){oO(n.x,e.x,t.x),oO(n.y,e.y,t.y)}function $o(n){return[n("x"),n("y")]}const dW=({current:n})=>n?n.ownerDocument.defaultView:null,aO=(n,e)=>Math.abs(n-e);function Fue(n,e){const t=aO(n.x,e.x),r=aO(n.y,e.y);return Math.sqrt(t**2+r**2)}class pW{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=c3(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,p=Fue(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!d&&!p)return;const{point:y}=h,{timestamp:x}=Ri;this.history.push({...y,timestamp:x});const{onStart:m,onMove:_}=this.handlers;d||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=u3(d,this.transformPagePoint),$n.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:p,onSessionEnd:y,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=c3(h.type==="pointercancel"?this.lastMoveEventInfo:u3(d,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,m),y&&y(h,m)},!XP(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const a=ey(e),l=u3(a,this.transformPagePoint),{point:u}=l,{timestamp:c}=Ri;this.history=[{...u,timestamp:c}];const{onSessionStart:f}=t;f&&f(e,c3(l,this.history)),this.removeListeners=Kv(mg(this.contextWindow,"pointermove",this.handlePointerMove),mg(this.contextWindow,"pointerup",this.handlePointerUp),mg(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wu(this.updatePoint)}}function u3(n,e){return e?{point:e(n.point)}:n}function lO(n,e){return{x:n.x-e.x,y:n.y-e.y}}function c3({point:n},e){return{point:n,delta:lO(n,mW(e)),offset:lO(n,Oue(e)),velocity:Bue(e,.1)}}function Oue(n){return n[0]}function mW(n){return n[n.length-1]}function Bue(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=mW(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>wl(e)));)t--;if(!r)return{x:0,y:0};const s=ia(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Uue(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?dr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?dr(t,n,r.max):Math.min(n,t)),n}function uO(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function zue(n,{top:e,left:t,bottom:r,right:i}){return{x:uO(n.x,t,i),y:uO(n.y,e,r)}}function cO(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function Vue(n,e){return{x:cO(n.x,e.x),y:cO(n.y,e.y)}}function Wue(n,e){let t=.5;const r=Ss(n),i=Ss(e);return i>r?t=vv(e.min,e.max-r,n.min):r>i&&(t=vv(n.min,n.max-i,e.min)),xu(0,1,t)}function Hue(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const LC=.35;function Gue(n=LC){return n===!1?n=0:n===!0&&(n=LC),{x:fO(n,"left","right"),y:fO(n,"top","bottom")}}function fO(n,e,t){return{min:hO(n,e),max:hO(n,t)}}function hO(n,e){return typeof n=="number"?n:n[e]||0}const jue=new WeakMap;class Xue{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Jr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ey(f).point)},o=(f,h)=>{const{drag:d,dragPropagation:p,onDragStart:y}=this.getProps();if(d&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Yae(d),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$o(m=>{let _=this.getAxisMotionValue(m).get()||0;if(bl.test(_)){const{projection:w}=this.visualElement;if(w&&w.layout){const b=w.layout.layoutBox[m];b&&(_=Ss(b)*(parseFloat(_)/100))}}this.originPoint[m]=_}),y&&$n.postRender(()=>y(f,h)),NC(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:d,dragDirectionLock:p,onDirectionLock:y,onDrag:x}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:m}=h;if(p&&this.currentDirection===null){this.currentDirection=$ue(m),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),x&&x(f,h)},l=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>$o(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new pW(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:dW(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&$n.postRender(()=>a(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Nx(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Uue(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;e&&hp(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=zue(r.layoutBox,e):this.constraints=!1,this.elastic=Gue(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&$o(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Hue(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!hp(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=qle(r,i.root,this.visualElement.getTransformPagePoint());let o=Vue(i.layout.layoutBox,s);if(t){const a=t(jle(o));this.hasMutatedConstraints=!!a,a&&(o=J9(a))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=$o(c=>{if(!Nx(c,t,this.currentDirection))return;let f=l&&l[c]||{};o&&(f={min:0,max:0});const h=i?200:1e6,d=i?40:1e7,p={type:"inertia",velocity:r?e[c]:0,bounceStiffness:h,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(c,p)});return Promise.all(u).then(a)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return NC(this.visualElement,e),r.start(t4(e,r,0,t,this.visualElement,!1))}stopAnimation(){$o(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$o(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){$o(t=>{const{drag:r}=this.getProps();if(!Nx(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[t];s.set(e[t]-dr(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!hp(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};$o(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=Wue({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),$o(o=>{if(!Nx(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:u}=this.constraints[o];a.set(dr(l,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;jue.set(this.visualElement,this);const e=this.visualElement.current,t=mg(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();hp(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),$n.read(r);const o=wv(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&($o(c=>{const f=this.getAxisMotionValue(c);f&&(this.originPoint[c]+=l[c].translate,f.set(f.get()+l[c].translate))}),this.visualElement.render())});return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=LC,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Nx(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function $ue(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class que extends Jc{constructor(e){super(e),this.removeGroupControls=la,this.removeListeners=la,this.controls=new Xue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||la}unmount(){this.removeGroupControls(),this.removeListeners()}}const dO=n=>(e,t)=>{n&&$n.postRender(()=>n(e,t))};class Yue extends Jc{constructor(){super(...arguments),this.removePointerDownListener=la}onPointerDown(e){this.session=new pW(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:dW(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:dO(e),onStart:dO(t),onMove:r,onEnd:(s,o)=>{delete this.session,i&&$n.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=mg(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const D2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let f3=!1;class Kue extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),f3&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),D2.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,{projection:o}=r;return o&&(o.isPresent=s,f3=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||$n.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),jP.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;f3=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function gW(n){const[e,t]=B9(),r=U.useContext(MP);return z.jsx(Kue,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(K9),isPresent:e,safeToRemove:t})}function Zue(n,e,t){const r=_i(n)?n:Th(n);return r.start(t4("",r,e,t)),r.animation}const Jue=(n,e)=>n.depth-e.depth;class Que{constructor(){this.children=[],this.isDirty=!1}add(e){AP(this.children,e),this.isDirty=!0}remove(e){RP(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Jue),this.isDirty=!1,this.children.forEach(e)}}function ece(n,e){const t=Vs.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(wu(r),n(s-e))};return $n.setup(r,!0),()=>wu(r)}const vW=["TopLeft","TopRight","BottomLeft","BottomRight"],tce=vW.length,pO=n=>typeof n=="string"?parseFloat(n):n,mO=n=>typeof n=="number"||zt.test(n);function nce(n,e,t,r,i,s){i?(n.opacity=dr(0,t.opacity??1,rce(r)),n.opacityExit=dr(e.opacity??1,0,ice(r))):s&&(n.opacity=dr(e.opacity??1,t.opacity??1,r));for(let o=0;o<tce;o++){const a=`border${vW[o]}Radius`;let l=gO(e,a),u=gO(t,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||mO(l)===mO(u)?(n[a]=Math.max(dr(pO(l),pO(u),r),0),(bl.test(u)||bl.test(l))&&(n[a]+="%")):n[a]=u}(e.rotate||t.rotate)&&(n.rotate=dr(e.rotate||0,t.rotate||0,r))}function gO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const rce=yW(0,.5,n9),ice=yW(.5,.95,la);function yW(n,e,t){return r=>r<n?0:r>e?1:t(vv(n,e,r))}function vO(n,e){n.min=e.min,n.max=e.max}function wa(n,e){vO(n.x,e.x),vO(n.y,e.y)}function yO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function xO(n,e,t,r,i){return n-=e,n=R_(n,1/t,r),i!==void 0&&(n=R_(n,1/i,r)),n}function sce(n,e=0,t=1,r=.5,i,s=n,o=n){if(bl.test(e)&&(e=parseFloat(e),e=dr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=dr(s.min,s.max,r);n===s&&(a-=e),n.min=xO(n.min,e,t,a,i),n.max=xO(n.max,e,t,a,i)}function _O(n,e,[t,r,i],s,o){sce(n,e[t],e[r],e[i],e.scale,s,o)}const oce=["x","scaleX","originX"],ace=["y","scaleY","originY"];function wO(n,e,t,r){_O(n.x,e,oce,t?t.x:void 0,r?r.x:void 0),_O(n.y,e,ace,t?t.y:void 0,r?r.y:void 0)}function bO(n){return n.translate===0&&n.scale===1}function xW(n){return bO(n.x)&&bO(n.y)}function SO(n,e){return n.min===e.min&&n.max===e.max}function lce(n,e){return SO(n.x,e.x)&&SO(n.y,e.y)}function EO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function _W(n,e){return EO(n.x,e.x)&&EO(n.y,e.y)}function MO(n){return Ss(n.x)/Ss(n.y)}function TO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class uce{constructor(){this.members=[]}add(e){AP(this.members,e),e.scheduleRender()}remove(e){if(RP(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function cce(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:c,rotateX:f,rotateY:h,skewX:d,skewY:p}=t;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),f&&(r+=`rotateX(${f}deg) `),h&&(r+=`rotateY(${h}deg) `),d&&(r+=`skewX(${d}deg) `),p&&(r+=`skewY(${p}deg) `)}const a=n.x.scale*e.x,l=n.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const h3=["","X","Y","Z"],fce=1e3;let hce=0;function d3(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function wW(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=oW(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",$n,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&wW(r)}function bW({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=hce++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(mce),this.nodes.forEach(xce),this.nodes.forEach(_ce),this.nodes.forEach(gce)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Que)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new DP),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=O9(o)&&!tle(o),this.instance=o;const{layoutId:a,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),n){let c,f=0;const h=()=>this.root.updateBlockedByResize=!1;$n.read(()=>{f=window.innerWidth}),n(o,()=>{const d=window.innerWidth;d!==f&&(f=d,this.root.updateBlockedByResize=!0,c&&c(),c=ece(h,250),D2.hasAnimatedSinceResize&&(D2.hasAnimatedSinceResize=!1,this.nodes.forEach(RO)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&u&&(a||l)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:d})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||Mce,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=u.getProps(),m=!this.targetLayout||!_W(this.targetLayout,d),_=!f&&h;if(this.options.layoutRoot||this.resumeFrom||_||f&&(m||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...HP(p,"layout"),onPlay:y,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(c,_)}else f||RO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=d})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),wu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(wce),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&wW(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const f=this.path[c];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(CO);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(AO);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(yce),this.nodes.forEach(dce),this.nodes.forEach(pce)):this.nodes.forEach(AO),this.clearAllSnapshots();const a=Vs.now();Ri.delta=xu(0,1e3/60,a-Ri.timestamp),Ri.timestamp=a,Ri.isProcessing=!0,t3.update.process(Ri),t3.preRender.process(Ri),t3.render.process(Ri),Ri.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jP.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(vce),this.sharedNodes.forEach(bce)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ss(this.snapshot.measuredBox.x)&&!Ss(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Jr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!xW(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;o&&this.instance&&(a||kf(this.latestValues)||c)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Tce(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return Jr();const a=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Cce))){const{scroll:c}=this.root;c&&(dp(a.x,c.offset.x),dp(a.y,c.offset.y))}return a}removeElementScroll(o){var l;const a=Jr();if(wa(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:f,options:h}=c;c!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&wa(a,o),dp(a.x,f.offset.x),dp(a.y,f.offset.y))}return a}applyTransform(o,a=!1){const l=Jr();wa(l,o);for(let u=0;u<this.path.length;u++){const c=this.path[u];!a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&pp(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),kf(c.latestValues)&&pp(l,c.latestValues)}return kf(this.latestValues)&&pp(l,this.latestValues),l}removeTransform(o){const a=Jr();wa(a,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!kf(u.latestValues))continue;RC(u.latestValues)&&u.updateSnapshot();const c=Jr(),f=u.measurePageBox();wa(c,f),wO(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return kf(this.latestValues)&&wO(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ri.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var d;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(d=this.parent)!=null&&d.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:f}=this.options;if(!this.layout||!(c||f))return;this.resolvedRelativeTargetAt=Ri.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Jr(),this.targetWithTransforms=Jr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Lue(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):wa(this.target,this.layout.layoutBox),eW(this.target,this.targetDelta)):wa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||RC(this.parent.latestValues)||Q9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,l){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Jr(),this.relativeTargetOrigin=Jr(),P_(this.relativeTargetOrigin,a,l),wa(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var p;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ri.timestamp&&(l=!1),l)return;const{layout:u,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||c))return;wa(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;$le(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Jr());const{target:d}=o;if(!d){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(yO(this.prevProjectionDelta.x,this.projectionDelta.x),yO(this.prevProjectionDelta.y,this.projectionDelta.y)),gg(this.projectionDelta,this.layoutCorrected,d,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!TO(this.projectionDelta.x,this.prevProjectionDelta.x)||!TO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mp(),this.projectionDelta=mp(),this.projectionDeltaWithTransform=mp()}setAnimationOrigin(o,a=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},f=mp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=Jr(),d=l?l.source:void 0,p=this.layout?this.layout.source:void 0,y=d!==p,x=this.getStack(),m=!x||x.members.length<=1,_=!!(y&&!m&&this.options.crossfade===!0&&!this.path.some(Ece));this.animationProgress=0;let w;this.mixTargetDelta=b=>{const S=b/1e3;PO(f.x,o.x,S),PO(f.y,o.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(P_(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Sce(this.relativeTarget,this.relativeTargetOrigin,h,S),w&&lce(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Jr()),wa(w,this.relativeTarget)),y&&(this.animationValues=c,nce(c,u,this.latestValues,S,_,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,u;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(wu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$n.update(()=>{D2.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Th(0)),this.currentAnimation=Zue(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fce),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:c}=o;if(!(!a||!l||!u)){if(this!==o&&this.layout&&u&&SW(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Jr();const f=Ss(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+f;const h=Ss(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}wa(a,l),pp(a,c),gg(this.projectionDeltaWithTransform,this.layoutCorrected,a,c)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new uce),this.sharedNodes.get(o).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&d3("z",o,u,this.animationValues);for(let c=0;c<h3.length;c++)d3(`rotate${h3[c]}`,o,u,this.animationValues),d3(`skew${h3[c]}`,o,u,this.animationValues);o.render();for(const c in u)o.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=I2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=I2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!kf(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const c=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=cce(this.projectionDeltaWithTransform,this.treeScale,c);l&&(f=l(c,f)),o.transform=f;const{x:h,y:d}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${d.origin*100}% 0`,u.animationValues?o.opacity=u===this?c.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:o.opacity=u===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const p in AC){if(c[p]===void 0)continue;const{correct:y,applyTo:x,isCSSVariable:m}=AC[p],_=f==="none"?c[p]:y(c[p],u);if(x){const w=x.length;for(let b=0;b<w;b++)o[x[b]]=_}else m?this.options.visualElement.renderState.vars[p]=_:o[p]=_}this.options.layoutId&&(o.pointerEvents=u===this?I2(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(CO),this.root.sharedNodes.clear()}}}function dce(n){n.updateLayout()}function pce(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,o=e.source!==n.layout.source;s==="size"?$o(f=>{const h=o?e.measuredBox[f]:e.layoutBox[f],d=Ss(h);h.min=r[f].min,h.max=h.min+d}):SW(s,e.layoutBox,r)&&$o(f=>{const h=o?e.measuredBox[f]:e.layoutBox[f],d=Ss(r[f]);h.max=h.min+d,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+d)});const a=mp();gg(a,r,e.layoutBox);const l=mp();o?gg(l,n.applyTransform(i,!0),e.measuredBox):gg(l,r,e.layoutBox);const u=!xW(a);let c=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:d}=f;if(h&&d){const p=Jr();P_(p,e.layoutBox,h.layoutBox);const y=Jr();P_(y,r,d.layoutBox),_W(p,y)||(c=!0),f.options.layoutRoot&&(n.relativeTarget=y,n.relativeTargetOrigin=p,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeLayoutChanged:c})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function mce(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function gce(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function vce(n){n.clearSnapshot()}function CO(n){n.clearMeasurements()}function AO(n){n.isLayoutDirty=!1}function yce(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function RO(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function xce(n){n.resolveTargetDelta()}function _ce(n){n.calcProjection()}function wce(n){n.resetSkewAndRotation()}function bce(n){n.removeLeadSnapshot()}function PO(n,e,t){n.translate=dr(e.translate,0,t),n.scale=dr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function IO(n,e,t,r){n.min=dr(e.min,t.min,r),n.max=dr(e.max,t.max,r)}function Sce(n,e,t,r){IO(n.x,e.x,t.x,r),IO(n.y,e.y,t.y,r)}function Ece(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Mce={duration:.45,ease:[.4,0,.1,1]},DO=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),NO=DO("applewebkit/")&&!DO("chrome/")?Math.round:la;function kO(n){n.min=NO(n.min),n.max=NO(n.max)}function Tce(n){kO(n.x),kO(n.y)}function SW(n,e,t){return n==="position"||n==="preserve-aspect"&&!kue(MO(e),MO(t),.2)}function Cce(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const Ace=bW({attachResizeListener:(n,e)=>wv(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),p3={current:void 0},EW=bW({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!p3.current){const n=new Ace({});n.mount(window),n.setOptions({layoutScroll:!0}),p3.current=n}return p3.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Rce={pan:{Feature:Yue},drag:{Feature:que,ProjectionNode:EW,MeasureLayout:gW}};function LO(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&$n.postRender(()=>s(e,ey(e)))}class Pce extends Jc{mount(){const{current:e}=this.node;e&&(this.unmount=Kae(e,(t,r)=>(LO(this.node,r,"Start"),i=>LO(this.node,i,"End"))))}unmount(){}}class Ice extends Jc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Kv(wv(this.node.current,"focus",()=>this.onFocus()),wv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function FO(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&$n.postRender(()=>s(e,ey(e)))}class Dce extends Jc{mount(){const{current:e}=this.node;e&&(this.unmount=ele(e,(t,r)=>(FO(this.node,r,"Start"),(i,{success:s})=>FO(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const FC=new WeakMap,m3=new WeakMap,Nce=n=>{const e=FC.get(n.target);e&&e(n)},kce=n=>{n.forEach(Nce)};function Lce({root:n,...e}){const t=n||document;m3.has(t)||m3.set(t,{});const r=m3.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(kce,{root:n,...e})),r[i]}function Fce(n,e,t){const r=Lce(e);return FC.set(n,t),r.observe(n),()=>{FC.delete(n),r.unobserve(n)}}const Oce={some:0,all:1};class Bce extends Jc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Oce[i]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:f}=this.node.getProps(),h=u?c:f;h&&h(l)};return Fce(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Uce(e,t))&&this.startObserver()}unmount(){}}function Uce({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const zce={inView:{Feature:Bce},tap:{Feature:Dce},focus:{Feature:Ice},hover:{Feature:Pce}},Vce={layout:{ProjectionNode:EW,MeasureLayout:gW}},Wce={...Aue,...zce,...Rce,...Vce},bv=Gle(Wce,rue);function Sv(n){const e=Yv(()=>Th(n)),{isStatic:t}=U.useContext(Qv);if(t){const[,r]=U.useState(n);U.useEffect(()=>e.on("change",r),[])}return e}function MW(n,e){const t=Sv(e()),r=()=>t.set(e());return r(),CP(()=>{const i=()=>$n.preRender(r,!1,!0),s=n.map(o=>o.on("change",i));return()=>{s.forEach(o=>o()),wu(r)}}),t}function Hce(n){pg.current=[],n();const e=MW(pg.current,n);return pg.current=void 0,e}function I_(n,e,t,r){if(typeof n=="function")return Hce(n);const i=typeof e=="function"?e:nle(e,t,r);return Array.isArray(n)?OO(n,i):OO([n],([s])=>i(s))}function OO(n,e){const t=Yv(()=>[]);return MW(n,()=>{t.length=0;const r=n.length;for(let i=0;i<r;i++)t[i]=n[i].get();return e(t)})}function TW(n,e={}){const{isStatic:t}=U.useContext(Qv),r=()=>_i(n)?n.get():n;if(t)return I_(r);const i=Sv(r());return U.useInsertionEffect(()=>rle(i,n,e),[i,JSON.stringify(e)]),i}function n4({text:n,speed:e=50,maxIterations:t=10,sequential:r=!1,revealDirection:i="start",useOriginalCharsOnly:s=!1,characters:o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+",className:a="",parentClassName:l="",encryptedClassName:u="",animateOn:c="hover",...f}){const[h,d]=U.useState(n),[p,y]=U.useState(!1),[x,m]=U.useState(!1),[_,w]=U.useState(new Set),[b,S]=U.useState(!1),M=U.useRef(null);U.useEffect(()=>{let P,C=0;const A=H=>{const F=n.length;switch(i){case"start":return H.size;case"end":return F-1-H.size;case"center":{const V=Math.floor(F/2),W=Math.floor(H.size/2),G=H.size%2===0?V+W:V-W-1;if(G>=0&&G<F&&!H.has(G))return G;for(let N=0;N<F;N++)if(!H.has(N))return N;return 0}default:return H.size}},k=s?Array.from(new Set(n.split(""))).filter(H=>H!==" "):o.split(""),L=(H,F)=>{if(s){const V=H.split("").map((N,B)=>({char:N,isSpace:N===" ",index:B,isRevealed:F.has(B)})),W=V.filter(N=>!N.isSpace&&!N.isRevealed).map(N=>N.char);for(let N=W.length-1;N>0;N--){const B=Math.floor(Math.random()*(N+1));[W[N],W[B]]=[W[B],W[N]]}let G=0;return V.map(N=>N.isSpace?" ":N.isRevealed?H[N.index]:W[G++]).join("")}else return H.split("").map((V,W)=>V===" "?" ":F.has(W)?H[W]:k[Math.floor(Math.random()*k.length)]).join("")};return p?(m(!0),P=setInterval(()=>{w(H=>{if(r)if(H.size<n.length){const F=A(H),V=new Set(H);return V.add(F),d(L(n,V)),V}else return clearInterval(P),m(!1),H;else return d(L(n,H)),C++,C>=t&&(clearInterval(P),m(!1),d(n)),H})},e)):(d(n),w(new Set),m(!1)),()=>{P&&clearInterval(P)}},[p,n,e,t,r,i,o,s]),U.useEffect(()=>{if(c!=="view"&&c!=="both")return;const P=L=>{L.forEach(H=>{H.isIntersecting&&!b&&(y(!0),S(!0))})},C={root:null,rootMargin:"0px",threshold:.1},A=new IntersectionObserver(P,C),k=M.current;return k&&A.observe(k),()=>{k&&A.unobserve(k)}},[c,b]);const T=c==="hover"||c==="both"?{onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1)}:{};return z.jsxs(bv.span,{ref:M,className:`inline-block whitespace-pre-wrap ${l}`,...T,...f,children:[z.jsx("span",{className:"sr-only",children:h}),z.jsx("span",{"aria-hidden":"true",children:h.split("").map((P,C)=>{const A=_.has(C)||!x||!p;return z.jsx("span",{className:A?a:u,children:P},C)})})]})}const Gce="linear-gradient(145deg, #1a1a2e8c 0%, #7c3aed44 100%)",v0={INITIAL_DURATION:1200,INITIAL_X_OFFSET:70,INITIAL_Y_OFFSET:60,DEVICE_BETA_OFFSET:20,ENTER_TRANSITION_MS:180},y0=(n,e=0,t=100)=>Math.min(Math.max(n,e),t),OC=(n,e=3)=>parseFloat(n.toFixed(e)),BO=(n,e,t,r,i)=>OC(r+(i-r)*(n-e)/(t-e)),jce=({avatarUrl:n="<Placeholder for avatar URL>",iconUrl:e="<Placeholder for icon URL>",grainUrl:t="<Placeholder for grain URL>",innerGradient:r,behindGlowEnabled:i=!0,behindGlowColor:s,behindGlowSize:o,className:a="",enableTilt:l=!0,enableMobileTilt:u=!1,mobileTiltSensitivity:c=5,miniAvatarUrl:f,name:h="Javi A. Torres",title:d="Software Engineer",handle:p="javicodes",status:y="Online",contactText:x="Contact",showUserInfo:m=!0,onContactClick:_})=>{const w=U.useRef(null),b=U.useRef(null),S=U.useRef(null),M=U.useRef(null),T=U.useMemo(()=>{if(!l)return null;let F=null,V=!1,W=0,G=0,N=0,B=0,D=0;const $=.14,ee=.6;let te=0;const se=(pe,Ne)=>{const Ue=b.current,We=w.current;if(!Ue||!We)return;const Be=Ue.clientWidth||1,J=Ue.clientHeight||1,he=y0(100/Be*pe),de=y0(100/J*Ne),Ie=he-50,ve=de-50,oe={"--pointer-x":`${he}%`,"--pointer-y":`${de}%`,"--background-x":`${BO(he,0,100,35,65)}%`,"--background-y":`${BO(de,0,100,35,65)}%`,"--pointer-from-center":`${y0(Math.hypot(de-50,he-50)/50,0,1)}`,"--pointer-from-top":`${de/100}`,"--pointer-from-left":`${he/100}`,"--rotate-x":`${OC(-(Ie/5))}deg`,"--rotate-y":`${OC(ve/4)}deg`};for(const[ze,X]of Object.entries(oe))We.style.setProperty(ze,X)},me=pe=>{if(!V)return;W===0&&(W=pe);const Ne=(pe-W)/1e3;W=pe;const Ue=pe<te?ee:$,We=1-Math.exp(-Ne/Ue);G+=(B-G)*We,N+=(D-N)*We,se(G,N),Math.abs(B-G)>.05||Math.abs(D-N)>.05||document.hasFocus()?F=requestAnimationFrame(me):(V=!1,W=0,F&&(cancelAnimationFrame(F),F=null))},_e=()=>{V||(V=!0,W=0,F=requestAnimationFrame(me))};return{setImmediate(pe,Ne){G=pe,N=Ne,se(G,N)},setTarget(pe,Ne){B=pe,D=Ne,_e()},toCenter(){const pe=b.current;pe&&this.setTarget(pe.clientWidth/2,pe.clientHeight/2)},beginInitial(pe){te=performance.now()+pe,_e()},getCurrent(){return{x:G,y:N,tx:B,ty:D}},cancel(){F&&cancelAnimationFrame(F),F=null,V=!1,W=0}}},[l]),P=(F,V)=>{const W=V.getBoundingClientRect();return{x:F.clientX-W.left,y:F.clientY-W.top}},C=U.useCallback(F=>{const V=b.current;if(!V||!T)return;const{x:W,y:G}=P(F,V);T.setTarget(W,G)},[T]),A=U.useCallback(F=>{const V=b.current;if(!V||!T)return;V.classList.add("active"),V.classList.add("entering"),S.current&&window.clearTimeout(S.current),S.current=window.setTimeout(()=>{V.classList.remove("entering")},v0.ENTER_TRANSITION_MS);const{x:W,y:G}=P(F,V);T.setTarget(W,G)},[T]),k=U.useCallback(()=>{const F=b.current;if(!F||!T)return;T.toCenter();const V=()=>{const{x:W,y:G,tx:N,ty:B}=T.getCurrent();Math.hypot(N-W,B-G)<.6?(F.classList.remove("active"),M.current=null):M.current=requestAnimationFrame(V)};M.current&&cancelAnimationFrame(M.current),M.current=requestAnimationFrame(V)},[T]),L=U.useCallback(F=>{const V=b.current;if(!V||!T)return;const{beta:W,gamma:G}=F;if(W==null||G==null)return;const N=V.clientWidth/2,B=V.clientHeight/2,D=y0(N+G*c,0,V.clientWidth),$=y0(B+(W-v0.DEVICE_BETA_OFFSET)*c,0,V.clientHeight);T.setTarget(D,$)},[T,c]);U.useEffect(()=>{if(!l||!T)return;const F=b.current;if(!F)return;const V=C,W=A,G=k,N=L;F.addEventListener("pointerenter",W),F.addEventListener("pointermove",V),F.addEventListener("pointerleave",G);const B=()=>{if(!u||location.protocol!=="https:")return;const ee=window.DeviceMotionEvent;ee&&typeof ee.requestPermission=="function"?ee.requestPermission().then(te=>{te==="granted"&&window.addEventListener("deviceorientation",N)}).catch(console.error):window.addEventListener("deviceorientation",N)};F.addEventListener("click",B);const D=(F.clientWidth||0)-v0.INITIAL_X_OFFSET,$=v0.INITIAL_Y_OFFSET;return T.setImmediate(D,$),T.toCenter(),T.beginInitial(v0.INITIAL_DURATION),()=>{F.removeEventListener("pointerenter",W),F.removeEventListener("pointermove",V),F.removeEventListener("pointerleave",G),F.removeEventListener("click",B),window.removeEventListener("deviceorientation",N),S.current&&window.clearTimeout(S.current),M.current&&cancelAnimationFrame(M.current),T.cancel(),F.classList.remove("entering")}},[l,u,T,C,A,k,L]);const H=U.useMemo(()=>({"--icon":e?`url(${e})`:"none","--grain":t?`url(${t})`:"none","--inner-gradient":r??Gce,"--behind-glow-color":s??"rgba(125, 190, 255, 0.67)","--behind-glow-size":o??"50%"}),[e,t,r,s,o]);return U.useCallback(()=>{_==null||_()},[_]),z.jsxs("div",{ref:w,className:`pc-card-wrapper ${a}`.trim(),style:H,children:[i&&z.jsx("div",{className:"pc-behind"}),z.jsx("div",{ref:b,className:"pc-card-shell",children:z.jsx("section",{className:"pc-card",children:z.jsxs("div",{className:"pc-inside",children:[z.jsx("div",{className:"pc-shine"}),z.jsx("div",{className:"pc-glare"}),z.jsx("div",{className:"pc-content pc-avatar-content",children:z.jsx("img",{className:"avatar",src:n,alt:`${h||"User"} avatar`,loading:"lazy",onError:F=>{const V=F.target;V.style.display="none"}})})]})})})]})},Xce=OB.memo(jce),$ce="/assets/Hero-FIfd392t.jpg",qce="/assets/My_Image-CFUFERC6.jpg",Yce="/assets/Creative-DOYK7l2Q.gif",Kce="/assets/Technical-CW0xz_gD.gif",Zce="/assets/Innovative-DEi4wfXr.gif",Jce="/assets/Leetcode-CUVm0HGP.jpg",Qce="/assets/Consistent-ruwVwDGy.jpg",efe="/assets/Always-D7wiFFdl.png",tfe="/assets/Clean-Dc25J3r-.jpg",nfe="/assets/portfolioImage-BsfQnGWi.png",rfe="/assets/EMC-BoTs6aDe.png",ife="/assets/DRT-Dkb_QHD5.png",sfe="/assets/vm-DFZTDcWE.png",ofe="/assets/core-CI_o2XPF.png",Dr={My_Image:qce,Creative:Yce,Technical:Kce,Innovative:Zce,Leetcode:Jce,Consistent:Qce,Always:efe,Clean:tfe,portfolioImage:nfe,EMC:rfe,DRT:ife,core:ofe,vm:sfe},afe=()=>{const n=U.useRef(null),e=_w(),[t,r]=U.useState(window.innerWidth<=768);return U.useEffect(()=>{const i=()=>r(window.innerWidth<=768);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),U.useEffect(()=>{const i=new IntersectionObserver(([s])=>{s.isIntersecting&&s.target.classList.add("hero-visible")},{threshold:.1});return n.current&&i.observe(n.current),()=>{n.current&&i.unobserve(n.current)}},[]),z.jsxs("section",{ref:n,className:"relative min-h-screen w-full flex items-center justify-center overflow-visible opacity-0 translate-y-5 transition-all duration-800 ease-out [&.hero-visible]:opacity-100 [&.hero-visible]:translate-y-0",children:[z.jsx("div",{className:"absolute inset-0 z-[1]",children:z.jsx(xie,{grid:20,mouse:.25,strength:.2,relaxation:.9,imageSrc:$ce})}),t?z.jsxs("div",{className:"relative z-[10] w-full h-full px-4 pt-20 pb-8 flex flex-col items-center justify-start",children:[z.jsx("div",{className:"text-center mb-6 animate-fade-in-up",children:z.jsxs("h1",{className:"flex flex-col gap-2",children:[z.jsx("span",{className:"text-lg font-bold text-gray-500 tracking-wider",children:"Hello there, I'm"}),z.jsx("span",{className:"text-4xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift",children:"Mayank Kumar"})]})}),z.jsxs("div",{className:"text-center mb-6 animate-fade-in-up [animation-delay:300ms]",children:[z.jsx("p",{className:"text-base text-gray-300 mb-3",children:"a Computer Science undergraduate"}),z.jsx("p",{className:"text-sm text-gray-400 leading-relaxed px-2",children:"Currently exploring Data Science, Machine Learning fundamentals, and full-stack development."})]}),z.jsx("div",{className:"mb-8 animate-fade-in-up [animation-delay:500ms]",children:z.jsx("div",{className:"w-48 h-48 rounded-2xl overflow-hidden border-2 border-primary/30 shadow-lg shadow-primary/20",children:z.jsx("img",{src:Dr.My_Image,alt:"Mayank Kumar",className:"w-full h-full object-cover"})})}),z.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-xs animate-fade-in-up [animation-delay:700ms]",children:[z.jsx("button",{onClick:()=>e("/projects"),className:"w-full px-6 py-3.5 text-sm font-semibold rounded-full bg-gradient-to-r from-primary via-secondary to-tertiary text-white shadow-[0_4px_20px_rgba(0,212,255,0.4)] transition-all duration-300 active:scale-95",children:"View My Work"}),z.jsx("button",{onClick:()=>e("/contact"),className:"w-full px-6 py-3.5 text-sm font-semibold rounded-full bg-transparent text-primary border-2 border-primary/50 transition-all duration-300 active:scale-95 active:bg-primary/10",children:"Get In Touch"})]})]}):z.jsxs("div",{className:"relative z-[10] w-full max-w-7xl px-8 flex items-center justify-between gap-12 pointer-events-none",children:[z.jsx("div",{className:"w-1/2 animate-fade-in-up [animation-delay:300ms]",children:z.jsxs("div",{className:"space-y-6",children:[z.jsxs("h1",{className:"flex flex-col gap-2 text-left",children:[z.jsx("span",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-gray-500 tracking-wider text-left",children:"Hello there, I'm"}),z.jsx("span",{className:"text-4xl sm:text-6xl md:text-7xl lg:text-8xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift",children:"Mayank Kumar"})]}),z.jsx("div",{className:"animate-fade-in-up [animation-delay:1200ms]",children:z.jsx(j7,{text:"a Computer Science undergraduate",as:"p",className:"text-xl sm:text-2xl md:text-3xl font-medium text-gray-300 tracking-wide",typingSpeed:60,initialDelay:1200,loop:!1,showCursor:!1,startOnVisible:!1})}),z.jsx("div",{className:"animate-fade-in-up [animation-delay:1200ms]",children:z.jsx(n4,{text:"Currently exploring Data Science, Machine Learning fundamentals, and full-stack development, while strengthening problem-solving and core computer science concepts.",className:"text-base sm:text-lg md:text-xl text-gray-400",parentClassName:"max-w-2xl leading-relaxed mb-10 block",speed:20,maxIterations:15,sequential:!0,revealDirection:"start",animateOn:"view"})}),z.jsxs("div",{className:"flex gap-4 flex-wrap animate-fade-in-up [animation-delay:1800ms]",children:[z.jsx("button",{onClick:()=>e("/projects"),className:"cursor-target px-8 py-4 text-base font-semibold rounded-full bg-gradient-to-r from-primary via-secondary to-tertiary text-white shadow-[0_4px_20px_rgba(0,212,255,0.4)] transition-all duration-300 hover:-translate-y-0.5 hover:shadow-[0_6px_30px_rgba(124,58,237,0.5)] pointer-events-auto",children:"View My Work"}),z.jsx("button",{onClick:()=>e("/contact"),className:"cursor-target px-8 py-4 text-base font-semibold rounded-full bg-transparent text-primary border-2 border-primary/50 transition-all duration-300 hover:bg-primary/10 hover:border-primary hover:-translate-y-0.5 pointer-events-auto",children:"Get In Touch"})]})]})}),z.jsx("div",{className:"w-1/2 flex items-center justify-center animate-fade-in-up [animation-delay:600ms] pointer-events-auto",children:z.jsx(Xce,{avatarUrl:Dr.My_Image,miniAvatarUrl:Dr.My_Image,name:"Mayank Kumar",title:"Full Stack Developer",handle:"mayank",status:"Available",contactText:"Contact Me",enableTilt:!0,behindGlowEnabled:!0,behindGlowColor:"rgba(124, 58, 237, 0.6)",onContactClick:()=>{console.log("Contact button clicked")}})})]})]})},lfe=({direction:n="right",speed:e=1,borderColor:t="#999",squareSize:r=40,hoverFillColor:i="#222"})=>{const s=U.useRef(null),o=U.useRef(null),a=U.useRef(0),l=U.useRef(0),u=U.useRef({x:0,y:0}),c=U.useRef(null);return U.useEffect(()=>{const f=s.current;if(!f)return;const h=f.getContext("2d"),d=()=>{f.width=f.offsetWidth,f.height=f.offsetHeight,a.current=Math.ceil(f.width/r)+1,l.current=Math.ceil(f.height/r)+1};window.addEventListener("resize",d),d();const p=()=>{if(!h)return;h.clearRect(0,0,f.width,f.height);const _=Math.floor(u.current.x/r)*r,w=Math.floor(u.current.y/r)*r;for(let S=_;S<f.width+r;S+=r)for(let M=w;M<f.height+r;M+=r){const T=S-u.current.x%r,P=M-u.current.y%r;c.current&&Math.floor((S-_)/r)===c.current.x&&Math.floor((M-w)/r)===c.current.y&&(h.fillStyle=i,h.fillRect(T,P,r,r)),h.strokeStyle=t,h.strokeRect(T,P,r,r)}const b=h.createRadialGradient(f.width/2,f.height/2,0,f.width/2,f.height/2,Math.sqrt(f.width**2+f.height**2)/2);b.addColorStop(0,"rgba(0, 0, 0, 0)"),b.addColorStop(1,"#0a0a0f"),h.fillStyle=b,h.fillRect(0,0,f.width,f.height)},y=()=>{const _=Math.max(e,.1);switch(n){case"right":u.current.x=(u.current.x-_+r)%r;break;case"left":u.current.x=(u.current.x+_+r)%r;break;case"up":u.current.y=(u.current.y+_+r)%r;break;case"down":u.current.y=(u.current.y-_+r)%r;break;case"diagonal":u.current.x=(u.current.x-_+r)%r,u.current.y=(u.current.y-_+r)%r;break}p(),o.current=requestAnimationFrame(y)},x=_=>{const w=f.getBoundingClientRect(),b=_.clientX-w.left,S=_.clientY-w.top,M=Math.floor(u.current.x/r)*r,T=Math.floor(u.current.y/r)*r,P=Math.floor((b+u.current.x-M)/r),C=Math.floor((S+u.current.y-T)/r);(!c.current||c.current.x!==P||c.current.y!==C)&&(c.current={x:P,y:C})},m=()=>{c.current=null};return f.addEventListener("mousemove",x),f.addEventListener("mouseleave",m),o.current=requestAnimationFrame(y),()=>{window.removeEventListener("resize",d),o.current&&cancelAnimationFrame(o.current),f.removeEventListener("mousemove",x),f.removeEventListener("mouseleave",m)}},[n,e,t,i,r]),z.jsx("canvas",{ref:s,className:"w-full h-full border-none block"})},Od=U.forwardRef(({customClass:n,...e},t)=>z.jsx("div",{ref:t,...e,className:`absolute top-1/2 left-1/2 rounded-xl border border-white/20 bg-surface [transform-style:preserve-3d] [will-change:transform] [backface-visibility:hidden] ${n??""} ${e.className??""}`.trim()}));Od.displayName="Card";const g3=(n,e,t,r)=>({x:n*e,y:-n*t,z:-n*e*1.5,zIndex:r-n}),ufe=(n,e,t)=>Wt.set(n,{x:e.x,y:e.y,z:e.z,xPercent:-50,yPercent:-50,skewY:t,transformOrigin:"center center",zIndex:e.zIndex,force3D:!0}),cfe=({width:n=500,height:e=400,cardDistance:t=60,verticalDistance:r=70,delay:i=5e3,pauseOnHover:s=!1,onCardClick:o,skewAmount:a=6,easing:l="elastic",children:u})=>{const c=l==="elastic"?{ease:"elastic.out(0.6,0.9)",durDrop:2,durMove:2,durReturn:2,promoteOverlap:.9,returnDelay:.05}:{ease:"power1.inOut",durDrop:.8,durMove:.8,durReturn:.8,promoteOverlap:.45,returnDelay:.2},f=U.useMemo(()=>U.Children.toArray(u),[u]),h=U.useMemo(()=>f.map(()=>OB.createRef()),[f.length]),d=U.useRef(Array.from({length:f.length},(_,w)=>w)),p=U.useRef(null),y=U.useRef(),x=U.useRef(null);U.useEffect(()=>{const _=h.length;h.forEach((b,S)=>ufe(b.current,g3(S,t,r,_),a));const w=()=>{if(d.current.length<2)return;const[b,...S]=d.current,M=h[b].current,T=Wt.timeline();p.current=T,T.to(M,{y:"+=500",duration:c.durDrop,ease:c.ease}),T.addLabel("promote",`-=${c.durDrop*c.promoteOverlap}`),S.forEach((C,A)=>{const k=h[C].current,L=g3(A,t,r,h.length);T.set(k,{zIndex:L.zIndex},"promote"),T.to(k,{x:L.x,y:L.y,z:L.z,duration:c.durMove,ease:c.ease},`promote+=${A*.15}`)});const P=g3(h.length-1,t,r,h.length);T.addLabel("return",`promote+=${c.durMove*c.returnDelay}`),T.call(()=>{Wt.set(M,{zIndex:P.zIndex})},void 0,"return"),T.to(M,{x:P.x,y:P.y,z:P.z,duration:c.durReturn,ease:c.ease},"return"),T.call(()=>{d.current=[...S,b]})};if(w(),y.current=window.setInterval(w,i),s){const b=x.current,S=()=>{var T;(T=p.current)==null||T.pause(),clearInterval(y.current)},M=()=>{var T;(T=p.current)==null||T.play(),y.current=window.setInterval(w,i)};return b.addEventListener("mouseenter",S),b.addEventListener("mouseleave",M),()=>{b.removeEventListener("mouseenter",S),b.removeEventListener("mouseleave",M),clearInterval(y.current)}}return()=>clearInterval(y.current)},[t,r,i,s,a,l]);const m=f.map((_,w)=>U.isValidElement(_)?U.cloneElement(_,{key:w,ref:h[w],style:{width:n,height:e,..._.props.style??{}},onClick:b=>{var S,M;(M=(S=_.props).onClick)==null||M.call(S,b),o==null||o(w)}}):_);return z.jsx("div",{ref:x,className:"absolute bottom-0 right-0 transform translate-x-[5%] translate-y-[20%] origin-bottom-right perspective-[900px] overflow-visible max-[768px]:translate-x-[25%] max-[768px]:translate-y-[25%] max-[768px]:scale-[0.75] max-[480px]:translate-x-[25%] max-[480px]:translate-y-[25%] max-[480px]:scale-[0.55]",style:{width:n,height:e},children:m})},CW=({children:n,autoPlayInterval:e=4e3,enableSwipe:t=!0,className:r=""})=>{const[i,s]=U.useState(0),[o,a]=U.useState(!1),l=U.useRef(null),u=U.useRef(0),c=U.useRef(0),f=Array.isArray(n)?n:[n],h=f.length;U.useEffect(()=>{const x=setInterval(()=>{o||(a(!0),s(m=>(m+1)%h),setTimeout(()=>a(!1),500))},e);return()=>clearInterval(x)},[h,e,o]);const d=x=>{t&&(u.current=x.touches[0].clientX)},p=x=>{t&&(c.current=x.touches[0].clientX)},y=()=>{if(!t||o)return;const x=u.current-c.current;Math.abs(x)>50&&(a(!0),x>0?s(_=>(_+1)%h):s(_=>(_-1+h)%h),setTimeout(()=>a(!1),500))};return z.jsxs("div",{ref:l,className:`relative w-full overflow-hidden ${r}`,onTouchStart:d,onTouchMove:p,onTouchEnd:y,children:[z.jsx("div",{className:"flex transition-transform duration-500 ease-out",style:{transform:`translateX(-${i*100}%)`},children:f.map((x,m)=>z.jsx("div",{className:"w-full flex-shrink-0 px-4",children:x},m))}),z.jsx("div",{className:"flex justify-center gap-2 mt-6",children:f.map((x,m)=>z.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${i===m?"w-6 bg-gradient-to-r from-primary via-secondary to-tertiary":"w-1.5 bg-white/20"}`},m))})]})},ffe=()=>{const n=U.useRef(null),[e,t]=U.useState(window.innerWidth<=768);return U.useEffect(()=>{const r=()=>t(window.innerWidth<=768);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),U.useEffect(()=>{const r=new IntersectionObserver(i=>{i.forEach(s=>{s.isIntersecting&&s.target.classList.add("about-visible")})},{threshold:.2});return n.current&&r.observe(n.current),()=>{n.current&&r.unobserve(n.current)}},[]),z.jsxs("section",{ref:n,className:"relative min-h-screen w-full flex items-center justify-center overflow-visible opacity-0 translate-y-10 transition-all duration-1000 ease-out [&.about-visible]:opacity-100 [&.about-visible]:translate-y-0",children:[z.jsx("div",{className:"absolute inset-0 z-[1] pointer-events-none",children:z.jsx(lfe,{direction:"diagonal",speed:.5,borderColor:"#7c3aed",squareSize:35,hoverFillColor:"rgba(124, 58, 237, 0.15)"})}),e?z.jsxs("div",{className:"relative z-[10] w-full h-full px-4 pt-20 pb-10",children:[z.jsxs("div",{className:"text-center mb-8",children:[z.jsx("h2",{className:"text-4xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift mb-4",children:"About Me"}),z.jsx("p",{className:"text-sm text-gray-300 leading-relaxed px-2",children:"I'm Mayank Kumar, a Computer Science undergraduate who enjoys exploring technology beyond the classroom."})]}),z.jsxs(CW,{autoPlayInterval:4e3,enableSwipe:!0,children:[z.jsxs("div",{className:"bg-gradient-to-br from-primary/20 to-surface/80 backdrop-blur-md border border-primary/40 rounded-2xl p-6 flex flex-col items-center min-h-[320px]",children:[z.jsx("img",{src:Dr.Leetcode,alt:"LeetCode Achievements",className:"w-full h-40 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"LeetCode Journey"}),z.jsx("p",{className:"text-primary/80 text-center text-sm",children:"Problem-solving excellence"})]}),z.jsxs("div",{className:"bg-gradient-to-br from-secondary/20 to-surface/80 backdrop-blur-md border border-secondary/40 rounded-2xl p-6 flex flex-col items-center min-h-[320px]",children:[z.jsx("img",{src:Dr.Clean,alt:"Coding",className:"w-full h-40 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Clean Code"}),z.jsx("p",{className:"text-secondary-light/80 text-center text-sm",children:"Writing elegant solutions"})]}),z.jsxs("div",{className:"bg-gradient-to-br from-tertiary/20 to-surface/80 backdrop-blur-md border border-tertiary/40 rounded-2xl p-6 flex flex-col items-center min-h-[320px]",children:[z.jsx("img",{src:Dr.Consistent,alt:"Streaks",className:"w-full h-40 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Consistency"}),z.jsx("p",{className:"text-tertiary/80 text-center text-sm",children:"Daily coding streaks"})]}),z.jsxs("div",{className:"bg-gradient-to-br from-accent/20 to-surface/80 backdrop-blur-md border border-accent/40 rounded-2xl p-6 flex flex-col items-center min-h-[320px]",children:[z.jsx("img",{src:Dr.A1,alt:"Mayank Kumar",className:"w-full h-40 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Passionate Developer"}),z.jsx("p",{className:"text-accent/80 text-center text-sm",children:"Building the future"})]}),z.jsxs("div",{className:"bg-gradient-to-br from-warm/20 to-surface/80 backdrop-blur-md border border-warm/40 rounded-2xl p-6 flex flex-col items-center min-h-[320px]",children:[z.jsx("img",{src:Dr.Always,alt:"Hello",className:"w-full h-40 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Always Learning"}),z.jsx("p",{className:"text-warm/80 text-center text-sm",children:"Growth mindset"})]})]})]}):z.jsxs("div",{className:"relative z-[10] w-full max-w-7xl px-8 flex items-center justify-between gap-12",children:[z.jsxs("div",{className:"w-1/2 space-y-8",children:[z.jsx("h2",{className:"text-5xl sm:text-6xl md:text-7xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift",children:"About Me"}),z.jsx("div",{className:"text-lg sm:text-xl text-gray-300 leading-relaxed",children:z.jsx(n4,{text:"I'm Mayank Kumar, a Computer Science undergraduate who enjoys exploring technology beyond the classroom.",parentClassName:"max-w-2xl leading-relaxed mb-10 block",speed:20,maxIterations:15,sequential:!0,revealDirection:"start",animateOn:"view"})}),z.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-8",children:[z.jsxs("div",{className:"cursor-target aspect-square rounded-xl backdrop-blur-sm border border-primary/30 bg-gradient-to-br from-primary/10 to-surface/50 hover:border-primary/60 hover:scale-105 hover:shadow-[0_0_30px_rgba(0,212,255,0.4)] transition-all duration-300 flex flex-col justify-center items-center text-center group relative overflow-hidden opacity-0 translate-y-8 [.about-visible_&]:opacity-100 [.about-visible_&]:translate-y-0 [.about-visible_&]:transition-all [.about-visible_&]:duration-700 [.about-visible_&]:delay-300",children:[z.jsx("div",{className:"absolute inset-0 opacity-30 group-hover:opacity-50 transition-opacity duration-300",children:z.jsx("img",{src:Dr.Creative,alt:"Creative",className:"w-full h-full object-cover"})}),z.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0f]/95 via-[#0a0a0f]/60 to-transparent"}),z.jsxs("div",{className:"relative z-10",children:[z.jsx("h3",{className:"text-xl font-semibold text-primary mb-1",children:"Creative"}),z.jsx("p",{className:"text-xs text-primary-light/80",children:"Beautiful designs"})]})]}),z.jsxs("div",{className:"cursor-target aspect-square rounded-xl backdrop-blur-sm border border-secondary/30 bg-gradient-to-br from-secondary/10 to-surface/50 hover:border-secondary/60 hover:scale-105 hover:shadow-[0_0_30px_rgba(124,58,237,0.4)] transition-all duration-300 flex flex-col justify-center items-center text-center group relative overflow-hidden opacity-0 translate-y-8 [.about-visible_&]:opacity-100 [.about-visible_&]:translate-y-0 [.about-visible_&]:transition-all [.about-visible_&]:duration-700 [.about-visible_&]:delay-500",children:[z.jsx("div",{className:"absolute inset-0 opacity-30 group-hover:opacity-50 transition-opacity duration-300",children:z.jsx("img",{src:Dr.Technical,alt:"Technical",className:"w-full h-full object-cover"})}),z.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0f]/95 via-[#0a0a0f]/60 to-transparent"}),z.jsxs("div",{className:"relative z-10",children:[z.jsx("h3",{className:"text-xl font-semibold text-secondary-light mb-1",children:"Technical"}),z.jsx("p",{className:"text-xs text-secondary/80",children:"Robust solutions"})]})]}),z.jsxs("div",{className:"cursor-target aspect-square rounded-xl backdrop-blur-sm border border-tertiary/30 bg-gradient-to-br from-tertiary/10 to-surface/50 hover:border-tertiary/60 hover:scale-105 hover:shadow-[0_0_30px_rgba(244,114,182,0.4)] transition-all duration-300 flex flex-col justify-center items-center text-center group relative overflow-hidden opacity-0 translate-y-8 [.about-visible_&]:opacity-100 [.about-visible_&]:translate-y-0 [.about-visible_&]:transition-all [.about-visible_&]:duration-700 [.about-visible_&]:delay-700",children:[z.jsx("div",{className:"absolute inset-0 opacity-30 group-hover:opacity-50 transition-opacity duration-300",children:z.jsx("img",{src:Dr.Innovative,alt:"Innovative",className:"w-full h-full object-cover"})}),z.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0f]/95 via-[#0a0a0f]/60 to-transparent"}),z.jsxs("div",{className:"relative z-10",children:[z.jsx("h3",{className:"text-xl font-semibold text-tertiary mb-1",children:"Innovative"}),z.jsx("p",{className:"text-xs text-tertiary-light/80",children:"New possibilities"})]})]})]})]}),z.jsx("div",{className:"w-1/2 relative h-[600px]",children:z.jsxs(cfe,{width:400,height:500,cardDistance:40,verticalDistance:50,delay:4e3,pauseOnHover:!1,skewAmount:5,easing:"elastic",children:[z.jsxs(Od,{className:"bg-gradient-to-br from-primary/20 to-surface/80 backdrop-blur-md border-primary/40 p-8 flex flex-col justify-center items-center",children:[z.jsx("img",{src:Dr.Leetcode,alt:"LeetCode Achievements",className:"w-full h-3/4 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-2xl font-bold text-white",children:"LeetCode Journey"}),z.jsx("p",{className:"text-primary/80 text-center mt-2",children:"Problem-solving excellence"})]}),z.jsxs(Od,{className:"bg-gradient-to-br from-secondary/20 to-surface/80 backdrop-blur-md border-secondary/40 p-8 flex flex-col justify-center items-center",children:[z.jsx("img",{src:Dr.Clean,alt:"Coding",className:"w-full h-3/4 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-2xl font-bold text-white",children:"Clean Code"}),z.jsx("p",{className:"text-secondary-light/80 text-center mt-2",children:"Writing elegant solutions"})]}),z.jsxs(Od,{className:"bg-gradient-to-br from-tertiary/20 to-surface/80 backdrop-blur-md border-tertiary/40 p-8 flex flex-col justify-center items-center",children:[z.jsx("img",{src:Dr.Consistent,alt:"Streaks",className:"w-full h-3/4 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-2xl font-bold text-white",children:"Consistency"}),z.jsx("p",{className:"text-tertiary/80 text-center mt-2",children:"Daily coding streaks"})]}),z.jsxs(Od,{className:"bg-gradient-to-br from-accent/20 to-surface/80 backdrop-blur-md border-accent/40 p-8 flex flex-col justify-center items-center",children:[z.jsx("img",{src:Dr.A1,alt:"Mayank Kumar",className:"w-full h-3/4 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-2xl font-bold text-white",children:"Passionate Developer"}),z.jsx("p",{className:"text-accent/80 text-center mt-2",children:"Building the future"})]}),z.jsxs(Od,{className:"bg-gradient-to-br from-warm/20 to-surface/80 backdrop-blur-md border-warm/40 p-8 flex flex-col justify-center items-center",children:[z.jsx("img",{src:Dr.Always,alt:"Hello",className:"w-full h-3/4 object-cover rounded-lg mb-4"}),z.jsx("h3",{className:"text-2xl font-bold text-white",children:"Always Learning"}),z.jsx("p",{className:"text-warm/80 text-center mt-2",children:"Growth mindset"})]})]})})]})]})};function vg(n){let e=n[0],t=n[1],r=n[2];return Math.sqrt(e*e+t*t+r*r)}function BC(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function hfe(n,e,t,r){return n[0]=e,n[1]=t,n[2]=r,n}function UO(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function zO(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function dfe(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function pfe(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function v3(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function mfe(n,e){let t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2];return Math.sqrt(t*t+r*r+i*i)}function gfe(n,e){let t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2];return t*t+r*r+i*i}function VO(n){let e=n[0],t=n[1],r=n[2];return e*e+t*t+r*r}function vfe(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function yfe(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function UC(n,e){let t=e[0],r=e[1],i=e[2],s=t*t+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n}function AW(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function WO(n,e,t){let r=e[0],i=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=i*l-s*a,n[1]=s*o-r*l,n[2]=r*a-i*o,n}function xfe(n,e,t,r){let i=e[0],s=e[1],o=e[2];return n[0]=i+r*(t[0]-i),n[1]=s+r*(t[1]-s),n[2]=o+r*(t[2]-o),n}function _fe(n,e,t,r,i){const s=Math.exp(-r*i);let o=e[0],a=e[1],l=e[2];return n[0]=t[0]+(o-t[0])*s,n[1]=t[1]+(a-t[1])*s,n[2]=t[2]+(l-t[2])*s,n}function wfe(n,e,t){let r=e[0],i=e[1],s=e[2],o=t[3]*r+t[7]*i+t[11]*s+t[15];return o=o||1,n[0]=(t[0]*r+t[4]*i+t[8]*s+t[12])/o,n[1]=(t[1]*r+t[5]*i+t[9]*s+t[13])/o,n[2]=(t[2]*r+t[6]*i+t[10]*s+t[14])/o,n}function bfe(n,e,t){let r=e[0],i=e[1],s=e[2],o=t[3]*r+t[7]*i+t[11]*s+t[15];return o=o||1,n[0]=(t[0]*r+t[4]*i+t[8]*s)/o,n[1]=(t[1]*r+t[5]*i+t[9]*s)/o,n[2]=(t[2]*r+t[6]*i+t[10]*s)/o,n}function Sfe(n,e,t){let r=e[0],i=e[1],s=e[2];return n[0]=r*t[0]+i*t[3]+s*t[6],n[1]=r*t[1]+i*t[4]+s*t[7],n[2]=r*t[2]+i*t[5]+s*t[8],n}function Efe(n,e,t){let r=e[0],i=e[1],s=e[2],o=t[0],a=t[1],l=t[2],u=t[3],c=a*s-l*i,f=l*r-o*s,h=o*i-a*r,d=a*h-l*f,p=l*c-o*h,y=o*f-a*c,x=u*2;return c*=x,f*=x,h*=x,d*=2,p*=2,y*=2,n[0]=r+c+d,n[1]=i+f+p,n[2]=s+h+y,n}const Mfe=function(){const n=[0,0,0],e=[0,0,0];return function(t,r){BC(n,t),BC(e,r),UC(n,n),UC(e,e);let i=AW(n,e);return i>1?0:i<-1?Math.PI:Math.acos(i)}}();function Tfe(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}class Pa extends Array{constructor(e=0,t=e,r=e){return super(e,t,r),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,t=e,r=e){return e.length?this.copy(e):(hfe(this,e,t,r),this)}copy(e){return BC(this,e),this}add(e,t){return t?UO(this,e,t):UO(this,this,e),this}sub(e,t){return t?zO(this,e,t):zO(this,this,e),this}multiply(e){return e.length?dfe(this,this,e):v3(this,this,e),this}divide(e){return e.length?pfe(this,this,e):v3(this,this,1/e),this}inverse(e=this){return yfe(this,e),this}len(){return vg(this)}distance(e){return e?mfe(this,e):vg(this)}squaredLen(){return VO(this)}squaredDistance(e){return e?gfe(this,e):VO(this)}negate(e=this){return vfe(this,e),this}cross(e,t){return t?WO(this,e,t):WO(this,this,e),this}scale(e){return v3(this,this,e),this}normalize(){return UC(this,this),this}dot(e){return AW(this,e)}equals(e){return Tfe(this,e)}applyMatrix3(e){return Sfe(this,this,e),this}applyMatrix4(e){return wfe(this,this,e),this}scaleRotateMatrix4(e){return bfe(this,this,e),this}applyQuaternion(e){return Efe(this,this,e),this}angle(e){return Mfe(this,e)}lerp(e,t){return xfe(this,this,e,t),this}smoothLerp(e,t,r){return _fe(this,this,e,t,r),this}clone(){return new Pa(this[0],this[1],this[2])}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}transformDirection(e){const t=this[0],r=this[1],i=this[2];return this[0]=e[0]*t+e[4]*r+e[8]*i,this[1]=e[1]*t+e[5]*r+e[9]*i,this[2]=e[2]*t+e[6]*r+e[10]*i,this.normalize()}}const HO=new Pa;let Cfe=1,Afe=1,GO=!1;class Rfe{constructor(e,t={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=t,this.id=Cfe++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let r in t)this.addAttribute(r,t[r])}addAttribute(e,t){if(this.attributes[e]=t,t.id=Afe++,t.size=t.size||1,t.type=t.type||(t.data.constructor===Float32Array?this.gl.FLOAT:t.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),t.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,t.normalized=t.normalized||!1,t.stride=t.stride||0,t.offset=t.offset||0,t.count=t.count||(t.stride?t.data.byteLength/t.stride:t.data.length/t.size),t.divisor=t.instanced||0,t.needsUpdate=!1,t.usage=t.usage||this.gl.STATIC_DRAW,t.buffer||this.updateAttribute(t),t.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==t.count*t.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,t.count*t.divisor);this.instancedCount=t.count*t.divisor}else e==="index"?this.drawRange.count=t.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,t.count))}updateAttribute(e){const t=!e.buffer;t&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),t?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((t,{name:r,type:i})=>{if(!this.attributes[r]){console.warn(`active attribute ${r} not being supplied`);return}const s=this.attributes[r];this.gl.bindBuffer(s.target,s.buffer),this.glState.boundBuffer=s.buffer;let o=1;i===35674&&(o=2),i===35675&&(o=3),i===35676&&(o=4);const a=s.size/o,l=o===1?0:o*o*4,u=o===1?0:o*4;for(let c=0;c<o;c++)this.gl.vertexAttribPointer(t+c,a,s.type,s.normalized,s.stride+l,s.offset+c*u),this.gl.enableVertexAttribArray(t+c),this.gl.renderer.vertexAttribDivisor(t+c,s.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:t=this.gl.TRIANGLES}){var i;this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((s,{name:o})=>{const a=this.attributes[o];a.needsUpdate&&this.updateAttribute(a)});let r=2;((i=this.attributes.index)==null?void 0:i.type)===this.gl.UNSIGNED_INT&&(r=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*r,this.instancedCount):this.gl.renderer.drawArraysInstanced(t,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*r):this.gl.drawArrays(t,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!GO)return console.warn("No position buffer data found to compute bounds"),GO=!0}computeBoundingBox(e){e||(e=this.getPosition());const t=e.data,r=e.size;this.bounds||(this.bounds={min:new Pa,max:new Pa,center:new Pa,scale:new Pa,radius:1/0});const i=this.bounds.min,s=this.bounds.max,o=this.bounds.center,a=this.bounds.scale;i.set(1/0),s.set(-1/0);for(let l=0,u=t.length;l<u;l+=r){const c=t[l],f=t[l+1],h=t[l+2];i.x=Math.min(c,i.x),i.y=Math.min(f,i.y),i.z=Math.min(h,i.z),s.x=Math.max(c,s.x),s.y=Math.max(f,s.y),s.z=Math.max(h,s.z)}a.sub(s,i),o.add(i,s).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const t=e.data,r=e.size;this.bounds||this.computeBoundingBox(e);let i=0;for(let s=0,o=t.length;s<o;s+=r)HO.fromArray(t,s),i=Math.max(i,this.bounds.center.squaredDistance(HO));this.bounds.radius=Math.sqrt(i)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let Pfe=1;const jO={};class Ife{constructor(e,{vertex:t,fragment:r,uniforms:i={},transparent:s=!1,cullFace:o=e.BACK,frontFace:a=e.CCW,depthTest:l=!0,depthWrite:u=!0,depthFunc:c=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=i,this.id=Pfe++,t||console.warn("vertex shader not supplied"),r||console.warn("fragment shader not supplied"),this.transparent=s,this.cullFace=o,this.frontFace=a,this.depthTest=l,this.depthWrite=u,this.depthFunc=c,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:t,fragment:r})}setShaders({vertex:e,fragment:t}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${XO(e)}`)),t&&(this.gl.shaderSource(this.fragmentShader,t),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${XO(t)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let r=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let o=0;o<r;o++){let a=this.gl.getActiveUniform(this.program,o);this.uniformLocations.set(a,this.gl.getUniformLocation(this.program,a.name));const l=a.name.match(/(\w+)/g);a.uniformName=l[0],a.nameComponents=l.slice(1)}this.attributeLocations=new Map;const i=[],s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let o=0;o<s;o++){const a=this.gl.getActiveAttrib(this.program,o),l=this.gl.getAttribLocation(this.program,a.name);l!==-1&&(i[l]=a.name,this.attributeLocations.set(a,l))}this.attributeOrder=i.join("")}setBlendFunc(e,t,r,i){this.blendFunc.src=e,this.blendFunc.dst=t,this.blendFunc.srcAlpha=r,this.blendFunc.dstAlpha=i,e&&(this.transparent=!0)}setBlendEquation(e,t){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=t}setStencilFunc(e,t,r){this.stencilRef=t,this.stencilFunc.func=e,this.stencilFunc.ref=t,this.stencilFunc.mask=r}setStencilOp(e,t,r){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=t,this.stencilOp.depthPass=r}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let t=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((i,s)=>{let o=this.uniforms[s.uniformName];for(const a of s.nameComponents){if(!o)break;if(a in o)o=o[a];else{if(Array.isArray(o.value))break;o=void 0;break}}if(!o)return $O(`Active uniform ${s.name} has not been supplied`);if(o&&o.value===void 0)return $O(`${s.name} uniform is missing a value parameter`);if(o.value.texture)return t=t+1,o.value.update(t),y3(this.gl,s.type,i,t);if(o.value.length&&o.value[0].texture){const a=[];return o.value.forEach(l=>{t=t+1,l.update(t),a.push(t)}),y3(this.gl,s.type,i,a)}y3(this.gl,s.type,i,o.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function y3(n,e,t,r){r=r.length?Dfe(r):r;const i=n.renderer.state.uniformLocations.get(t);if(r.length)if(i===void 0||i.length!==r.length)n.renderer.state.uniformLocations.set(t,r.slice(0));else{if(Nfe(i,r))return;i.set?i.set(r):kfe(i,r),n.renderer.state.uniformLocations.set(t,i)}else{if(i===r)return;n.renderer.state.uniformLocations.set(t,r)}switch(e){case 5126:return r.length?n.uniform1fv(t,r):n.uniform1f(t,r);case 35664:return n.uniform2fv(t,r);case 35665:return n.uniform3fv(t,r);case 35666:return n.uniform4fv(t,r);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return r.length?n.uniform1iv(t,r):n.uniform1i(t,r);case 35671:case 35667:return n.uniform2iv(t,r);case 35672:case 35668:return n.uniform3iv(t,r);case 35673:case 35669:return n.uniform4iv(t,r);case 35674:return n.uniformMatrix2fv(t,!1,r);case 35675:return n.uniformMatrix3fv(t,!1,r);case 35676:return n.uniformMatrix4fv(t,!1,r)}}function XO(n){let e=n.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function Dfe(n){const e=n.length,t=n[0].length;if(t===void 0)return n;const r=e*t;let i=jO[r];i||(jO[r]=i=new Float32Array(r));for(let s=0;s<e;s++)i.set(n[s],s*t);return i}function Nfe(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function kfe(n,e){for(let t=0,r=n.length;t<r;t++)n[t]=e[t]}let x3=0;function $O(n){x3>100||(console.warn(n),x3++,x3>100&&console.warn("More than 100 program warnings - stopping logs."))}const _3=new Pa;let Lfe=1;class Ffe{constructor({canvas:e=document.createElement("canvas"),width:t=300,height:r=150,dpr:i=1,alpha:s=!1,depth:o=!0,stencil:a=!1,antialias:l=!1,premultipliedAlpha:u=!1,preserveDrawingBuffer:c=!1,powerPreference:f="default",autoClear:h=!0,webgl:d=2}={}){const p={alpha:s,depth:o,stencil:a,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:f};this.dpr=i,this.alpha=s,this.color=!0,this.depth=o,this.stencil=a,this.premultipliedAlpha=u,this.autoClear=h,this.id=Lfe++,d===2&&(this.gl=e.getContext("webgl2",p)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",p)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(t,r),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,t){this.width=e,this.height=t,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=t*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:t+"px"})}setViewport(e,t,r=0,i=0){this.state.viewport.width===e&&this.state.viewport.height===t||(this.state.viewport.width=e,this.state.viewport.height=t,this.state.viewport.x=r,this.state.viewport.y=i,this.gl.viewport(r,i,e,t))}setScissor(e,t,r=0,i=0){this.gl.scissor(r,i,e,t)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,t,r,i){this.state.blendFunc.src===e&&this.state.blendFunc.dst===t&&this.state.blendFunc.srcAlpha===r&&this.state.blendFunc.dstAlpha===i||(this.state.blendFunc.src=e,this.state.blendFunc.dst=t,this.state.blendFunc.srcAlpha=r,this.state.blendFunc.dstAlpha=i,r!==void 0?this.gl.blendFuncSeparate(e,t,r,i):this.gl.blendFunc(e,t))}setBlendEquation(e,t){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===t)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=t,t!==void 0?this.gl.blendEquationSeparate(e,t):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,t,r){this.state.stencilFunc===e&&this.state.stencilRef===t&&this.state.stencilFuncMask===r||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=t||0,this.state.stencilFuncMask=r||0,this.gl.stencilFunc(e||this.gl.ALWAYS,t||0,r||0))}setStencilOp(e,t,r){this.state.stencilFail===e&&this.state.stencilDepthFail===t&&this.state.stencilDepthPass===r||(this.state.stencilFail=e,this.state.stencilDepthFail=t,this.state.stencilDepthPass=r,this.gl.stencilOp(e,t,r))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:t=null}={}){this.state.framebuffer!==t&&(this.state.framebuffer=t,this.gl.bindFramebuffer(e,t))}getExtension(e,t,r){return t&&this.gl[t]?this.gl[t].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),t?this.extensions[e]?this.extensions[e][r].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:e.zDepth!==t.zDepth?e.zDepth-t.zDepth:t.id-e.id}sortTransparent(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.zDepth!==t.zDepth?t.zDepth-e.zDepth:t.id-e.id}sortUI(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:t.id-e.id}getRenderList({scene:e,camera:t,frustumCull:r,sort:i}){let s=[];if(t&&r&&t.updateFrustum(),e.traverse(o=>{if(!o.visible)return!0;o.draw&&(r&&o.frustumCulled&&t&&!t.frustumIntersectsMesh(o)||s.push(o))}),i){const o=[],a=[],l=[];s.forEach(u=>{u.program.transparent?u.program.depthTest?a.push(u):l.push(u):o.push(u),u.zDepth=0,!(u.renderOrder!==0||!u.program.depthTest||!t)&&(u.worldMatrix.getTranslation(_3),_3.applyMatrix4(t.projectionViewMatrix),u.zDepth=_3.z)}),o.sort(this.sortOpaque),a.sort(this.sortTransparent),l.sort(this.sortUI),s=o.concat(a,l)}return s}render({scene:e,camera:t,target:r=null,update:i=!0,sort:s=!0,frustumCull:o=!0,clear:a}){r===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(r),this.setViewport(r.width,r.height)),(a||this.autoClear&&a!==!1)&&(this.depth&&(!r||r.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!r||r.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),i&&e.updateMatrixWorld(),t&&t.updateMatrixWorld(),this.getRenderList({scene:e,camera:t,frustumCull:o,sort:s}).forEach(u=>{u.draw({camera:t})})}}function Ofe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function Bfe(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function Ufe(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=t*t+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=r*o,n[2]=i*o,n[3]=s*o,n}function zfe(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function Vfe(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Wfe(n,e,t){t=t*.5;let r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function qO(n,e,t){let r=e[0],i=e[1],s=e[2],o=e[3],a=t[0],l=t[1],u=t[2],c=t[3];return n[0]=r*c+o*a+i*u-s*l,n[1]=i*c+o*l+s*a-r*u,n[2]=s*c+o*u+r*l-i*a,n[3]=o*c-r*a-i*l-s*u,n}function Hfe(n,e,t){t*=.5;let r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=r*l+o*a,n[1]=i*l+s*a,n[2]=s*l-i*a,n[3]=o*l-r*a,n}function Gfe(n,e,t){t*=.5;let r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=r*l-s*a,n[1]=i*l+o*a,n[2]=s*l+r*a,n[3]=o*l-i*a,n}function jfe(n,e,t){t*=.5;let r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=r*l+i*a,n[1]=i*l-r*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function Xfe(n,e,t,r){let i=e[0],s=e[1],o=e[2],a=e[3],l=t[0],u=t[1],c=t[2],f=t[3],h,d,p,y,x;return d=i*l+s*u+o*c+a*f,d<0&&(d=-d,l=-l,u=-u,c=-c,f=-f),1-d>1e-6?(h=Math.acos(d),p=Math.sin(h),y=Math.sin((1-r)*h)/p,x=Math.sin(r*h)/p):(y=1-r,x=r),n[0]=y*i+x*l,n[1]=y*s+x*u,n[2]=y*o+x*c,n[3]=y*a+x*f,n}function $fe(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=t*t+r*r+i*i+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-r*a,n[2]=-i*a,n[3]=s*a,n}function qfe(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function Yfe(n,e){let t=e[0]+e[4]+e[8],r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);let s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[o*3+o]+1),n[i]=.5*r,r=.5/r,n[3]=(e[s*3+o]-e[o*3+s])*r,n[s]=(e[s*3+i]+e[i*3+s])*r,n[o]=(e[o*3+i]+e[i*3+o])*r}return n}function Kfe(n,e,t="YXZ"){let r=Math.sin(e[0]*.5),i=Math.cos(e[0]*.5),s=Math.sin(e[1]*.5),o=Math.cos(e[1]*.5),a=Math.sin(e[2]*.5),l=Math.cos(e[2]*.5);return t==="XYZ"?(n[0]=r*o*l+i*s*a,n[1]=i*s*l-r*o*a,n[2]=i*o*a+r*s*l,n[3]=i*o*l-r*s*a):t==="YXZ"?(n[0]=r*o*l+i*s*a,n[1]=i*s*l-r*o*a,n[2]=i*o*a-r*s*l,n[3]=i*o*l+r*s*a):t==="ZXY"?(n[0]=r*o*l-i*s*a,n[1]=i*s*l+r*o*a,n[2]=i*o*a+r*s*l,n[3]=i*o*l-r*s*a):t==="ZYX"?(n[0]=r*o*l-i*s*a,n[1]=i*s*l+r*o*a,n[2]=i*o*a-r*s*l,n[3]=i*o*l+r*s*a):t==="YZX"?(n[0]=r*o*l+i*s*a,n[1]=i*s*l+r*o*a,n[2]=i*o*a-r*s*l,n[3]=i*o*l-r*s*a):t==="XZY"&&(n[0]=r*o*l-i*s*a,n[1]=i*s*l-r*o*a,n[2]=i*o*a+r*s*l,n[3]=i*o*l+r*s*a),n}const Zfe=Ofe,Jfe=Bfe,Qfe=zfe,ehe=Ufe;class the extends Array{constructor(e=0,t=0,r=0,i=1){super(e,t,r,i),this.onChange=()=>{},this._target=this;const s=["0","1","2","3"];return new Proxy(this,{set(o,a){const l=Reflect.set(...arguments);return l&&s.includes(a)&&o.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return Vfe(this._target),this.onChange(),this}set(e,t,r,i){return e.length?this.copy(e):(Jfe(this._target,e,t,r,i),this.onChange(),this)}rotateX(e){return Hfe(this._target,this._target,e),this.onChange(),this}rotateY(e){return Gfe(this._target,this._target,e),this.onChange(),this}rotateZ(e){return jfe(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return $fe(this._target,e),this.onChange(),this}conjugate(e=this._target){return qfe(this._target,e),this.onChange(),this}copy(e){return Zfe(this._target,e),this.onChange(),this}normalize(e=this._target){return ehe(this._target,e),this.onChange(),this}multiply(e,t){return t?qO(this._target,e,t):qO(this._target,this._target,e),this.onChange(),this}dot(e){return Qfe(this._target,e)}fromMatrix3(e){return Yfe(this._target,e),this.onChange(),this}fromEuler(e,t){return Kfe(this._target,e,e.order),t||this.onChange(),this}fromAxisAngle(e,t){return Wfe(this._target,e,t),this.onChange(),this}slerp(e,t){return Xfe(this._target,this._target,e,t),this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this._target[3]=e[t+3],this.onChange(),this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}}const nhe=1e-6;function rhe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function ihe(n,e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=o,n[6]=a,n[7]=l,n[8]=u,n[9]=c,n[10]=f,n[11]=h,n[12]=d,n[13]=p,n[14]=y,n[15]=x,n}function she(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ohe(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],y=e[13],x=e[14],m=e[15],_=t*a-r*o,w=t*l-i*o,b=t*u-s*o,S=r*l-i*a,M=r*u-s*a,T=i*u-s*l,P=c*y-f*p,C=c*x-h*p,A=c*m-d*p,k=f*x-h*y,L=f*m-d*y,H=h*m-d*x,F=_*H-w*L+b*k+S*A-M*C+T*P;return F?(F=1/F,n[0]=(a*H-l*L+u*k)*F,n[1]=(i*L-r*H-s*k)*F,n[2]=(y*T-x*M+m*S)*F,n[3]=(h*M-f*T-d*S)*F,n[4]=(l*A-o*H-u*C)*F,n[5]=(t*H-i*A+s*C)*F,n[6]=(x*b-p*T-m*w)*F,n[7]=(c*T-h*b+d*w)*F,n[8]=(o*L-a*A+u*P)*F,n[9]=(r*A-t*L-s*P)*F,n[10]=(p*M-y*b+m*_)*F,n[11]=(f*b-c*M-d*_)*F,n[12]=(a*C-o*k-l*P)*F,n[13]=(t*k-r*C+i*P)*F,n[14]=(y*w-p*S-x*_)*F,n[15]=(c*S-f*w+h*_)*F,n):null}function RW(n){let e=n[0],t=n[1],r=n[2],i=n[3],s=n[4],o=n[5],a=n[6],l=n[7],u=n[8],c=n[9],f=n[10],h=n[11],d=n[12],p=n[13],y=n[14],x=n[15],m=e*o-t*s,_=e*a-r*s,w=e*l-i*s,b=t*a-r*o,S=t*l-i*o,M=r*l-i*a,T=u*p-c*d,P=u*y-f*d,C=u*x-h*d,A=c*y-f*p,k=c*x-h*p,L=f*x-h*y;return m*L-_*k+w*A+b*C-S*P+M*T}function YO(n,e,t){let r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],d=e[10],p=e[11],y=e[12],x=e[13],m=e[14],_=e[15],w=t[0],b=t[1],S=t[2],M=t[3];return n[0]=w*r+b*a+S*f+M*y,n[1]=w*i+b*l+S*h+M*x,n[2]=w*s+b*u+S*d+M*m,n[3]=w*o+b*c+S*p+M*_,w=t[4],b=t[5],S=t[6],M=t[7],n[4]=w*r+b*a+S*f+M*y,n[5]=w*i+b*l+S*h+M*x,n[6]=w*s+b*u+S*d+M*m,n[7]=w*o+b*c+S*p+M*_,w=t[8],b=t[9],S=t[10],M=t[11],n[8]=w*r+b*a+S*f+M*y,n[9]=w*i+b*l+S*h+M*x,n[10]=w*s+b*u+S*d+M*m,n[11]=w*o+b*c+S*p+M*_,w=t[12],b=t[13],S=t[14],M=t[15],n[12]=w*r+b*a+S*f+M*y,n[13]=w*i+b*l+S*h+M*x,n[14]=w*s+b*u+S*d+M*m,n[15]=w*o+b*c+S*p+M*_,n}function ahe(n,e,t){let r=t[0],i=t[1],s=t[2],o,a,l,u,c,f,h,d,p,y,x,m;return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*s+e[12],n[13]=e[1]*r+e[5]*i+e[9]*s+e[13],n[14]=e[2]*r+e[6]*i+e[10]*s+e[14],n[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],d=e[7],p=e[8],y=e[9],x=e[10],m=e[11],n[0]=o,n[1]=a,n[2]=l,n[3]=u,n[4]=c,n[5]=f,n[6]=h,n[7]=d,n[8]=p,n[9]=y,n[10]=x,n[11]=m,n[12]=o*r+c*i+p*s+e[12],n[13]=a*r+f*i+y*s+e[13],n[14]=l*r+h*i+x*s+e[14],n[15]=u*r+d*i+m*s+e[15]),n}function lhe(n,e,t){let r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function uhe(n,e,t,r){let i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P,C,A,k,L,H,F,V;return Math.abs(a)<nhe?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(t),u=Math.cos(t),c=1-u,f=e[0],h=e[1],d=e[2],p=e[3],y=e[4],x=e[5],m=e[6],_=e[7],w=e[8],b=e[9],S=e[10],M=e[11],T=i*i*c+u,P=s*i*c+o*l,C=o*i*c-s*l,A=i*s*c-o*l,k=s*s*c+u,L=o*s*c+i*l,H=i*o*c+s*l,F=s*o*c-i*l,V=o*o*c+u,n[0]=f*T+y*P+w*C,n[1]=h*T+x*P+b*C,n[2]=d*T+m*P+S*C,n[3]=p*T+_*P+M*C,n[4]=f*A+y*k+w*L,n[5]=h*A+x*k+b*L,n[6]=d*A+m*k+S*L,n[7]=p*A+_*k+M*L,n[8]=f*H+y*F+w*V,n[9]=h*H+x*F+b*V,n[10]=d*H+m*F+S*V,n[11]=p*H+_*F+M*V,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function che(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function PW(n,e){let t=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return n[0]=Math.hypot(t,r,i),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,u,c),n}function fhe(n){let e=n[0],t=n[1],r=n[2],i=n[4],s=n[5],o=n[6],a=n[8],l=n[9],u=n[10];const c=e*e+t*t+r*r,f=i*i+s*s+o*o,h=a*a+l*l+u*u;return Math.sqrt(Math.max(c,f,h))}const IW=function(){const n=[1,1,1];return function(e,t){let r=n;PW(r,t);let i=1/r[0],s=1/r[1],o=1/r[2],a=t[0]*i,l=t[1]*s,u=t[2]*o,c=t[4]*i,f=t[5]*s,h=t[6]*o,d=t[8]*i,p=t[9]*s,y=t[10]*o,x=a+f+y,m=0;return x>0?(m=Math.sqrt(x+1)*2,e[3]=.25*m,e[0]=(h-p)/m,e[1]=(d-u)/m,e[2]=(l-c)/m):a>f&&a>y?(m=Math.sqrt(1+a-f-y)*2,e[3]=(h-p)/m,e[0]=.25*m,e[1]=(l+c)/m,e[2]=(d+u)/m):f>y?(m=Math.sqrt(1+f-a-y)*2,e[3]=(d-u)/m,e[0]=(l+c)/m,e[1]=.25*m,e[2]=(h+p)/m):(m=Math.sqrt(1+y-a-f)*2,e[3]=(l-c)/m,e[0]=(d+u)/m,e[1]=(h+p)/m,e[2]=.25*m),e}}();function hhe(n,e,t,r){let i=vg([n[0],n[1],n[2]]);const s=vg([n[4],n[5],n[6]]),o=vg([n[8],n[9],n[10]]);RW(n)<0&&(i=-i),t[0]=n[12],t[1]=n[13],t[2]=n[14];const l=n.slice(),u=1/i,c=1/s,f=1/o;l[0]*=u,l[1]*=u,l[2]*=u,l[4]*=c,l[5]*=c,l[6]*=c,l[8]*=f,l[9]*=f,l[10]*=f,IW(e,l),r[0]=i,r[1]=s,r[2]=o}function dhe(n,e,t,r){const i=n,s=e[0],o=e[1],a=e[2],l=e[3],u=s+s,c=o+o,f=a+a,h=s*u,d=s*c,p=s*f,y=o*c,x=o*f,m=a*f,_=l*u,w=l*c,b=l*f,S=r[0],M=r[1],T=r[2];return i[0]=(1-(y+m))*S,i[1]=(d+b)*S,i[2]=(p-w)*S,i[3]=0,i[4]=(d-b)*M,i[5]=(1-(h+m))*M,i[6]=(x+_)*M,i[7]=0,i[8]=(p+w)*T,i[9]=(x-_)*T,i[10]=(1-(h+y))*T,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}function phe(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=t+t,a=r+r,l=i+i,u=t*o,c=r*o,f=r*a,h=i*o,d=i*a,p=i*l,y=s*o,x=s*a,m=s*l;return n[0]=1-f-p,n[1]=c+m,n[2]=h-x,n[3]=0,n[4]=c-m,n[5]=1-u-p,n[6]=d+y,n[7]=0,n[8]=h+x,n[9]=d-y,n[10]=1-u-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function mhe(n,e,t,r,i){let s=1/Math.tan(e/2),o=1/(r-i);return n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(i+r)*o,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*i*r*o,n[15]=0,n}function ghe(n,e,t,r,i,s,o){let a=1/(e-t),l=1/(r-i),u=1/(s-o);return n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*u,n[11]=0,n[12]=(e+t)*a,n[13]=(i+r)*l,n[14]=(o+s)*u,n[15]=1,n}function vhe(n,e,t,r){let i=e[0],s=e[1],o=e[2],a=r[0],l=r[1],u=r[2],c=i-t[0],f=s-t[1],h=o-t[2],d=c*c+f*f+h*h;d===0?h=1:(d=1/Math.sqrt(d),c*=d,f*=d,h*=d);let p=l*h-u*f,y=u*c-a*h,x=a*f-l*c;return d=p*p+y*y+x*x,d===0&&(u?a+=1e-6:l?u+=1e-6:l+=1e-6,p=l*h-u*f,y=u*c-a*h,x=a*f-l*c,d=p*p+y*y+x*x),d=1/Math.sqrt(d),p*=d,y*=d,x*=d,n[0]=p,n[1]=y,n[2]=x,n[3]=0,n[4]=f*x-h*y,n[5]=h*p-c*x,n[6]=c*y-f*p,n[7]=0,n[8]=c,n[9]=f,n[10]=h,n[11]=0,n[12]=i,n[13]=s,n[14]=o,n[15]=1,n}function KO(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n}function ZO(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n}function yhe(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n}class D_ extends Array{constructor(e=1,t=0,r=0,i=0,s=0,o=1,a=0,l=0,u=0,c=0,f=1,h=0,d=0,p=0,y=0,x=1){return super(e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x){return e.length?this.copy(e):(ihe(this,e,t,r,i,s,o,a,l,u,c,f,h,d,p,y,x),this)}translate(e,t=this){return ahe(this,t,e),this}rotate(e,t,r=this){return uhe(this,r,e,t),this}scale(e,t=this){return lhe(this,t,typeof e=="number"?[e,e,e]:e),this}add(e,t){return t?KO(this,e,t):KO(this,this,e),this}sub(e,t){return t?ZO(this,e,t):ZO(this,this,e),this}multiply(e,t){return e.length?t?YO(this,e,t):YO(this,this,e):yhe(this,this,e),this}identity(){return she(this),this}copy(e){return rhe(this,e),this}fromPerspective({fov:e,aspect:t,near:r,far:i}={}){return mhe(this,e,t,r,i),this}fromOrthogonal({left:e,right:t,bottom:r,top:i,near:s,far:o}){return ghe(this,e,t,r,i,s,o),this}fromQuaternion(e){return phe(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return ohe(this,e),this}compose(e,t,r){return dhe(this,e,t,r),this}decompose(e,t,r){return hhe(this,e,t,r),this}getRotation(e){return IW(e,this),this}getTranslation(e){return che(e,this),this}getScaling(e){return PW(e,this),this}getMaxScaleOnAxis(){return fhe(this)}lookAt(e,t,r){return vhe(this,e,t,r),this}determinant(){return RW(this)}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this[3]=e[t+3],this[4]=e[t+4],this[5]=e[t+5],this[6]=e[t+6],this[7]=e[t+7],this[8]=e[t+8],this[9]=e[t+9],this[10]=e[t+10],this[11]=e[t+11],this[12]=e[t+12],this[13]=e[t+13],this[14]=e[t+14],this[15]=e[t+15],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e[t+4]=this[4],e[t+5]=this[5],e[t+6]=this[6],e[t+7]=this[7],e[t+8]=this[8],e[t+9]=this[9],e[t+10]=this[10],e[t+11]=this[11],e[t+12]=this[12],e[t+13]=this[13],e[t+14]=this[14],e[t+15]=this[15],e}}function xhe(n,e,t="YXZ"){return t==="XYZ"?(n[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(n[0]=Math.atan2(-e[9],e[10]),n[2]=Math.atan2(-e[4],e[0])):(n[0]=Math.atan2(e[6],e[5]),n[2]=0)):t==="YXZ"?(n[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(n[1]=Math.atan2(e[8],e[10]),n[2]=Math.atan2(e[1],e[5])):(n[1]=Math.atan2(-e[2],e[0]),n[2]=0)):t==="ZXY"?(n[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(n[1]=Math.atan2(-e[2],e[10]),n[2]=Math.atan2(-e[4],e[5])):(n[1]=0,n[2]=Math.atan2(e[1],e[0]))):t==="ZYX"?(n[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(n[0]=Math.atan2(e[6],e[10]),n[2]=Math.atan2(e[1],e[0])):(n[0]=0,n[2]=Math.atan2(-e[4],e[5]))):t==="YZX"?(n[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(n[0]=Math.atan2(-e[9],e[5]),n[1]=Math.atan2(-e[2],e[0])):(n[0]=0,n[1]=Math.atan2(e[8],e[10]))):t==="XZY"&&(n[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(n[0]=Math.atan2(e[6],e[5]),n[1]=Math.atan2(e[8],e[0])):(n[0]=Math.atan2(-e[9],e[10]),n[1]=0)),n}const JO=new D_;class _he extends Array{constructor(e=0,t=e,r=e,i="YXZ"){super(e,t,r),this.order=i,this.onChange=()=>{},this._target=this;const s=["0","1","2"];return new Proxy(this,{set(o,a){const l=Reflect.set(...arguments);return l&&s.includes(a)&&o.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,t=e,r=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=t,this._target[2]=r,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,t=this.order){return xhe(this._target,e,t),this.onChange(),this}fromQuaternion(e,t=this.order,r){return JO.fromQuaternion(e),this._target.fromRotationMatrix(JO,t),r||this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}}class whe{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new D_,this.worldMatrix=new D_,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Pa,this.quaternion=new the,this.scale=new Pa(1),this.rotation=new _he,this.up=new Pa(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,t=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,t&&e&&e.addChild(this,!1)}addChild(e,t=!0){~this.children.indexOf(e)||this.children.push(e),t&&e.setParent(this,!1)}removeChild(e,t=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),t&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let t=0,r=this.children.length;t<r;t++)this.children[t].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,t=!1){t?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function bhe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n}function She(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=t+t,a=r+r,l=i+i,u=t*o,c=r*o,f=r*a,h=i*o,d=i*a,p=i*l,y=s*o,x=s*a,m=s*l;return n[0]=1-f-p,n[3]=c-m,n[6]=h+x,n[1]=c+m,n[4]=1-u-p,n[7]=d-y,n[2]=h-x,n[5]=d+y,n[8]=1-u-f,n}function Ehe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function Mhe(n,e,t,r,i,s,o,a,l,u){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=o,n[6]=a,n[7]=l,n[8]=u,n}function The(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function Che(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=c*o-a*u,h=-c*s+a*l,d=u*s-o*l,p=t*f+r*h+i*d;return p?(p=1/p,n[0]=f*p,n[1]=(-c*r+i*u)*p,n[2]=(a*r-i*o)*p,n[3]=h*p,n[4]=(c*t-i*l)*p,n[5]=(-a*t+i*s)*p,n[6]=d*p,n[7]=(-u*t+r*l)*p,n[8]=(o*t-r*s)*p,n):null}function QO(n,e,t){let r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=t[0],d=t[1],p=t[2],y=t[3],x=t[4],m=t[5],_=t[6],w=t[7],b=t[8];return n[0]=h*r+d*o+p*u,n[1]=h*i+d*a+p*c,n[2]=h*s+d*l+p*f,n[3]=y*r+x*o+m*u,n[4]=y*i+x*a+m*c,n[5]=y*s+x*l+m*f,n[6]=_*r+w*o+b*u,n[7]=_*i+w*a+b*c,n[8]=_*s+w*l+b*f,n}function Ahe(n,e,t){let r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=t[0],d=t[1];return n[0]=r,n[1]=i,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=h*r+d*o+u,n[7]=h*i+d*a+c,n[8]=h*s+d*l+f,n}function Rhe(n,e,t){let r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=Math.sin(t),d=Math.cos(t);return n[0]=d*r+h*o,n[1]=d*i+h*a,n[2]=d*s+h*l,n[3]=d*o-h*r,n[4]=d*a-h*i,n[5]=d*l-h*s,n[6]=u,n[7]=c,n[8]=f,n}function Phe(n,e,t){let r=t[0],i=t[1];return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=i*e[3],n[4]=i*e[4],n[5]=i*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function Ihe(n,e){let t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],y=e[13],x=e[14],m=e[15],_=t*a-r*o,w=t*l-i*o,b=t*u-s*o,S=r*l-i*a,M=r*u-s*a,T=i*u-s*l,P=c*y-f*p,C=c*x-h*p,A=c*m-d*p,k=f*x-h*y,L=f*m-d*y,H=h*m-d*x,F=_*H-w*L+b*k+S*A-M*C+T*P;return F?(F=1/F,n[0]=(a*H-l*L+u*k)*F,n[1]=(l*A-o*H-u*C)*F,n[2]=(o*L-a*A+u*P)*F,n[3]=(i*L-r*H-s*k)*F,n[4]=(t*H-i*A+s*C)*F,n[5]=(r*A-t*L-s*P)*F,n[6]=(y*T-x*M+m*S)*F,n[7]=(x*b-p*T-m*w)*F,n[8]=(p*M-y*b+m*_)*F,n):null}class Dhe extends Array{constructor(e=1,t=0,r=0,i=0,s=1,o=0,a=0,l=0,u=1){return super(e,t,r,i,s,o,a,l,u),this}set(e,t,r,i,s,o,a,l,u){return e.length?this.copy(e):(Mhe(this,e,t,r,i,s,o,a,l,u),this)}translate(e,t=this){return Ahe(this,t,e),this}rotate(e,t=this){return Rhe(this,t,e),this}scale(e,t=this){return Phe(this,t,e),this}multiply(e,t){return t?QO(this,e,t):QO(this,this,e),this}identity(){return The(this),this}copy(e){return Ehe(this,e),this}fromMatrix4(e){return bhe(this,e),this}fromQuaternion(e){return She(this,e),this}fromBasis(e,t,r){return this.set(e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2]),this}inverse(e=this){return Che(this,e),this}getNormalMatrix(e){return Ihe(this,e),this}}let Nhe=0;class khe extends whe{constructor(e,{geometry:t,program:r,mode:i=e.TRIANGLES,frustumCulled:s=!0,renderOrder:o=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=Nhe++,this.geometry=t,this.program=r,this.mode=i,this.frustumCulled=s,this.renderOrder=o,this.modelViewMatrix=new D_,this.normalMatrix=new Dhe,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(r=>r&&r({mesh:this,camera:e}));let t=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:t}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(r=>r&&r({mesh:this,camera:e}))}}class Lhe extends Rfe{constructor(e,{attributes:t={}}={}){Object.assign(t,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,t)}}const Fhe=n=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]:[1,.5,.2]},Ohe=`#version 300 es
precision highp float;
in vec2 position;
in vec2 uv;
out vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 0.0, 1.0);
}
`,Bhe=`#version 300 es
precision highp float;
uniform vec2 iResolution;
uniform float iTime;
uniform vec3 uCustomColor;
uniform float uUseCustomColor;
uniform float uSpeed;
uniform float uDirection;
uniform float uScale;
uniform float uOpacity;
uniform vec2 uMouse;
uniform float uMouseInteractive;
out vec4 fragColor;

void mainImage(out vec4 o, vec2 C) {
  vec2 center = iResolution.xy * 0.5;
  C = (C - center) / uScale + center;
  
  vec2 mouseOffset = (uMouse - center) * 0.0002;
  C += mouseOffset * length(C - center) * step(0.5, uMouseInteractive);
  
  float i, d, z, T = iTime * uSpeed * uDirection;
  vec3 O, p, S;

  for (vec2 r = iResolution.xy, Q; ++i < 60.; O += o.w/d*o.xyz) {
    p = z*normalize(vec3(C-.5*r,r.y)); 
    p.z -= 4.; 
    S = p;
    d = p.y-T;
    
    p.x += .4*(1.+p.y)*sin(d + p.x*0.1)*cos(.34*d + p.x*0.05); 
    Q = p.xz *= mat2(cos(p.y+vec4(0,11,33,0)-T)); 
    z+= d = abs(sqrt(length(Q*Q)) - .25*(5.+S.y))/3.+8e-4; 
    o = 1.+sin(S.y+p.z*.5+S.z-length(S-p)+vec4(2,1,0,8));
  }
  
  o.xyz = tanh(O/1e4);
}

bool finite1(float x){ return !(isnan(x) || isinf(x)); }
vec3 sanitize(vec3 c){
  return vec3(
    finite1(c.r) ? c.r : 0.0,
    finite1(c.g) ? c.g : 0.0,
    finite1(c.b) ? c.b : 0.0
  );
}

void main() {
  vec4 o = vec4(0.0);
  mainImage(o, gl_FragCoord.xy);
  vec3 rgb = sanitize(o.rgb);
  
  float intensity = (rgb.r + rgb.g + rgb.b) / 3.0;
  vec3 customColor = intensity * uCustomColor;
  vec3 finalColor = mix(rgb, customColor, step(0.5, uUseCustomColor));
  
  float alpha = length(rgb) * uOpacity;
  fragColor = vec4(finalColor, alpha);
}`,Uhe=({color:n="#ffffff",speed:e=1,direction:t="forward",scale:r=1,opacity:i=1,mouseInteractive:s=!0})=>{const o=U.useRef(null),a=U.useRef({x:0,y:0});return U.useEffect(()=>{if(!o.current)return;const l=n?1:0,u=n?Fhe(n):[1,1,1],c=t==="reverse"?-1:1,f=new Ffe({webgl:2,alpha:!0,antialias:!1,dpr:Math.min(window.devicePixelRatio||1,2)}),h=f.gl,d=h.canvas;d.style.display="block",d.style.width="100%",d.style.height="100%",o.current.appendChild(d);const p=new Lhe(h),y=new Ife(h,{vertex:Ohe,fragment:Bhe,uniforms:{iTime:{value:0},iResolution:{value:new Float32Array([1,1])},uCustomColor:{value:new Float32Array(u)},uUseCustomColor:{value:l},uSpeed:{value:e*.4},uDirection:{value:c},uScale:{value:r},uOpacity:{value:i},uMouse:{value:new Float32Array([0,0])},uMouseInteractive:{value:s?1:0}}}),x=new khe(h,{geometry:p,program:y}),m=T=>{if(!s)return;const P=o.current.getBoundingClientRect();a.current.x=T.clientX-P.left,a.current.y=T.clientY-P.top;const C=y.uniforms.uMouse.value;C[0]=a.current.x,C[1]=a.current.y};s&&o.current.addEventListener("mousemove",m);const _=()=>{const T=o.current.getBoundingClientRect(),P=Math.max(1,Math.floor(T.width)),C=Math.max(1,Math.floor(T.height));f.setSize(P,C);const A=y.uniforms.iResolution.value;A[0]=h.drawingBufferWidth,A[1]=h.drawingBufferHeight},w=new ResizeObserver(_);w.observe(o.current),_();let b=0;const S=performance.now(),M=T=>{let P=(T-S)*.001;if(t==="pingpong"){const A=P%10,k=Math.floor(P/10)%2===0,L=A/10,H=L*L*(3-2*L),F=k?H*10:(1-H)*10;y.uniforms.uDirection.value=1,y.uniforms.iTime.value=F}else y.uniforms.iTime.value=P;f.render({scene:x}),b=requestAnimationFrame(M)};return b=requestAnimationFrame(M),()=>{var T;cancelAnimationFrame(b),w.disconnect(),s&&o.current&&o.current.removeEventListener("mousemove",m);try{(T=o.current)==null||T.removeChild(d)}catch{console.warn("Canvas already removed from container")}}},[n,e,t,r,i,s]),z.jsx("div",{ref:o,className:"w-full h-full overflow-hidden relative"})};class ty{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const zhe=()=>{if(!(typeof localStorage>"u"))return{get:n=>Promise.resolve(localStorage.getItem(n)),set:(n,e)=>Promise.resolve(localStorage.setItem(n,e)),remove:n=>Promise.resolve(localStorage.removeItem(n))}},Ni={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:zhe()},r4=n=>n?typeof n=="string"?{publicKey:n}:n.toString()==="[object Object]"?n:{}:{},Vhe=(n,e="https://api.emailjs.com")=>{if(!n)return;const t=r4(n);Ni.publicKey=t.publicKey,Ni.blockHeadless=t.blockHeadless,Ni.storageProvider=t.storageProvider,Ni.blockList=t.blockList,Ni.limitRate=t.limitRate,Ni.origin=t.origin||e},DW=async(n,e,t={})=>{const r=await fetch(Ni.origin+n,{method:"POST",headers:t,body:e}),i=await r.text(),s=new ty(r.status,i);if(r.ok)return s;throw s},NW=(n,e,t)=>{if(!n||typeof n!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Whe=n=>{if(n&&n.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},kW=n=>n.webdriver||!n.languages||n.languages.length===0,LW=()=>new ty(451,"Unavailable For Headless Browser"),Hhe=(n,e)=>{if(!Array.isArray(n))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},Ghe=n=>{var e;return!((e=n.list)!=null&&e.length)||!n.watchVariable},jhe=(n,e)=>n instanceof FormData?n.get(e):n[e],FW=(n,e)=>{if(Ghe(n))return!1;Hhe(n.list,n.watchVariable);const t=jhe(e,n.watchVariable);return typeof t!="string"?!1:n.list.includes(t)},OW=()=>new ty(403,"Forbidden"),Xhe=(n,e)=>{if(typeof n!="number"||n<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},$he=async(n,e,t)=>{const r=Number(await t.get(n)||0);return e-Date.now()+r},BW=async(n,e,t)=>{if(!e.throttle||!t)return!1;Xhe(e.throttle,e.id);const r=e.id||n;return await $he(r,e.throttle,t)>0?!0:(await t.set(r,Date.now().toString()),!1)},UW=()=>new ty(429,"Too Many Requests"),qhe=async(n,e,t,r)=>{const i=r4(r),s=i.publicKey||Ni.publicKey,o=i.blockHeadless||Ni.blockHeadless,a=i.storageProvider||Ni.storageProvider,l={...Ni.blockList,...i.blockList},u={...Ni.limitRate,...i.limitRate};return o&&kW(navigator)?Promise.reject(LW()):(NW(s,n,e),Whe(t),t&&FW(l,t)?Promise.reject(OW()):await BW(location.pathname,u,a)?Promise.reject(UW()):DW("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"}))},Yhe=n=>{if(!n||n.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},Khe=n=>typeof n=="string"?document.querySelector(n):n,Zhe=async(n,e,t,r)=>{const i=r4(r),s=i.publicKey||Ni.publicKey,o=i.blockHeadless||Ni.blockHeadless,a=Ni.storageProvider||i.storageProvider,l={...Ni.blockList,...i.blockList},u={...Ni.limitRate,...i.limitRate};if(o&&kW(navigator))return Promise.reject(LW());const c=Khe(t);NW(s,n,e),Yhe(c);const f=new FormData(c);return FW(l,f)?Promise.reject(OW()):await BW(location.pathname,u,a)?Promise.reject(UW()):(f.append("lib_version","4.4.1"),f.append("service_id",n),f.append("template_id",e),f.append("user_id",s),DW("/api/v1.0/email/send-form",f))},Jhe={init:Vhe,send:qhe,sendForm:Zhe,EmailJSResponseStatus:ty},e5=()=>{const n=U.useRef(),[e,t]=U.useState({name:"",email:"",subject:"",message:""}),[r,i]=U.useState({name:!1,email:!1,subject:!1,message:!1}),[s,o]=U.useState({type:"",message:""}),[a,l]=U.useState(!1),u=d=>{t({...e,[d.target.name]:d.target.value})},c=d=>{i({...r,[d]:!0})},f=d=>{e[d]||i({...r,[d]:!1})},h=async d=>{d.preventDefault(),l(!0),o({type:"",message:""});try{await Jhe.sendForm("service_pqeeaz8","template_jry3q3n",n.current,"H6X5q9F74zm5z3ekm"),o({type:"success",message:"Message sent successfully! I will get back to you soon."}),setTimeout(()=>{o({type:"",message:""})},5e3),t({name:"",email:"",subject:"",message:""}),i({name:!1,email:!1,subject:!1,message:!1})}catch(p){o({type:"error",message:"Failed to send message. Please try again later."}),setTimeout(()=>{o({type:"",message:""})},5e3),console.error("EmailJS Error:",p)}finally{l(!1)}};return z.jsxs("div",{className:"w-full max-w-2xl animate-float relative",children:[s.message&&z.jsx("div",{className:"absolute -top-20 right-0 z-[9999] animate-slide-down",style:{animation:"slideDown 0.5s ease-out forwards"},children:z.jsxs("div",{className:`relative backdrop-blur-xl rounded-lg px-4 py-3 shadow-2xl border-2 flex items-center gap-2 ${s.type==="success"?"bg-gradient-to-r from-green-500/20 via-emerald-500/20 to-green-500/20 border-green-400/50":"bg-gradient-to-r from-red-500/20 via-rose-500/20 to-red-500/20 border-red-400/50"}`,children:[z.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${s.type==="success"?"bg-green-500/30":"bg-red-500/30"}`,children:s.type==="success"?z.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):z.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),z.jsx("p",{className:`text-sm font-medium ${s.type==="success"?"text-green-300":"text-red-300"}`,children:s.type==="success"?"Message sent!":"Failed to send"}),z.jsx("button",{onClick:()=>o({type:"",message:""}),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors duration-200",children:z.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),z.jsx("div",{className:`absolute inset-0 -z-10 blur-lg opacity-50 ${s.type==="success"?"bg-green-500/30":"bg-red-500/30"}`})]})}),z.jsxs("form",{ref:n,className:"relative bg-surface/30 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl",onSubmit:h,children:[z.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-gradient-to-br from-primary/30 to-secondary/30 rounded-full blur-3xl"}),z.jsx("div",{className:"absolute -bottom-24 -left-24 w-48 h-48 bg-gradient-to-br from-tertiary/30 to-primary/30 rounded-full blur-3xl"}),z.jsxs("div",{className:"relative z-10",children:[z.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent mb-2",children:"Send a Message"}),z.jsx("p",{className:"text-gray-500 text-sm mb-8",children:"Fill out the form below and I'll get back to you soon!"}),z.jsxs("div",{className:"space-y-6",children:[z.jsxs("div",{className:"relative group",children:[z.jsx("input",{type:"text",name:"name",value:e.name,onChange:u,onFocus:()=>c("name"),onBlur:()=>f("name"),required:!0,className:"w-full bg-surface/30 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-transparent focus:outline-none focus:border-primary/50 focus:bg-surface/50 transition-all duration-300 peer",placeholder:"Your Name"}),z.jsx("label",{className:`absolute left-4 transition-all duration-300 pointer-events-none ${r.name||e.name?"-top-2.5 text-xs bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent font-medium":"top-3 text-gray-500"}`,children:"Your Name"})]}),z.jsxs("div",{className:"relative group",children:[z.jsx("input",{type:"email",name:"email",value:e.email,onChange:u,onFocus:()=>c("email"),onBlur:()=>f("email"),required:!0,className:"w-full bg-surface/30 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-transparent focus:outline-none focus:border-secondary/50 focus:bg-surface/50 transition-all duration-300 peer",placeholder:"Your Email"}),z.jsx("label",{className:`absolute left-4 transition-all duration-300 pointer-events-none ${r.email||e.email?"-top-2.5 text-xs bg-gradient-to-r from-secondary to-tertiary bg-clip-text text-transparent font-medium":"top-3 text-gray-500"}`,children:"Your Email"})]}),z.jsxs("div",{className:"relative group",children:[z.jsx("input",{type:"text",name:"subject",value:e.subject,onChange:u,onFocus:()=>c("subject"),onBlur:()=>f("subject"),required:!0,className:"w-full bg-surface/30 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-transparent focus:outline-none focus:border-tertiary/50 focus:bg-surface/50 transition-all duration-300 peer",placeholder:"Subject"}),z.jsx("label",{className:`absolute left-4 transition-all duration-300 pointer-events-none ${r.subject||e.subject?"-top-2.5 text-xs bg-gradient-to-r from-tertiary to-primary bg-clip-text text-transparent font-medium":"top-3 text-gray-500"}`,children:"Subject"})]}),z.jsxs("div",{className:"relative group",children:[z.jsx("textarea",{name:"message",value:e.message,onChange:u,onFocus:()=>c("message"),onBlur:()=>f("message"),required:!0,className:"w-full bg-surface/30 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-transparent focus:outline-none focus:border-primary/50 focus:bg-surface/50 transition-all duration-300 peer resize-none",placeholder:"Your Message",rows:"5"}),z.jsx("label",{className:`absolute left-4 transition-all duration-300 pointer-events-none ${r.message||e.message?"-top-2.5 text-xs bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent font-medium":"top-3 text-gray-500"}`,children:"Your Message"})]})]}),z.jsxs("button",{type:"submit",disabled:a,className:"group relative w-full mt-8 bg-gradient-to-r from-primary via-secondary to-tertiary rounded-xl px-6 py-4 text-white font-semibold overflow-hidden hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-2xl hover:shadow-primary/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:[z.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[z.jsx("span",{children:a?"Sending...":"Send Message"}),z.jsx("svg",{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13"})})]}),z.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500",children:z.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"})})]})]})]})]})};function Qhe({children:n,className:e="",onClick:t,mouseX:r,spring:i,distance:s,magnification:o,baseItemSize:a}){const l=U.useRef(null),u=Sv(0),c=I_(r,d=>{var y;const p=((y=l.current)==null?void 0:y.getBoundingClientRect())??{x:0};return d-p.x-a/2}),f=I_(c,[-s,0,s],[a,o,a]),h=TW(f,i);return z.jsx(bv.div,{ref:l,style:{width:h,height:h},onHoverStart:()=>u.set(1),onHoverEnd:()=>u.set(0),onFocus:()=>u.set(1),onBlur:()=>u.set(0),onClick:t,className:`relative inline-flex items-center justify-center rounded-xl bg-surface border-white/10 border-2 shadow-md ${e}`,tabIndex:0,role:"button","aria-haspopup":"true",children:U.Children.map(n,d=>U.cloneElement(d,{isHovered:u}))})}function ede({children:n,className:e="",...t}){const{isHovered:r}=t,[i,s]=U.useState(!1);return U.useEffect(()=>{const o=r.on("change",a=>{s(a===1)});return()=>o()},[r]),z.jsx(hle,{children:i&&z.jsx(bv.div,{initial:{opacity:0,y:0},animate:{opacity:1,y:-10},exit:{opacity:0,y:0},transition:{duration:.2},className:`${e} absolute -top-6 left-1/2 w-fit whitespace-pre rounded-md border border-white/10 bg-surface px-2 py-0.5 text-xs text-gray-300`,role:"tooltip",style:{x:"-50%"},children:n})})}function tde({children:n,className:e=""}){return z.jsx("div",{className:`flex items-center justify-center ${e}`,children:n})}function nde({items:n,className:e="",spring:t={mass:.1,stiffness:150,damping:12},magnification:r=70,distance:i=200,panelHeight:s=64,dockHeight:o=256,baseItemSize:a=50}){const l=Sv(1/0),u=Sv(0),c=U.useMemo(()=>Math.max(o,r+r/2+4),[r,o]),f=I_(u,[0,1],[s,c]),h=TW(f,t);return z.jsx(bv.div,{style:{height:h,scrollbarWidth:"none"},className:"mx-2 flex max-w-full items-center",children:z.jsx(bv.div,{onMouseMove:({pageX:d})=>{u.set(1),l.set(d)},onMouseLeave:()=>{u.set(0),l.set(1/0)},className:`${e} absolute bottom-2 left-1/2 transform -translate-x-1/2 flex items-end w-fit gap-4 rounded-2xl border-primary/30 border-2 pb-2 px-4`,style:{height:s},role:"toolbar","aria-label":"Application dock",children:n.map((d,p)=>z.jsxs(Qhe,{onClick:d.onClick,className:d.className,mouseX:l,spring:t,distance:i,magnification:r,baseItemSize:a,children:[z.jsx(tde,{children:d.icon}),z.jsx(ede,{children:d.label})]},p))})})}const rde=()=>{const[n,e]=U.useState(window.innerWidth<=768);U.useEffect(()=>{const i=()=>e(window.innerWidth<=768);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const t=[{label:"Instagram",icon:z.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}),onClick:()=>window.open("https://www.instagram.com/kumar_mayank.27/","_blank"),className:"bg-gradient-to-r from-tertiary to-rose"},{label:"LinkedIn",icon:z.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),onClick:()=>window.open("https://www.linkedin.com/in/mayankkumarupes/","_blank"),className:"bg-gradient-to-r from-primary to-secondary"},{label:"GitHub",icon:z.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),onClick:()=>window.open("https://github.com/mayank-kumar-27","_blank"),className:"bg-gradient-to-r from-surface to-surface-light"},{label:"Email",icon:z.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),onClick:()=>window.location.href="mailto:mayankkumar.270607@gmail.com",className:"bg-gradient-to-r from-warm to-rose"}],r=t.map(i=>({...i,className:i.className+" border-0"}));return z.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-visible pt-32 pb-20",children:[z.jsx("div",{className:"absolute inset-0 z-[1] pointer-events-none",children:z.jsx(Uhe,{color:"#7c3aed",speed:1,opacity:.6,mouseInteractive:!1})}),n?z.jsxs("div",{className:"relative z-[10] w-full px-4 pt-4 pb-8 flex flex-col touch-pan-y",children:[z.jsxs("div",{className:"text-center mb-4",children:[z.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift mb-3",children:"Get In Touch"}),z.jsx("p",{className:"text-sm text-gray-300 leading-relaxed px-2",children:"I'm always open to discussing new projects, creative ideas, or opportunities. Let's create something amazing together!"})]}),z.jsx("div",{className:"flex flex-row items-center justify-center gap-4 mb-6 touch-none",children:t.map((i,s)=>z.jsx("button",{onClick:i.onClick,className:`w-10 h-10 rounded-lg ${i.className} flex items-center justify-center transition-all duration-300 active:scale-95 shadow-md touch-manipulation`,"aria-label":i.label,children:z.jsx("div",{className:"w-5 h-5 flex items-center justify-center [&>svg]:w-5 [&>svg]:h-5",children:i.icon})},s))}),z.jsx("div",{className:"w-full",children:z.jsx(e5,{})})]}):z.jsxs("div",{className:"relative z-[10] w-full max-w-7xl mx-auto px-8 flex items-center justify-between gap-12",children:[z.jsxs("div",{className:"w-1/2 flex flex-col justify-center items-start",children:[z.jsxs("div",{className:"mb-8",children:[z.jsx("h1",{className:"text-5xl sm:text-6xl md:text-7xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift mb-6",children:"Get In Touch"}),z.jsx(j7,{text:"I'm always open to discussing new projects, creative ideas, or opportunities to be part of your vision. Let's create something amazing together!",as:"p",className:"text-base sm:text-lg md:text-xl text-gray-300 tracking-wide",typingSpeed:20,initialDelay:1200,loop:!1,showCursor:!1,startOnVisible:!1})]}),z.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8 w-full",children:[z.jsx("div",{className:"group relative bg-gradient-to-br from-primary/20 to-surface/50 backdrop-blur-sm border border-primary/30 rounded-xl p-4 hover:from-primary/30 hover:to-surface/60 hover:scale-105 hover:border-primary/50 transition-all duration-300 overflow-hidden shadow-lg shadow-primary/20",children:z.jsxs("div",{className:"relative z-10",children:[z.jsx("svg",{className:"w-8 h-8 text-primary mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),z.jsx("p",{className:"text-sm text-gray-500",children:"Response Time"}),z.jsx("p",{className:"text-white font-semibold",children:"Within 24hrs"})]})}),z.jsx("div",{className:"group relative bg-gradient-to-br from-secondary/20 to-surface/50 backdrop-blur-sm border border-secondary/30 rounded-xl p-4 hover:from-secondary/30 hover:to-surface/60 hover:scale-105 hover:border-secondary/50 transition-all duration-300 overflow-hidden shadow-lg shadow-secondary/20",children:z.jsxs("div",{className:"relative z-10",children:[z.jsx("svg",{className:"w-8 h-8 text-secondary-light mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),z.jsx("p",{className:"text-sm text-gray-500",children:"Location"}),z.jsx("p",{className:"text-white font-semibold",children:"Available Remote"})]})})]}),z.jsx("div",{className:"relative h-24 w-full flex items-center justify-center",children:z.jsx(nde,{items:r})})]}),z.jsxs("div",{className:"w-1/2 flex items-center justify-center relative",children:[z.jsx("div",{className:"absolute -top-6 -left-6 w-32 h-32 border-2 border-primary/30 rounded-xl rotate-6 pointer-events-none"}),z.jsx("div",{className:"absolute -bottom-6 -right-6 w-32 h-32 border-2 border-secondary/30 rounded-xl -rotate-6 pointer-events-none"}),z.jsx(e5,{})]})]})]})},ide=({items:n=[],gradientColor:e="black"})=>{const t=U.useRef(null),r=U.useRef([]),i=U.useRef(window.innerWidth/2),s=28,o=Array.from({length:s},(l,u)=>`Item ${u+1}`),a=n.length>0?n.slice(0,s):o;return U.useEffect(()=>{Wt.ticker.lagSmoothing(0);const l=f=>{i.current=f.clientX},u=()=>{const d=[.6,.4,.3,.2];r.current.forEach((p,y)=>{if(p){const x=y%2===0?1:-1,m=(i.current/window.innerWidth*300-300/2)*x;Wt.to(p,{x:m,duration:.8+d[y%d.length],ease:"power3.out",overwrite:"auto"})}})},c=Wt.ticker.add(u);return window.addEventListener("mousemove",l),()=>{window.removeEventListener("mousemove",l),c()}},[]),z.jsx("div",{ref:t,className:"h-full w-full overflow-hidden",children:z.jsxs("section",{className:"w-full h-screen overflow-hidden relative flex items-center justify-center",style:{background:`radial-gradient(circle, ${e} 0%, transparent 100%)`},children:[z.jsx("div",{className:"absolute inset-0 pointer-events-none z-[4] bg-[length:250px]"}),z.jsx("div",{className:"gap-16 flex-none relative w-[140vw] h-[150vh] grid grid-rows-4 grid-cols-1 rotate-[-15deg] origin-center z-[2] p-12",children:[...Array(4)].map((l,u)=>z.jsx("div",{className:"grid gap-4 grid-cols-7",style:{willChange:"transform, filter"},ref:c=>r.current[u]=c,children:[...Array(7)].map((c,f)=>{const h=a[u*7+f];return z.jsx("div",{className:"relative aspect-square pointer-events-auto",children:z.jsx("div",{className:"relative w-full h-full overflow-hidden rounded-xl bg-gradient-to-br from-surface to-background border border-white/10 flex items-center justify-center text-white text-[1.5rem] transition-all duration-300 hover:scale-110 hover:border-secondary/50 hover:shadow-[0_0_20px_rgba(124,58,237,0.5)] hover:z-10 group",children:typeof h=="string"&&h.startsWith("http")?z.jsx("div",{className:"w-full h-full bg-cover bg-center absolute top-0 left-0 transition-transform duration-300 group-hover:scale-110",style:{backgroundImage:`url(${h})`}}):typeof h=="object"&&h.url?z.jsx("div",{className:"w-full h-full flex items-center justify-center p-8",children:z.jsx("img",{src:h.url,alt:h.name||"",className:"max-w-[70%] max-h-[70%] object-contain transition-all duration-300 group-hover:scale-125 drop-shadow-[0_0_10px_rgba(124,58,237,0.3)]"})}):z.jsx("div",{className:"p-4 text-center z-[1] transition-all duration-300 group-hover:text-primary",children:h})})},f)})},u))}),z.jsx("div",{className:"relative w-full h-full top-0 left-0 pointer-events-none"})]})})};function sde({mouseForce:n=20,cursorSize:e=100,isViscous:t=!1,viscous:r=30,iterationsViscous:i=32,iterationsPoisson:s=32,dt:o=.014,BFECC:a=!0,resolution:l=.5,isBounce:u=!1,colors:c=["#00d4ff","#7c3aed","#f472b6"],style:f={},className:h="",autoDemo:d=!0,autoSpeed:p=.5,autoIntensity:y=2.2,takeoverDuration:x=.25,autoResumeDelay:m=1e3,autoRampDuration:_=.6}){const w=U.useRef(null),b=U.useRef(null),S=U.useRef(null),M=U.useRef(null),T=U.useRef(null),P=U.useRef(!0),C=U.useRef(null);return U.useEffect(()=>{if(!w.current)return;function A(Se){let K;Array.isArray(Se)&&Se.length>0?Se.length===1?K=[Se[0],Se[0]]:K=Se:K=["#ffffff","#ffffff"];const ge=K.length,Te=new Uint8Array(ge*4);for(let Pe=0;Pe<ge;Pe++){const De=new it(K[Pe]);Te[Pe*4+0]=Math.round(De.r*255),Te[Pe*4+1]=Math.round(De.g*255),Te[Pe*4+2]=Math.round(De.b*255),Te[Pe*4+3]=255}const Le=new au(Te,ge,1,ki);return Le.magFilter=bn,Le.minFilter=bn,Le.wrapS=Cr,Le.wrapT=Cr,Le.generateMipmaps=!1,Le.needsUpdate=!0,Le}const k=A(c),L=new Sn(0,0,0,0);class H{constructor(){this.width=0,this.height=0,this.aspect=1,this.pixelRatio=1,this.isMobile=!1,this.breakpoint=768,this.fboWidth=null,this.fboHeight=null,this.time=0,this.delta=0,this.container=null,this.renderer=null,this.clock=null}init(K){this.container=K,this.pixelRatio=Math.min(window.devicePixelRatio||1,2),this.resize(),this.renderer=new xm({antialias:!0,alpha:!0}),this.renderer.autoClear=!1,this.renderer.setClearColor(new it(0),0),this.renderer.setPixelRatio(this.pixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.display="block",this.clock=new Kw,this.clock.start()}resize(){if(!this.container)return;const K=this.container.getBoundingClientRect();this.width=Math.max(1,Math.floor(K.width)),this.height=Math.max(1,Math.floor(K.height)),this.aspect=this.width/this.height,this.renderer&&this.renderer.setSize(this.width,this.height,!1)}update(){this.delta=this.clock.getDelta(),this.time+=this.delta}}const F=new H;class V{constructor(){this.mouseMoved=!1,this.coords=new Me,this.coords_old=new Me,this.diff=new Me,this.timer=null,this.container=null,this.docTarget=null,this.listenerTarget=null,this.isHoverInside=!1,this.hasUserControl=!1,this.isAutoActive=!1,this.autoIntensity=2,this.takeoverActive=!1,this.takeoverStartTime=0,this.takeoverDuration=.25,this.takeoverFrom=new Me,this.takeoverTo=new Me,this.onInteract=null,this._onMouseMove=this.onDocumentMouseMove.bind(this),this._onTouchStart=this.onDocumentTouchStart.bind(this),this._onTouchMove=this.onDocumentTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this._onDocumentLeave=this.onDocumentLeave.bind(this)}init(K){this.container=K,this.docTarget=K.ownerDocument||null;const ge=this.docTarget&&this.docTarget.defaultView||(typeof window<"u"?window:null);ge&&(this.listenerTarget=ge,this.listenerTarget.addEventListener("mousemove",this._onMouseMove),this.listenerTarget.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.listenerTarget.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.listenerTarget.addEventListener("touchend",this._onTouchEnd),this.docTarget&&this.docTarget.addEventListener("mouseleave",this._onDocumentLeave))}dispose(){this.listenerTarget&&(this.listenerTarget.removeEventListener("mousemove",this._onMouseMove),this.listenerTarget.removeEventListener("touchstart",this._onTouchStart),this.listenerTarget.removeEventListener("touchmove",this._onTouchMove),this.listenerTarget.removeEventListener("touchend",this._onTouchEnd)),this.docTarget&&this.docTarget.removeEventListener("mouseleave",this._onDocumentLeave),this.listenerTarget=null,this.docTarget=null,this.container=null}isPointInside(K,ge){if(!this.container)return!1;const Te=this.container.getBoundingClientRect();return Te.width===0||Te.height===0?!1:K>=Te.left&&K<=Te.right&&ge>=Te.top&&ge<=Te.bottom}updateHoverState(K,ge){return this.isHoverInside=this.isPointInside(K,ge),this.isHoverInside}setCoords(K,ge){if(!this.container)return;this.timer&&window.clearTimeout(this.timer);const Te=this.container.getBoundingClientRect();if(Te.width===0||Te.height===0)return;const Le=(K-Te.left)/Te.width,Pe=(ge-Te.top)/Te.height;this.coords.set(Le*2-1,-(Pe*2-1)),this.mouseMoved=!0,this.timer=window.setTimeout(()=>{this.mouseMoved=!1},100)}setNormalized(K,ge){this.coords.set(K,ge),this.mouseMoved=!0}onDocumentMouseMove(K){if(this.updateHoverState(K.clientX,K.clientY)){if(this.onInteract&&this.onInteract(),this.isAutoActive&&!this.hasUserControl&&!this.takeoverActive){if(!this.container)return;const ge=this.container.getBoundingClientRect();if(ge.width===0||ge.height===0)return;const Te=(K.clientX-ge.left)/ge.width,Le=(K.clientY-ge.top)/ge.height;this.takeoverFrom.copy(this.coords),this.takeoverTo.set(Te*2-1,-(Le*2-1)),this.takeoverStartTime=performance.now(),this.takeoverActive=!0,this.hasUserControl=!0,this.isAutoActive=!1;return}this.setCoords(K.clientX,K.clientY),this.hasUserControl=!0}}onDocumentTouchStart(K){if(K.touches.length!==1)return;const ge=K.touches[0];this.updateHoverState(ge.clientX,ge.clientY)&&(this.onInteract&&this.onInteract(),this.setCoords(ge.clientX,ge.clientY),this.hasUserControl=!0)}onDocumentTouchMove(K){if(K.touches.length!==1)return;const ge=K.touches[0];this.updateHoverState(ge.clientX,ge.clientY)&&(this.onInteract&&this.onInteract(),this.setCoords(ge.clientX,ge.clientY))}onTouchEnd(){this.isHoverInside=!1}onDocumentLeave(){this.isHoverInside=!1}update(){if(this.takeoverActive){const K=(performance.now()-this.takeoverStartTime)/(this.takeoverDuration*1e3);if(K>=1)this.takeoverActive=!1,this.coords.copy(this.takeoverTo),this.coords_old.copy(this.coords),this.diff.set(0,0);else{const ge=K*K*(3-2*K);this.coords.copy(this.takeoverFrom).lerp(this.takeoverTo,ge)}}this.diff.subVectors(this.coords,this.coords_old),this.coords_old.copy(this.coords),this.coords_old.x===0&&this.coords_old.y===0&&this.diff.set(0,0),this.isAutoActive&&!this.takeoverActive&&this.diff.multiplyScalar(this.autoIntensity)}}const W=new V;class G{constructor(K,ge,Te){this.mouse=K,this.manager=ge,this.enabled=Te.enabled,this.speed=Te.speed,this.resumeDelay=Te.resumeDelay||3e3,this.rampDurationMs=(Te.rampDuration||0)*1e3,this.active=!1,this.current=new Me(0,0),this.target=new Me,this.lastTime=performance.now(),this.activationTime=0,this.margin=.2,this._tmpDir=new Me,this.pickNewTarget()}pickNewTarget(){const K=Math.random;this.target.set((K()*2-1)*(1-this.margin),(K()*2-1)*(1-this.margin))}forceStop(){this.active=!1,this.mouse.isAutoActive=!1}update(){if(!this.enabled)return;const K=performance.now();if(K-this.manager.lastUserInteraction<this.resumeDelay){this.active&&this.forceStop();return}if(this.mouse.isHoverInside){this.active&&this.forceStop();return}if(this.active||(this.active=!0,this.current.copy(this.mouse.coords),this.lastTime=K,this.activationTime=K),!this.active)return;this.mouse.isAutoActive=!0;let Te=(K-this.lastTime)/1e3;this.lastTime=K,Te>.2&&(Te=.016);const Le=this._tmpDir.subVectors(this.target,this.current),Pe=Le.length();if(Pe<.01){this.pickNewTarget();return}Le.normalize();let De=1;if(this.rampDurationMs>0){const Ze=Math.min(1,(K-this.activationTime)/this.rampDurationMs);De=Ze*Ze*(3-2*Ze)}const Ae=this.speed*Te*De,ht=Math.min(Ae,Pe);this.current.addScaledVector(Le,ht),this.mouse.setNormalized(this.current.x,this.current.y)}}const N=`
  attribute vec3 position;
  uniform vec2 px;
  uniform vec2 boundarySpace;
  varying vec2 uv;
  precision highp float;
  void main(){
  vec3 pos = position;
  vec2 scale = 1.0 - boundarySpace * 2.0;
  pos.xy = pos.xy * scale;
  uv = vec2(0.5)+(pos.xy)*0.5;
  gl_Position = vec4(pos, 1.0);
}
`,B=`
  attribute vec3 position;
  uniform vec2 px;
  precision highp float;
  varying vec2 uv;
  void main(){
  vec3 pos = position;
  uv = 0.5 + pos.xy * 0.5;
  vec2 n = sign(pos.xy);
  pos.xy = abs(pos.xy) - px * 1.0;
  pos.xy *= n;
  gl_Position = vec4(pos, 1.0);
}
`,D=`
    precision highp float;
    attribute vec3 position;
    attribute vec2 uv;
    uniform vec2 center;
    uniform vec2 scale;
    uniform vec2 px;
    varying vec2 vUv;
    void main(){
    vec2 pos = position.xy * scale * 2.0 * px + center;
    vUv = uv;
    gl_Position = vec4(pos, 0.0, 1.0);
}
`,$=`
    precision highp float;
    uniform sampler2D velocity;
    uniform float dt;
    uniform bool isBFECC;
    uniform vec2 fboSize;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    vec2 ratio = max(fboSize.x, fboSize.y) / fboSize;
    if(isBFECC == false){
        vec2 vel = texture2D(velocity, uv).xy;
        vec2 uv2 = uv - vel * dt * ratio;
        vec2 newVel = texture2D(velocity, uv2).xy;
        gl_FragColor = vec4(newVel, 0.0, 0.0);
    } else {
        vec2 spot_new = uv;
        vec2 vel_old = texture2D(velocity, uv).xy;
        vec2 spot_old = spot_new - vel_old * dt * ratio;
        vec2 vel_new1 = texture2D(velocity, spot_old).xy;
        vec2 spot_new2 = spot_old + vel_new1 * dt * ratio;
        vec2 error = spot_new2 - spot_new;
        vec2 spot_new3 = spot_new - error / 2.0;
        vec2 vel_2 = texture2D(velocity, spot_new3).xy;
        vec2 spot_old2 = spot_new3 - vel_2 * dt * ratio;
        vec2 newVel2 = texture2D(velocity, spot_old2).xy; 
        gl_FragColor = vec4(newVel2, 0.0, 0.0);
    }
}
`,ee=`
    precision highp float;
    uniform sampler2D velocity;
    uniform sampler2D palette;
    uniform vec4 bgColor;
    varying vec2 uv;
    void main(){
    vec2 vel = texture2D(velocity, uv).xy;
    float lenv = clamp(length(vel), 0.0, 1.0);
    vec3 c = texture2D(palette, vec2(lenv, 0.5)).rgb;
    vec3 outRGB = mix(bgColor.rgb, c, lenv);
    float outA = mix(bgColor.a, 1.0, lenv);
    gl_FragColor = vec4(outRGB, outA);
}
`,te=`
    precision highp float;
    uniform sampler2D velocity;
    uniform float dt;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    float x0 = texture2D(velocity, uv-vec2(px.x, 0.0)).x;
    float x1 = texture2D(velocity, uv+vec2(px.x, 0.0)).x;
    float y0 = texture2D(velocity, uv-vec2(0.0, px.y)).y;
    float y1 = texture2D(velocity, uv+vec2(0.0, px.y)).y;
    float divergence = (x1 - x0 + y1 - y0) / 2.0;
    gl_FragColor = vec4(divergence / dt);
}
`,se=`
    precision highp float;
    uniform vec2 force;
    uniform vec2 center;
    uniform vec2 scale;
    uniform vec2 px;
    varying vec2 vUv;
    void main(){
    vec2 circle = (vUv - 0.5) * 2.0;
    float d = 1.0 - min(length(circle), 1.0);
    d *= d;
    gl_FragColor = vec4(force * d, 0.0, 1.0);
}
`,me=`
    precision highp float;
    uniform sampler2D pressure;
    uniform sampler2D divergence;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    float p0 = texture2D(pressure, uv + vec2(px.x * 2.0, 0.0)).r;
    float p1 = texture2D(pressure, uv - vec2(px.x * 2.0, 0.0)).r;
    float p2 = texture2D(pressure, uv + vec2(0.0, px.y * 2.0)).r;
    float p3 = texture2D(pressure, uv - vec2(0.0, px.y * 2.0)).r;
    float div = texture2D(divergence, uv).r;
    float newP = (p0 + p1 + p2 + p3) / 4.0 - div;
    gl_FragColor = vec4(newP);
}
`,_e=`
    precision highp float;
    uniform sampler2D pressure;
    uniform sampler2D velocity;
    uniform vec2 px;
    uniform float dt;
    varying vec2 uv;
    void main(){
    float step = 1.0;
    float p0 = texture2D(pressure, uv + vec2(px.x * step, 0.0)).r;
    float p1 = texture2D(pressure, uv - vec2(px.x * step, 0.0)).r;
    float p2 = texture2D(pressure, uv + vec2(0.0, px.y * step)).r;
    float p3 = texture2D(pressure, uv - vec2(0.0, px.y * step)).r;
    vec2 v = texture2D(velocity, uv).xy;
    vec2 gradP = vec2(p0 - p1, p2 - p3) * 0.5;
    v = v - gradP * dt;
    gl_FragColor = vec4(v, 0.0, 1.0);
}
`,pe=`
    precision highp float;
    uniform sampler2D velocity;
    uniform sampler2D velocity_new;
    uniform float v;
    uniform vec2 px;
    uniform float dt;
    varying vec2 uv;
    void main(){
    vec2 old = texture2D(velocity, uv).xy;
    vec2 new0 = texture2D(velocity_new, uv + vec2(px.x * 2.0, 0.0)).xy;
    vec2 new1 = texture2D(velocity_new, uv - vec2(px.x * 2.0, 0.0)).xy;
    vec2 new2 = texture2D(velocity_new, uv + vec2(0.0, px.y * 2.0)).xy;
    vec2 new3 = texture2D(velocity_new, uv - vec2(0.0, px.y * 2.0)).xy;
    vec2 newv = 4.0 * old + v * dt * (new0 + new1 + new2 + new3);
    newv /= 4.0 * (1.0 + v * dt);
    gl_FragColor = vec4(newv, 0.0, 0.0);
}
`;class Ne{constructor(K){var ge;this.props=K||{},this.uniforms=(ge=this.props.material)==null?void 0:ge.uniforms,this.scene=null,this.camera=null,this.material=null,this.geometry=null,this.plane=null}init(){this.scene=new mu,this.camera=new _h,this.uniforms&&(this.material=new ap(this.props.material),this.geometry=new yl(2,2),this.plane=new Qn(this.geometry,this.material),this.scene.add(this.plane))}update(){F.renderer.setRenderTarget(this.props.output||null),F.renderer.render(this.scene,this.camera),F.renderer.setRenderTarget(null)}}class Ue extends Ne{constructor(K){super({material:{vertexShader:N,fragmentShader:$,uniforms:{boundarySpace:{value:K.cellScale},px:{value:K.cellScale},fboSize:{value:K.fboSize},velocity:{value:K.src.texture},dt:{value:K.dt},isBFECC:{value:!0}}},output:K.dst}),this.uniforms=this.props.material.uniforms,this.init()}init(){super.init(),this.createBoundary()}createBoundary(){const K=new qt,ge=new Float32Array([-1,-1,0,-1,1,0,-1,1,0,1,1,0,1,1,0,1,-1,0,1,-1,0,-1,-1,0]);K.setAttribute("position",new vn(ge,3));const Te=new ap({vertexShader:B,fragmentShader:$,uniforms:this.uniforms});this.line=new Ua(K,Te),this.scene.add(this.line)}update({dt:K,isBounce:ge,BFECC:Te}){this.uniforms.dt.value=K,this.line.visible=ge,this.uniforms.isBFECC.value=Te,super.update()}}class We extends Ne{constructor(K){super({output:K.dst}),this.init(K)}init(K){super.init();const ge=new yl(1,1),Te=new ap({vertexShader:D,fragmentShader:se,blending:o_,depthWrite:!1,uniforms:{px:{value:K.cellScale},force:{value:new Me(0,0)},center:{value:new Me(0,0)},scale:{value:new Me(K.cursor_size,K.cursor_size)}}});this.mouse=new Qn(ge,Te),this.scene.add(this.mouse)}update(K){const ge=W.diff.x/2*K.mouse_force,Te=W.diff.y/2*K.mouse_force,Le=K.cursor_size*K.cellScale.x,Pe=K.cursor_size*K.cellScale.y,De=Math.min(Math.max(W.coords.x,-1+Le+K.cellScale.x*2),1-Le-K.cellScale.x*2),Ae=Math.min(Math.max(W.coords.y,-1+Pe+K.cellScale.y*2),1-Pe-K.cellScale.y*2),ht=this.mouse.material.uniforms;ht.force.value.set(ge,Te),ht.center.value.set(De,Ae),ht.scale.value.set(K.cursor_size,K.cursor_size),super.update()}}class Be extends Ne{constructor(K){super({material:{vertexShader:N,fragmentShader:pe,uniforms:{boundarySpace:{value:K.boundarySpace},velocity:{value:K.src.texture},velocity_new:{value:K.dst_.texture},v:{value:K.viscous},px:{value:K.cellScale},dt:{value:K.dt}}},output:K.dst,output0:K.dst_,output1:K.dst}),this.init()}update({viscous:K,iterations:ge,dt:Te}){let Le,Pe;this.uniforms.v.value=K;for(let De=0;De<ge;De++)De%2===0?(Le=this.props.output0,Pe=this.props.output1):(Le=this.props.output1,Pe=this.props.output0),this.uniforms.velocity_new.value=Le.texture,this.props.output=Pe,this.uniforms.dt.value=Te,super.update();return Pe}}class J extends Ne{constructor(K){super({material:{vertexShader:N,fragmentShader:te,uniforms:{boundarySpace:{value:K.boundarySpace},velocity:{value:K.src.texture},px:{value:K.cellScale},dt:{value:K.dt}}},output:K.dst}),this.init()}update({vel:K}){this.uniforms.velocity.value=K.texture,super.update()}}class he extends Ne{constructor(K){super({material:{vertexShader:N,fragmentShader:me,uniforms:{boundarySpace:{value:K.boundarySpace},pressure:{value:K.dst_.texture},divergence:{value:K.src.texture},px:{value:K.cellScale}}},output:K.dst,output0:K.dst_,output1:K.dst}),this.init()}update({iterations:K}){let ge,Te;for(let Le=0;Le<K;Le++)Le%2===0?(ge=this.props.output0,Te=this.props.output1):(ge=this.props.output1,Te=this.props.output0),this.uniforms.pressure.value=ge.texture,this.props.output=Te,super.update();return Te}}class de extends Ne{constructor(K){super({material:{vertexShader:N,fragmentShader:_e,uniforms:{boundarySpace:{value:K.boundarySpace},pressure:{value:K.src_p.texture},velocity:{value:K.src_v.texture},px:{value:K.cellScale},dt:{value:K.dt}}},output:K.dst}),this.init()}update({vel:K,pressure:ge}){this.uniforms.velocity.value=K.texture,this.uniforms.pressure.value=ge.texture,super.update()}}class Ie{constructor(K){this.options={iterations_poisson:32,iterations_viscous:32,mouse_force:20,resolution:.5,cursor_size:100,viscous:30,isBounce:!1,dt:.014,isViscous:!1,BFECC:!0,...K},this.fbos={vel_0:null,vel_1:null,vel_viscous0:null,vel_viscous1:null,div:null,pressure_0:null,pressure_1:null},this.fboSize=new Me,this.cellScale=new Me,this.boundarySpace=new Me,this.init()}init(){this.calcSize(),this.createAllFBO(),this.createShaderPass()}getFloatType(){return/(iPad|iPhone|iPod)/i.test(navigator.userAgent)?Nc:zs}createAllFBO(){const ge={type:this.getFloatType(),depthBuffer:!1,stencilBuffer:!1,minFilter:bn,magFilter:bn,wrapS:Cr,wrapT:Cr};for(let Te in this.fbos)this.fbos[Te]=new Br(this.fboSize.x,this.fboSize.y,ge)}createShaderPass(){this.advection=new Ue({cellScale:this.cellScale,fboSize:this.fboSize,dt:this.options.dt,src:this.fbos.vel_0,dst:this.fbos.vel_1}),this.externalForce=new We({cellScale:this.cellScale,cursor_size:this.options.cursor_size,dst:this.fbos.vel_1}),this.viscous=new Be({cellScale:this.cellScale,boundarySpace:this.boundarySpace,viscous:this.options.viscous,src:this.fbos.vel_1,dst:this.fbos.vel_viscous1,dst_:this.fbos.vel_viscous0,dt:this.options.dt}),this.divergence=new J({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src:this.fbos.vel_viscous0,dst:this.fbos.div,dt:this.options.dt}),this.poisson=new he({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src:this.fbos.div,dst:this.fbos.pressure_1,dst_:this.fbos.pressure_0}),this.pressure=new de({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src_p:this.fbos.pressure_0,src_v:this.fbos.vel_viscous0,dst:this.fbos.vel_0,dt:this.options.dt})}calcSize(){const K=Math.max(1,Math.round(this.options.resolution*F.width)),ge=Math.max(1,Math.round(this.options.resolution*F.height)),Te=1/K,Le=1/ge;this.cellScale.set(Te,Le),this.fboSize.set(K,ge)}resize(){this.calcSize();for(let K in this.fbos)this.fbos[K].setSize(this.fboSize.x,this.fboSize.y)}update(){this.options.isBounce?this.boundarySpace.set(0,0):this.boundarySpace.copy(this.cellScale),this.advection.update({dt:this.options.dt,isBounce:this.options.isBounce,BFECC:this.options.BFECC}),this.externalForce.update({cursor_size:this.options.cursor_size,mouse_force:this.options.mouse_force,cellScale:this.cellScale});let K=this.fbos.vel_1;this.options.isViscous&&(K=this.viscous.update({viscous:this.options.viscous,iterations:this.options.iterations_viscous,dt:this.options.dt})),this.divergence.update({vel:K});const ge=this.poisson.update({iterations:this.options.iterations_poisson});this.pressure.update({vel:K,pressure:ge})}}class ve{constructor(){this.init()}init(){this.simulation=new Ie,this.scene=new mu,this.camera=new _h,this.output=new Qn(new yl(2,2),new ap({vertexShader:N,fragmentShader:ee,transparent:!0,depthWrite:!1,uniforms:{velocity:{value:this.simulation.fbos.vel_0.texture},boundarySpace:{value:new Me},palette:{value:k},bgColor:{value:L}}})),this.scene.add(this.output)}addScene(K){this.scene.add(K)}resize(){this.simulation.resize()}render(){F.renderer.setRenderTarget(null),F.renderer.render(this.scene,this.camera)}update(){this.simulation.update(),this.render()}}class oe{constructor(K){this.props=K,F.init(K.$wrapper),W.init(K.$wrapper),W.autoIntensity=K.autoIntensity,W.takeoverDuration=K.takeoverDuration,this.lastUserInteraction=performance.now(),W.onInteract=()=>{this.lastUserInteraction=performance.now(),this.autoDriver&&this.autoDriver.forceStop()},this.autoDriver=new G(W,this,{enabled:K.autoDemo,speed:K.autoSpeed,resumeDelay:K.autoResumeDelay,rampDuration:K.autoRampDuration}),this.init(),this._loop=this.loop.bind(this),this._resize=this.resize.bind(this),window.addEventListener("resize",this._resize),this._onVisibility=()=>{document.hidden?this.pause():P.current&&this.start()},document.addEventListener("visibilitychange",this._onVisibility),this.running=!1}init(){this.props.$wrapper.prepend(F.renderer.domElement),this.output=new ve}resize(){F.resize(),this.output.resize()}render(){this.autoDriver&&this.autoDriver.update(),W.update(),F.update(),this.output.update()}loop(){this.running&&(this.render(),M.current=requestAnimationFrame(this._loop))}start(){this.running||(this.running=!0,this._loop())}pause(){this.running=!1,M.current&&(cancelAnimationFrame(M.current),M.current=null)}dispose(){try{if(window.removeEventListener("resize",this._resize),document.removeEventListener("visibilitychange",this._onVisibility),W.dispose(),F.renderer){const K=F.renderer.domElement;K&&K.parentNode&&K.parentNode.removeChild(K),F.renderer.dispose()}}catch{}}}const ze=w.current;ze.style.position=ze.style.position||"relative",ze.style.overflow=ze.style.overflow||"hidden";const X=new oe({$wrapper:ze,autoDemo:d,autoSpeed:p,autoIntensity:y,takeoverDuration:x,autoResumeDelay:m,autoRampDuration:_});b.current=X,(()=>{var ge;if(!b.current)return;const Se=(ge=b.current.output)==null?void 0:ge.simulation;if(!Se)return;const K=Se.options.resolution;Object.assign(Se.options,{mouse_force:n,cursor_size:e,isViscous:t,viscous:r,iterations_viscous:i,iterations_poisson:s,dt:o,BFECC:a,resolution:l,isBounce:u}),l!==K&&Se.resize()})(),X.start();const ae=new IntersectionObserver(Se=>{const K=Se[0],ge=K.isIntersecting&&K.intersectionRatio>0;P.current=ge,b.current&&(ge&&!document.hidden?b.current.start():b.current.pause())},{threshold:[0,.01,.1]});ae.observe(ze),T.current=ae;const Oe=new ResizeObserver(()=>{b.current&&(C.current&&cancelAnimationFrame(C.current),C.current=requestAnimationFrame(()=>{b.current&&b.current.resize()}))});return Oe.observe(ze),S.current=Oe,()=>{if(M.current&&cancelAnimationFrame(M.current),S.current)try{S.current.disconnect()}catch{}if(T.current)try{T.current.disconnect()}catch{}b.current&&b.current.dispose(),b.current=null}},[a,e,o,u,t,s,i,n,l,r,c,d,p,y,x,m,_]),U.useEffect(()=>{var H;const A=b.current;if(!A)return;const k=(H=A.output)==null?void 0:H.simulation;if(!k)return;const L=k.options.resolution;Object.assign(k.options,{mouse_force:n,cursor_size:e,isViscous:t,viscous:r,iterations_viscous:i,iterations_poisson:s,dt:o,BFECC:a,resolution:l,isBounce:u}),A.autoDriver&&(A.autoDriver.enabled=d,A.autoDriver.speed=p,A.autoDriver.resumeDelay=m,A.autoDriver.rampDurationMs=_*1e3,A.autoDriver.mouse&&(A.autoDriver.mouse.autoIntensity=y,A.autoDriver.mouse.takeoverDuration=x)),l!==L&&k.resize()},[n,e,t,r,i,s,o,a,l,u,d,p,y,x,m,_]),z.jsx("div",{ref:w,className:`w-full h-full relative overflow-hidden pointer-events-none touch-none ${h||""}`,style:f})}const ode="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23a9bacd'%20d='M125%2050c-4-32-24-50-62-50C29%200%203%2024%203%2064c0%2039%2024%2064%2064%2064%2032%200%2055-19%2058-50H87c-2%2011-8%2020-20%2020-21%200-24-16-24-33%200-23%208-35%2022-35%2013%200%2020%207%2022%2020z'%20/%3e%3c/svg%3e",ade="data:image/svg+xml,%3csvg%20viewBox='0%200%20128%20128'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill='%2300599c'%20d='M118.766%2095.82c.89-1.543%201.441-3.28%201.441-4.843V36.78c0-1.558-.55-3.297-1.441-4.84l-55.32%2031.94Zm0%200'/%3e%3cpath%20fill='%23004482'%20d='m68.36%20126.586%2046.933-27.094c1.352-.781%202.582-2.129%203.473-3.672l-55.32-31.94L8.12%2095.82c.89%201.543%202.121%202.89%203.473%203.672l46.933%2027.094c2.703%201.562%207.13%201.562%209.832%200Zm0%200'/%3e%3cpath%20fill='%23659ad2'%20d='M118.766%2031.941c-.891-1.546-2.121-2.894-3.473-3.671L68.359%201.172c-2.703-1.563-7.129-1.563-9.832%200L11.594%2028.27C8.89%2029.828%206.68%2033.66%206.68%2036.78v54.196c0%201.562.55%203.3%201.441%204.843L63.445%2063.88Zm0%200'/%3e%3cpath%20fill='%23fff'%20d='M63.445%2026.035c-20.867%200-37.843%2016.977-37.843%2037.844s16.976%2037.844%2037.843%2037.844c13.465%200%2026.024-7.247%2032.77-18.91L79.84%2073.335c-3.38%205.84-9.66%209.465-16.395%209.465-10.433%200-18.922-8.488-18.922-18.922%200-10.434%208.49-18.922%2018.922-18.922%206.73%200%2013.017%203.629%2016.39%209.465l16.38-9.477c-6.75-11.664-19.305-18.91-32.77-18.91zM92.88%2057.57v4.207h-4.207v4.203h4.207v4.207h4.203V65.98h4.203v-4.203h-4.203V57.57H92.88zm15.766%200v4.207h-4.204v4.203h4.204v4.207h4.207V65.98h4.203v-4.203h-4.203V57.57h-4.207z'/%3e%3c/svg%3e",lde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cg%20fill='%2300c4cc'%3e%3cpath%20d='M59.39.152c-.484.051-1.995.23-3.328.387-5.374.613-11.468%202.227-16.816%204.48C19.891%2013.106%205.324%2030.849%201.305%2051.2.359%2056.04.129%2058.418.129%2064c0%207.195.715%2012.16%202.61%2018.434%206.195%2020.53%2022.323%2036.632%2042.906%2042.851%206.195%201.871%2011.187%202.586%2018.355%202.586%207.195%200%2012.16-.715%2018.434-2.61%2020.53-6.195%2036.632-22.323%2042.851-42.906%201.871-6.195%202.586-11.187%202.586-18.355%200-3.047-.152-6.527-.332-7.809-2.074-14.796-8.168-27.238-18.328-37.402C99.07%208.703%2086.68%202.586%2072.19.512c-1.996-.282-11.238-.54-12.8-.36zm-20.863%2040.32c1.36.41%201.996.794%202.918%201.715%201.793%201.82%202.203%202.817%202.203%205.555%200%202.051-.078%202.434-.691%203.508-1.18%201.996-3.918%203.84-5.812%203.89-1.333.028-1.278-.562.18-2.097%201.945-2.023%202.226-2.79%202.226-5.813-.024-2.917-.383-3.914-1.739-4.734-1.128-.691-2.355-.64-4.148.203-4.66%202.23-9.703%209.653-11.672%2017.258-2.613%2010.137%202.02%2018.25%209.649%2016.867%202.226-.41%206.425-2.558%208.246-4.25%201.508-1.379%201.508-1.406%201.66-3.12.336-3.587%202.867-7.169%206.25-8.833%201.558-.77%201.945-.844%204.043-.844%201.996%200%202.457.102%203.43.637%203.097%201.77%202.457%205.89-.895%205.89-1.945%200-2.945-1-1.535-1.534%201.383-.512.867-2.434-.742-2.868-1.895-.488-4.047.793-5.403%203.25-1.64%202.97-1.715%206.504-.156%208.114%201.512%201.613%203.406.336%204.867-3.329.766-1.867%201.867-2.867%203.149-2.867%201.125%200%201.332.692.843%202.793-.718%203.25-.23%204.094%201.793%203.098.664-.309%201.766-1.023%202.43-1.535l1.254-1%20.848-4.43c.922-4.965%201.277-5.633%203.172-5.988%201.82-.336%202.23.562%201.562%203.402l-.36%201.59%201.333-1.36c3.148-3.226%207.015-4.812%208.347-3.48.715.715.637%201.613-.386%204.785-.485%201.512-1.153%203.895-1.457%205.25-.461%202.047-.489%202.535-.23%202.868.82.972%203.327-.028%205.554-2.204l1.305-1.277.156-2.844c.152-3.277.457-4.453%201.328-5.504.82-.972%202.305-1.687%203.098-1.484.793.207.793.973.078%203.227-1%203.097-.895%2010.238.129%2010.238.41%200%202.507-2.2%203.84-4.043l.996-1.36-.793-.816c-1.383-1.46-1.715-2.406-1.715-4.789%200-1.738.129-2.379.562-3.227.719-1.328%201.844-2.3%203.176-2.687%201.406-.434%203.148.281%203.863%201.562.719%201.305.54%204.223-.383%206.223l-.664%201.457h.895c1.23%200%201.715-.305%203.918-2.379%201.152-1.101%202.484-2.05%203.48-2.511%203.918-1.84%208.528-.895%209.293%201.921.64%202.254-.765%203.84-3.226%203.66-1.766-.128-2.098-.59-1.074-1.456%201.843-1.54%200-3.508-2.637-2.793-1.434.386-3.047%201.996-3.89%203.867-1.692%203.738-.794%208.14%201.636%208.14.973%200%202.691-1.921%203.355-3.789.793-2.152%202.457-3.507%203.711-3.02.692.255.743.946.309%203.122-.488%202.383-.563%204.61-.18%205.633.153.382.614%201.101%201.051%201.586.816.921.844%201.254.152%201.691-.332.23-.77.129-1.843-.46-1.485-.77-2.766-2.153-3.227-3.458l-.281-.766-1.024.766c-.59.41-1.511.871-2.047%201.023-2.125.563-4.738-.894-5.964-3.351-.489-.95-.641-3.738-.282-4.813.204-.59.204-.59-.617-.18-.433.231-1.355.485-2.07.563-1.18.13-1.36.258-2.535%201.742-1.664%202.07-4.61%204.864-5.813%205.454-2.558%201.277-3.402.918-4.07-1.72l-.461-1.765-1.102.973c-1.406%201.23-4.222%202.715-5.836%203.074-1.535.332-3.175-.156-3.84-1.18-.995-1.535-.663-4.785.922-9.164%201.176-3.25.333-3.3-2.636-.203-2.203%202.328-3.149%203.992-3.762%206.578-.64%202.688-1.41%203.66-3.148%204.07-1.051.231-1.54-.41-1.332-1.816l.152-1.129-.973.668c-1.383.946-3.125%201.817-4.328%202.149-1.203.332-2.789-.024-3.172-.692-.691-1.175-.691-1.175-1.765-.332-2.332%201.895-5.66%201.356-7.348-1.152l-.54-.793-1.687%201.562c-4.867%204.454-10.957%206.45-15.464%205.067-5.735-1.738-8.907-6.656-8.856-13.746.024-7.117%203.172-14.617%208.473-20.172%202.996-3.125%205.812-4.969%208.68-5.66%202.07-.512%203.328-.485%205.296.129zm0%200'/%3e%3cpath%20d='M90.418%2058.676c-.563.562-.356%202.816.36%204.25.359.742.742%201.332.87%201.332.102%200%20.332-.59.512-1.309.64-2.66-.512-5.504-1.742-4.273zm0%200'/%3e%3c/g%3e%3c/svg%3e",ude="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%231572B6'%20d='M18.814%20114.123L8.76%201.352h110.48l-10.064%20112.754-45.243%2012.543-45.119-12.526z'/%3e%3cpath%20fill='%2333A9DC'%20d='M64.001%20117.062l36.559-10.136%208.601-96.354h-45.16v106.49z'/%3e%3cpath%20fill='%23fff'%20d='M64.001%2051.429h18.302l1.264-14.163H64.001V23.435h34.682l-.332%203.711-3.4%2038.114h-30.95V51.429z'/%3e%3cpath%20fill='%23EBEBEB'%20d='M64.083%2087.349l-.061.018-15.403-4.159-.985-11.031H33.752l1.937%2021.717%2028.331%207.863.063-.018v-14.39z'/%3e%3cpath%20fill='%23fff'%20d='M81.127%2064.675l-1.666%2018.522-15.426%204.164v14.39l28.354-7.858.208-2.337%202.406-26.881H81.127z'/%3e%3cpath%20fill='%23EBEBEB'%20d='M64.048%2023.435v13.831H30.64l-.277-3.108-.63-7.012-.331-3.711h34.646zm-.047%2027.996v13.831H48.792l-.277-3.108-.631-7.012-.33-3.711h16.447z'/%3e%3c/svg%3e",cde="/assets/docker-DLqjD3tf.svg",fde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20d='M126.67%2098.44c-4.56%201.16-7.38.05-9.91-3.75-5.68-8.51-11.95-16.63-18-24.9-.78-1.07-1.59-2.12-2.6-3.45C89%2076%2081.85%2085.2%2075.14%2094.77c-2.4%203.42-4.92%204.91-9.4%203.7l26.92-36.13L67.6%2029.71c4.31-.84%207.29-.41%209.93%203.45%205.83%208.52%2012.26%2016.63%2018.67%2025.21%206.45-8.55%2012.8-16.67%2018.8-25.11%202.41-3.42%205-4.72%209.33-3.46-3.28%204.35-6.49%208.63-9.72%2012.88-4.36%205.73-8.64%2011.53-13.16%2017.14-1.61%202-1.35%203.3.09%205.19C109.9%2076%20118.16%2087.1%20126.67%2098.44zM1.33%2061.74c.72-3.61%201.2-7.29%202.2-10.83%206-21.43%2030.6-30.34%2047.5-17.06C60.93%2041.64%2063.39%2052.62%2062.9%2065H7.1c-.84%2022.21%2015.15%2035.62%2035.53%2028.78%207.15-2.4%2011.36-8%2013.47-15%201.07-3.51%202.84-4.06%206.14-3.06-1.69%208.76-5.52%2016.08-13.52%2020.66-12%206.86-29.13%204.64-38.14-4.89C5.26%2085.89%203%2078.92%202%2071.39c-.15-1.2-.46-2.38-.7-3.57q.03-3.04.03-6.08zm5.87-1.49h50.43c-.33-16.06-10.33-27.47-24-27.57-15-.12-25.78%2011.02-26.43%2027.57z'/%3e%3c/svg%3e",hde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%230acf83'%20d='M45.5%20129c11.9%200%2021.5-9.6%2021.5-21.5V86H45.5C33.6%2086%2024%2095.6%2024%20107.5S33.6%20129%2045.5%20129zm0%200'/%3e%3cpath%20fill='%23a259ff'%20d='M24%2064.5C24%2052.6%2033.6%2043%2045.5%2043H67v43H45.5C33.6%2086%2024%2076.4%2024%2064.5zm0%200'/%3e%3cpath%20fill='%23f24e1e'%20d='M24%2021.5C24%209.6%2033.6%200%2045.5%200H67v43H45.5C33.6%2043%2024%2033.4%2024%2021.5zm0%200'/%3e%3cpath%20fill='%23ff7262'%20d='M67%200h21.5C100.4%200%20110%209.6%20110%2021.5S100.4%2043%2088.5%2043H67zm0%200'/%3e%3cpath%20fill='%231abcfe'%20d='M110%2064.5c0%2011.9-9.6%2021.5-21.5%2021.5S67%2076.4%2067%2064.5%2076.6%2043%2088.5%2043%20110%2052.6%20110%2064.5zm0%200'/%3e%3c/svg%3e",dde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23F34F29'%20d='M124.737%2058.378L69.621%203.264c-3.172-3.174-8.32-3.174-11.497%200L46.68%2014.71l14.518%2014.518c3.375-1.139%207.243-.375%209.932%202.314%202.703%202.706%203.461%206.607%202.294%209.993l13.992%2013.993c3.385-1.167%207.292-.413%209.994%202.295%203.78%203.777%203.78%209.9%200%2013.679a9.673%209.673%200%2001-13.683%200%209.677%209.677%200%2001-2.105-10.521L68.574%2047.933l-.002%2034.341a9.708%209.708%200%20012.559%201.828c3.778%203.777%203.778%209.898%200%2013.683-3.779%203.777-9.904%203.777-13.679%200-3.778-3.784-3.778-9.905%200-13.683a9.65%209.65%200%20013.167-2.11V47.333a9.581%209.581%200%2001-3.167-2.111c-2.862-2.86-3.551-7.06-2.083-10.576L41.056%2020.333%203.264%2058.123a8.133%208.133%200%20000%2011.5l55.117%2055.114c3.174%203.174%208.32%203.174%2011.499%200l54.858-54.858a8.135%208.135%200%2000-.001-11.501z'/%3e%3c/svg%3e",pde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cg%20fill='%23181616'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M64%205.103c-33.347%200-60.388%2027.035-60.388%2060.388%200%2026.682%2017.303%2049.317%2041.297%2057.303%203.017.56%204.125-1.31%204.125-2.905%200-1.44-.056-6.197-.082-11.243-16.8%203.653-20.345-7.125-20.345-7.125-2.747-6.98-6.705-8.836-6.705-8.836-5.48-3.748.413-3.67.413-3.67%206.063.425%209.257%206.223%209.257%206.223%205.386%209.23%2014.127%206.562%2017.573%205.02.542-3.903%202.107-6.568%203.834-8.076-13.413-1.525-27.514-6.704-27.514-29.843%200-6.593%202.36-11.98%206.223-16.21-.628-1.52-2.695-7.662.584-15.98%200%200%205.07-1.623%2016.61%206.19C53.7%2035%2058.867%2034.327%2064%2034.304c5.13.023%2010.3.694%2015.127%202.033%2011.526-7.813%2016.59-6.19%2016.59-6.19%203.287%208.317%201.22%2014.46.593%2015.98%203.872%204.23%206.215%209.617%206.215%2016.21%200%2023.194-14.127%2028.3-27.574%2029.796%202.167%201.874%204.097%205.55%204.097%2011.183%200%208.08-.07%2014.583-.07%2016.572%200%201.607%201.088%203.49%204.148%202.897%2023.98-7.994%2041.263-30.622%2041.263-57.294C124.388%2032.14%2097.35%205.104%2064%205.104z'/%3e%3cpath%20d='M26.484%2091.806c-.133.3-.605.39-1.035.185-.44-.196-.685-.605-.543-.906.13-.31.603-.395%201.04-.188.44.197.69.61.537.91zm2.446%202.729c-.287.267-.85.143-1.232-.28-.396-.42-.47-.983-.177-1.254.298-.266.844-.14%201.24.28.394.426.472.984.17%201.255zM31.312%2098.012c-.37.258-.976.017-1.35-.52-.37-.538-.37-1.183.01-1.44.373-.258.97-.025%201.35.507.368.545.368%201.19-.01%201.452zm3.261%203.361c-.33.365-1.036.267-1.552-.23-.527-.487-.674-1.18-.343-1.544.336-.366%201.045-.264%201.564.23.527.486.686%201.18.333%201.543zm4.5%201.951c-.147.473-.825.688-1.51.486-.683-.207-1.13-.76-.99-1.238.14-.477.823-.7%201.512-.485.683.206%201.13.756.988%201.237zm4.943.361c.017.498-.563.91-1.28.92-.723.017-1.308-.387-1.315-.877%200-.503.568-.91%201.29-.924.717-.013%201.306.387%201.306.88zm4.598-.782c.086.485-.413.984-1.126%201.117-.7.13-1.35-.172-1.44-.653-.086-.498.422-.997%201.122-1.126.714-.123%201.354.17%201.444.663zm0%200'/%3e%3c/g%3e%3c/svg%3e",mde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23E44D26'%20d='M19.037%20113.876L9.032%201.661h109.936l-10.016%20112.198-45.019%2012.48z'/%3e%3cpath%20fill='%23F16529'%20d='M64%20116.8l36.378-10.086%208.559-95.878H64z'/%3e%3cpath%20fill='%23EBEBEB'%20d='M64%2052.455H45.788L44.53%2038.361H64V24.599H29.489l.33%203.692%203.382%2037.927H64zm0%2035.743l-.061.017-15.327-4.14-.979-10.975H33.816l1.928%2021.609%2028.193%207.826.063-.017z'/%3e%3cpath%20fill='%23fff'%20d='M63.952%2052.455v13.763h16.947l-1.597%2017.849-15.35%204.143v14.319l28.215-7.82.207-2.325%203.234-36.233.335-3.696h-3.708zm0-27.856v13.762h33.244l.276-3.092.628-6.978.329-3.692z'/%3e%3c/svg%3e",gde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%230074BD'%20d='M47.617%2098.12s-4.767%202.774%203.397%203.71c9.892%201.13%2014.947.968%2025.845-1.092%200%200%202.871%201.795%206.873%203.351-24.439%2010.47-55.308-.607-36.115-5.969zm-2.988-13.665s-5.348%203.959%202.823%204.805c10.567%201.091%2018.91%201.18%2033.354-1.6%200%200%201.993%202.025%205.132%203.131-29.542%208.64-62.446.68-41.309-6.336z'/%3e%3cpath%20fill='%23EA2D2E'%20d='M69.802%2061.271c6.025%206.935-1.58%2013.17-1.58%2013.17s15.289-7.891%208.269-17.777c-6.559-9.215-11.587-13.792%2015.635-29.58%200%20.001-42.731%2010.67-22.324%2034.187z'/%3e%3cpath%20fill='%230074BD'%20d='M102.123%20108.229s3.529%202.91-3.888%205.159c-14.102%204.272-58.706%205.56-71.094.171-4.451-1.938%203.899-4.625%206.526-5.192%202.739-.593%204.303-.485%204.303-.485-4.953-3.487-32.013%206.85-13.743%209.815%2049.821%208.076%2090.817-3.637%2077.896-9.468zM49.912%2070.294s-22.686%205.389-8.033%207.348c6.188.828%2018.518.638%2030.011-.326%209.39-.789%2018.813-2.474%2018.813-2.474s-3.308%201.419-5.704%203.053c-23.042%206.061-67.544%203.238-54.731-2.958%2010.832-5.239%2019.644-4.643%2019.644-4.643zm40.697%2022.747c23.421-12.167%2012.591-23.86%205.032-22.285-1.848.385-2.677.72-2.677.72s.688-1.079%202-1.543c14.953-5.255%2026.451%2015.503-4.823%2023.725%200-.002.359-.327.468-.617z'/%3e%3cpath%20fill='%23EA2D2E'%20d='M76.491%201.587S89.459%2014.563%2064.188%2034.51c-20.266%2016.006-4.621%2025.13-.007%2035.559-11.831-10.673-20.509-20.07-14.688-28.815C58.041%2028.42%2081.722%2022.195%2076.491%201.587z'/%3e%3cpath%20fill='%230074BD'%20d='M52.214%20126.021c22.476%201.437%2057-.8%2057.817-11.436%200%200-1.571%204.032-18.577%207.231-19.186%203.612-42.854%203.191-56.887.874%200%20.001%202.875%202.381%2017.647%203.331z'/%3e%3c/svg%3e",vde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23F0DB4F'%20d='M1.408%201.408h125.184v125.185H1.408z'/%3e%3cpath%20fill='%23323330'%20d='M116.347%2096.736c-.917-5.711-4.641-10.508-15.672-14.981-3.832-1.761-8.104-3.022-9.377-5.926-.452-1.69-.512-2.642-.226-3.665.821-3.32%204.784-4.355%207.925-3.403%202.023.678%203.938%202.237%205.093%204.724%205.402-3.498%205.391-3.475%209.163-5.879-1.381-2.141-2.118-3.129-3.022-4.045-3.249-3.629-7.676-5.498-14.756-5.355l-3.688.477c-3.534.893-6.902%202.748-8.877%205.235-5.926%206.724-4.236%2018.492%202.975%2023.335%207.104%205.332%2017.54%206.545%2018.873%2011.531%201.297%206.104-4.486%208.08-10.234%207.378-4.236-.881-6.592-3.034-9.139-6.949-4.688%202.713-4.688%202.713-9.508%205.485%201.143%202.499%202.344%203.63%204.26%205.795%209.068%209.198%2031.76%208.746%2035.83-5.176.165-.478%201.261-3.666.38-8.581zM69.462%2058.943H57.753l-.048%2030.272c0%206.438.333%2012.34-.714%2014.149-1.713%203.558-6.152%203.117-8.175%202.427-2.059-1.012-3.106-2.451-4.319-4.485-.333-.584-.583-1.036-.667-1.071l-9.52%205.83c1.583%203.249%203.915%206.069%206.902%207.901%204.462%202.678%2010.459%203.499%2016.731%202.059%204.082-1.189%207.604-3.652%209.448-7.401%202.666-4.915%202.094-10.864%202.07-17.444.06-10.735.001-21.468.001-32.237z'/%3e%3c/svg%3e",yde="/assets/linux-BsaQAsRn.svg",xde="/assets/matplotlib-HPIvE-Qa.svg",_de="/assets/mongodb-Dijo5B3J.svg",wde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='url(%23a)'%20d='M66.958.825a6.07%206.07%200%200%200-6.035%200L11.103%2029.76c-1.895%201.072-2.96%203.095-2.96%205.24v57.988c0%202.143%201.183%204.167%202.958%205.24l49.82%2028.934a6.07%206.07%200%200%200%206.036%200l49.82-28.935c1.894-1.072%202.958-3.096%202.958-5.24V35c0-2.144-1.183-4.167-2.958-5.24z'/%3e%3cpath%20fill='url(%23b)'%20d='M116.897%2029.76%2066.841.825A8.161%208.161%200%200%200%2065.302.23L9.21%2096.798a6.251%206.251%200%200%200%201.657%201.43l50.057%2028.934c1.42.833%203.076%201.072%204.615.595l52.66-96.925a3.702%203.702%200%200%200-1.302-1.072z'/%3e%3cpath%20fill='url(%23c)'%20d='M116.898%2098.225c1.42-.833%202.485-2.262%202.958-3.81L65.066.108c-1.42-.238-2.959-.119-4.26.715L11.104%2029.639l53.606%2098.355c.71-.12%201.54-.358%202.25-.715z'/%3e%3cdefs%3e%3clinearGradient%20id='a'%20x1='34.513'%20x2='27.157'%20y1='15.535'%20y2='30.448'%20gradientTransform='translate(-129.242%20-73.715)%20scale(6.18523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%233F873F'/%3e%3cstop%20offset='.33'%20stop-color='%233F8B3D'/%3e%3cstop%20offset='.637'%20stop-color='%233E9638'/%3e%3cstop%20offset='.934'%20stop-color='%233DA92E'/%3e%3cstop%20offset='1'%20stop-color='%233DAE2B'/%3e%3c/linearGradient%3e%3clinearGradient%20id='b'%20x1='30.009'%20x2='50.533'%20y1='23.359'%20y2='8.288'%20gradientTransform='translate(-129.242%20-73.715)%20scale(6.18523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='.138'%20stop-color='%233F873F'/%3e%3cstop%20offset='.402'%20stop-color='%2352A044'/%3e%3cstop%20offset='.713'%20stop-color='%2364B749'/%3e%3cstop%20offset='.908'%20stop-color='%236ABF4B'/%3e%3c/linearGradient%3e%3clinearGradient%20id='c'%20x1='21.917'%20x2='40.555'%20y1='22.261'%20y2='22.261'%20gradientTransform='translate(-129.242%20-73.715)%20scale(6.18523)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='.092'%20stop-color='%236ABF4B'/%3e%3cstop%20offset='.287'%20stop-color='%2364B749'/%3e%3cstop%20offset='.598'%20stop-color='%2352A044'/%3e%3cstop%20offset='.862'%20stop-color='%233F873F'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",bde="/assets/notion-CikWTPeg.svg",Sde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%234DABCF'%20d='m55.012%2026.006-21.38-10.789L10.154%2026.93l21.969%2011.027Zm9.808%204.951L87.241%2042.28%2063.982%2053.955l-22-11.043Zm29.948-15.581%2023.037%2011.552L97.2%2037.272%2074.735%2025.938ZM84.853%2010.4%2064.113%200%2043.598%2010.24%2064.97%2021.014ZM68.64%2099.702V128l25.122-12.537-.023-28.31ZM93.727%2077.27l-.028-28.012-25.06%2012.458V89.74Zm30.158-5.246v28.41l-21.43%2010.69-.017-28.279zm0-9.935V34.25l-21.47%2010.673.016%2028.068z'/%3e%3cpath%20fill='%234c75cf'%20d='m59.77%2061.716-16.918-8.512V89.97s-20.7-44.033-22.612-47.99c-.246-.513-1.263-1.07-1.522-1.209-3.731-1.947-14.603-7.45-14.603-7.45v64.977l15.04%208.063V72.382s20.478%2039.346%2020.689%2039.78c.214.429%202.257%204.57%204.459%206.028%202.92%201.939%2015.458%209.477%2015.458%209.477z'%20/%3e%3c/svg%3e",Ede="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23130754'%20d='M46.236%207.567h13.99v29.047h-13.99Zm0%2059.668h13.99V96.28h-13.99Z'/%3e%3cpath%20fill='%23ffca00'%20d='M46.236%2045.092h13.99v13.705h-13.99Z'/%3e%3cpath%20fill='%23130754'%20d='M23.763%2031.446h13.989V128h-13.99ZM68.245%2091.2h13.99v29.046h-13.99Zm0-59.72h13.99v29.047h-13.99Z'/%3e%3cpath%20fill='%23e70488'%20d='M68.245%2069.011h13.99v13.705h-13.99Z'/%3e%3cpath%20fill='%23130754'%20d='M90.248%200h13.99v96.554h-13.99Z'/%3e%3c/svg%3e",Mde="/assets/postgresql-CTql7Pj9.svg",Tde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3clinearGradient%20id='python-original-a'%20gradientUnits='userSpaceOnUse'%20x1='70.252'%20y1='1237.476'%20x2='170.659'%20y2='1151.089'%20gradientTransform='matrix(.563%200%200%20-.568%20-29.215%20707.817)'%3e%3cstop%20offset='0'%20stop-color='%235A9FD4'/%3e%3cstop%20offset='1'%20stop-color='%23306998'/%3e%3c/linearGradient%3e%3clinearGradient%20id='python-original-b'%20gradientUnits='userSpaceOnUse'%20x1='209.474'%20y1='1098.811'%20x2='173.62'%20y2='1149.537'%20gradientTransform='matrix(.563%200%200%20-.568%20-29.215%20707.817)'%3e%3cstop%20offset='0'%20stop-color='%23FFD43B'/%3e%3cstop%20offset='1'%20stop-color='%23FFE873'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23python-original-a)'%20d='M63.391%201.988c-4.222.02-8.252.379-11.8%201.007-10.45%201.846-12.346%205.71-12.346%2012.837v9.411h24.693v3.137H29.977c-7.176%200-13.46%204.313-15.426%2012.521-2.268%209.405-2.368%2015.275%200%2025.096%201.755%207.311%205.947%2012.519%2013.124%2012.519h8.491V67.234c0-8.151%207.051-15.34%2015.426-15.34h24.665c6.866%200%2012.346-5.654%2012.346-12.548V15.833c0-6.693-5.646-11.72-12.346-12.837-4.244-.706-8.645-1.027-12.866-1.008zM50.037%209.557c2.55%200%204.634%202.117%204.634%204.721%200%202.593-2.083%204.69-4.634%204.69-2.56%200-4.633-2.097-4.633-4.69-.001-2.604%202.073-4.721%204.633-4.721z'%20transform='translate(0%2010.26)'/%3e%3cpath%20fill='url(%23python-original-b)'%20d='M91.682%2028.38v10.966c0%208.5-7.208%2015.655-15.426%2015.655H51.591c-6.756%200-12.346%205.783-12.346%2012.549v23.515c0%206.691%205.818%2010.628%2012.346%2012.547%207.816%202.297%2015.312%202.713%2024.665%200%206.216-1.801%2012.346-5.423%2012.346-12.547v-9.412H63.938v-3.138h37.012c7.176%200%209.852-5.005%2012.348-12.519%202.578-7.735%202.467-15.174%200-25.096-1.774-7.145-5.161-12.521-12.348-12.521h-9.268zM77.809%2087.927c2.561%200%204.634%202.097%204.634%204.692%200%202.602-2.074%204.719-4.634%204.719-2.55%200-4.633-2.117-4.633-4.719%200-2.595%202.083-4.692%204.633-4.692z'%20transform='translate(0%2010.26)'/%3e%3cradialGradient%20id='python-original-c'%20cx='1825.678'%20cy='444.45'%20r='26.743'%20gradientTransform='matrix(0%20-.24%20-1.055%200%20532.979%20557.576)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23B8B8B8'%20stop-opacity='.498'/%3e%3cstop%20offset='1'%20stop-color='%237F7F7F'%20stop-opacity='0'/%3e%3c/radialGradient%3e%3cpath%20opacity='.444'%20fill='url(%23python-original-c)'%20d='M97.309%20119.597c0%203.543-14.816%206.416-33.091%206.416-18.276%200-33.092-2.873-33.092-6.416%200-3.544%2014.815-6.417%2033.092-6.417%2018.275%200%2033.091%202.872%2033.091%206.417z'/%3e%3c/svg%3e",Cde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cg%20fill='%2361DAFB'%3e%3ccircle%20cx='64'%20cy='64'%20r='11.4'/%3e%3cpath%20d='M107.3%2045.2c-2.2-.8-4.5-1.6-6.9-2.3.6-2.4%201.1-4.8%201.5-7.1%202.1-13.2-.2-22.5-6.6-26.1-1.9-1.1-4-1.6-6.4-1.6-7%200-15.9%205.2-24.9%2013.9-9-8.7-17.9-13.9-24.9-13.9-2.4%200-4.5.5-6.4%201.6-6.4%203.7-8.7%2013-6.6%2026.1.4%202.3.9%204.7%201.5%207.1-2.4.7-4.7%201.4-6.9%202.3C8.2%2050%201.4%2056.6%201.4%2064s6.9%2014%2019.3%2018.8c2.2.8%204.5%201.6%206.9%202.3-.6%202.4-1.1%204.8-1.5%207.1-2.1%2013.2.2%2022.5%206.6%2026.1%201.9%201.1%204%201.6%206.4%201.6%207.1%200%2016-5.2%2024.9-13.9%209%208.7%2017.9%2013.9%2024.9%2013.9%202.4%200%204.5-.5%206.4-1.6%206.4-3.7%208.7-13%206.6-26.1-.4-2.3-.9-4.7-1.5-7.1%202.4-.7%204.7-1.4%206.9-2.3%2012.5-4.8%2019.3-11.4%2019.3-18.8s-6.8-14-19.3-18.8zM92.5%2014.7c4.1%202.4%205.5%209.8%203.8%2020.3-.3%202.1-.8%204.3-1.4%206.6-5.2-1.2-10.7-2-16.5-2.5-3.4-4.8-6.9-9.1-10.4-13%207.4-7.3%2014.9-12.3%2021-12.3%201.3%200%202.5.3%203.5.9zM81.3%2074c-1.8%203.2-3.9%206.4-6.1%209.6-3.7.3-7.4.4-11.2.4-3.9%200-7.6-.1-11.2-.4-2.2-3.2-4.2-6.4-6-9.6-1.9-3.3-3.7-6.7-5.3-10%201.6-3.3%203.4-6.7%205.3-10%201.8-3.2%203.9-6.4%206.1-9.6%203.7-.3%207.4-.4%2011.2-.4%203.9%200%207.6.1%2011.2.4%202.2%203.2%204.2%206.4%206%209.6%201.9%203.3%203.7%206.7%205.3%2010-1.7%203.3-3.4%206.6-5.3%2010zm8.3-3.3c1.5%203.5%202.7%206.9%203.8%2010.3-3.4.8-7%201.4-10.8%201.9%201.2-1.9%202.5-3.9%203.6-6%201.2-2.1%202.3-4.2%203.4-6.2zM64%2097.8c-2.4-2.6-4.7-5.4-6.9-8.3%202.3.1%204.6.2%206.9.2%202.3%200%204.6-.1%206.9-.2-2.2%202.9-4.5%205.7-6.9%208.3zm-18.6-15c-3.8-.5-7.4-1.1-10.8-1.9%201.1-3.3%202.3-6.8%203.8-10.3%201.1%202%202.2%204.1%203.4%206.1%201.2%202.2%202.4%204.1%203.6%206.1zm-7-25.5c-1.5-3.5-2.7-6.9-3.8-10.3%203.4-.8%207-1.4%2010.8-1.9-1.2%201.9-2.5%203.9-3.6%206-1.2%202.1-2.3%204.2-3.4%206.2zM64%2030.2c2.4%202.6%204.7%205.4%206.9%208.3-2.3-.1-4.6-.2-6.9-.2-2.3%200-4.6.1-6.9.2%202.2-2.9%204.5-5.7%206.9-8.3zm22.2%2021l-3.6-6c3.8.5%207.4%201.1%2010.8%201.9-1.1%203.3-2.3%206.8-3.8%2010.3-1.1-2.1-2.2-4.2-3.4-6.2zM31.7%2035c-1.7-10.5-.3-17.9%203.8-20.3%201-.6%202.2-.9%203.5-.9%206%200%2013.5%204.9%2021%2012.3-3.5%203.8-7%208.2-10.4%2013-5.8.5-11.3%201.4-16.5%202.5-.6-2.3-1-4.5-1.4-6.6zM7%2064c0-4.7%205.7-9.7%2015.7-13.4%202-.8%204.2-1.5%206.4-2.1%201.6%205%203.6%2010.3%206%2015.6-2.4%205.3-4.5%2010.5-6%2015.5C15.3%2075.6%207%2069.6%207%2064zm28.5%2049.3c-4.1-2.4-5.5-9.8-3.8-20.3.3-2.1.8-4.3%201.4-6.6%205.2%201.2%2010.7%202%2016.5%202.5%203.4%204.8%206.9%209.1%2010.4%2013-7.4%207.3-14.9%2012.3-21%2012.3-1.3%200-2.5-.3-3.5-.9zM96.3%2093c1.7%2010.5.3%2017.9-3.8%2020.3-1%20.6-2.2.9-3.5.9-6%200-13.5-4.9-21-12.3%203.5-3.8%207-8.2%2010.4-13%205.8-.5%2011.3-1.4%2016.5-2.5.6%202.3%201%204.5%201.4%206.6zm9-15.6c-2%20.8-4.2%201.5-6.4%202.1-1.6-5-3.6-10.3-6-15.6%202.4-5.3%204.5-10.5%206-15.5%2013.8%204%2022.1%2010%2022.1%2015.6%200%204.7-5.8%209.7-15.7%2013.4z'/%3e%3c/g%3e%3c/svg%3e",Ade="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%2300618A'%20d='M117.688%2098.242c-6.973-.191-12.297.461-16.852%202.379-1.293.547-3.355.559-3.566%202.18.711.746.82%201.859%201.387%202.777%201.086%201.754%202.922%204.113%204.559%205.352%201.789%201.348%203.633%202.793%205.551%203.961%203.414%202.082%207.223%203.27%2010.504%205.352%201.938%201.23%203.859%202.777%205.75%204.164.934.684%201.563%201.75%202.773%202.18v-.195c-.637-.812-.801-1.93-1.387-2.777l-2.578-2.578c-2.52-3.344-5.719-6.281-9.117-8.719-2.711-1.949-8.781-4.578-9.91-7.73l-.199-.199c1.922-.219%204.172-.914%205.949-1.391%202.98-.797%205.645-.59%208.719-1.387l4.164-1.187v-.793c-1.555-1.594-2.664-3.707-4.359-5.152-4.441-3.781-9.285-7.555-14.273-10.703-2.766-1.746-6.184-2.883-9.117-4.363-.988-.496-2.719-.758-3.371-1.586-1.539-1.961-2.379-4.449-3.566-6.738-2.488-4.793-4.93-10.023-7.137-15.066-1.504-3.437-2.484-6.828-4.359-9.91-9-14.797-18.687-23.73-33.695-32.508-3.195-1.867-7.039-2.605-11.102-3.57l-6.543-.395c-1.332-.555-2.715-2.184-3.965-2.977C16.977%203.52%204.223-3.312.539%205.672-1.785%2011.34%204.016%2016.871%206.09%2019.746c1.457%202.012%203.32%204.273%204.359%206.539.688%201.492.805%202.984%201.391%204.559%201.438%203.883%202.695%208.109%204.559%2011.695.941%201.816%201.98%203.727%203.172%205.352.727.996%201.98%201.438%202.18%202.973-1.227%201.715-1.297%204.375-1.984%206.543-3.098%209.77-1.926%2021.91%202.578%2029.137%201.383%202.223%204.641%206.98%209.117%205.156%203.918-1.598%203.043-6.539%204.164-10.902.254-.988.098-1.715.594-2.379v.199l3.57%207.133c2.641%204.254%207.324%208.699%2011.297%2011.699%202.059%201.555%203.68%204.242%206.344%205.152v-.199h-.199c-.516-.805-1.324-1.137-1.98-1.781-1.551-1.523-3.277-3.414-4.559-5.156-3.613-4.902-6.805-10.27-9.711-15.855-1.391-2.668-2.598-5.609-3.77-8.324-.453-1.047-.445-2.633-1.387-3.172-1.281%201.988-3.172%203.598-4.164%205.945-1.582%203.754-1.789%208.336-2.375%2013.082-.348.125-.195.039-.398.199-2.762-.668-3.73-3.508-4.758-5.949-2.594-6.164-3.078-16.09-.793-23.191.59-1.836%203.262-7.617%202.18-9.316-.516-1.691-2.219-2.672-3.172-3.965-1.18-1.598-2.355-3.703-3.172-5.551-2.125-4.805-3.113-10.203-5.352-15.062-1.07-2.324-2.875-4.676-4.359-6.738-1.645-2.289-3.484-3.977-4.758-6.742-.453-.984-1.066-2.559-.398-3.566.215-.684.516-.969%201.191-1.191%201.148-.887%204.352.297%205.547.793%203.18%201.32%205.832%202.578%208.527%204.363%201.289.855%202.598%202.512%204.16%202.973h1.785c2.789.641%205.914.195%208.523.988%204.609%201.402%208.738%203.582%2012.488%205.949%2011.422%207.215%2020.766%2017.48%2027.156%2029.734%201.027%201.973%201.473%203.852%202.379%205.945%201.824%204.219%204.125%208.559%205.941%2012.688%201.816%204.113%203.582%208.27%206.148%2011.695%201.348%201.801%206.551%202.766%208.918%203.766%201.66.699%204.379%201.43%205.949%202.379%203%201.809%205.906%203.965%208.723%205.945%201.402.992%205.73%203.168%205.945%204.957zm-88.605-75.52c-1.453-.027-2.48.156-3.566.395v.199h.195c.695%201.422%201.918%202.34%202.777%203.566l1.98%204.164.199-.195c1.227-.867%201.789-2.25%201.781-4.363-.492-.52-.562-1.164-.992-1.785-.562-.824-1.66-1.289-2.375-1.98zm0%200'/%3e%3c/svg%3e",Rde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20d='M64.004%2025.602c-17.067%200-27.73%208.53-32%2025.597%206.398-8.531%2013.867-11.73%2022.398-9.597%204.871%201.214%208.352%204.746%2012.207%208.66C72.883%2056.629%2080.145%2064%2096.004%2064c17.066%200%2027.73-8.531%2032-25.602-6.399%208.536-13.867%2011.735-22.399%209.602-4.87-1.215-8.347-4.746-12.207-8.66-6.27-6.367-13.53-13.738-29.394-13.738zM32.004%2064c-17.066%200-27.73%208.531-32%2025.602C6.402%2081.066%2013.87%2077.867%2022.402%2080c4.871%201.215%208.352%204.746%2012.207%208.66%206.274%206.367%2013.536%2013.738%2029.395%2013.738%2017.066%200%2027.73-8.53%2032-25.597-6.399%208.531-13.867%2011.73-22.399%209.597-4.87-1.214-8.347-4.746-12.207-8.66C55.128%2071.371%2047.868%2064%2032.004%2064zm0%200'%20fill='%2338bdf8'/%3e%3c/svg%3e",Pde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20128%20128'%3e%3cpath%20d='m61.55%20128-21.84-12.68V40.55L6.81%2059.56l.08-28.32L61.55%200zM66.46%200v128l21.84-12.68V79.31l16.49%209.53-.1-24.63-16.39-9.36v-14.3l32.89%2019.01-.08-28.32z'%20fill='%23ff6f00'%20/%3e%3c/svg%3e",Ide="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%23fff'%20d='M22.67%2047h99.67v73.67H22.67z'/%3e%3cpath%20data-name='original'%20fill='%23007acc'%20d='M1.5%2063.91v62.5h125v-125H1.5zm100.73-5a15.56%2015.56%200%20017.82%204.5%2020.58%2020.58%200%20013%204c0%20.16-5.4%203.81-8.69%205.85-.12.08-.6-.44-1.13-1.23a7.09%207.09%200%2000-5.87-3.53c-3.79-.26-6.23%201.73-6.21%205a4.58%204.58%200%2000.54%202.34c.83%201.73%202.38%202.76%207.24%204.86%208.95%203.85%2012.78%206.39%2015.16%2010%202.66%204%203.25%2010.46%201.45%2015.24-2%205.2-6.9%208.73-13.83%209.9a38.32%2038.32%200%2001-9.52-.1%2023%2023%200%2001-12.72-6.63c-1.15-1.27-3.39-4.58-3.25-4.82a9.34%209.34%200%20011.15-.73L82%20101l3.59-2.08.75%201.11a16.78%2016.78%200%20004.74%204.54c4%202.1%209.46%201.81%2012.16-.62a5.43%205.43%200%2000.69-6.92c-1-1.39-3-2.56-8.59-5-6.45-2.78-9.23-4.5-11.77-7.24a16.48%2016.48%200%2001-3.43-6.25%2025%2025%200%2001-.22-8c1.33-6.23%206-10.58%2012.82-11.87a31.66%2031.66%200%20019.49.26zm-29.34%205.24v5.12H56.66v46.23H45.15V69.26H28.88v-5a49.19%2049.19%200%2001.12-5.17C29.08%2059%2039%2059%2051%2059h21.83z'/%3e%3c/svg%3e",Dde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cmask%20id='a'%20width='128'%20height='128'%20x='0'%20y='0'%20maskUnits='userSpaceOnUse'%20style='mask-type:alpha'%3e%3cpath%20fill='%23fff'%20fill-rule='evenodd'%20d='M90.767%20127.126a7.968%207.968%200%200%200%206.35-.244l26.353-12.681a8%208%200%200%200%204.53-7.209V21.009a8%208%200%200%200-4.53-7.21L97.117%201.12a7.97%207.97%200%200%200-9.093%201.548l-50.45%2046.026L15.6%2032.013a5.328%205.328%200%200%200-6.807.302l-7.048%206.411a5.335%205.335%200%200%200-.006%207.888L20.796%2064%201.74%2081.387a5.336%205.336%200%200%200%20.006%207.887l7.048%206.411a5.327%205.327%200%200%200%206.807.303l21.974-16.68%2050.45%2046.025a7.96%207.96%200%200%200%202.743%201.793Zm5.252-92.183L57.74%2064l38.28%2029.058V34.943Z'%20clip-rule='evenodd'/%3e%3c/mask%3e%3cg%20mask='url(%23a)'%3e%3cpath%20fill='%230065A9'%20d='M123.471%2013.82%2097.097%201.12A7.973%207.973%200%200%200%2088%202.668L1.662%2081.387a5.333%205.333%200%200%200%20.006%207.887l7.052%206.411a5.333%205.333%200%200%200%206.811.303l103.971-78.875c3.488-2.646%208.498-.158%208.498%204.22v-.306a8.001%208.001%200%200%200-4.529-7.208Z'/%3e%3cg%20filter='url(%23b)'%3e%3cpath%20fill='%23007ACC'%20d='m123.471%20114.181-26.374%2012.698A7.973%207.973%200%200%201%2088%20125.333L1.662%2046.613a5.333%205.333%200%200%201%20.006-7.887l7.052-6.411a5.333%205.333%200%200%201%206.811-.303l103.971%2078.874c3.488%202.647%208.498.159%208.498-4.219v.306a8.001%208.001%200%200%201-4.529%207.208Z'/%3e%3c/g%3e%3cg%20filter='url(%23c)'%3e%3cpath%20fill='%231F9CF0'%20d='M97.098%20126.882A7.977%207.977%200%200%201%2088%20125.333c2.952%202.952%208%20.861%208-3.314V5.98c0-4.175-5.048-6.266-8-3.313a7.977%207.977%200%200%201%209.098-1.549L123.467%2013.8A8%208%200%200%201%20128%2021.01v85.982a8%208%200%200%201-4.533%207.21l-26.369%2012.681Z'/%3e%3c/g%3e%3cpath%20fill='url(%23d)'%20fill-rule='evenodd'%20d='M90.69%20127.126a7.968%207.968%200%200%200%206.349-.244l26.353-12.681a8%208%200%200%200%204.53-7.21V21.009a8%208%200%200%200-4.53-7.21L97.039%201.12a7.97%207.97%200%200%200-9.093%201.548l-50.45%2046.026-21.974-16.68a5.328%205.328%200%200%200-6.807.302l-7.048%206.411a5.336%205.336%200%200%200-.006%207.888L20.718%2064%201.662%2081.386a5.335%205.335%200%200%200%20.006%207.888l7.048%206.411a5.328%205.328%200%200%200%206.807.303l21.975-16.681%2050.45%2046.026a7.959%207.959%200%200%200%202.742%201.793Zm5.252-92.184L57.662%2064l38.28%2029.057V34.943Z'%20clip-rule='evenodd'%20opacity='0.25'%20style='mix-blend-mode:overlay'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='b'%20width='144.744'%20height='113.408'%20x='-8.41115'%20y='22.5944'%20color-interpolation-filters='sRGB'%20filterUnits='userSpaceOnUse'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20result='hardAlpha'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='4.16667'/%3e%3cfeColorMatrix%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.25%200'/%3e%3cfeBlend%20in2='BackgroundImageFix'%20mode='overlay'%20result='effect1_dropShadow_1_36'/%3e%3cfeBlend%20in='SourceGraphic'%20in2='effect1_dropShadow_1_36'%20result='shape'/%3e%3c/filter%3e%3cfilter%20id='c'%20width='56.6667'%20height='144.007'%20x='79.6667'%20y='-8.0035'%20color-interpolation-filters='sRGB'%20filterUnits='userSpaceOnUse'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20result='hardAlpha'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='4.16667'/%3e%3cfeColorMatrix%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.25%200'/%3e%3cfeBlend%20in2='BackgroundImageFix'%20mode='overlay'%20result='effect1_dropShadow_1_36'/%3e%3cfeBlend%20in='SourceGraphic'%20in2='effect1_dropShadow_1_36'%20result='shape'/%3e%3c/filter%3e%3clinearGradient%20id='d'%20x1='63.9222'%20x2='63.9222'%20y1='0.329902'%20y2='127.67'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Nde="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20128%20128'%3e%3cpath%20fill='%2300ADEF'%20d='M126%201.637l-67%209.834v49.831l67-.534zM1.647%2066.709l.003%2042.404%2050.791%206.983-.04-49.057zm56.82.68l.094%2049.465%2067.376%209.509.016-58.863zM1.61%2019.297l.047%2042.383%2050.791-.289-.023-49.016z'/%3e%3c/svg%3e",Un={c:ode,cpp:ade,canva:lde,css:ude,docker:cde,express:fde,figma:hde,git:dde,github:pde,html:mde,java:gde,javascript:vde,linux:yde,matplotlib:xde,mongodb:_de,nodejs:wde,notion:bde,numpy:Sde,pandas:Ede,postgresql:Mde,python:Tde,react:Cde,sql:Ade,tailwindcss:Rde,tensorflow:Pde,typescript:Ide,vscode:Dde,windows:Nde},kde=()=>{const[n,e]=U.useState(window.innerWidth<=768),t=U.useRef(null),[r,i]=U.useState(0);U.useEffect(()=>{const a=()=>e(window.innerWidth<=768);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),U.useEffect(()=>{if(!n)return;const a=()=>{t.current&&i(t.current.scrollTop)},l=t.current;if(l)return l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)},[n]);const s=[{name:"HTML",url:Un.html},{name:"CSS",url:Un.css},{name:"React",url:Un.react},{name:"Git",url:Un.git},{name:"GitHub",url:Un.github},{name:"VS Code",url:Un.vscode},{name:"Linux",url:Un.linux},{name:"C",url:Un.c},{name:"C++",url:Un.cpp},{name:"Python",url:Un.python},{name:"Java",url:Un.java},{name:"JavaScript",url:Un.javascript},{name:"Pandas",url:Un.pandas},{name:"NumPy",url:Un.numpy},{name:"Matplotlib",url:Un.matplotlib},{name:"SQL",url:Un.sql},{name:"MongoDB",url:Un.mongodb},{name:"Canva",url:Un.canva},{name:"Notion",url:Un.notion},{name:"Node.js",url:Un.nodejs},{name:"TypeScript",url:Un.typescript},{name:"Docker",url:Un.docker},{name:"TensorFlow",url:Un.tensorflow},{name:"Figma",url:Un.figma},{name:"Express",url:Un.express},{name:"PostgreSQL",url:Un.postgresql},{name:"Windows",url:Un.windows},{name:"Tailwind CSS",url:Un.tailwindcss}],o=({skill:a,index:l})=>{const u=Math.sin(r*.01+l*.5)*8;return z.jsxs("div",{className:"relative w-full aspect-square rounded-xl bg-gradient-to-br from-surface to-background border border-white/10 flex flex-col items-center justify-center transition-all duration-300",style:{transform:`translateY(${u}px)`},children:[a.url&&z.jsx("img",{src:a.url,alt:a.name,className:"w-12 h-12 object-contain mb-2 drop-shadow-[0_0_8px_rgba(124,58,237,0.3)]"}),z.jsx("span",{className:"text-sm font-medium text-white text-center px-2",children:a.name})]})};return z.jsxs("section",{className:"relative min-h-screen w-full overflow-visible",children:[z.jsx("div",{className:"absolute inset-0 z-[1]",children:z.jsx(sde,{})}),n?z.jsxs("div",{ref:t,className:"relative z-[10] w-full h-full pt-20 pb-10 px-4",children:[z.jsx("div",{className:"text-center mb-8",children:z.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift",children:"Skills"})}),z.jsx("div",{className:"grid grid-cols-3 gap-3 w-full",children:s.map((a,l)=>z.jsx(o,{skill:a,index:l},l))})]}):z.jsxs(z.Fragment,{children:[z.jsx("div",{className:"absolute inset-0 z-[2] pointer-events-none",children:z.jsx(ide,{items:s,gradientColor:"transparent"})}),z.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[10]",children:z.jsx("h1",{className:"text-7xl sm:text-8xl md:text-9xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift",children:"Skills"})})]})]})};var zW={exports:{}},Lh={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Lh.ConcurrentRoot=1;Lh.ContinuousEventPriority=4;Lh.DefaultEventPriority=16;Lh.DiscreteEventPriority=1;Lh.IdleEventPriority=536870912;Lh.LegacyRoot=0;zW.exports=Lh;var gp=zW.exports;function Lde(n){let e;const t=new Set,r=(u,c)=>{const f=typeof u=="function"?u(e):u;if(f!==e){const h=e;e=c?f:Object.assign({},e,f),t.forEach(d=>d(e,h))}},i=()=>e,s=(u,c=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=c(e);function d(){const p=c(e);if(!f(h,p)){const y=h;u(h=p,y)}}return t.add(d),()=>t.delete(d)},l={setState:r,getState:i,subscribe:(u,c,f)=>c||f?s(u,c,f):(t.add(u),()=>t.delete(u)),destroy:()=>t.clear()};return e=n(r,i,l),l}const Fde=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),t5=Fde?U.useEffect:U.useLayoutEffect;function Ode(n){const e=typeof n=="function"?Lde(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=U.useReducer(x=>x+1,0),o=e.getState(),a=U.useRef(o),l=U.useRef(r),u=U.useRef(i),c=U.useRef(!1),f=U.useRef();f.current===void 0&&(f.current=r(o));let h,d=!1;(a.current!==o||l.current!==r||u.current!==i||c.current)&&(h=r(o),d=!i(f.current,h)),t5(()=>{d&&(f.current=h),a.current=o,l.current=r,u.current=i,c.current=!1});const p=U.useRef(o);t5(()=>{const x=()=>{try{const _=e.getState(),w=l.current(_);u.current(f.current,w)||(a.current=_,f.current=w,s())}catch{c.current=!0,s()}},m=e.subscribe(x);return e.getState()!==p.current&&x(),m},[]);const y=d?h:f.current;return U.useDebugValue(y),y};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}var VW={exports:{}},w3={exports:{}},b3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n5;function Bde(){return n5||(n5=1,function(n){function e(N,B){var D=N.length;N.push(B);e:for(;0<D;){var $=D-1>>>1,ee=N[$];if(0<i(ee,B))N[$]=B,N[D]=ee,D=$;else break e}}function t(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var B=N[0],D=N.pop();if(D!==B){N[0]=D;e:for(var $=0,ee=N.length,te=ee>>>1;$<te;){var se=2*($+1)-1,me=N[se],_e=se+1,pe=N[_e];if(0>i(me,D))_e<ee&&0>i(pe,me)?(N[$]=pe,N[_e]=D,$=_e):(N[$]=me,N[se]=D,$=se);else if(_e<ee&&0>i(pe,D))N[$]=pe,N[_e]=D,$=_e;else break e}}return B}function i(N,B){var D=N.sortIndex-B.sortIndex;return D!==0?D:N.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,d=!1,p=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var B=t(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=N)r(u),B.sortIndex=B.expirationTime,e(l,B);else break;B=t(u)}}function b(N){if(y=!1,w(N),!p)if(t(l)!==null)p=!0,W(S);else{var B=t(u);B!==null&&G(b,B.startTime-N)}}function S(N,B){p=!1,y&&(y=!1,m(P),P=-1),d=!0;var D=h;try{for(w(B),f=t(l);f!==null&&(!(f.expirationTime>B)||N&&!k());){var $=f.callback;if(typeof $=="function"){f.callback=null,h=f.priorityLevel;var ee=$(f.expirationTime<=B);B=n.unstable_now(),typeof ee=="function"?f.callback=ee:f===t(l)&&r(l),w(B)}else r(l);f=t(l)}if(f!==null)var te=!0;else{var se=t(u);se!==null&&G(b,se.startTime-B),te=!1}return te}finally{f=null,h=D,d=!1}}var M=!1,T=null,P=-1,C=5,A=-1;function k(){return!(n.unstable_now()-A<C)}function L(){if(T!==null){var N=n.unstable_now();A=N;var B=!0;try{B=T(!0,N)}finally{B?H():(M=!1,T=null)}}else M=!1}var H;if(typeof _=="function")H=function(){_(L)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=L,H=function(){V.postMessage(null)}}else H=function(){x(L,0)};function W(N){T=N,M||(M=!0,H())}function G(N,B){P=x(function(){N(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(N){N.callback=null},n.unstable_continueExecution=function(){p||d||(p=!0,W(S))},n.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<N?Math.floor(1e3/N):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(N){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var D=h;h=B;try{return N()}finally{h=D}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var D=h;h=N;try{return B()}finally{h=D}},n.unstable_scheduleCallback=function(N,B,D){var $=n.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?$+D:$):D=$,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=D+ee,N={id:c++,callback:B,priorityLevel:N,startTime:D,expirationTime:ee,sortIndex:-1},D>$?(N.sortIndex=D,e(u,N),t(l)===null&&N===t(u)&&(y?(m(P),P=-1):y=!0,G(b,D-$))):(N.sortIndex=ee,e(l,N),p||d||(p=!0,W(S))),N},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(N){var B=h;return function(){var D=h;h=B;try{return N.apply(this,arguments)}finally{h=D}}}}(b3)),b3}var r5;function Ude(){return r5||(r5=1,w3.exports=Bde()),w3.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zde=function(e){var t={},r=U,i=Ude(),s=Object.assign;function o(g){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+g,E=1;E<arguments.length;E++)v+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+g+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),p=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),S=Symbol.iterator;function M(g){return g===null||typeof g!="object"?null:(g=S&&g[S]||g["@@iterator"],typeof g=="function"?g:null)}function T(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case c:return"Fragment";case u:return"Portal";case h:return"Profiler";case f:return"StrictMode";case x:return"Suspense";case m:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case p:return(g.displayName||"Context")+".Consumer";case d:return(g._context.displayName||"Context")+".Provider";case y:var v=g.render;return g=g.displayName,g||(g=v.displayName||v.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case _:return v=g.displayName||null,v!==null?v:T(g.type)||"Memo";case w:v=g._payload,g=g._init;try{return T(g(v))}catch{}}return null}function P(g){var v=g.type;switch(g.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=v.render,g=g.displayName||g.name||"",v.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(v);case 8:return v===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function C(g){var v=g,E=g;if(g.alternate)for(;v.return;)v=v.return;else{g=v;do v=g,v.flags&4098&&(E=v.return),g=v.return;while(g)}return v.tag===3?E:null}function A(g){if(C(g)!==g)throw Error(o(188))}function k(g){var v=g.alternate;if(!v){if(v=C(g),v===null)throw Error(o(188));return v!==g?null:g}for(var E=g,R=v;;){var I=E.return;if(I===null)break;var O=I.alternate;if(O===null){if(R=I.return,R!==null){E=R;continue}break}if(I.child===O.child){for(O=I.child;O;){if(O===E)return A(I),g;if(O===R)return A(I),v;O=O.sibling}throw Error(o(188))}if(E.return!==R.return)E=I,R=O;else{for(var ne=!1,ue=I.child;ue;){if(ue===E){ne=!0,E=I,R=O;break}if(ue===R){ne=!0,R=I,E=O;break}ue=ue.sibling}if(!ne){for(ue=O.child;ue;){if(ue===E){ne=!0,E=O,R=I;break}if(ue===R){ne=!0,R=O,E=I;break}ue=ue.sibling}if(!ne)throw Error(o(189))}}if(E.alternate!==R)throw Error(o(190))}if(E.tag!==3)throw Error(o(188));return E.stateNode.current===E?g:v}function L(g){return g=k(g),g!==null?H(g):null}function H(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var v=H(g);if(v!==null)return v;g=g.sibling}return null}function F(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){if(g.tag!==4){var v=F(g);if(v!==null)return v}g=g.sibling}return null}var V=Array.isArray,W=e.getPublicInstance,G=e.getRootHostContext,N=e.getChildHostContext,B=e.prepareForCommit,D=e.resetAfterCommit,$=e.createInstance,ee=e.appendInitialChild,te=e.finalizeInitialChildren,se=e.prepareUpdate,me=e.shouldSetTextContent,_e=e.createTextInstance,pe=e.scheduleTimeout,Ne=e.cancelTimeout,Ue=e.noTimeout,We=e.isPrimaryRenderer,Be=e.supportsMutation,J=e.supportsPersistence,he=e.supportsHydration,de=e.getInstanceFromNode,Ie=e.preparePortalMount,ve=e.getCurrentEventPriority,oe=e.detachDeletedInstance,ze=e.supportsMicrotasks,X=e.scheduleMicrotask,j=e.supportsTestSelectors,ae=e.findFiberRoot,Oe=e.getBoundingRect,Se=e.getTextContent,K=e.isHiddenSubtree,ge=e.matchAccessibilityRole,Te=e.setFocusIfFocusable,Le=e.setupIntersectionObserver,Pe=e.appendChild,De=e.appendChildToContainer,Ae=e.commitTextUpdate,ht=e.commitMount,Ze=e.commitUpdate,at=e.insertBefore,Qe=e.insertInContainerBefore,$e=e.removeChild,Dt=e.removeChildFromContainer,Ft=e.resetTextContent,sn=e.hideInstance,Ke=e.hideTextInstance,He=e.unhideInstance,re=e.unhideTextInstance,je=e.clearContainer,qe=e.cloneInstance,At=e.createContainerChildSet,_t=e.appendChildToContainerChildSet,Jt=e.finalizeContainerChildren,cn=e.replaceContainerChildren,ut=e.cloneHiddenInstance,ot=e.cloneHiddenTextInstance,xt=e.canHydrateInstance,Ge=e.canHydrateTextInstance,wt=e.canHydrateSuspenseInstance,Et=e.isSuspenseInstancePending,kt=e.isSuspenseInstanceFallback,Bn=e.registerSuspenseInstanceRetry,Bt=e.getNextHydratableSibling,In=e.getFirstHydratableChild,ir=e.getFirstHydratableChildWithinContainer,Ln=e.getFirstHydratableChildWithinSuspenseInstance,Dn=e.hydrateInstance,_n=e.hydrateTextInstance,qr=e.hydrateSuspenseInstance,q=e.getNextHydratableInstanceAfterSuspenseInstance,ce=e.commitHydratedContainer,we=e.commitHydratedSuspenseInstance,xe=e.clearSuspenseBoundary,ye=e.clearSuspenseBoundaryFromContainer,Je=e.shouldDeleteUnhydratedTailInstances,dt=e.didNotMatchHydratedContainerTextInstance,Nt=e.didNotMatchHydratedTextInstance,ct;function pt(g){if(ct===void 0)try{throw Error()}catch(E){var v=E.stack.trim().match(/\n( *(at )?)/);ct=v&&v[1]||""}return`
`+ct+g}var Pt=!1;function Ut(g,v){if(!g||Pt)return"";Pt=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(Ye){var R=Ye}Reflect.construct(g,[],v)}else{try{v.call()}catch(Ye){R=Ye}g.call(v.prototype)}else{try{throw Error()}catch(Ye){R=Ye}g()}}catch(Ye){if(Ye&&R&&typeof Ye.stack=="string"){for(var I=Ye.stack.split(`
`),O=R.stack.split(`
`),ne=I.length-1,ue=O.length-1;1<=ne&&0<=ue&&I[ne]!==O[ue];)ue--;for(;1<=ne&&0<=ue;ne--,ue--)if(I[ne]!==O[ue]){if(ne!==1||ue!==1)do if(ne--,ue--,0>ue||I[ne]!==O[ue]){var ke=`
`+I[ne].replace(" at new "," at ");return g.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",g.displayName)),ke}while(1<=ne&&0<=ue);break}}}finally{Pt=!1,Error.prepareStackTrace=E}return(g=g?g.displayName||g.name:"")?pt(g):""}var Hn=Object.prototype.hasOwnProperty,sr=[],dn=-1;function er(g){return{current:g}}function Lt(g){0>dn||(g.current=sr[dn],sr[dn]=null,dn--)}function nt(g,v){dn++,sr[dn]=g.current,g.current=v}var Lo={},tn=er(Lo),_r=er(!1),ja=Lo;function Fo(g,v){var E=g.type.contextTypes;if(!E)return Lo;var R=g.stateNode;if(R&&R.__reactInternalMemoizedUnmaskedChildContext===v)return R.__reactInternalMemoizedMaskedChildContext;var I={},O;for(O in E)I[O]=v[O];return R&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=v,g.__reactInternalMemoizedMaskedChildContext=I),I}function fi(g){return g=g.childContextTypes,g!=null}function Rr(){Lt(_r),Lt(tn)}function Xa(g,v,E){if(tn.current!==Lo)throw Error(o(168));nt(tn,v),nt(_r,E)}function Vh(g,v,E){var R=g.stateNode;if(v=v.childContextTypes,typeof R.getChildContext!="function")return E;R=R.getChildContext();for(var I in R)if(!(I in v))throw Error(o(108,P(g)||"Unknown",I));return s({},E,R)}function Ti(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Lo,ja=tn.current,nt(tn,g),nt(_r,_r.current),!0}function Wh(g,v,E){var R=g.stateNode;if(!R)throw Error(o(169));E?(g=Vh(g,v,ja),R.__reactInternalMemoizedMergedChildContext=g,Lt(_r),Lt(tn),nt(tn,g)):Lt(_r),nt(_r,E)}var no=Math.clz32?Math.clz32:Dj,dy=Math.log,Ij=Math.LN2;function Dj(g){return g>>>=0,g===0?32:31-(dy(g)/Ij|0)|0}var py=64,my=4194304;function Cm(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function gy(g,v){var E=g.pendingLanes;if(E===0)return 0;var R=0,I=g.suspendedLanes,O=g.pingedLanes,ne=E&268435455;if(ne!==0){var ue=ne&~I;ue!==0?R=Cm(ue):(O&=ne,O!==0&&(R=Cm(O)))}else ne=E&~I,ne!==0?R=Cm(ne):O!==0&&(R=Cm(O));if(R===0)return 0;if(v!==0&&v!==R&&!(v&I)&&(I=R&-R,O=v&-v,I>=O||I===16&&(O&4194240)!==0))return v;if(R&4&&(R|=E&16),v=g.entangledLanes,v!==0)for(g=g.entanglements,v&=R;0<v;)E=31-no(v),I=1<<E,R|=g[E],v&=~I;return R}function Nj(g,v){switch(g){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kj(g,v){for(var E=g.suspendedLanes,R=g.pingedLanes,I=g.expirationTimes,O=g.pendingLanes;0<O;){var ne=31-no(O),ue=1<<ne,ke=I[ne];ke===-1?(!(ue&E)||ue&R)&&(I[ne]=Nj(ue,v)):ke<=v&&(g.expiredLanes|=ue),O&=~ue}}function Sb(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function Eb(g){for(var v=[],E=0;31>E;E++)v.push(g);return v}function Am(g,v,E){g.pendingLanes|=v,v!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,v=31-no(v),g[v]=E}function Lj(g,v){var E=g.pendingLanes&~v;g.pendingLanes=v,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=v,g.mutableReadLanes&=v,g.entangledLanes&=v,v=g.entanglements;var R=g.eventTimes;for(g=g.expirationTimes;0<E;){var I=31-no(E),O=1<<I;v[I]=0,R[I]=-1,g[I]=-1,E&=~O}}function Mb(g,v){var E=g.entangledLanes|=v;for(g=g.entanglements;E;){var R=31-no(E),I=1<<R;I&v|g[R]&v&&(g[R]|=v),E&=~I}}var Mn=0;function cI(g){return g&=-g,1<g?4<g?g&268435455?16:536870912:4:1}var Tb=i.unstable_scheduleCallback,fI=i.unstable_cancelCallback,Fj=i.unstable_shouldYield,Oj=i.unstable_requestPaint,hi=i.unstable_now,Cb=i.unstable_ImmediatePriority,Bj=i.unstable_UserBlockingPriority,Ab=i.unstable_NormalPriority,Uj=i.unstable_IdlePriority,vy=null,$a=null;function zj(g){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(vy,g,void 0,(g.current.flags&128)===128)}catch{}}function Vj(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var qa=typeof Object.is=="function"?Object.is:Vj,Nl=null,yy=!1,Rb=!1;function hI(g){Nl===null?Nl=[g]:Nl.push(g)}function Wj(g){yy=!0,hI(g)}function Ya(){if(!Rb&&Nl!==null){Rb=!0;var g=0,v=Mn;try{var E=Nl;for(Mn=1;g<E.length;g++){var R=E[g];do R=R(!0);while(R!==null)}Nl=null,yy=!1}catch(I){throw Nl!==null&&(Nl=Nl.slice(g+1)),Tb(Cb,Ya),I}finally{Mn=v,Rb=!1}}return null}var Hj=a.ReactCurrentBatchConfig;function xy(g,v){if(qa(g,v))return!0;if(typeof g!="object"||g===null||typeof v!="object"||v===null)return!1;var E=Object.keys(g),R=Object.keys(v);if(E.length!==R.length)return!1;for(R=0;R<E.length;R++){var I=E[R];if(!Hn.call(v,I)||!qa(g[I],v[I]))return!1}return!0}function Gj(g){switch(g.tag){case 5:return pt(g.type);case 16:return pt("Lazy");case 13:return pt("Suspense");case 19:return pt("SuspenseList");case 0:case 2:case 15:return g=Ut(g.type,!1),g;case 11:return g=Ut(g.type.render,!1),g;case 1:return g=Ut(g.type,!0),g;default:return""}}function ma(g,v){if(g&&g.defaultProps){v=s({},v),g=g.defaultProps;for(var E in g)v[E]===void 0&&(v[E]=g[E]);return v}return v}var _y=er(null),wy=null,Hh=null,Pb=null;function Ib(){Pb=Hh=wy=null}function dI(g,v,E){We?(nt(_y,v._currentValue),v._currentValue=E):(nt(_y,v._currentValue2),v._currentValue2=E)}function Db(g){var v=_y.current;Lt(_y),We?g._currentValue=v:g._currentValue2=v}function Nb(g,v,E){for(;g!==null;){var R=g.alternate;if((g.childLanes&v)!==v?(g.childLanes|=v,R!==null&&(R.childLanes|=v)):R!==null&&(R.childLanes&v)!==v&&(R.childLanes|=v),g===E)break;g=g.return}}function Gh(g,v){wy=g,Pb=Hh=null,g=g.dependencies,g!==null&&g.firstContext!==null&&(g.lanes&v&&(so=!0),g.firstContext=null)}function Oo(g){var v=We?g._currentValue:g._currentValue2;if(Pb!==g)if(g={context:g,memoizedValue:v,next:null},Hh===null){if(wy===null)throw Error(o(308));Hh=g,wy.dependencies={lanes:0,firstContext:g}}else Hh=Hh.next=g;return v}var Ka=null,Pu=!1;function kb(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pI(g,v){g=g.updateQueue,v.updateQueue===g&&(v.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function kl(g,v){return{eventTime:g,lane:v,tag:0,payload:null,callback:null,next:null}}function Iu(g,v){var E=g.updateQueue;E!==null&&(E=E.shared,Ur!==null&&g.mode&1&&!(nn&2)?(g=E.interleaved,g===null?(v.next=v,Ka===null?Ka=[E]:Ka.push(E)):(v.next=g.next,g.next=v),E.interleaved=v):(g=E.pending,g===null?v.next=v:(v.next=g.next,g.next=v),E.pending=v))}function by(g,v,E){if(v=v.updateQueue,v!==null&&(v=v.shared,(E&4194240)!==0)){var R=v.lanes;R&=g.pendingLanes,E|=R,v.lanes=E,Mb(g,E)}}function mI(g,v){var E=g.updateQueue,R=g.alternate;if(R!==null&&(R=R.updateQueue,E===R)){var I=null,O=null;if(E=E.firstBaseUpdate,E!==null){do{var ne={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};O===null?I=O=ne:O=O.next=ne,E=E.next}while(E!==null);O===null?I=O=v:O=O.next=v}else I=O=v;E={baseState:R.baseState,firstBaseUpdate:I,lastBaseUpdate:O,shared:R.shared,effects:R.effects},g.updateQueue=E;return}g=E.lastBaseUpdate,g===null?E.firstBaseUpdate=v:g.next=v,E.lastBaseUpdate=v}function Sy(g,v,E,R){var I=g.updateQueue;Pu=!1;var O=I.firstBaseUpdate,ne=I.lastBaseUpdate,ue=I.shared.pending;if(ue!==null){I.shared.pending=null;var ke=ue,Ye=ke.next;ke.next=null,ne===null?O=Ye:ne.next=Ye,ne=ke;var mt=g.alternate;mt!==null&&(mt=mt.updateQueue,ue=mt.lastBaseUpdate,ue!==ne&&(ue===null?mt.firstBaseUpdate=Ye:ue.next=Ye,mt.lastBaseUpdate=ke))}if(O!==null){var Xt=I.baseState;ne=0,mt=Ye=ke=null,ue=O;do{var Ot=ue.lane,zn=ue.eventTime;if((R&Ot)===Ot){mt!==null&&(mt=mt.next={eventTime:zn,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var It=g,Hi=ue;switch(Ot=v,zn=E,Hi.tag){case 1:if(It=Hi.payload,typeof It=="function"){Xt=It.call(zn,Xt,Ot);break e}Xt=It;break e;case 3:It.flags=It.flags&-65537|128;case 0:if(It=Hi.payload,Ot=typeof It=="function"?It.call(zn,Xt,Ot):It,Ot==null)break e;Xt=s({},Xt,Ot);break e;case 2:Pu=!0}}ue.callback!==null&&ue.lane!==0&&(g.flags|=64,Ot=I.effects,Ot===null?I.effects=[ue]:Ot.push(ue))}else zn={eventTime:zn,lane:Ot,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},mt===null?(Ye=mt=zn,ke=Xt):mt=mt.next=zn,ne|=Ot;if(ue=ue.next,ue===null){if(ue=I.shared.pending,ue===null)break;Ot=ue,ue=Ot.next,Ot.next=null,I.lastBaseUpdate=Ot,I.shared.pending=null}}while(!0);if(mt===null&&(ke=Xt),I.baseState=ke,I.firstBaseUpdate=Ye,I.lastBaseUpdate=mt,v=I.shared.interleaved,v!==null){I=v;do ne|=I.lane,I=I.next;while(I!==v)}else O===null&&(I.shared.lanes=0);Qh|=ne,g.lanes=ne,g.memoizedState=Xt}}function gI(g,v,E){if(g=v.effects,v.effects=null,g!==null)for(v=0;v<g.length;v++){var R=g[v],I=R.callback;if(I!==null){if(R.callback=null,R=E,typeof I!="function")throw Error(o(191,I));I.call(R)}}}var vI=new r.Component().refs;function Lb(g,v,E,R){v=g.memoizedState,E=E(R,v),E=E==null?v:s({},v,E),g.memoizedState=E,g.lanes===0&&(g.updateQueue.baseState=E)}var Ey={isMounted:function(g){return(g=g._reactInternals)?C(g)===g:!1},enqueueSetState:function(g,v,E){g=g._reactInternals;var R=cs(),I=ku(g),O=kl(R,I);O.payload=v,E!=null&&(O.callback=E),Iu(g,O),v=Wo(g,I,R),v!==null&&by(v,g,I)},enqueueReplaceState:function(g,v,E){g=g._reactInternals;var R=cs(),I=ku(g),O=kl(R,I);O.tag=1,O.payload=v,E!=null&&(O.callback=E),Iu(g,O),v=Wo(g,I,R),v!==null&&by(v,g,I)},enqueueForceUpdate:function(g,v){g=g._reactInternals;var E=cs(),R=ku(g),I=kl(E,R);I.tag=2,v!=null&&(I.callback=v),Iu(g,I),v=Wo(g,R,E),v!==null&&by(v,g,R)}};function yI(g,v,E,R,I,O,ne){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(R,O,ne):v.prototype&&v.prototype.isPureReactComponent?!xy(E,R)||!xy(I,O):!0}function xI(g,v,E){var R=!1,I=Lo,O=v.contextType;return typeof O=="object"&&O!==null?O=Oo(O):(I=fi(v)?ja:tn.current,R=v.contextTypes,O=(R=R!=null)?Fo(g,I):Lo),v=new v(E,O),g.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Ey,g.stateNode=v,v._reactInternals=g,R&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=I,g.__reactInternalMemoizedMaskedChildContext=O),v}function _I(g,v,E,R){g=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(E,R),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(E,R),v.state!==g&&Ey.enqueueReplaceState(v,v.state,null)}function Fb(g,v,E,R){var I=g.stateNode;I.props=E,I.state=g.memoizedState,I.refs=vI,kb(g);var O=v.contextType;typeof O=="object"&&O!==null?I.context=Oo(O):(O=fi(v)?ja:tn.current,I.context=Fo(g,O)),I.state=g.memoizedState,O=v.getDerivedStateFromProps,typeof O=="function"&&(Lb(g,v,O,E),I.state=g.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(v=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),v!==I.state&&Ey.enqueueReplaceState(I,I.state,null),Sy(g,E,I,R),I.state=g.memoizedState),typeof I.componentDidMount=="function"&&(g.flags|=4194308)}var jh=[],Xh=0,My=null,Ty=0,Bo=[],Uo=0,nf=null,Ll=1,Fl="";function rf(g,v){jh[Xh++]=Ty,jh[Xh++]=My,My=g,Ty=v}function wI(g,v,E){Bo[Uo++]=Ll,Bo[Uo++]=Fl,Bo[Uo++]=nf,nf=g;var R=Ll;g=Fl;var I=32-no(R)-1;R&=~(1<<I),E+=1;var O=32-no(v)+I;if(30<O){var ne=I-I%5;O=(R&(1<<ne)-1).toString(32),R>>=ne,I-=ne,Ll=1<<32-no(v)+I|E<<I|R,Fl=O+g}else Ll=1<<O|E<<I|R,Fl=g}function Ob(g){g.return!==null&&(rf(g,1),wI(g,1,0))}function Bb(g){for(;g===My;)My=jh[--Xh],jh[Xh]=null,Ty=jh[--Xh],jh[Xh]=null;for(;g===nf;)nf=Bo[--Uo],Bo[Uo]=null,Fl=Bo[--Uo],Bo[Uo]=null,Ll=Bo[--Uo],Bo[Uo]=null}var ro=null,io=null,tr=!1,Rm=!1,ga=null;function bI(g,v){var E=Ho(5,null,null,0);E.elementType="DELETED",E.stateNode=v,E.return=g,v=g.deletions,v===null?(g.deletions=[E],g.flags|=16):v.push(E)}function SI(g,v){switch(g.tag){case 5:return v=xt(v,g.type,g.pendingProps),v!==null?(g.stateNode=v,ro=g,io=In(v),!0):!1;case 6:return v=Ge(v,g.pendingProps),v!==null?(g.stateNode=v,ro=g,io=null,!0):!1;case 13:if(v=wt(v),v!==null){var E=nf!==null?{id:Ll,overflow:Fl}:null;return g.memoizedState={dehydrated:v,treeContext:E,retryLane:1073741824},E=Ho(18,null,null,0),E.stateNode=v,E.return=g,g.child=E,ro=g,io=null,!0}return!1;default:return!1}}function Ub(g){return(g.mode&1)!==0&&(g.flags&128)===0}function zb(g){if(tr){var v=io;if(v){var E=v;if(!SI(g,v)){if(Ub(g))throw Error(o(418));v=Bt(E);var R=ro;v&&SI(g,v)?bI(R,E):(g.flags=g.flags&-4097|2,tr=!1,ro=g)}}else{if(Ub(g))throw Error(o(418));g.flags=g.flags&-4097|2,tr=!1,ro=g}}}function EI(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;ro=g}function Pm(g){if(!he||g!==ro)return!1;if(!tr)return EI(g),tr=!0,!1;if(g.tag!==3&&(g.tag!==5||Je(g.type)&&!me(g.type,g.memoizedProps))){var v=io;if(v){if(Ub(g)){for(g=io;g;)g=Bt(g);throw Error(o(418))}for(;v;)bI(g,v),v=Bt(v)}}if(EI(g),g.tag===13){if(!he)throw Error(o(316));if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));io=q(g)}else io=ro?Bt(g.stateNode):null;return!0}function $h(){he&&(io=ro=null,Rm=tr=!1)}function Vb(g){ga===null?ga=[g]:ga.push(g)}function Im(g,v,E){if(g=E.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(o(309));var R=E.stateNode}if(!R)throw Error(o(147,g));var I=R,O=""+g;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===O?v.ref:(v=function(ne){var ue=I.refs;ue===vI&&(ue=I.refs={}),ne===null?delete ue[O]:ue[O]=ne},v._stringRef=O,v)}if(typeof g!="string")throw Error(o(284));if(!E._owner)throw Error(o(290,g))}return g}function Cy(g,v){throw g=Object.prototype.toString.call(v),Error(o(31,g==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":g))}function MI(g){var v=g._init;return v(g._payload)}function TI(g){function v(be,fe){if(g){var Re=be.deletions;Re===null?(be.deletions=[fe],be.flags|=16):Re.push(fe)}}function E(be,fe){if(!g)return null;for(;fe!==null;)v(be,fe),fe=fe.sibling;return null}function R(be,fe){for(be=new Map;fe!==null;)fe.key!==null?be.set(fe.key,fe):be.set(fe.index,fe),fe=fe.sibling;return be}function I(be,fe){return be=Fu(be,fe),be.index=0,be.sibling=null,be}function O(be,fe,Re){return be.index=Re,g?(Re=be.alternate,Re!==null?(Re=Re.index,Re<fe?(be.flags|=2,fe):Re):(be.flags|=2,fe)):(be.flags|=1048576,fe)}function ne(be){return g&&be.alternate===null&&(be.flags|=2),be}function ue(be,fe,Re,st){return fe===null||fe.tag!==6?(fe=ES(Re,be.mode,st),fe.return=be,fe):(fe=I(fe,Re),fe.return=be,fe)}function ke(be,fe,Re,st){var Rt=Re.type;return Rt===c?mt(be,fe,Re.props.children,st,Re.key):fe!==null&&(fe.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===w&&MI(Rt)===fe.type)?(st=I(fe,Re.props),st.ref=Im(be,fe,Re),st.return=be,st):(st=i1(Re.type,Re.key,Re.props,null,be.mode,st),st.ref=Im(be,fe,Re),st.return=be,st)}function Ye(be,fe,Re,st){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==Re.containerInfo||fe.stateNode.implementation!==Re.implementation?(fe=MS(Re,be.mode,st),fe.return=be,fe):(fe=I(fe,Re.children||[]),fe.return=be,fe)}function mt(be,fe,Re,st,Rt){return fe===null||fe.tag!==7?(fe=ff(Re,be.mode,st,Rt),fe.return=be,fe):(fe=I(fe,Re),fe.return=be,fe)}function Xt(be,fe,Re){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=ES(""+fe,be.mode,Re),fe.return=be,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case l:return Re=i1(fe.type,fe.key,fe.props,null,be.mode,Re),Re.ref=Im(be,null,fe),Re.return=be,Re;case u:return fe=MS(fe,be.mode,Re),fe.return=be,fe;case w:var st=fe._init;return Xt(be,st(fe._payload),Re)}if(V(fe)||M(fe))return fe=ff(fe,be.mode,Re,null),fe.return=be,fe;Cy(be,fe)}return null}function Ot(be,fe,Re,st){var Rt=fe!==null?fe.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number")return Rt!==null?null:ue(be,fe,""+Re,st);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case l:return Re.key===Rt?ke(be,fe,Re,st):null;case u:return Re.key===Rt?Ye(be,fe,Re,st):null;case w:return Rt=Re._init,Ot(be,fe,Rt(Re._payload),st)}if(V(Re)||M(Re))return Rt!==null?null:mt(be,fe,Re,st,null);Cy(be,Re)}return null}function zn(be,fe,Re,st,Rt){if(typeof st=="string"&&st!==""||typeof st=="number")return be=be.get(Re)||null,ue(fe,be,""+st,Rt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case l:return be=be.get(st.key===null?Re:st.key)||null,ke(fe,be,st,Rt);case u:return be=be.get(st.key===null?Re:st.key)||null,Ye(fe,be,st,Rt);case w:var Qt=st._init;return zn(be,fe,Re,Qt(st._payload),Rt)}if(V(st)||M(st))return be=be.get(Re)||null,mt(fe,be,st,Rt,null);Cy(fe,st)}return null}function It(be,fe,Re,st){for(var Rt=null,Qt=null,$t=fe,Tn=fe=0,pi=null;$t!==null&&Tn<Re.length;Tn++){$t.index>Tn?(pi=$t,$t=null):pi=$t.sibling;var Cn=Ot(be,$t,Re[Tn],st);if(Cn===null){$t===null&&($t=pi);break}g&&$t&&Cn.alternate===null&&v(be,$t),fe=O(Cn,fe,Tn),Qt===null?Rt=Cn:Qt.sibling=Cn,Qt=Cn,$t=pi}if(Tn===Re.length)return E(be,$t),tr&&rf(be,Tn),Rt;if($t===null){for(;Tn<Re.length;Tn++)$t=Xt(be,Re[Tn],st),$t!==null&&(fe=O($t,fe,Tn),Qt===null?Rt=$t:Qt.sibling=$t,Qt=$t);return tr&&rf(be,Tn),Rt}for($t=R(be,$t);Tn<Re.length;Tn++)pi=zn($t,be,Tn,Re[Tn],st),pi!==null&&(g&&pi.alternate!==null&&$t.delete(pi.key===null?Tn:pi.key),fe=O(pi,fe,Tn),Qt===null?Rt=pi:Qt.sibling=pi,Qt=pi);return g&&$t.forEach(function(Ou){return v(be,Ou)}),tr&&rf(be,Tn),Rt}function Hi(be,fe,Re,st){var Rt=M(Re);if(typeof Rt!="function")throw Error(o(150));if(Re=Rt.call(Re),Re==null)throw Error(o(151));for(var Qt=Rt=null,$t=fe,Tn=fe=0,pi=null,Cn=Re.next();$t!==null&&!Cn.done;Tn++,Cn=Re.next()){$t.index>Tn?(pi=$t,$t=null):pi=$t.sibling;var Ou=Ot(be,$t,Cn.value,st);if(Ou===null){$t===null&&($t=pi);break}g&&$t&&Ou.alternate===null&&v(be,$t),fe=O(Ou,fe,Tn),Qt===null?Rt=Ou:Qt.sibling=Ou,Qt=Ou,$t=pi}if(Cn.done)return E(be,$t),tr&&rf(be,Tn),Rt;if($t===null){for(;!Cn.done;Tn++,Cn=Re.next())Cn=Xt(be,Cn.value,st),Cn!==null&&(fe=O(Cn,fe,Tn),Qt===null?Rt=Cn:Qt.sibling=Cn,Qt=Cn);return tr&&rf(be,Tn),Rt}for($t=R(be,$t);!Cn.done;Tn++,Cn=Re.next())Cn=zn($t,be,Tn,Cn.value,st),Cn!==null&&(g&&Cn.alternate!==null&&$t.delete(Cn.key===null?Tn:Cn.key),fe=O(Cn,fe,Tn),Qt===null?Rt=Cn:Qt.sibling=Cn,Qt=Cn);return g&&$t.forEach(function(_X){return v(be,_X)}),tr&&rf(be,Tn),Rt}function Go(be,fe,Re,st){if(typeof Re=="object"&&Re!==null&&Re.type===c&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case l:e:{for(var Rt=Re.key,Qt=fe;Qt!==null;){if(Qt.key===Rt){if(Rt=Re.type,Rt===c){if(Qt.tag===7){E(be,Qt.sibling),fe=I(Qt,Re.props.children),fe.return=be,be=fe;break e}}else if(Qt.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===w&&MI(Rt)===Qt.type){E(be,Qt.sibling),fe=I(Qt,Re.props),fe.ref=Im(be,Qt,Re),fe.return=be,be=fe;break e}E(be,Qt);break}else v(be,Qt);Qt=Qt.sibling}Re.type===c?(fe=ff(Re.props.children,be.mode,st,Re.key),fe.return=be,be=fe):(st=i1(Re.type,Re.key,Re.props,null,be.mode,st),st.ref=Im(be,fe,Re),st.return=be,be=st)}return ne(be);case u:e:{for(Qt=Re.key;fe!==null;){if(fe.key===Qt)if(fe.tag===4&&fe.stateNode.containerInfo===Re.containerInfo&&fe.stateNode.implementation===Re.implementation){E(be,fe.sibling),fe=I(fe,Re.children||[]),fe.return=be,be=fe;break e}else{E(be,fe);break}else v(be,fe);fe=fe.sibling}fe=MS(Re,be.mode,st),fe.return=be,be=fe}return ne(be);case w:return Qt=Re._init,Go(be,fe,Qt(Re._payload),st)}if(V(Re))return It(be,fe,Re,st);if(M(Re))return Hi(be,fe,Re,st);Cy(be,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"?(Re=""+Re,fe!==null&&fe.tag===6?(E(be,fe.sibling),fe=I(fe,Re),fe.return=be,be=fe):(E(be,fe),fe=ES(Re,be.mode,st),fe.return=be,be=fe),ne(be)):E(be,fe)}return Go}var qh=TI(!0),CI=TI(!1),Dm={},zo=er(Dm),Nm=er(Dm),Yh=er(Dm);function Za(g){if(g===Dm)throw Error(o(174));return g}function Wb(g,v){nt(Yh,v),nt(Nm,g),nt(zo,Dm),g=G(v),Lt(zo),nt(zo,g)}function Kh(){Lt(zo),Lt(Nm),Lt(Yh)}function AI(g){var v=Za(Yh.current),E=Za(zo.current);v=N(E,g.type,v),E!==v&&(nt(Nm,g),nt(zo,v))}function Hb(g){Nm.current===g&&(Lt(zo),Lt(Nm))}var or=er(0);function Ay(g){for(var v=g;v!==null;){if(v.tag===13){var E=v.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||Et(E)||kt(E)))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if(v.flags&128)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===g)break;for(;v.sibling===null;){if(v.return===null||v.return===g)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var Gb=[];function jb(){for(var g=0;g<Gb.length;g++){var v=Gb[g];We?v._workInProgressVersionPrimary=null:v._workInProgressVersionSecondary=null}Gb.length=0}var Ry=a.ReactCurrentDispatcher,Vo=a.ReactCurrentBatchConfig,Zh=0,wr=null,zi=null,di=null,Py=!1,km=!1,Lm=0,jj=0;function Vi(){throw Error(o(321))}function Xb(g,v){if(v===null)return!1;for(var E=0;E<v.length&&E<g.length;E++)if(!qa(g[E],v[E]))return!1;return!0}function $b(g,v,E,R,I,O){if(Zh=O,wr=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,Ry.current=g===null||g.memoizedState===null?Yj:Kj,g=E(R,I),km){O=0;do{if(km=!1,Lm=0,25<=O)throw Error(o(301));O+=1,di=zi=null,v.updateQueue=null,Ry.current=Zj,g=E(R,I)}while(km)}if(Ry.current=Ly,v=zi!==null&&zi.next!==null,Zh=0,di=zi=wr=null,Py=!1,v)throw Error(o(300));return g}function qb(){var g=Lm!==0;return Lm=0,g}function Ol(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?wr.memoizedState=di=g:di=di.next=g,di}function Ja(){if(zi===null){var g=wr.alternate;g=g!==null?g.memoizedState:null}else g=zi.next;var v=di===null?wr.memoizedState:di.next;if(v!==null)di=v,zi=g;else{if(g===null)throw Error(o(310));zi=g,g={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},di===null?wr.memoizedState=di=g:di=di.next=g}return di}function sf(g,v){return typeof v=="function"?v(g):v}function Iy(g){var v=Ja(),E=v.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=g;var R=zi,I=R.baseQueue,O=E.pending;if(O!==null){if(I!==null){var ne=I.next;I.next=O.next,O.next=ne}R.baseQueue=I=O,E.pending=null}if(I!==null){O=I.next,R=R.baseState;var ue=ne=null,ke=null,Ye=O;do{var mt=Ye.lane;if((Zh&mt)===mt)ke!==null&&(ke=ke.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),R=Ye.hasEagerState?Ye.eagerState:g(R,Ye.action);else{var Xt={lane:mt,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};ke===null?(ue=ke=Xt,ne=R):ke=ke.next=Xt,wr.lanes|=mt,Qh|=mt}Ye=Ye.next}while(Ye!==null&&Ye!==O);ke===null?ne=R:ke.next=ue,qa(R,v.memoizedState)||(so=!0),v.memoizedState=R,v.baseState=ne,v.baseQueue=ke,E.lastRenderedState=R}if(g=E.interleaved,g!==null){I=g;do O=I.lane,wr.lanes|=O,Qh|=O,I=I.next;while(I!==g)}else I===null&&(E.lanes=0);return[v.memoizedState,E.dispatch]}function Dy(g){var v=Ja(),E=v.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=g;var R=E.dispatch,I=E.pending,O=v.memoizedState;if(I!==null){E.pending=null;var ne=I=I.next;do O=g(O,ne.action),ne=ne.next;while(ne!==I);qa(O,v.memoizedState)||(so=!0),v.memoizedState=O,v.baseQueue===null&&(v.baseState=O),E.lastRenderedState=O}return[O,R]}function RI(){}function PI(g,v){var E=wr,R=Ja(),I=v(),O=!qa(R.memoizedState,I);if(O&&(R.memoizedState=I,so=!0),R=R.queue,Om(NI.bind(null,E,R,g),[g]),R.getSnapshot!==v||O||di!==null&&di.memoizedState.tag&1){if(E.flags|=2048,Fm(9,DI.bind(null,E,R,I,v),void 0,null),Ur===null)throw Error(o(349));Zh&30||II(E,v,I)}return I}function II(g,v,E){g.flags|=16384,g={getSnapshot:v,value:E},v=wr.updateQueue,v===null?(v={lastEffect:null,stores:null},wr.updateQueue=v,v.stores=[g]):(E=v.stores,E===null?v.stores=[g]:E.push(g))}function DI(g,v,E,R){v.value=E,v.getSnapshot=R,kI(v)&&Wo(g,1,-1)}function NI(g,v,E){return E(function(){kI(v)&&Wo(g,1,-1)})}function kI(g){var v=g.getSnapshot;g=g.value;try{var E=v();return!qa(g,E)}catch{return!0}}function Yb(g){var v=Ol();return typeof g=="function"&&(g=g()),v.memoizedState=v.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sf,lastRenderedState:g},v.queue=g,g=g.dispatch=qj.bind(null,wr,g),[v.memoizedState,g]}function Fm(g,v,E,R){return g={tag:g,create:v,destroy:E,deps:R,next:null},v=wr.updateQueue,v===null?(v={lastEffect:null,stores:null},wr.updateQueue=v,v.lastEffect=g.next=g):(E=v.lastEffect,E===null?v.lastEffect=g.next=g:(R=E.next,E.next=g,g.next=R,v.lastEffect=g)),g}function LI(){return Ja().memoizedState}function Ny(g,v,E,R){var I=Ol();wr.flags|=g,I.memoizedState=Fm(1|v,E,void 0,R===void 0?null:R)}function ky(g,v,E,R){var I=Ja();R=R===void 0?null:R;var O=void 0;if(zi!==null){var ne=zi.memoizedState;if(O=ne.destroy,R!==null&&Xb(R,ne.deps)){I.memoizedState=Fm(v,E,O,R);return}}wr.flags|=g,I.memoizedState=Fm(1|v,E,O,R)}function Kb(g,v){return Ny(8390656,8,g,v)}function Om(g,v){return ky(2048,8,g,v)}function FI(g,v){return ky(4,2,g,v)}function OI(g,v){return ky(4,4,g,v)}function BI(g,v){if(typeof v=="function")return g=g(),v(g),function(){v(null)};if(v!=null)return g=g(),v.current=g,function(){v.current=null}}function UI(g,v,E){return E=E!=null?E.concat([g]):null,ky(4,4,BI.bind(null,v,g),E)}function Zb(){}function zI(g,v){var E=Ja();v=v===void 0?null:v;var R=E.memoizedState;return R!==null&&v!==null&&Xb(v,R[1])?R[0]:(E.memoizedState=[g,v],g)}function VI(g,v){var E=Ja();v=v===void 0?null:v;var R=E.memoizedState;return R!==null&&v!==null&&Xb(v,R[1])?R[0]:(g=g(),E.memoizedState=[g,v],g)}function Xj(g,v){var E=Mn;Mn=E!==0&&4>E?E:4,g(!0);var R=Vo.transition;Vo.transition={};try{g(!1),v()}finally{Mn=E,Vo.transition=R}}function WI(){return Ja().memoizedState}function $j(g,v,E){var R=ku(g);E={lane:R,action:E,hasEagerState:!1,eagerState:null,next:null},HI(g)?GI(v,E):(jI(g,v,E),E=cs(),g=Wo(g,R,E),g!==null&&XI(g,v,R))}function qj(g,v,E){var R=ku(g),I={lane:R,action:E,hasEagerState:!1,eagerState:null,next:null};if(HI(g))GI(v,I);else{jI(g,v,I);var O=g.alternate;if(g.lanes===0&&(O===null||O.lanes===0)&&(O=v.lastRenderedReducer,O!==null))try{var ne=v.lastRenderedState,ue=O(ne,E);if(I.hasEagerState=!0,I.eagerState=ue,qa(ue,ne))return}catch{}finally{}E=cs(),g=Wo(g,R,E),g!==null&&XI(g,v,R)}}function HI(g){var v=g.alternate;return g===wr||v!==null&&v===wr}function GI(g,v){km=Py=!0;var E=g.pending;E===null?v.next=v:(v.next=E.next,E.next=v),g.pending=v}function jI(g,v,E){Ur!==null&&g.mode&1&&!(nn&2)?(g=v.interleaved,g===null?(E.next=E,Ka===null?Ka=[v]:Ka.push(v)):(E.next=g.next,g.next=E),v.interleaved=E):(g=v.pending,g===null?E.next=E:(E.next=g.next,g.next=E),v.pending=E)}function XI(g,v,E){if(E&4194240){var R=v.lanes;R&=g.pendingLanes,E|=R,v.lanes=E,Mb(g,E)}}var Ly={readContext:Oo,useCallback:Vi,useContext:Vi,useEffect:Vi,useImperativeHandle:Vi,useInsertionEffect:Vi,useLayoutEffect:Vi,useMemo:Vi,useReducer:Vi,useRef:Vi,useState:Vi,useDebugValue:Vi,useDeferredValue:Vi,useTransition:Vi,useMutableSource:Vi,useSyncExternalStore:Vi,useId:Vi,unstable_isNewReconciler:!1},Yj={readContext:Oo,useCallback:function(g,v){return Ol().memoizedState=[g,v===void 0?null:v],g},useContext:Oo,useEffect:Kb,useImperativeHandle:function(g,v,E){return E=E!=null?E.concat([g]):null,Ny(4194308,4,BI.bind(null,v,g),E)},useLayoutEffect:function(g,v){return Ny(4194308,4,g,v)},useInsertionEffect:function(g,v){return Ny(4,2,g,v)},useMemo:function(g,v){var E=Ol();return v=v===void 0?null:v,g=g(),E.memoizedState=[g,v],g},useReducer:function(g,v,E){var R=Ol();return v=E!==void 0?E(v):v,R.memoizedState=R.baseState=v,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:v},R.queue=g,g=g.dispatch=$j.bind(null,wr,g),[R.memoizedState,g]},useRef:function(g){var v=Ol();return g={current:g},v.memoizedState=g},useState:Yb,useDebugValue:Zb,useDeferredValue:function(g){var v=Yb(g),E=v[0],R=v[1];return Kb(function(){var I=Vo.transition;Vo.transition={};try{R(g)}finally{Vo.transition=I}},[g]),E},useTransition:function(){var g=Yb(!1),v=g[0];return g=Xj.bind(null,g[1]),Ol().memoizedState=g,[v,g]},useMutableSource:function(){},useSyncExternalStore:function(g,v,E){var R=wr,I=Ol();if(tr){if(E===void 0)throw Error(o(407));E=E()}else{if(E=v(),Ur===null)throw Error(o(349));Zh&30||II(R,v,E)}I.memoizedState=E;var O={value:E,getSnapshot:v};return I.queue=O,Kb(NI.bind(null,R,O,g),[g]),R.flags|=2048,Fm(9,DI.bind(null,R,O,E,v),void 0,null),E},useId:function(){var g=Ol(),v=Ur.identifierPrefix;if(tr){var E=Fl,R=Ll;E=(R&~(1<<32-no(R)-1)).toString(32)+E,v=":"+v+"R"+E,E=Lm++,0<E&&(v+="H"+E.toString(32)),v+=":"}else E=jj++,v=":"+v+"r"+E.toString(32)+":";return g.memoizedState=v},unstable_isNewReconciler:!1},Kj={readContext:Oo,useCallback:zI,useContext:Oo,useEffect:Om,useImperativeHandle:UI,useInsertionEffect:FI,useLayoutEffect:OI,useMemo:VI,useReducer:Iy,useRef:LI,useState:function(){return Iy(sf)},useDebugValue:Zb,useDeferredValue:function(g){var v=Iy(sf),E=v[0],R=v[1];return Om(function(){var I=Vo.transition;Vo.transition={};try{R(g)}finally{Vo.transition=I}},[g]),E},useTransition:function(){var g=Iy(sf)[0],v=Ja().memoizedState;return[g,v]},useMutableSource:RI,useSyncExternalStore:PI,useId:WI,unstable_isNewReconciler:!1},Zj={readContext:Oo,useCallback:zI,useContext:Oo,useEffect:Om,useImperativeHandle:UI,useInsertionEffect:FI,useLayoutEffect:OI,useMemo:VI,useReducer:Dy,useRef:LI,useState:function(){return Dy(sf)},useDebugValue:Zb,useDeferredValue:function(g){var v=Dy(sf),E=v[0],R=v[1];return Om(function(){var I=Vo.transition;Vo.transition={};try{R(g)}finally{Vo.transition=I}},[g]),E},useTransition:function(){var g=Dy(sf)[0],v=Ja().memoizedState;return[g,v]},useMutableSource:RI,useSyncExternalStore:PI,useId:WI,unstable_isNewReconciler:!1};function Jb(g,v){try{var E="",R=v;do E+=Gj(R),R=R.return;while(R);var I=E}catch(O){I=`
Error generating stack: `+O.message+`
`+O.stack}return{value:g,source:v,stack:I}}function Qb(g,v){try{console.error(v.value)}catch(E){setTimeout(function(){throw E})}}var Jj=typeof WeakMap=="function"?WeakMap:Map;function $I(g,v,E){E=kl(-1,E),E.tag=3,E.payload={element:null};var R=v.value;return E.callback=function(){Zy||(Zy=!0,vS=R),Qb(g,v)},E}function qI(g,v,E){E=kl(-1,E),E.tag=3;var R=g.type.getDerivedStateFromError;if(typeof R=="function"){var I=v.value;E.payload=function(){return R(I)},E.callback=function(){Qb(g,v)}}var O=g.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(E.callback=function(){Qb(g,v),typeof R!="function"&&(Du===null?Du=new Set([this]):Du.add(this));var ne=v.stack;this.componentDidCatch(v.value,{componentStack:ne!==null?ne:""})}),E}function YI(g,v,E){var R=g.pingCache;if(R===null){R=g.pingCache=new Jj;var I=new Set;R.set(v,I)}else I=R.get(v),I===void 0&&(I=new Set,R.set(v,I));I.has(E)||(I.add(E),g=hX.bind(null,g,v,E),v.then(g,g))}function KI(g){do{var v;if((v=g.tag===13)&&(v=g.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return g;g=g.return}while(g!==null);return null}function ZI(g,v,E,R,I){return g.mode&1?(g.flags|=65536,g.lanes=I,g):(g===v?g.flags|=65536:(g.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(v=kl(-1,1),v.tag=2,Iu(E,v))),E.lanes|=1),g)}function Qa(g){g.flags|=4}function JI(g,v){if(g!==null&&g.child===v.child)return!0;if(v.flags&16)return!1;for(g=v.child;g!==null;){if(g.flags&12854||g.subtreeFlags&12854)return!1;g=g.sibling}return!0}var Bm,Um,Fy,Oy;if(Be)Bm=function(g,v){for(var E=v.child;E!==null;){if(E.tag===5||E.tag===6)ee(g,E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===v)break;for(;E.sibling===null;){if(E.return===null||E.return===v)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},Um=function(){},Fy=function(g,v,E,R,I){if(g=g.memoizedProps,g!==R){var O=v.stateNode,ne=Za(zo.current);E=se(O,E,g,R,I,ne),(v.updateQueue=E)&&Qa(v)}},Oy=function(g,v,E,R){E!==R&&Qa(v)};else if(J){Bm=function(g,v,E,R){for(var I=v.child;I!==null;){if(I.tag===5){var O=I.stateNode;E&&R&&(O=ut(O,I.type,I.memoizedProps,I)),ee(g,O)}else if(I.tag===6)O=I.stateNode,E&&R&&(O=ot(O,I.memoizedProps,I)),ee(g,O);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)O=I.child,O!==null&&(O.return=I),Bm(g,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===v)break;for(;I.sibling===null;){if(I.return===null||I.return===v)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};var QI=function(g,v,E,R){for(var I=v.child;I!==null;){if(I.tag===5){var O=I.stateNode;E&&R&&(O=ut(O,I.type,I.memoizedProps,I)),_t(g,O)}else if(I.tag===6)O=I.stateNode,E&&R&&(O=ot(O,I.memoizedProps,I)),_t(g,O);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)O=I.child,O!==null&&(O.return=I),QI(g,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===v)break;for(;I.sibling===null;){if(I.return===null||I.return===v)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};Um=function(g,v){var E=v.stateNode;if(!JI(g,v)){g=E.containerInfo;var R=At(g);QI(R,v,!1,!1),E.pendingChildren=R,Qa(v),Jt(g,R)}},Fy=function(g,v,E,R,I){var O=g.stateNode,ne=g.memoizedProps;if((g=JI(g,v))&&ne===R)v.stateNode=O;else{var ue=v.stateNode,ke=Za(zo.current),Ye=null;ne!==R&&(Ye=se(ue,E,ne,R,I,ke)),g&&Ye===null?v.stateNode=O:(O=qe(O,Ye,E,ne,R,v,g,ue),te(O,E,R,I,ke)&&Qa(v),v.stateNode=O,g?Qa(v):Bm(O,v,!1,!1))}},Oy=function(g,v,E,R){E!==R?(g=Za(Yh.current),E=Za(zo.current),v.stateNode=_e(R,g,E,v),Qa(v)):v.stateNode=g.stateNode}}else Um=function(){},Fy=function(){},Oy=function(){};function zm(g,v){if(!tr)switch(g.tailMode){case"hidden":v=g.tail;for(var E=null;v!==null;)v.alternate!==null&&(E=v),v=v.sibling;E===null?g.tail=null:E.sibling=null;break;case"collapsed":E=g.tail;for(var R=null;E!==null;)E.alternate!==null&&(R=E),E=E.sibling;R===null?v||g.tail===null?g.tail=null:g.tail.sibling=null:R.sibling=null}}function Wi(g){var v=g.alternate!==null&&g.alternate.child===g.child,E=0,R=0;if(v)for(var I=g.child;I!==null;)E|=I.lanes|I.childLanes,R|=I.subtreeFlags&14680064,R|=I.flags&14680064,I.return=g,I=I.sibling;else for(I=g.child;I!==null;)E|=I.lanes|I.childLanes,R|=I.subtreeFlags,R|=I.flags,I.return=g,I=I.sibling;return g.subtreeFlags|=R,g.childLanes=E,v}function Qj(g,v,E){var R=v.pendingProps;switch(Bb(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wi(v),null;case 1:return fi(v.type)&&Rr(),Wi(v),null;case 3:return R=v.stateNode,Kh(),Lt(_r),Lt(tn),jb(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(g===null||g.child===null)&&(Pm(v)?Qa(v):g===null||g.memoizedState.isDehydrated&&!(v.flags&256)||(v.flags|=1024,ga!==null&&(_S(ga),ga=null))),Um(g,v),Wi(v),null;case 5:Hb(v),E=Za(Yh.current);var I=v.type;if(g!==null&&v.stateNode!=null)Fy(g,v,I,R,E),g.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!R){if(v.stateNode===null)throw Error(o(166));return Wi(v),null}if(g=Za(zo.current),Pm(v)){if(!he)throw Error(o(175));g=Dn(v.stateNode,v.type,v.memoizedProps,E,g,v,!Rm),v.updateQueue=g,g!==null&&Qa(v)}else{var O=$(I,R,E,g,v);Bm(O,v,!1,!1),v.stateNode=O,te(O,I,R,E,g)&&Qa(v)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return Wi(v),null;case 6:if(g&&v.stateNode!=null)Oy(g,v,g.memoizedProps,R);else{if(typeof R!="string"&&v.stateNode===null)throw Error(o(166));if(g=Za(Yh.current),E=Za(zo.current),Pm(v)){if(!he)throw Error(o(176));if(g=v.stateNode,R=v.memoizedProps,(E=_n(g,R,v,!Rm))&&(I=ro,I!==null))switch(O=(I.mode&1)!==0,I.tag){case 3:dt(I.stateNode.containerInfo,g,R,O);break;case 5:Nt(I.type,I.memoizedProps,I.stateNode,g,R,O)}E&&Qa(v)}else v.stateNode=_e(R,g,E,v)}return Wi(v),null;case 13:if(Lt(or),R=v.memoizedState,tr&&io!==null&&v.mode&1&&!(v.flags&128)){for(g=io;g;)g=Bt(g);return $h(),v.flags|=98560,v}if(R!==null&&R.dehydrated!==null){if(R=Pm(v),g===null){if(!R)throw Error(o(318));if(!he)throw Error(o(344));if(g=v.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));qr(g,v)}else $h(),!(v.flags&128)&&(v.memoizedState=null),v.flags|=4;return Wi(v),null}return ga!==null&&(_S(ga),ga=null),v.flags&128?(v.lanes=E,v):(R=R!==null,E=!1,g===null?Pm(v):E=g.memoizedState!==null,R&&!E&&(v.child.flags|=8192,v.mode&1&&(g===null||or.current&1?Yr===0&&(Yr=3):bS())),v.updateQueue!==null&&(v.flags|=4),Wi(v),null);case 4:return Kh(),Um(g,v),g===null&&Ie(v.stateNode.containerInfo),Wi(v),null;case 10:return Db(v.type._context),Wi(v),null;case 17:return fi(v.type)&&Rr(),Wi(v),null;case 19:if(Lt(or),I=v.memoizedState,I===null)return Wi(v),null;if(R=(v.flags&128)!==0,O=I.rendering,O===null)if(R)zm(I,!1);else{if(Yr!==0||g!==null&&g.flags&128)for(g=v.child;g!==null;){if(O=Ay(g),O!==null){for(v.flags|=128,zm(I,!1),g=O.updateQueue,g!==null&&(v.updateQueue=g,v.flags|=4),v.subtreeFlags=0,g=E,R=v.child;R!==null;)E=R,I=g,E.flags&=14680066,O=E.alternate,O===null?(E.childLanes=0,E.lanes=I,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=O.childLanes,E.lanes=O.lanes,E.child=O.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=O.memoizedProps,E.memoizedState=O.memoizedState,E.updateQueue=O.updateQueue,E.type=O.type,I=O.dependencies,E.dependencies=I===null?null:{lanes:I.lanes,firstContext:I.firstContext}),R=R.sibling;return nt(or,or.current&1|2),v.child}g=g.sibling}I.tail!==null&&hi()>gS&&(v.flags|=128,R=!0,zm(I,!1),v.lanes=4194304)}else{if(!R)if(g=Ay(O),g!==null){if(v.flags|=128,R=!0,g=g.updateQueue,g!==null&&(v.updateQueue=g,v.flags|=4),zm(I,!0),I.tail===null&&I.tailMode==="hidden"&&!O.alternate&&!tr)return Wi(v),null}else 2*hi()-I.renderingStartTime>gS&&E!==1073741824&&(v.flags|=128,R=!0,zm(I,!1),v.lanes=4194304);I.isBackwards?(O.sibling=v.child,v.child=O):(g=I.last,g!==null?g.sibling=O:v.child=O,I.last=O)}return I.tail!==null?(v=I.tail,I.rendering=v,I.tail=v.sibling,I.renderingStartTime=hi(),v.sibling=null,g=or.current,nt(or,R?g&1|2:g&1),v):(Wi(v),null);case 22:case 23:return wS(),R=v.memoizedState!==null,g!==null&&g.memoizedState!==null!==R&&(v.flags|=8192),R&&v.mode&1?oo&1073741824&&(Wi(v),Be&&v.subtreeFlags&6&&(v.flags|=8192)):Wi(v),null;case 24:return null;case 25:return null}throw Error(o(156,v.tag))}var eX=a.ReactCurrentOwner,so=!1;function us(g,v,E,R){v.child=g===null?CI(v,null,E,R):qh(v,g.child,E,R)}function eD(g,v,E,R,I){E=E.render;var O=v.ref;return Gh(v,I),R=$b(g,v,E,R,O,I),E=qb(),g!==null&&!so?(v.updateQueue=g.updateQueue,v.flags&=-2053,g.lanes&=~I,Bl(g,v,I)):(tr&&E&&Ob(v),v.flags|=1,us(g,v,R,I),v.child)}function tD(g,v,E,R,I){if(g===null){var O=E.type;return typeof O=="function"&&!SS(O)&&O.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(v.tag=15,v.type=O,nD(g,v,O,R,I)):(g=i1(E.type,null,R,v,v.mode,I),g.ref=v.ref,g.return=v,v.child=g)}if(O=g.child,!(g.lanes&I)){var ne=O.memoizedProps;if(E=E.compare,E=E!==null?E:xy,E(ne,R)&&g.ref===v.ref)return Bl(g,v,I)}return v.flags|=1,g=Fu(O,R),g.ref=v.ref,g.return=v,v.child=g}function nD(g,v,E,R,I){if(g!==null&&xy(g.memoizedProps,R)&&g.ref===v.ref)if(so=!1,(g.lanes&I)!==0)g.flags&131072&&(so=!0);else return v.lanes=g.lanes,Bl(g,v,I);return eS(g,v,E,R,I)}function rD(g,v,E){var R=v.pendingProps,I=R.children,O=g!==null?g.memoizedState:null;if(R.mode==="hidden")if(!(v.mode&1))v.memoizedState={baseLanes:0,cachePool:null},nt(Jh,oo),oo|=E;else if(E&1073741824)v.memoizedState={baseLanes:0,cachePool:null},R=O!==null?O.baseLanes:E,nt(Jh,oo),oo|=R;else return g=O!==null?O.baseLanes|E:E,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:g,cachePool:null},v.updateQueue=null,nt(Jh,oo),oo|=g,null;else O!==null?(R=O.baseLanes|E,v.memoizedState=null):R=E,nt(Jh,oo),oo|=R;return us(g,v,I,E),v.child}function iD(g,v){var E=v.ref;(g===null&&E!==null||g!==null&&g.ref!==E)&&(v.flags|=512,v.flags|=2097152)}function eS(g,v,E,R,I){var O=fi(E)?ja:tn.current;return O=Fo(v,O),Gh(v,I),E=$b(g,v,E,R,O,I),R=qb(),g!==null&&!so?(v.updateQueue=g.updateQueue,v.flags&=-2053,g.lanes&=~I,Bl(g,v,I)):(tr&&R&&Ob(v),v.flags|=1,us(g,v,E,I),v.child)}function sD(g,v,E,R,I){if(fi(E)){var O=!0;Ti(v)}else O=!1;if(Gh(v,I),v.stateNode===null)g!==null&&(g.alternate=null,v.alternate=null,v.flags|=2),xI(v,E,R),Fb(v,E,R,I),R=!0;else if(g===null){var ne=v.stateNode,ue=v.memoizedProps;ne.props=ue;var ke=ne.context,Ye=E.contextType;typeof Ye=="object"&&Ye!==null?Ye=Oo(Ye):(Ye=fi(E)?ja:tn.current,Ye=Fo(v,Ye));var mt=E.getDerivedStateFromProps,Xt=typeof mt=="function"||typeof ne.getSnapshotBeforeUpdate=="function";Xt||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(ue!==R||ke!==Ye)&&_I(v,ne,R,Ye),Pu=!1;var Ot=v.memoizedState;ne.state=Ot,Sy(v,R,ne,I),ke=v.memoizedState,ue!==R||Ot!==ke||_r.current||Pu?(typeof mt=="function"&&(Lb(v,E,mt,R),ke=v.memoizedState),(ue=Pu||yI(v,E,ue,R,Ot,ke,Ye))?(Xt||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(v.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=R,v.memoizedState=ke),ne.props=R,ne.state=ke,ne.context=Ye,R=ue):(typeof ne.componentDidMount=="function"&&(v.flags|=4194308),R=!1)}else{ne=v.stateNode,pI(g,v),ue=v.memoizedProps,Ye=v.type===v.elementType?ue:ma(v.type,ue),ne.props=Ye,Xt=v.pendingProps,Ot=ne.context,ke=E.contextType,typeof ke=="object"&&ke!==null?ke=Oo(ke):(ke=fi(E)?ja:tn.current,ke=Fo(v,ke));var zn=E.getDerivedStateFromProps;(mt=typeof zn=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(ue!==Xt||Ot!==ke)&&_I(v,ne,R,ke),Pu=!1,Ot=v.memoizedState,ne.state=Ot,Sy(v,R,ne,I);var It=v.memoizedState;ue!==Xt||Ot!==It||_r.current||Pu?(typeof zn=="function"&&(Lb(v,E,zn,R),It=v.memoizedState),(Ye=Pu||yI(v,E,Ye,R,Ot,It,ke)||!1)?(mt||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(R,It,ke),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(R,It,ke)),typeof ne.componentDidUpdate=="function"&&(v.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof ne.componentDidUpdate!="function"||ue===g.memoizedProps&&Ot===g.memoizedState||(v.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||ue===g.memoizedProps&&Ot===g.memoizedState||(v.flags|=1024),v.memoizedProps=R,v.memoizedState=It),ne.props=R,ne.state=It,ne.context=ke,R=Ye):(typeof ne.componentDidUpdate!="function"||ue===g.memoizedProps&&Ot===g.memoizedState||(v.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||ue===g.memoizedProps&&Ot===g.memoizedState||(v.flags|=1024),R=!1)}return tS(g,v,E,R,O,I)}function tS(g,v,E,R,I,O){iD(g,v);var ne=(v.flags&128)!==0;if(!R&&!ne)return I&&Wh(v,E,!1),Bl(g,v,O);R=v.stateNode,eX.current=v;var ue=ne&&typeof E.getDerivedStateFromError!="function"?null:R.render();return v.flags|=1,g!==null&&ne?(v.child=qh(v,g.child,null,O),v.child=qh(v,null,ue,O)):us(g,v,ue,O),v.memoizedState=R.state,I&&Wh(v,E,!0),v.child}function oD(g){var v=g.stateNode;v.pendingContext?Xa(g,v.pendingContext,v.pendingContext!==v.context):v.context&&Xa(g,v.context,!1),Wb(g,v.containerInfo)}function aD(g,v,E,R,I){return $h(),Vb(I),v.flags|=256,us(g,v,E,R),v.child}var By={dehydrated:null,treeContext:null,retryLane:0};function Uy(g){return{baseLanes:g,cachePool:null}}function lD(g,v,E){var R=v.pendingProps,I=or.current,O=!1,ne=(v.flags&128)!==0,ue;if((ue=ne)||(ue=g!==null&&g.memoizedState===null?!1:(I&2)!==0),ue?(O=!0,v.flags&=-129):(g===null||g.memoizedState!==null)&&(I|=1),nt(or,I&1),g===null)return zb(v),g=v.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?(v.mode&1?kt(g)?v.lanes=8:v.lanes=1073741824:v.lanes=1,null):(I=R.children,g=R.fallback,O?(R=v.mode,O=v.child,I={mode:"hidden",children:I},!(R&1)&&O!==null?(O.childLanes=0,O.pendingProps=I):O=s1(I,R,0,null),g=ff(g,R,E,null),O.return=v,g.return=v,O.sibling=g,v.child=O,v.child.memoizedState=Uy(E),v.memoizedState=By,g):nS(v,I));if(I=g.memoizedState,I!==null){if(ue=I.dehydrated,ue!==null){if(ne)return v.flags&256?(v.flags&=-257,zy(g,v,E,Error(o(422)))):v.memoizedState!==null?(v.child=g.child,v.flags|=128,null):(O=R.fallback,I=v.mode,R=s1({mode:"visible",children:R.children},I,0,null),O=ff(O,I,E,null),O.flags|=2,R.return=v,O.return=v,R.sibling=O,v.child=R,v.mode&1&&qh(v,g.child,null,E),v.child.memoizedState=Uy(E),v.memoizedState=By,O);if(!(v.mode&1))v=zy(g,v,E,null);else if(kt(ue))v=zy(g,v,E,Error(o(419)));else if(R=(E&g.childLanes)!==0,so||R){if(R=Ur,R!==null){switch(E&-E){case 4:O=2;break;case 16:O=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:O=32;break;case 536870912:O=268435456;break;default:O=0}R=O&(R.suspendedLanes|E)?0:O,R!==0&&R!==I.retryLane&&(I.retryLane=R,Wo(g,R,-1))}bS(),v=zy(g,v,E,Error(o(421)))}else Et(ue)?(v.flags|=128,v.child=g.child,v=dX.bind(null,g),Bn(ue,v),v=null):(E=I.treeContext,he&&(io=Ln(ue),ro=v,tr=!0,ga=null,Rm=!1,E!==null&&(Bo[Uo++]=Ll,Bo[Uo++]=Fl,Bo[Uo++]=nf,Ll=E.id,Fl=E.overflow,nf=v)),v=nS(v,v.pendingProps.children),v.flags|=4096);return v}return O?(R=cD(g,v,R.children,R.fallback,E),O=v.child,I=g.child.memoizedState,O.memoizedState=I===null?Uy(E):{baseLanes:I.baseLanes|E,cachePool:null},O.childLanes=g.childLanes&~E,v.memoizedState=By,R):(E=uD(g,v,R.children,E),v.memoizedState=null,E)}return O?(R=cD(g,v,R.children,R.fallback,E),O=v.child,I=g.child.memoizedState,O.memoizedState=I===null?Uy(E):{baseLanes:I.baseLanes|E,cachePool:null},O.childLanes=g.childLanes&~E,v.memoizedState=By,R):(E=uD(g,v,R.children,E),v.memoizedState=null,E)}function nS(g,v){return v=s1({mode:"visible",children:v},g.mode,0,null),v.return=g,g.child=v}function uD(g,v,E,R){var I=g.child;return g=I.sibling,E=Fu(I,{mode:"visible",children:E}),!(v.mode&1)&&(E.lanes=R),E.return=v,E.sibling=null,g!==null&&(R=v.deletions,R===null?(v.deletions=[g],v.flags|=16):R.push(g)),v.child=E}function cD(g,v,E,R,I){var O=v.mode;g=g.child;var ne=g.sibling,ue={mode:"hidden",children:E};return!(O&1)&&v.child!==g?(E=v.child,E.childLanes=0,E.pendingProps=ue,v.deletions=null):(E=Fu(g,ue),E.subtreeFlags=g.subtreeFlags&14680064),ne!==null?R=Fu(ne,R):(R=ff(R,O,I,null),R.flags|=2),R.return=v,E.return=v,E.sibling=R,v.child=E,R}function zy(g,v,E,R){return R!==null&&Vb(R),qh(v,g.child,null,E),g=nS(v,v.pendingProps.children),g.flags|=2,v.memoizedState=null,g}function fD(g,v,E){g.lanes|=v;var R=g.alternate;R!==null&&(R.lanes|=v),Nb(g.return,v,E)}function rS(g,v,E,R,I){var O=g.memoizedState;O===null?g.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:R,tail:E,tailMode:I}:(O.isBackwards=v,O.rendering=null,O.renderingStartTime=0,O.last=R,O.tail=E,O.tailMode=I)}function hD(g,v,E){var R=v.pendingProps,I=R.revealOrder,O=R.tail;if(us(g,v,R.children,E),R=or.current,R&2)R=R&1|2,v.flags|=128;else{if(g!==null&&g.flags&128)e:for(g=v.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&fD(g,E,v);else if(g.tag===19)fD(g,E,v);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===v)break e;for(;g.sibling===null;){if(g.return===null||g.return===v)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}R&=1}if(nt(or,R),!(v.mode&1))v.memoizedState=null;else switch(I){case"forwards":for(E=v.child,I=null;E!==null;)g=E.alternate,g!==null&&Ay(g)===null&&(I=E),E=E.sibling;E=I,E===null?(I=v.child,v.child=null):(I=E.sibling,E.sibling=null),rS(v,!1,I,E,O);break;case"backwards":for(E=null,I=v.child,v.child=null;I!==null;){if(g=I.alternate,g!==null&&Ay(g)===null){v.child=I;break}g=I.sibling,I.sibling=E,E=I,I=g}rS(v,!0,E,null,O);break;case"together":rS(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function Bl(g,v,E){if(g!==null&&(v.dependencies=g.dependencies),Qh|=v.lanes,!(E&v.childLanes))return null;if(g!==null&&v.child!==g.child)throw Error(o(153));if(v.child!==null){for(g=v.child,E=Fu(g,g.pendingProps),v.child=E,E.return=v;g.sibling!==null;)g=g.sibling,E=E.sibling=Fu(g,g.pendingProps),E.return=v;E.sibling=null}return v.child}function tX(g,v,E){switch(v.tag){case 3:oD(v),$h();break;case 5:AI(v);break;case 1:fi(v.type)&&Ti(v);break;case 4:Wb(v,v.stateNode.containerInfo);break;case 10:dI(v,v.type._context,v.memoizedProps.value);break;case 13:var R=v.memoizedState;if(R!==null)return R.dehydrated!==null?(nt(or,or.current&1),v.flags|=128,null):E&v.child.childLanes?lD(g,v,E):(nt(or,or.current&1),g=Bl(g,v,E),g!==null?g.sibling:null);nt(or,or.current&1);break;case 19:if(R=(E&v.childLanes)!==0,g.flags&128){if(R)return hD(g,v,E);v.flags|=128}var I=v.memoizedState;if(I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),nt(or,or.current),R)break;return null;case 22:case 23:return v.lanes=0,rD(g,v,E)}return Bl(g,v,E)}function nX(g,v){switch(Bb(v),v.tag){case 1:return fi(v.type)&&Rr(),g=v.flags,g&65536?(v.flags=g&-65537|128,v):null;case 3:return Kh(),Lt(_r),Lt(tn),jb(),g=v.flags,g&65536&&!(g&128)?(v.flags=g&-65537|128,v):null;case 5:return Hb(v),null;case 13:if(Lt(or),g=v.memoizedState,g!==null&&g.dehydrated!==null){if(v.alternate===null)throw Error(o(340));$h()}return g=v.flags,g&65536?(v.flags=g&-65537|128,v):null;case 19:return Lt(or),null;case 4:return Kh(),null;case 10:return Db(v.type._context),null;case 22:case 23:return wS(),null;case 24:return null;default:return null}}var Vy=!1,of=!1,rX=typeof WeakSet=="function"?WeakSet:Set,rt=null;function Wy(g,v){var E=g.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(R){Ds(g,v,R)}else E.current=null}function iS(g,v,E){try{E()}catch(R){Ds(g,v,R)}}var dD=!1;function iX(g,v){for(B(g.containerInfo),rt=v;rt!==null;)if(g=rt,v=g.child,(g.subtreeFlags&1028)!==0&&v!==null)v.return=g,rt=v;else for(;rt!==null;){g=rt;try{var E=g.alternate;if(g.flags&1024)switch(g.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var R=E.memoizedProps,I=E.memoizedState,O=g.stateNode,ne=O.getSnapshotBeforeUpdate(g.elementType===g.type?R:ma(g.type,R),I);O.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:Be&&je(g.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ue){Ds(g,g.return,ue)}if(v=g.sibling,v!==null){v.return=g.return,rt=v;break}rt=g.return}return E=dD,dD=!1,E}function af(g,v,E){var R=v.updateQueue;if(R=R!==null?R.lastEffect:null,R!==null){var I=R=R.next;do{if((I.tag&g)===g){var O=I.destroy;I.destroy=void 0,O!==void 0&&iS(v,E,O)}I=I.next}while(I!==R)}}function Vm(g,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var E=v=v.next;do{if((E.tag&g)===g){var R=E.create;E.destroy=R()}E=E.next}while(E!==v)}}function sS(g){var v=g.ref;if(v!==null){var E=g.stateNode;switch(g.tag){case 5:g=W(E);break;default:g=E}typeof v=="function"?v(g):v.current=g}}function pD(g,v,E){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(vy,v)}catch{}switch(v.tag){case 0:case 11:case 14:case 15:if(g=v.updateQueue,g!==null&&(g=g.lastEffect,g!==null)){var R=g=g.next;do{var I=R,O=I.destroy;I=I.tag,O!==void 0&&(I&2||I&4)&&iS(v,E,O),R=R.next}while(R!==g)}break;case 1:if(Wy(v,E),g=v.stateNode,typeof g.componentWillUnmount=="function")try{g.props=v.memoizedProps,g.state=v.memoizedState,g.componentWillUnmount()}catch(ne){Ds(v,E,ne)}break;case 5:Wy(v,E);break;case 4:Be?_D(g,v,E):J&&J&&(v=v.stateNode.containerInfo,E=At(v),cn(v,E))}}function mD(g,v,E){for(var R=v;;)if(pD(g,R,E),R.child===null||Be&&R.tag===4){if(R===v)break;for(;R.sibling===null;){if(R.return===null||R.return===v)return;R=R.return}R.sibling.return=R.return,R=R.sibling}else R.child.return=R,R=R.child}function gD(g){var v=g.alternate;v!==null&&(g.alternate=null,gD(v)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(v=g.stateNode,v!==null&&oe(v)),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function vD(g){return g.tag===5||g.tag===3||g.tag===4}function yD(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||vD(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function xD(g){if(Be){e:{for(var v=g.return;v!==null;){if(vD(v))break e;v=v.return}throw Error(o(160))}var E=v;switch(E.tag){case 5:v=E.stateNode,E.flags&32&&(Ft(v),E.flags&=-33),E=yD(g),aS(g,E,v);break;case 3:case 4:v=E.stateNode.containerInfo,E=yD(g),oS(g,E,v);break;default:throw Error(o(161))}}}function oS(g,v,E){var R=g.tag;if(R===5||R===6)g=g.stateNode,v?Qe(E,g,v):De(E,g);else if(R!==4&&(g=g.child,g!==null))for(oS(g,v,E),g=g.sibling;g!==null;)oS(g,v,E),g=g.sibling}function aS(g,v,E){var R=g.tag;if(R===5||R===6)g=g.stateNode,v?at(E,g,v):Pe(E,g);else if(R!==4&&(g=g.child,g!==null))for(aS(g,v,E),g=g.sibling;g!==null;)aS(g,v,E),g=g.sibling}function _D(g,v,E){for(var R=v,I=!1,O,ne;;){if(!I){I=R.return;e:for(;;){if(I===null)throw Error(o(160));switch(O=I.stateNode,I.tag){case 5:ne=!1;break e;case 3:O=O.containerInfo,ne=!0;break e;case 4:O=O.containerInfo,ne=!0;break e}I=I.return}I=!0}if(R.tag===5||R.tag===6)mD(g,R,E),ne?Dt(O,R.stateNode):$e(O,R.stateNode);else if(R.tag===18)ne?ye(O,R.stateNode):xe(O,R.stateNode);else if(R.tag===4){if(R.child!==null){O=R.stateNode.containerInfo,ne=!0,R.child.return=R,R=R.child;continue}}else if(pD(g,R,E),R.child!==null){R.child.return=R,R=R.child;continue}if(R===v)break;for(;R.sibling===null;){if(R.return===null||R.return===v)return;R=R.return,R.tag===4&&(I=!1)}R.sibling.return=R.return,R=R.sibling}}function lS(g,v){if(Be){switch(v.tag){case 0:case 11:case 14:case 15:af(3,v,v.return),Vm(3,v),af(5,v,v.return);return;case 1:return;case 5:var E=v.stateNode;if(E!=null){var R=v.memoizedProps;g=g!==null?g.memoizedProps:R;var I=v.type,O=v.updateQueue;v.updateQueue=null,O!==null&&Ze(E,O,I,g,R,v)}return;case 6:if(v.stateNode===null)throw Error(o(162));E=v.memoizedProps,Ae(v.stateNode,g!==null?g.memoizedProps:E,E);return;case 3:he&&g!==null&&g.memoizedState.isDehydrated&&ce(v.stateNode.containerInfo);return;case 12:return;case 13:Hy(v);return;case 19:Hy(v);return;case 17:return}throw Error(o(163))}switch(v.tag){case 0:case 11:case 14:case 15:af(3,v,v.return),Vm(3,v),af(5,v,v.return);return;case 12:return;case 13:Hy(v);return;case 19:Hy(v);return;case 3:he&&g!==null&&g.memoizedState.isDehydrated&&ce(v.stateNode.containerInfo);break;case 22:case 23:return}e:if(J){switch(v.tag){case 1:case 5:case 6:break e;case 3:case 4:v=v.stateNode,cn(v.containerInfo,v.pendingChildren);break e}throw Error(o(163))}}function Hy(g){var v=g.updateQueue;if(v!==null){g.updateQueue=null;var E=g.stateNode;E===null&&(E=g.stateNode=new rX),v.forEach(function(R){var I=pX.bind(null,g,R);E.has(R)||(E.add(R),R.then(I,I))})}}function sX(g,v){for(rt=v;rt!==null;){v=rt;var E=v.deletions;if(E!==null)for(var R=0;R<E.length;R++){var I=E[R];try{var O=g;Be?_D(O,I,v):mD(O,I,v);var ne=I.alternate;ne!==null&&(ne.return=null),I.return=null}catch(Rt){Ds(I,v,Rt)}}if(E=v.child,v.subtreeFlags&12854&&E!==null)E.return=v,rt=E;else for(;rt!==null;){v=rt;try{var ue=v.flags;if(ue&32&&Be&&Ft(v.stateNode),ue&512){var ke=v.alternate;if(ke!==null){var Ye=ke.ref;Ye!==null&&(typeof Ye=="function"?Ye(null):Ye.current=null)}}if(ue&8192)switch(v.tag){case 13:if(v.memoizedState!==null){var mt=v.alternate;(mt===null||mt.memoizedState===null)&&(mS=hi())}break;case 22:var Xt=v.memoizedState!==null,Ot=v.alternate,zn=Ot!==null&&Ot.memoizedState!==null;if(E=v,Be){e:if(R=E,I=Xt,O=null,Be)for(var It=R;;){if(It.tag===5){if(O===null){O=It;var Hi=It.stateNode;I?sn(Hi):He(It.stateNode,It.memoizedProps)}}else if(It.tag===6){if(O===null){var Go=It.stateNode;I?Ke(Go):re(Go,It.memoizedProps)}}else if((It.tag!==22&&It.tag!==23||It.memoizedState===null||It===R)&&It.child!==null){It.child.return=It,It=It.child;continue}if(It===R)break;for(;It.sibling===null;){if(It.return===null||It.return===R)break e;O===It&&(O=null),It=It.return}O===It&&(O=null),It.sibling.return=It.return,It=It.sibling}}if(Xt&&!zn&&E.mode&1){rt=E;for(var be=E.child;be!==null;){for(E=rt=be;rt!==null;){R=rt;var fe=R.child;switch(R.tag){case 0:case 11:case 14:case 15:af(4,R,R.return);break;case 1:Wy(R,R.return);var Re=R.stateNode;if(typeof Re.componentWillUnmount=="function"){var st=R.return;try{Re.props=R.memoizedProps,Re.state=R.memoizedState,Re.componentWillUnmount()}catch(Rt){Ds(R,st,Rt)}}break;case 5:Wy(R,R.return);break;case 22:if(R.memoizedState!==null){SD(E);continue}}fe!==null?(fe.return=R,rt=fe):SD(E)}be=be.sibling}}}switch(ue&4102){case 2:xD(v),v.flags&=-3;break;case 6:xD(v),v.flags&=-3,lS(v.alternate,v);break;case 4096:v.flags&=-4097;break;case 4100:v.flags&=-4097,lS(v.alternate,v);break;case 4:lS(v.alternate,v)}}catch(Rt){Ds(v,v.return,Rt)}if(E=v.sibling,E!==null){E.return=v.return,rt=E;break}rt=v.return}}}function oX(g,v,E){rt=g,wD(g)}function wD(g,v,E){for(var R=(g.mode&1)!==0;rt!==null;){var I=rt,O=I.child;if(I.tag===22&&R){var ne=I.memoizedState!==null||Vy;if(!ne){var ue=I.alternate,ke=ue!==null&&ue.memoizedState!==null||of;ue=Vy;var Ye=of;if(Vy=ne,(of=ke)&&!Ye)for(rt=I;rt!==null;)ne=rt,ke=ne.child,ne.tag===22&&ne.memoizedState!==null?ED(I):ke!==null?(ke.return=ne,rt=ke):ED(I);for(;O!==null;)rt=O,wD(O),O=O.sibling;rt=I,Vy=ue,of=Ye}bD(g)}else I.subtreeFlags&8772&&O!==null?(O.return=I,rt=O):bD(g)}}function bD(g){for(;rt!==null;){var v=rt;if(v.flags&8772){var E=v.alternate;try{if(v.flags&8772)switch(v.tag){case 0:case 11:case 15:of||Vm(5,v);break;case 1:var R=v.stateNode;if(v.flags&4&&!of)if(E===null)R.componentDidMount();else{var I=v.elementType===v.type?E.memoizedProps:ma(v.type,E.memoizedProps);R.componentDidUpdate(I,E.memoizedState,R.__reactInternalSnapshotBeforeUpdate)}var O=v.updateQueue;O!==null&&gI(v,O,R);break;case 3:var ne=v.updateQueue;if(ne!==null){if(E=null,v.child!==null)switch(v.child.tag){case 5:E=W(v.child.stateNode);break;case 1:E=v.child.stateNode}gI(v,ne,E)}break;case 5:var ue=v.stateNode;E===null&&v.flags&4&&ht(ue,v.type,v.memoizedProps,v);break;case 6:break;case 4:break;case 12:break;case 13:if(he&&v.memoizedState===null){var ke=v.alternate;if(ke!==null){var Ye=ke.memoizedState;if(Ye!==null){var mt=Ye.dehydrated;mt!==null&&we(mt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}of||v.flags&512&&sS(v)}catch(Xt){Ds(v,v.return,Xt)}}if(v===g){rt=null;break}if(E=v.sibling,E!==null){E.return=v.return,rt=E;break}rt=v.return}}function SD(g){for(;rt!==null;){var v=rt;if(v===g){rt=null;break}var E=v.sibling;if(E!==null){E.return=v.return,rt=E;break}rt=v.return}}function ED(g){for(;rt!==null;){var v=rt;try{switch(v.tag){case 0:case 11:case 15:var E=v.return;try{Vm(4,v)}catch(ke){Ds(v,E,ke)}break;case 1:var R=v.stateNode;if(typeof R.componentDidMount=="function"){var I=v.return;try{R.componentDidMount()}catch(ke){Ds(v,I,ke)}}var O=v.return;try{sS(v)}catch(ke){Ds(v,O,ke)}break;case 5:var ne=v.return;try{sS(v)}catch(ke){Ds(v,ne,ke)}}}catch(ke){Ds(v,v.return,ke)}if(v===g){rt=null;break}var ue=v.sibling;if(ue!==null){ue.return=v.return,rt=ue;break}rt=v.return}}var Gy=0,jy=1,Xy=2,$y=3,qy=4;if(typeof Symbol=="function"&&Symbol.for){var Wm=Symbol.for;Gy=Wm("selector.component"),jy=Wm("selector.has_pseudo_class"),Xy=Wm("selector.role"),$y=Wm("selector.test_id"),qy=Wm("selector.text")}function uS(g){var v=de(g);if(v!=null){if(typeof v.memoizedProps["data-testname"]!="string")throw Error(o(364));return v}if(g=ae(g),g===null)throw Error(o(362));return g.stateNode.current}function cS(g,v){switch(v.$$typeof){case Gy:if(g.type===v.value)return!0;break;case jy:e:{v=v.value,g=[g,0];for(var E=0;E<g.length;){var R=g[E++],I=g[E++],O=v[I];if(R.tag!==5||!K(R)){for(;O!=null&&cS(R,O);)I++,O=v[I];if(I===v.length){v=!0;break e}else for(R=R.child;R!==null;)g.push(R,I),R=R.sibling}}v=!1}return v;case Xy:if(g.tag===5&&ge(g.stateNode,v.value))return!0;break;case qy:if((g.tag===5||g.tag===6)&&(g=Se(g),g!==null&&0<=g.indexOf(v.value)))return!0;break;case $y:if(g.tag===5&&(g=g.memoizedProps["data-testname"],typeof g=="string"&&g.toLowerCase()===v.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function fS(g){switch(g.$$typeof){case Gy:return"<"+(T(g.value)||"Unknown")+">";case jy:return":has("+(fS(g)||"")+")";case Xy:return'[role="'+g.value+'"]';case qy:return'"'+g.value+'"';case $y:return'[data-testname="'+g.value+'"]';default:throw Error(o(365))}}function MD(g,v){var E=[];g=[g,0];for(var R=0;R<g.length;){var I=g[R++],O=g[R++],ne=v[O];if(I.tag!==5||!K(I)){for(;ne!=null&&cS(I,ne);)O++,ne=v[O];if(O===v.length)E.push(I);else for(I=I.child;I!==null;)g.push(I,O),I=I.sibling}}return E}function hS(g,v){if(!j)throw Error(o(363));g=uS(g),g=MD(g,v),v=[],g=Array.from(g);for(var E=0;E<g.length;){var R=g[E++];if(R.tag===5)K(R)||v.push(R.stateNode);else for(R=R.child;R!==null;)g.push(R),R=R.sibling}return v}var aX=Math.ceil,Yy=a.ReactCurrentDispatcher,dS=a.ReactCurrentOwner,Pr=a.ReactCurrentBatchConfig,nn=0,Ur=null,zr=null,Ci=0,oo=0,Jh=er(0),Yr=0,Hm=null,Qh=0,Ky=0,pS=0,Gm=null,Ps=null,mS=0,gS=1/0;function ed(){gS=hi()+500}var Zy=!1,vS=null,Du=null,Jy=!1,Nu=null,Qy=0,jm=0,yS=null,e1=-1,t1=0;function cs(){return nn&6?hi():e1!==-1?e1:e1=hi()}function ku(g){return g.mode&1?nn&2&&Ci!==0?Ci&-Ci:Hj.transition!==null?(t1===0&&(g=py,py<<=1,!(py&4194240)&&(py=64),t1=g),t1):(g=Mn,g!==0?g:ve()):1}function Wo(g,v,E){if(50<jm)throw jm=0,yS=null,Error(o(185));var R=n1(g,v);return R===null?null:(Am(R,v,E),(!(nn&2)||R!==Ur)&&(R===Ur&&(!(nn&2)&&(Ky|=v),Yr===4&&Lu(R,Ci)),Is(R,E),v===1&&nn===0&&!(g.mode&1)&&(ed(),yy&&Ya())),R)}function n1(g,v){g.lanes|=v;var E=g.alternate;for(E!==null&&(E.lanes|=v),E=g,g=g.return;g!==null;)g.childLanes|=v,E=g.alternate,E!==null&&(E.childLanes|=v),E=g,g=g.return;return E.tag===3?E.stateNode:null}function Is(g,v){var E=g.callbackNode;kj(g,v);var R=gy(g,g===Ur?Ci:0);if(R===0)E!==null&&fI(E),g.callbackNode=null,g.callbackPriority=0;else if(v=R&-R,g.callbackPriority!==v){if(E!=null&&fI(E),v===1)g.tag===0?Wj(CD.bind(null,g)):hI(CD.bind(null,g)),ze?X(function(){nn===0&&Ya()}):Tb(Cb,Ya),E=null;else{switch(cI(R)){case 1:E=Cb;break;case 4:E=Bj;break;case 16:E=Ab;break;case 536870912:E=Uj;break;default:E=Ab}E=FD(E,TD.bind(null,g))}g.callbackPriority=v,g.callbackNode=E}}function TD(g,v){if(e1=-1,t1=0,nn&6)throw Error(o(327));var E=g.callbackNode;if(cf()&&g.callbackNode!==E)return null;var R=gy(g,g===Ur?Ci:0);if(R===0)return null;if(R&30||R&g.expiredLanes||v)v=r1(g,R);else{v=R;var I=nn;nn|=2;var O=PD();(Ur!==g||Ci!==v)&&(ed(),lf(g,v));do try{cX();break}catch(ue){RD(g,ue)}while(!0);Ib(),Yy.current=O,nn=I,zr!==null?v=0:(Ur=null,Ci=0,v=Yr)}if(v!==0){if(v===2&&(I=Sb(g),I!==0&&(R=I,v=xS(g,I))),v===1)throw E=Hm,lf(g,0),Lu(g,R),Is(g,hi()),E;if(v===6)Lu(g,R);else{if(I=g.current.alternate,!(R&30)&&!lX(I)&&(v=r1(g,R),v===2&&(O=Sb(g),O!==0&&(R=O,v=xS(g,O))),v===1))throw E=Hm,lf(g,0),Lu(g,R),Is(g,hi()),E;switch(g.finishedWork=I,g.finishedLanes=R,v){case 0:case 1:throw Error(o(345));case 2:uf(g,Ps);break;case 3:if(Lu(g,R),(R&130023424)===R&&(v=mS+500-hi(),10<v)){if(gy(g,0)!==0)break;if(I=g.suspendedLanes,(I&R)!==R){cs(),g.pingedLanes|=g.suspendedLanes&I;break}g.timeoutHandle=pe(uf.bind(null,g,Ps),v);break}uf(g,Ps);break;case 4:if(Lu(g,R),(R&4194240)===R)break;for(v=g.eventTimes,I=-1;0<R;){var ne=31-no(R);O=1<<ne,ne=v[ne],ne>I&&(I=ne),R&=~O}if(R=I,R=hi()-R,R=(120>R?120:480>R?480:1080>R?1080:1920>R?1920:3e3>R?3e3:4320>R?4320:1960*aX(R/1960))-R,10<R){g.timeoutHandle=pe(uf.bind(null,g,Ps),R);break}uf(g,Ps);break;case 5:uf(g,Ps);break;default:throw Error(o(329))}}}return Is(g,hi()),g.callbackNode===E?TD.bind(null,g):null}function xS(g,v){var E=Gm;return g.current.memoizedState.isDehydrated&&(lf(g,v).flags|=256),g=r1(g,v),g!==2&&(v=Ps,Ps=E,v!==null&&_S(v)),g}function _S(g){Ps===null?Ps=g:Ps.push.apply(Ps,g)}function lX(g){for(var v=g;;){if(v.flags&16384){var E=v.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var R=0;R<E.length;R++){var I=E[R],O=I.getSnapshot;I=I.value;try{if(!qa(O(),I))return!1}catch{return!1}}}if(E=v.child,v.subtreeFlags&16384&&E!==null)E.return=v,v=E;else{if(v===g)break;for(;v.sibling===null;){if(v.return===null||v.return===g)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function Lu(g,v){for(v&=~pS,v&=~Ky,g.suspendedLanes|=v,g.pingedLanes&=~v,g=g.expirationTimes;0<v;){var E=31-no(v),R=1<<E;g[E]=-1,v&=~R}}function CD(g){if(nn&6)throw Error(o(327));cf();var v=gy(g,0);if(!(v&1))return Is(g,hi()),null;var E=r1(g,v);if(g.tag!==0&&E===2){var R=Sb(g);R!==0&&(v=R,E=xS(g,R))}if(E===1)throw E=Hm,lf(g,0),Lu(g,v),Is(g,hi()),E;if(E===6)throw Error(o(345));return g.finishedWork=g.current.alternate,g.finishedLanes=v,uf(g,Ps),Is(g,hi()),null}function AD(g){Nu!==null&&Nu.tag===0&&!(nn&6)&&cf();var v=nn;nn|=1;var E=Pr.transition,R=Mn;try{if(Pr.transition=null,Mn=1,g)return g()}finally{Mn=R,Pr.transition=E,nn=v,!(nn&6)&&Ya()}}function wS(){oo=Jh.current,Lt(Jh)}function lf(g,v){g.finishedWork=null,g.finishedLanes=0;var E=g.timeoutHandle;if(E!==Ue&&(g.timeoutHandle=Ue,Ne(E)),zr!==null)for(E=zr.return;E!==null;){var R=E;switch(Bb(R),R.tag){case 1:R=R.type.childContextTypes,R!=null&&Rr();break;case 3:Kh(),Lt(_r),Lt(tn),jb();break;case 5:Hb(R);break;case 4:Kh();break;case 13:Lt(or);break;case 19:Lt(or);break;case 10:Db(R.type._context);break;case 22:case 23:wS()}E=E.return}if(Ur=g,zr=g=Fu(g.current,null),Ci=oo=v,Yr=0,Hm=null,pS=Ky=Qh=0,Ps=Gm=null,Ka!==null){for(v=0;v<Ka.length;v++)if(E=Ka[v],R=E.interleaved,R!==null){E.interleaved=null;var I=R.next,O=E.pending;if(O!==null){var ne=O.next;O.next=I,R.next=ne}E.pending=R}Ka=null}return g}function RD(g,v){do{var E=zr;try{if(Ib(),Ry.current=Ly,Py){for(var R=wr.memoizedState;R!==null;){var I=R.queue;I!==null&&(I.pending=null),R=R.next}Py=!1}if(Zh=0,di=zi=wr=null,km=!1,Lm=0,dS.current=null,E===null||E.return===null){Yr=1,Hm=v,zr=null;break}e:{var O=g,ne=E.return,ue=E,ke=v;if(v=Ci,ue.flags|=32768,ke!==null&&typeof ke=="object"&&typeof ke.then=="function"){var Ye=ke,mt=ue,Xt=mt.tag;if(!(mt.mode&1)&&(Xt===0||Xt===11||Xt===15)){var Ot=mt.alternate;Ot?(mt.updateQueue=Ot.updateQueue,mt.memoizedState=Ot.memoizedState,mt.lanes=Ot.lanes):(mt.updateQueue=null,mt.memoizedState=null)}var zn=KI(ne);if(zn!==null){zn.flags&=-257,ZI(zn,ne,ue,O,v),zn.mode&1&&YI(O,Ye,v),v=zn,ke=Ye;var It=v.updateQueue;if(It===null){var Hi=new Set;Hi.add(ke),v.updateQueue=Hi}else It.add(ke);break e}else{if(!(v&1)){YI(O,Ye,v),bS();break e}ke=Error(o(426))}}else if(tr&&ue.mode&1){var Go=KI(ne);if(Go!==null){!(Go.flags&65536)&&(Go.flags|=256),ZI(Go,ne,ue,O,v),Vb(ke);break e}}O=ke,Yr!==4&&(Yr=2),Gm===null?Gm=[O]:Gm.push(O),ke=Jb(ke,ue),ue=ne;do{switch(ue.tag){case 3:ue.flags|=65536,v&=-v,ue.lanes|=v;var be=$I(ue,ke,v);mI(ue,be);break e;case 1:O=ke;var fe=ue.type,Re=ue.stateNode;if(!(ue.flags&128)&&(typeof fe.getDerivedStateFromError=="function"||Re!==null&&typeof Re.componentDidCatch=="function"&&(Du===null||!Du.has(Re)))){ue.flags|=65536,v&=-v,ue.lanes|=v;var st=qI(ue,O,v);mI(ue,st);break e}}ue=ue.return}while(ue!==null)}DD(E)}catch(Rt){v=Rt,zr===E&&E!==null&&(zr=E=E.return);continue}break}while(!0)}function PD(){var g=Yy.current;return Yy.current=Ly,g===null?Ly:g}function bS(){(Yr===0||Yr===3||Yr===2)&&(Yr=4),Ur===null||!(Qh&268435455)&&!(Ky&268435455)||Lu(Ur,Ci)}function r1(g,v){var E=nn;nn|=2;var R=PD();Ur===g&&Ci===v||lf(g,v);do try{uX();break}catch(I){RD(g,I)}while(!0);if(Ib(),nn=E,Yy.current=R,zr!==null)throw Error(o(261));return Ur=null,Ci=0,Yr}function uX(){for(;zr!==null;)ID(zr)}function cX(){for(;zr!==null&&!Fj();)ID(zr)}function ID(g){var v=LD(g.alternate,g,oo);g.memoizedProps=g.pendingProps,v===null?DD(g):zr=v,dS.current=null}function DD(g){var v=g;do{var E=v.alternate;if(g=v.return,v.flags&32768){if(E=nX(E,v),E!==null){E.flags&=32767,zr=E;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{Yr=6,zr=null;return}}else if(E=Qj(E,v,oo),E!==null){zr=E;return}if(v=v.sibling,v!==null){zr=v;return}zr=v=g}while(v!==null);Yr===0&&(Yr=5)}function uf(g,v){var E=Mn,R=Pr.transition;try{Pr.transition=null,Mn=1,fX(g,v,E)}finally{Pr.transition=R,Mn=E}return null}function fX(g,v,E){do cf();while(Nu!==null);if(nn&6)throw Error(o(327));var R=g.finishedWork,I=g.finishedLanes;if(R===null)return null;if(g.finishedWork=null,g.finishedLanes=0,R===g.current)throw Error(o(177));g.callbackNode=null,g.callbackPriority=0;var O=R.lanes|R.childLanes;if(Lj(g,O),g===Ur&&(zr=Ur=null,Ci=0),!(R.subtreeFlags&2064)&&!(R.flags&2064)||Jy||(Jy=!0,FD(Ab,function(){return cf(),null})),O=(R.flags&15990)!==0,R.subtreeFlags&15990||O){O=Pr.transition,Pr.transition=null;var ne=Mn;Mn=1;var ue=nn;nn|=4,dS.current=null,iX(g,R),sX(g,R),D(g.containerInfo),g.current=R,oX(R),Oj(),nn=ue,Mn=ne,Pr.transition=O}else g.current=R;if(Jy&&(Jy=!1,Nu=g,Qy=I),O=g.pendingLanes,O===0&&(Du=null),zj(R.stateNode),Is(g,hi()),v!==null)for(E=g.onRecoverableError,R=0;R<v.length;R++)E(v[R]);if(Zy)throw Zy=!1,g=vS,vS=null,g;return Qy&1&&g.tag!==0&&cf(),O=g.pendingLanes,O&1?g===yS?jm++:(jm=0,yS=g):jm=0,Ya(),null}function cf(){if(Nu!==null){var g=cI(Qy),v=Pr.transition,E=Mn;try{if(Pr.transition=null,Mn=16>g?16:g,Nu===null)var R=!1;else{if(g=Nu,Nu=null,Qy=0,nn&6)throw Error(o(331));var I=nn;for(nn|=4,rt=g.current;rt!==null;){var O=rt,ne=O.child;if(rt.flags&16){var ue=O.deletions;if(ue!==null){for(var ke=0;ke<ue.length;ke++){var Ye=ue[ke];for(rt=Ye;rt!==null;){var mt=rt;switch(mt.tag){case 0:case 11:case 15:af(8,mt,O)}var Xt=mt.child;if(Xt!==null)Xt.return=mt,rt=Xt;else for(;rt!==null;){mt=rt;var Ot=mt.sibling,zn=mt.return;if(gD(mt),mt===Ye){rt=null;break}if(Ot!==null){Ot.return=zn,rt=Ot;break}rt=zn}}}var It=O.alternate;if(It!==null){var Hi=It.child;if(Hi!==null){It.child=null;do{var Go=Hi.sibling;Hi.sibling=null,Hi=Go}while(Hi!==null)}}rt=O}}if(O.subtreeFlags&2064&&ne!==null)ne.return=O,rt=ne;else e:for(;rt!==null;){if(O=rt,O.flags&2048)switch(O.tag){case 0:case 11:case 15:af(9,O,O.return)}var be=O.sibling;if(be!==null){be.return=O.return,rt=be;break e}rt=O.return}}var fe=g.current;for(rt=fe;rt!==null;){ne=rt;var Re=ne.child;if(ne.subtreeFlags&2064&&Re!==null)Re.return=ne,rt=Re;else e:for(ne=fe;rt!==null;){if(ue=rt,ue.flags&2048)try{switch(ue.tag){case 0:case 11:case 15:Vm(9,ue)}}catch(Rt){Ds(ue,ue.return,Rt)}if(ue===ne){rt=null;break e}var st=ue.sibling;if(st!==null){st.return=ue.return,rt=st;break e}rt=ue.return}}if(nn=I,Ya(),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(vy,g)}catch{}R=!0}return R}finally{Mn=E,Pr.transition=v}}return!1}function ND(g,v,E){v=Jb(E,v),v=$I(g,v,1),Iu(g,v),v=cs(),g=n1(g,1),g!==null&&(Am(g,1,v),Is(g,v))}function Ds(g,v,E){if(g.tag===3)ND(g,g,E);else for(;v!==null;){if(v.tag===3){ND(v,g,E);break}else if(v.tag===1){var R=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(Du===null||!Du.has(R))){g=Jb(E,g),g=qI(v,g,1),Iu(v,g),g=cs(),v=n1(v,1),v!==null&&(Am(v,1,g),Is(v,g));break}}v=v.return}}function hX(g,v,E){var R=g.pingCache;R!==null&&R.delete(v),v=cs(),g.pingedLanes|=g.suspendedLanes&E,Ur===g&&(Ci&E)===E&&(Yr===4||Yr===3&&(Ci&130023424)===Ci&&500>hi()-mS?lf(g,0):pS|=E),Is(g,v)}function kD(g,v){v===0&&(g.mode&1?(v=my,my<<=1,!(my&130023424)&&(my=4194304)):v=1);var E=cs();g=n1(g,v),g!==null&&(Am(g,v,E),Is(g,E))}function dX(g){var v=g.memoizedState,E=0;v!==null&&(E=v.retryLane),kD(g,E)}function pX(g,v){var E=0;switch(g.tag){case 13:var R=g.stateNode,I=g.memoizedState;I!==null&&(E=I.retryLane);break;case 19:R=g.stateNode;break;default:throw Error(o(314))}R!==null&&R.delete(v),kD(g,E)}var LD;LD=function(g,v,E){if(g!==null)if(g.memoizedProps!==v.pendingProps||_r.current)so=!0;else{if(!(g.lanes&E)&&!(v.flags&128))return so=!1,tX(g,v,E);so=!!(g.flags&131072)}else so=!1,tr&&v.flags&1048576&&wI(v,Ty,v.index);switch(v.lanes=0,v.tag){case 2:var R=v.type;g!==null&&(g.alternate=null,v.alternate=null,v.flags|=2),g=v.pendingProps;var I=Fo(v,tn.current);Gh(v,E),I=$b(null,v,R,g,I,E);var O=qb();return v.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,fi(R)?(O=!0,Ti(v)):O=!1,v.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,kb(v),I.updater=Ey,v.stateNode=I,I._reactInternals=v,Fb(v,R,g,E),v=tS(null,v,R,!0,O,E)):(v.tag=0,tr&&O&&Ob(v),us(null,v,I,E),v=v.child),v;case 16:R=v.elementType;e:{switch(g!==null&&(g.alternate=null,v.alternate=null,v.flags|=2),g=v.pendingProps,I=R._init,R=I(R._payload),v.type=R,I=v.tag=gX(R),g=ma(R,g),I){case 0:v=eS(null,v,R,g,E);break e;case 1:v=sD(null,v,R,g,E);break e;case 11:v=eD(null,v,R,g,E);break e;case 14:v=tD(null,v,R,ma(R.type,g),E);break e}throw Error(o(306,R,""))}return v;case 0:return R=v.type,I=v.pendingProps,I=v.elementType===R?I:ma(R,I),eS(g,v,R,I,E);case 1:return R=v.type,I=v.pendingProps,I=v.elementType===R?I:ma(R,I),sD(g,v,R,I,E);case 3:e:{if(oD(v),g===null)throw Error(o(387));R=v.pendingProps,O=v.memoizedState,I=O.element,pI(g,v),Sy(v,R,null,E);var ne=v.memoizedState;if(R=ne.element,he&&O.isDehydrated)if(O={element:R,isDehydrated:!1,cache:ne.cache,transitions:ne.transitions},v.updateQueue.baseState=O,v.memoizedState=O,v.flags&256){I=Error(o(423)),v=aD(g,v,R,E,I);break e}else if(R!==I){I=Error(o(424)),v=aD(g,v,R,E,I);break e}else for(he&&(io=ir(v.stateNode.containerInfo),ro=v,tr=!0,ga=null,Rm=!1),E=CI(v,null,R,E),v.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if($h(),R===I){v=Bl(g,v,E);break e}us(g,v,R,E)}v=v.child}return v;case 5:return AI(v),g===null&&zb(v),R=v.type,I=v.pendingProps,O=g!==null?g.memoizedProps:null,ne=I.children,me(R,I)?ne=null:O!==null&&me(R,O)&&(v.flags|=32),iD(g,v),us(g,v,ne,E),v.child;case 6:return g===null&&zb(v),null;case 13:return lD(g,v,E);case 4:return Wb(v,v.stateNode.containerInfo),R=v.pendingProps,g===null?v.child=qh(v,null,R,E):us(g,v,R,E),v.child;case 11:return R=v.type,I=v.pendingProps,I=v.elementType===R?I:ma(R,I),eD(g,v,R,I,E);case 7:return us(g,v,v.pendingProps,E),v.child;case 8:return us(g,v,v.pendingProps.children,E),v.child;case 12:return us(g,v,v.pendingProps.children,E),v.child;case 10:e:{if(R=v.type._context,I=v.pendingProps,O=v.memoizedProps,ne=I.value,dI(v,R,ne),O!==null)if(qa(O.value,ne)){if(O.children===I.children&&!_r.current){v=Bl(g,v,E);break e}}else for(O=v.child,O!==null&&(O.return=v);O!==null;){var ue=O.dependencies;if(ue!==null){ne=O.child;for(var ke=ue.firstContext;ke!==null;){if(ke.context===R){if(O.tag===1){ke=kl(-1,E&-E),ke.tag=2;var Ye=O.updateQueue;if(Ye!==null){Ye=Ye.shared;var mt=Ye.pending;mt===null?ke.next=ke:(ke.next=mt.next,mt.next=ke),Ye.pending=ke}}O.lanes|=E,ke=O.alternate,ke!==null&&(ke.lanes|=E),Nb(O.return,E,v),ue.lanes|=E;break}ke=ke.next}}else if(O.tag===10)ne=O.type===v.type?null:O.child;else if(O.tag===18){if(ne=O.return,ne===null)throw Error(o(341));ne.lanes|=E,ue=ne.alternate,ue!==null&&(ue.lanes|=E),Nb(ne,E,v),ne=O.sibling}else ne=O.child;if(ne!==null)ne.return=O;else for(ne=O;ne!==null;){if(ne===v){ne=null;break}if(O=ne.sibling,O!==null){O.return=ne.return,ne=O;break}ne=ne.return}O=ne}us(g,v,I.children,E),v=v.child}return v;case 9:return I=v.type,R=v.pendingProps.children,Gh(v,E),I=Oo(I),R=R(I),v.flags|=1,us(g,v,R,E),v.child;case 14:return R=v.type,I=ma(R,v.pendingProps),I=ma(R.type,I),tD(g,v,R,I,E);case 15:return nD(g,v,v.type,v.pendingProps,E);case 17:return R=v.type,I=v.pendingProps,I=v.elementType===R?I:ma(R,I),g!==null&&(g.alternate=null,v.alternate=null,v.flags|=2),v.tag=1,fi(R)?(g=!0,Ti(v)):g=!1,Gh(v,E),xI(v,R,I),Fb(v,R,I,E),tS(null,v,R,!0,g,E);case 19:return hD(g,v,E);case 22:return rD(g,v,E)}throw Error(o(156,v.tag))};function FD(g,v){return Tb(g,v)}function mX(g,v,E,R){this.tag=g,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ho(g,v,E,R){return new mX(g,v,E,R)}function SS(g){return g=g.prototype,!(!g||!g.isReactComponent)}function gX(g){if(typeof g=="function")return SS(g)?1:0;if(g!=null){if(g=g.$$typeof,g===y)return 11;if(g===_)return 14}return 2}function Fu(g,v){var E=g.alternate;return E===null?(E=Ho(g.tag,v,g.key,g.mode),E.elementType=g.elementType,E.type=g.type,E.stateNode=g.stateNode,E.alternate=g,g.alternate=E):(E.pendingProps=v,E.type=g.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=g.flags&14680064,E.childLanes=g.childLanes,E.lanes=g.lanes,E.child=g.child,E.memoizedProps=g.memoizedProps,E.memoizedState=g.memoizedState,E.updateQueue=g.updateQueue,v=g.dependencies,E.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},E.sibling=g.sibling,E.index=g.index,E.ref=g.ref,E}function i1(g,v,E,R,I,O){var ne=2;if(R=g,typeof g=="function")SS(g)&&(ne=1);else if(typeof g=="string")ne=5;else e:switch(g){case c:return ff(E.children,I,O,v);case f:ne=8,I|=8;break;case h:return g=Ho(12,E,v,I|2),g.elementType=h,g.lanes=O,g;case x:return g=Ho(13,E,v,I),g.elementType=x,g.lanes=O,g;case m:return g=Ho(19,E,v,I),g.elementType=m,g.lanes=O,g;case b:return s1(E,I,O,v);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case d:ne=10;break e;case p:ne=9;break e;case y:ne=11;break e;case _:ne=14;break e;case w:ne=16,R=null;break e}throw Error(o(130,g==null?g:typeof g,""))}return v=Ho(ne,E,v,I),v.elementType=g,v.type=R,v.lanes=O,v}function ff(g,v,E,R){return g=Ho(7,g,R,v),g.lanes=E,g}function s1(g,v,E,R){return g=Ho(22,g,R,v),g.elementType=b,g.lanes=E,g.stateNode={},g}function ES(g,v,E){return g=Ho(6,g,null,v),g.lanes=E,g}function MS(g,v,E){return v=Ho(4,g.children!==null?g.children:[],g.key,v),v.lanes=E,v.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},v}function vX(g,v,E,R,I){this.tag=v,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ue,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Eb(0),this.expirationTimes=Eb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eb(0),this.identifierPrefix=R,this.onRecoverableError=I,he&&(this.mutableSourceEagerHydrationData=null)}function OD(g,v,E,R,I,O,ne,ue,ke){return g=new vX(g,v,E,ue,ke),v===1?(v=1,O===!0&&(v|=8)):v=0,O=Ho(3,null,null,v),g.current=O,O.stateNode=g,O.memoizedState={element:R,isDehydrated:E,cache:null,transitions:null},kb(O),g}function BD(g){if(!g)return Lo;g=g._reactInternals;e:{if(C(g)!==g||g.tag!==1)throw Error(o(170));var v=g;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if(fi(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(o(171))}if(g.tag===1){var E=g.type;if(fi(E))return Vh(g,E,v)}return v}function UD(g){var v=g._reactInternals;if(v===void 0)throw typeof g.render=="function"?Error(o(188)):(g=Object.keys(g).join(","),Error(o(268,g)));return g=L(v),g===null?null:g.stateNode}function zD(g,v){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var E=g.retryLane;g.retryLane=E!==0&&E<v?E:v}}function TS(g,v){zD(g,v),(g=g.alternate)&&zD(g,v)}function yX(g){return g=L(g),g===null?null:g.stateNode}function xX(){return null}return t.attemptContinuousHydration=function(g){if(g.tag===13){var v=cs();Wo(g,134217728,v),TS(g,134217728)}},t.attemptHydrationAtCurrentPriority=function(g){if(g.tag===13){var v=cs(),E=ku(g);Wo(g,E,v),TS(g,E)}},t.attemptSynchronousHydration=function(g){switch(g.tag){case 3:var v=g.stateNode;if(v.current.memoizedState.isDehydrated){var E=Cm(v.pendingLanes);E!==0&&(Mb(v,E|1),Is(v,hi()),!(nn&6)&&(ed(),Ya()))}break;case 13:var R=cs();AD(function(){return Wo(g,1,R)}),TS(g,1)}},t.batchedUpdates=function(g,v){var E=nn;nn|=1;try{return g(v)}finally{nn=E,nn===0&&(ed(),yy&&Ya())}},t.createComponentSelector=function(g){return{$$typeof:Gy,value:g}},t.createContainer=function(g,v,E,R,I,O,ne){return OD(g,v,!1,null,E,R,I,O,ne)},t.createHasPseudoClassSelector=function(g){return{$$typeof:jy,value:g}},t.createHydrationContainer=function(g,v,E,R,I,O,ne,ue,ke){return g=OD(E,R,!0,g,I,O,ne,ue,ke),g.context=BD(null),E=g.current,R=cs(),I=ku(E),O=kl(R,I),O.callback=v??null,Iu(E,O),g.current.lanes=I,Am(g,I,R),Is(g,R),g},t.createPortal=function(g,v,E){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:R==null?null:""+R,children:g,containerInfo:v,implementation:E}},t.createRoleSelector=function(g){return{$$typeof:Xy,value:g}},t.createTestNameSelector=function(g){return{$$typeof:$y,value:g}},t.createTextSelector=function(g){return{$$typeof:qy,value:g}},t.deferredUpdates=function(g){var v=Mn,E=Pr.transition;try{return Pr.transition=null,Mn=16,g()}finally{Mn=v,Pr.transition=E}},t.discreteUpdates=function(g,v,E,R,I){var O=Mn,ne=Pr.transition;try{return Pr.transition=null,Mn=1,g(v,E,R,I)}finally{Mn=O,Pr.transition=ne,nn===0&&ed()}},t.findAllNodes=hS,t.findBoundingRects=function(g,v){if(!j)throw Error(o(363));v=hS(g,v),g=[];for(var E=0;E<v.length;E++)g.push(Oe(v[E]));for(v=g.length-1;0<v;v--){E=g[v];for(var R=E.x,I=R+E.width,O=E.y,ne=O+E.height,ue=v-1;0<=ue;ue--)if(v!==ue){var ke=g[ue],Ye=ke.x,mt=Ye+ke.width,Xt=ke.y,Ot=Xt+ke.height;if(R>=Ye&&O>=Xt&&I<=mt&&ne<=Ot){g.splice(v,1);break}else if(R!==Ye||E.width!==ke.width||Ot<O||Xt>ne){if(!(O!==Xt||E.height!==ke.height||mt<R||Ye>I)){Ye>R&&(ke.width+=Ye-R,ke.x=R),mt<I&&(ke.width=I-Ye),g.splice(v,1);break}}else{Xt>O&&(ke.height+=Xt-O,ke.y=O),Ot<ne&&(ke.height=ne-Xt),g.splice(v,1);break}}}return g},t.findHostInstance=UD,t.findHostInstanceWithNoPortals=function(g){return g=k(g),g=g!==null?F(g):null,g===null?null:g.stateNode},t.findHostInstanceWithWarning=function(g){return UD(g)},t.flushControlled=function(g){var v=nn;nn|=1;var E=Pr.transition,R=Mn;try{Pr.transition=null,Mn=1,g()}finally{Mn=R,Pr.transition=E,nn=v,nn===0&&(ed(),Ya())}},t.flushPassiveEffects=cf,t.flushSync=AD,t.focusWithin=function(g,v){if(!j)throw Error(o(363));for(g=uS(g),v=MD(g,v),v=Array.from(v),g=0;g<v.length;){var E=v[g++];if(!K(E)){if(E.tag===5&&Te(E.stateNode))return!0;for(E=E.child;E!==null;)v.push(E),E=E.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Mn},t.getFindAllNodesFailureDescription=function(g,v){if(!j)throw Error(o(363));var E=0,R=[];g=[uS(g),0];for(var I=0;I<g.length;){var O=g[I++],ne=g[I++],ue=v[ne];if((O.tag!==5||!K(O))&&(cS(O,ue)&&(R.push(fS(ue)),ne++,ne>E&&(E=ne)),ne<v.length))for(O=O.child;O!==null;)g.push(O,ne),O=O.sibling}if(E<v.length){for(g=[];E<v.length;E++)g.push(fS(v[E]));return`findAllNodes was able to match part of the selector:
  `+(R.join(" > ")+`

No matching component was found for:
  `)+g.join(" > ")}return null},t.getPublicRootInstance=function(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return W(g.child.stateNode);default:return g.child.stateNode}},t.injectIntoDevTools=function(g){if(g={bundleType:g.bundleType,version:g.version,rendererPackageName:g.rendererPackageName,rendererConfig:g.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:yX,findFiberByHostInstance:g.findFiberByHostInstance||xX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")g=!1;else{var v=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(v.isDisabled||!v.supportsFiber)g=!0;else{try{vy=v.inject(g),$a=v}catch{}g=!!v.checkDCE}}return g},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(g,v,E,R){if(!j)throw Error(o(363));g=hS(g,v);var I=Le(g,E,R).disconnect;return{disconnect:function(){I()}}},t.registerMutableSourceForHydration=function(g,v){var E=v._getVersion;E=E(v._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[v,E]:g.mutableSourceEagerHydrationData.push(v,E)},t.runWithPriority=function(g,v){var E=Mn;try{return Mn=g,v()}finally{Mn=E}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(g,v,E,R){var I=v.current,O=cs(),ne=ku(I);return E=BD(E),v.context===null?v.context=E:v.pendingContext=E,v=kl(O,ne),v.payload={element:g},R=R===void 0?null:R,R!==null&&(v.callback=R),Iu(I,v),g=Wo(I,ne,O),g!==null&&by(g,I,ne),ne},t};VW.exports=zde;var Vde=VW.exports;const Wde=TB(Vde);var WW={exports:{}},HW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(N,B){var D=N.length;N.push(B);e:for(;0<D;){var $=D-1>>>1,ee=N[$];if(0<i(ee,B))N[$]=B,N[D]=ee,D=$;else break e}}function t(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var B=N[0],D=N.pop();if(D!==B){N[0]=D;e:for(var $=0,ee=N.length,te=ee>>>1;$<te;){var se=2*($+1)-1,me=N[se],_e=se+1,pe=N[_e];if(0>i(me,D))_e<ee&&0>i(pe,me)?(N[$]=pe,N[_e]=D,$=_e):(N[$]=me,N[se]=D,$=se);else if(_e<ee&&0>i(pe,D))N[$]=pe,N[_e]=D,$=_e;else break e}}return B}function i(N,B){var D=N.sortIndex-B.sortIndex;return D!==0?D:N.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,d=!1,p=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var B=t(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=N)r(u),B.sortIndex=B.expirationTime,e(l,B);else break;B=t(u)}}function b(N){if(y=!1,w(N),!p)if(t(l)!==null)p=!0,W(S);else{var B=t(u);B!==null&&G(b,B.startTime-N)}}function S(N,B){p=!1,y&&(y=!1,m(P),P=-1),d=!0;var D=h;try{for(w(B),f=t(l);f!==null&&(!(f.expirationTime>B)||N&&!k());){var $=f.callback;if(typeof $=="function"){f.callback=null,h=f.priorityLevel;var ee=$(f.expirationTime<=B);B=n.unstable_now(),typeof ee=="function"?f.callback=ee:f===t(l)&&r(l),w(B)}else r(l);f=t(l)}if(f!==null)var te=!0;else{var se=t(u);se!==null&&G(b,se.startTime-B),te=!1}return te}finally{f=null,h=D,d=!1}}var M=!1,T=null,P=-1,C=5,A=-1;function k(){return!(n.unstable_now()-A<C)}function L(){if(T!==null){var N=n.unstable_now();A=N;var B=!0;try{B=T(!0,N)}finally{B?H():(M=!1,T=null)}}else M=!1}var H;if(typeof _=="function")H=function(){_(L)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=L,H=function(){V.postMessage(null)}}else H=function(){x(L,0)};function W(N){T=N,M||(M=!0,H())}function G(N,B){P=x(function(){N(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(N){N.callback=null},n.unstable_continueExecution=function(){p||d||(p=!0,W(S))},n.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<N?Math.floor(1e3/N):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(N){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var D=h;h=B;try{return N()}finally{h=D}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var D=h;h=N;try{return B()}finally{h=D}},n.unstable_scheduleCallback=function(N,B,D){var $=n.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?$+D:$):D=$,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=D+ee,N={id:c++,callback:B,priorityLevel:N,startTime:D,expirationTime:ee,sortIndex:-1},D>$?(N.sortIndex=D,e(u,N),t(l)===null&&N===t(u)&&(y?(m(P),P=-1):y=!0,G(b,D-$))):(N.sortIndex=ee,e(l,N),p||d||(p=!0,W(S))),N},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(N){var B=h;return function(){var D=h;h=B;try{return N.apply(this,arguments)}finally{h=D}}}})(HW);WW.exports=HW;var i5=WW.exports;const i4={},Hde=n=>void Object.assign(i4,n);function Gde(n,e){function t(c,{args:f=[],attach:h,...d},p){let y=`${c[0].toUpperCase()}${c.slice(1)}`,x;if(c==="primitive"){if(d.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const m=d.object;x=Bd(m,{type:c,root:p,attach:h,primitive:!0})}else{const m=i4[y];if(!m)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");x=Bd(new m(...f),{type:c,root:p,attach:h,memoizedProps:{args:f}})}return x.__r3f.attach===void 0&&(x.isBufferGeometry?x.__r3f.attach="geometry":x.isMaterial&&(x.__r3f.attach="material")),y!=="inject"&&M3(x,d),x}function r(c,f){let h=!1;if(f){var d,p;(d=f.__r3f)!=null&&d.attach?E3(c,f,f.__r3f.attach):f.isObject3D&&c.isObject3D&&(c.add(f),h=!0),h||(p=c.__r3f)==null||p.objects.push(f),f.__r3f||Bd(f,{}),f.__r3f.parent=c,VC(f),Ud(f)}}function i(c,f,h){let d=!1;if(f){var p,y;if((p=f.__r3f)!=null&&p.attach)E3(c,f,f.__r3f.attach);else if(f.isObject3D&&c.isObject3D){f.parent=c,f.dispatchEvent({type:"added"}),c.dispatchEvent({type:"childadded",child:f});const x=c.children.filter(_=>_!==f),m=x.indexOf(h);c.children=[...x.slice(0,m),f,...x.slice(m)],d=!0}d||(y=c.__r3f)==null||y.objects.push(f),f.__r3f||Bd(f,{}),f.__r3f.parent=c,VC(f),Ud(f)}}function s(c,f,h=!1){c&&[...c].forEach(d=>o(f,d,h))}function o(c,f,h){if(f){var d,p,y;if(f.__r3f&&(f.__r3f.parent=null),(d=c.__r3f)!=null&&d.objects&&(c.__r3f.objects=c.__r3f.objects.filter(b=>b!==f)),(p=f.__r3f)!=null&&p.attach)u5(c,f,f.__r3f.attach);else if(f.isObject3D&&c.isObject3D){var x;c.remove(f),(x=f.__r3f)!=null&&x.root&&Zde(N2(f),f)}const _=(y=f.__r3f)==null?void 0:y.primitive,w=!_&&(h===void 0?f.dispose!==null:h);if(!_){var m;s((m=f.__r3f)==null?void 0:m.objects,f,w),s(f.children,f,w)}if(delete f.__r3f,w&&f.dispose&&f.type!=="Scene"){const b=()=>{try{f.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?i5.unstable_scheduleCallback(i5.unstable_IdlePriority,b):b()}Ud(c)}}function a(c,f,h,d){var p;const y=(p=c.__r3f)==null?void 0:p.parent;if(!y)return;const x=t(f,h,c.__r3f.root);if(c.children){for(const m of c.children)m.__r3f&&r(x,m);c.children=c.children.filter(m=>!m.__r3f)}c.__r3f.objects.forEach(m=>r(x,m)),c.__r3f.objects=[],c.__r3f.autoRemovedBeforeAppend||o(y,c),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),r(y,x),x.raycast&&x.__r3f.eventCount&&N2(x).getState().internal.interaction.push(x),[d,d.alternate].forEach(m=>{m!==null&&(m.stateNode=x,m.ref&&(typeof m.ref=="function"?m.ref(x):m.ref.current=x))})}const l=()=>{};return{reconciler:Wde({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(c,f)=>{if(!f)return;const h=c.getState().scene;h.__r3f&&(h.__r3f.root=c,r(h,f))},removeChildFromContainer:(c,f)=>{f&&o(c.getState().scene,f)},insertInContainerBefore:(c,f,h)=>{if(!f||!h)return;const d=c.getState().scene;d.__r3f&&i(d,f,h)},getRootHostContext:()=>null,getChildHostContext:c=>c,finalizeInitialChildren(c){var f;return!!((f=c==null?void 0:c.__r3f)!=null?f:{}).handlers},prepareUpdate(c,f,h,d){var p;if(((p=c==null?void 0:c.__r3f)!=null?p:{}).primitive&&d.object&&d.object!==c)return[!0];{const{args:x=[],children:m,..._}=d,{args:w=[],children:b,...S}=h;if(!Array.isArray(x))throw new Error("R3F: the args prop must be an array!");if(x.some((T,P)=>T!==w[P]))return[!0];const M=KW(c,_,S,!0);return M.changes.length?[!1,M]:null}},commitUpdate(c,[f,h],d,p,y,x){f?a(c,d,y,x):M3(c,h)},commitMount(c,f,h,d){var p;const y=(p=c.__r3f)!=null?p:{};c.raycast&&y.handlers&&y.eventCount&&N2(c).getState().internal.interaction.push(c)},getPublicInstance:c=>c,prepareForCommit:()=>null,preparePortalMount:c=>Bd(c.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(c){var f;const{attach:h,parent:d}=(f=c.__r3f)!=null?f:{};h&&d&&u5(d,c,h),c.isObject3D&&(c.visible=!1),Ud(c)},unhideInstance(c,f){var h;const{attach:d,parent:p}=(h=c.__r3f)!=null?h:{};d&&p&&E3(p,c,d),(c.isObject3D&&f.visible==null||f.visible)&&(c.visible=!0),Ud(c)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():gp.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Zn.fun(performance.now)?performance.now:Zn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Zn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Zn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:M3}}var s5,o5;const S3=n=>"colorSpace"in n||"outputColorSpace"in n,GW=()=>{var n;return(n=i4.ColorManagement)!=null?n:null},jW=n=>n&&n.isOrthographicCamera,jde=n=>n&&n.hasOwnProperty("current"),ny=typeof window<"u"&&((s5=window.document)!=null&&s5.createElement||((o5=window.navigator)==null?void 0:o5.product)==="ReactNative")?U.useLayoutEffect:U.useEffect;function XW(n){const e=U.useRef(n);return ny(()=>void(e.current=n),[n]),e}function Xde({set:n}){return ny(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class $W extends U.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}$W.getDerivedStateFromError=()=>({error:!0});const qW="__default",a5=new Map,$de=n=>n&&!!n.memoized&&!!n.changes;function YW(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const x0=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function N2(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Zn={obj:n=>n===Object(n)&&!Zn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Zn.str(n)||Zn.num(n)||Zn.boo(n))return n===e;const s=Zn.obj(n);if(s&&r==="reference")return n===e;const o=Zn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(a in i?e:n)if(!Zn.equ(n[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:n)if(n[a]!==e[a])return!1;if(Zn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function qde(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Bd(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function zC(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const l5=/-\d+$/;function E3(n,e,t){if(Zn.str(t)){if(l5.test(t)){const s=t.replace(l5,""),{target:o,key:a}=zC(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=zC(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function u5(n,e,t){var r,i;if(Zn.str(t)){const{target:s,key:o}=zC(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function KW(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:a,...l}={},u=!1){const c=n.__r3f,f=Object.entries(i),h=[];if(u){const p=Object.keys(l);for(let y=0;y<p.length;y++)i.hasOwnProperty(p[y])||f.unshift([p[y],qW+"remove"])}f.forEach(([p,y])=>{var x;if((x=n.__r3f)!=null&&x.primitive&&p==="object"||Zn.equ(y,l[p]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(p))return h.push([p,y,!0,[]]);let m=[];p.includes("-")&&(m=p.split("-")),h.push([p,y,!1,m]);for(const _ in i){const w=i[_];_.startsWith(`${p}-`)&&h.push([_,w,!1,_.split("-")])}});const d={...i};return c!=null&&c.memoizedProps&&c!=null&&c.memoizedProps.args&&(d.args=c.memoizedProps.args),c!=null&&c.memoizedProps&&c!=null&&c.memoizedProps.attach&&(d.attach=c.memoizedProps.attach),{memoized:d,changes:h}}function M3(n,e){var t;const r=n.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=$de(e)?e:KW(n,e),l=r==null?void 0:r.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let h=0;h<a.length;h++){let[d,p,y,x]=a[h];if(S3(n)){const b="srgb",S="srgb-linear";d==="encoding"?(d="colorSpace",p=p===3001?b:S):d==="outputEncoding"&&(d="outputColorSpace",p=p===3001?b:S)}let m=n,_=m[d];if(x.length&&(_=x.reduce((w,b)=>w[b],n),!(_&&_.set))){const[w,...b]=x.reverse();m=b.reverse().reduce((S,M)=>S[M],n),d=w}if(p===qW+"remove")if(m.constructor){let w=a5.get(m.constructor);w||(w=new m.constructor,a5.set(m.constructor,w)),p=w[d]}else p=0;if(y&&r)p?r.handlers[d]=p:delete r.handlers[d],r.eventCount=Object.keys(r.handlers).length;else if(_&&_.set&&(_.copy||_ instanceof rh)){if(Array.isArray(p))_.fromArray?_.fromArray(p):_.set(...p);else if(_.copy&&p&&p.constructor&&_.constructor===p.constructor)_.copy(p);else if(p!==void 0){var u;const w=(u=_)==null?void 0:u.isColor;!w&&_.setScalar?_.setScalar(p):_ instanceof rh&&p instanceof rh?_.mask=p.mask:_.set(p),!GW()&&s&&!s.linear&&w&&_.convertSRGBToLinear()}}else{var c;if(m[d]=p,(c=m[d])!=null&&c.isTexture&&m[d].format===ki&&m[d].type===Oi&&s){const w=m[d];S3(w)&&S3(s.gl)?w.colorSpace=s.gl.outputColorSpace:w.encoding=s.gl.outputEncoding}}Ud(n)}if(r&&r.parent&&n.raycast&&l!==r.eventCount){const h=N2(n).getState().internal,d=h.interaction.indexOf(n);d>-1&&h.interaction.splice(d,1),r.eventCount&&h.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&VC(n),n}function Ud(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function VC(n){n.onUpdate==null||n.onUpdate(n)}function Yde(n,e){n.manual||(jW(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function kx(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function Kde(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return gp.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return gp.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return gp.ContinuousEventPriority;default:return gp.DefaultEventPriority}}function ZW(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function Zde(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{ZW(t.capturedMap,e,r,i)})}function Jde(n){function e(l){const{internal:u}=n.getState(),c=l.offsetX-u.initialClick[0],f=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(c*c+f*f))}function t(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(c=>{var f;return(f=u.__r3f)==null?void 0:f.handlers["onPointer"+c]}))}function r(l,u){const c=n.getState(),f=new Set,h=[],d=u?u(c.internal.interaction):c.internal.interaction;for(let m=0;m<d.length;m++){const _=x0(d[m]);_&&(_.raycaster.camera=void 0)}c.previousRoot||c.events.compute==null||c.events.compute(l,c);function p(m){const _=x0(m);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var w;_.events.compute==null||_.events.compute(l,_,(w=_.previousRoot)==null?void 0:w.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(m,!0):[]}let y=d.flatMap(p).sort((m,_)=>{const w=x0(m.object),b=x0(_.object);return!w||!b?m.distance-_.distance:b.events.priority-w.events.priority||m.distance-_.distance}).filter(m=>{const _=kx(m);return f.has(_)?!1:(f.add(_),!0)});c.events.filter&&(y=c.events.filter(y,c));for(const m of y){let _=m.object;for(;_;){var x;(x=_.__r3f)!=null&&x.eventCount&&h.push({...m,eventObject:_}),_=_.parent}}if("pointerId"in l&&c.internal.capturedMap.has(l.pointerId))for(let m of c.internal.capturedMap.get(l.pointerId).values())f.has(kx(m.intersection))||h.push(m.intersection);return h}function i(l,u,c,f){const h=n.getState();if(l.length){const d={stopped:!1};for(const p of l){const y=x0(p.object)||h,{raycaster:x,pointer:m,camera:_,internal:w}=y,b=new Q(m.x,m.y,0).unproject(_),S=A=>{var k,L;return(k=(L=w.capturedMap.get(A))==null?void 0:L.has(p.eventObject))!=null?k:!1},M=A=>{const k={intersection:p,target:u.target};w.capturedMap.has(A)?w.capturedMap.get(A).set(p.eventObject,k):w.capturedMap.set(A,new Map([[p.eventObject,k]])),u.target.setPointerCapture(A)},T=A=>{const k=w.capturedMap.get(A);k&&ZW(w.capturedMap,p.eventObject,k,A)};let P={};for(let A in u){let k=u[A];typeof k!="function"&&(P[A]=k)}let C={...p,...P,pointer:m,intersections:l,stopped:d.stopped,delta:c,unprojectedPoint:b,ray:x.ray,camera:_,stopPropagation(){const A="pointerId"in u&&w.capturedMap.get(u.pointerId);if((!A||A.has(p.eventObject))&&(C.stopped=d.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(k=>k.eventObject===p.eventObject))){const k=l.slice(0,l.indexOf(p));s([...k,p])}},target:{hasPointerCapture:S,setPointerCapture:M,releasePointerCapture:T},currentTarget:{hasPointerCapture:S,setPointerCapture:M,releasePointerCapture:T},nativeEvent:u};if(f(C),d.stopped===!0)break}}return l}function s(l){const{internal:u}=n.getState();for(const c of u.hovered.values())if(!l.length||!l.find(f=>f.object===c.object&&f.index===c.index&&f.instanceId===c.instanceId)){const h=c.eventObject.__r3f,d=h==null?void 0:h.handlers;if(u.hovered.delete(kx(c)),h!=null&&h.eventCount){const p={...c,intersections:l};d.onPointerOut==null||d.onPointerOut(p),d.onPointerLeave==null||d.onPointerLeave(p)}}}function o(l,u){for(let c=0;c<u.length;c++){const f=u[c].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:c}=n.getState();"pointerId"in u&&c.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{c.capturedMap.has(u.pointerId)&&(c.capturedMap.delete(u.pointerId),s([]))})}}return function(c){const{onPointerMissed:f,internal:h}=n.getState();h.lastEvent.current=c;const d=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=r(c,d?t:void 0),m=p?e(c):0;l==="onPointerDown"&&(h.initialClick=[c.offsetX,c.offsetY],h.initialHits=x.map(w=>w.eventObject)),p&&!x.length&&m<=2&&(o(c,h.interaction),f&&f(c)),d&&s(x);function _(w){const b=w.eventObject,S=b.__r3f,M=S==null?void 0:S.handlers;if(S!=null&&S.eventCount)if(d){if(M.onPointerOver||M.onPointerEnter||M.onPointerOut||M.onPointerLeave){const T=kx(w),P=h.hovered.get(T);P?P.stopped&&w.stopPropagation():(h.hovered.set(T,w),M.onPointerOver==null||M.onPointerOver(w),M.onPointerEnter==null||M.onPointerEnter(w))}M.onPointerMove==null||M.onPointerMove(w)}else{const T=M[l];T?(!p||h.initialHits.includes(b))&&(o(c,h.interaction.filter(P=>!h.initialHits.includes(P))),T(w)):p&&h.initialHits.includes(b)&&o(c,h.interaction.filter(P=>!h.initialHits.includes(P)))}}i(x,c,m,_)}}return{handlePointer:a}}const JW=n=>!!(n!=null&&n.render),QW=U.createContext(null),Qde=(n,e)=>{const t=Ode((a,l)=>{const u=new Q,c=new Q,f=new Q;function h(m=l().camera,_=c,w=l().size){const{width:b,height:S,top:M,left:T}=w,P=b/S;_.isVector3?f.copy(_):f.set(..._);const C=m.getWorldPosition(u).distanceTo(f);if(jW(m))return{width:b/m.zoom,height:S/m.zoom,top:M,left:T,factor:1,distance:C,aspect:P};{const A=m.fov*Math.PI/180,k=2*Math.tan(A/2)*C,L=k*(b/S);return{width:L,height:k,top:M,left:T,factor:b/L,distance:C,aspect:P}}}let d;const p=m=>a(_=>({performance:{..._.performance,current:m}})),y=new Me;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(m=1)=>n(l(),m),advance:(m,_)=>e(m,_,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Kw,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const m=l();d&&clearTimeout(d),m.performance.current!==m.performance.min&&p(m.performance.min),d=setTimeout(()=>p(l().performance.max),m.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:m=>a(_=>({..._,events:{..._.events,...m}})),setSize:(m,_,w,b,S)=>{const M=l().camera,T={width:m,height:_,top:b||0,left:S||0,updateStyle:w};a(P=>({size:T,viewport:{...P.viewport,...h(M,c,T)}}))},setDpr:m=>a(_=>{const w=YW(m);return{viewport:{..._.viewport,dpr:w,initialDpr:_.viewport.initialDpr||w}}}),setFrameloop:(m="always")=>{const _=l().clock;_.stop(),_.elapsedTime=0,m!=="never"&&(_.start(),_.elapsedTime=0),a(()=>({frameloop:m}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:U.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(m,_,w)=>{const b=l().internal;return b.priority=b.priority+(_>0?1:0),b.subscribers.push({ref:m,priority:_,store:w}),b.subscribers=b.subscribers.sort((S,M)=>S.priority-M.priority),()=>{const S=l().internal;S!=null&&S.subscribers&&(S.priority=S.priority-(_>0?1:0),S.subscribers=S.subscribers.filter(M=>M.ref!==m))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:c,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||u.dpr!==s){var h;i=l,s=u.dpr,Yde(a,l),c.setPixelRatio(u.dpr);const d=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&c.domElement instanceof HTMLCanvasElement;c.setSize(l.width,l.height,d)}a!==o&&(o=a,f(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let Lx,epe=new Set,tpe=new Set,npe=new Set;function T3(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function _0(n,e){switch(n){case"before":return T3(epe,e);case"after":return T3(tpe,e);case"tail":return T3(npe,e)}}let C3,A3;function R3(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),C3=e.internal.subscribers,Lx=0;Lx<C3.length;Lx++)A3=C3[Lx],A3.ref.current(A3.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function rpe(n){let e=!1,t=!1,r,i,s;function o(u){i=requestAnimationFrame(o),e=!0,r=0,_0("before",u),t=!0;for(const f of n.values()){var c;s=f.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((c=s.gl.xr)!=null&&c.isPresenting)&&(r+=R3(u,s))}if(t=!1,_0("after",u),r===0)return _0("tail",u),e=!1,cancelAnimationFrame(i)}function a(u,c=1){var f;if(!u)return n.forEach(h=>a(h.store.getState(),c));(f=u.gl.xr)!=null&&f.isPresenting||!u.internal.active||u.frameloop==="never"||(c>1?u.internal.frames=Math.min(60,u.internal.frames+c):t?u.internal.frames=2:u.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(u,c=!0,f,h){if(c&&_0("before",u),f)R3(u,f,h);else for(const d of n.values())R3(u,d.store.getState());c&&_0("after",u)}return{loop:o,invalidate:a,advance:l}}function eH(){const n=U.useContext(QW);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function yg(n=t=>t,e){return eH()(n,e)}function tH(n,e=0){const t=eH(),r=t.getState().internal.subscribe,i=XW(n);return ny(()=>r(i,e,t),[e,r,t]),null}const im=new Map,{invalidate:c5,advance:f5}=rpe(im),{reconciler:N_,applyProps:Ad}=Gde(im,Kde),Rd={objects:"shallow",strict:!1},ipe=(n,e)=>{const t=typeof n=="function"?n(e):n;return JW(t)?t:new xm({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function spe(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:a=t}=e;return{width:r,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function ope(n){const e=im.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||Qde(c5,f5),o=t||N_.createContainer(s,gp.ConcurrentRoot,null,!1,null,"",i,null);e||im.set(n,{fiber:o,store:s});let a,l=!1,u;return{configure(c={}){let{gl:f,size:h,scene:d,events:p,onCreated:y,shadows:x=!1,linear:m=!1,flat:_=!1,legacy:w=!1,orthographic:b=!1,frameloop:S="always",dpr:M=[1,2],performance:T,raycaster:P,camera:C,onPointerMissed:A}=c,k=s.getState(),L=k.gl;k.gl||k.set({gl:L=ipe(f,n)});let H=k.raycaster;H||k.set({raycaster:H=new gV});const{params:F,...V}=P||{};if(Zn.equ(V,H,Rd)||Ad(H,{...V}),Zn.equ(F,H.params,Rd)||Ad(H,{params:{...H.params,...F}}),!k.camera||k.camera===u&&!Zn.equ(u,C,Rd)){u=C;const D=C instanceof _h,$=D?C:b?new qc(0,0,0,0,.1,1e3):new ti(75,0,.1,1e3);D||($.position.z=5,C&&(Ad($,C),("aspect"in C||"left"in C||"right"in C||"bottom"in C||"top"in C)&&($.manual=!0,$.updateProjectionMatrix())),!k.camera&&!(C!=null&&C.rotation)&&$.lookAt(0,0,0)),k.set({camera:$}),H.camera=$}if(!k.scene){let D;d!=null&&d.isScene?D=d:(D=new mu,d&&Ad(D,d)),k.set({scene:Bd(D)})}if(!k.xr){var W;const D=(te,se)=>{const me=s.getState();me.frameloop!=="never"&&f5(te,!0,me,se)},$=()=>{const te=s.getState();te.gl.xr.enabled=te.gl.xr.isPresenting,te.gl.xr.setAnimationLoop(te.gl.xr.isPresenting?D:null),te.gl.xr.isPresenting||c5(te)},ee={connect(){const te=s.getState().gl;te.xr.addEventListener("sessionstart",$),te.xr.addEventListener("sessionend",$)},disconnect(){const te=s.getState().gl;te.xr.removeEventListener("sessionstart",$),te.xr.removeEventListener("sessionend",$)}};typeof((W=L.xr)==null?void 0:W.addEventListener)=="function"&&ee.connect(),k.set({xr:ee})}if(L.shadowMap){const D=L.shadowMap.enabled,$=L.shadowMap.type;if(L.shadowMap.enabled=!!x,Zn.boo(x))L.shadowMap.type=$0;else if(Zn.str(x)){var G;const ee={basic:cz,percentage:bw,soft:$0,variance:Ma};L.shadowMap.type=(G=ee[x])!=null?G:$0}else Zn.obj(x)&&Object.assign(L.shadowMap,x);(D!==L.shadowMap.enabled||$!==L.shadowMap.type)&&(L.shadowMap.needsUpdate=!0)}const N=GW();N&&("enabled"in N?N.enabled=!w:"legacyMode"in N&&(N.legacyMode=w)),l||Ad(L,{outputEncoding:m?3e3:3001,toneMapping:_?ka:dR}),k.legacy!==w&&k.set(()=>({legacy:w})),k.linear!==m&&k.set(()=>({linear:m})),k.flat!==_&&k.set(()=>({flat:_})),f&&!Zn.fun(f)&&!JW(f)&&!Zn.equ(f,L,Rd)&&Ad(L,f),p&&!k.events.handlers&&k.set({events:p(s)});const B=spe(n,h);return Zn.equ(B,k.size,Rd)||k.setSize(B.width,B.height,B.updateStyle,B.top,B.left),M&&k.viewport.dpr!==YW(M)&&k.setDpr(M),k.frameloop!==S&&k.setFrameloop(S),k.onPointerMissed||k.set({onPointerMissed:A}),T&&!Zn.equ(T,k.performance,Rd)&&k.set(D=>({performance:{...D.performance,...T}})),a=y,l=!0,this},render(c){return l||this.configure(),N_.updateContainer(z.jsx(ape,{store:s,children:c,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){nH(n)}}}function ape({store:n,children:e,onCreated:t,rootElement:r}){return ny(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),z.jsx(QW.Provider,{value:n,children:e})}function nH(n,e){const t=im.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),N_.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),qde(i),im.delete(n)}catch{}},500)})}}N_.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:U.version});const P3={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function lpe(n){const{handlePointer:e}=Jde(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(P3).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,u]=P3[o];t.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=P3[s];r.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function h5(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function upe({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=U.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=U.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,u=n?typeof n=="number"?n:n.resize:null,c=U.useRef(!1);U.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[f,h,d]=U.useMemo(()=>{const m=()=>{if(!a.current.element)return;const{left:_,top:w,width:b,height:S,bottom:M,right:T,x:P,y:C}=a.current.element.getBoundingClientRect(),A={left:_,top:w,width:b,height:S,bottom:M,right:T,x:P,y:C};a.current.element instanceof HTMLElement&&r&&(A.height=a.current.element.offsetHeight,A.width=a.current.element.offsetWidth),Object.freeze(A),c.current&&!dpe(a.current.lastBounds,A)&&o(a.current.lastBounds=A)};return[m,u?h5(m,u):m,l?h5(m,l):m]},[o,r,l,u]);function p(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(m=>m.removeEventListener("scroll",d,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function y(){a.current.element&&(a.current.resizeObserver=new i(d),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(m=>m.addEventListener("scroll",d,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{d()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const x=m=>{!m||m===a.current.element||(p(),a.current.element=m,a.current.scrollContainers=rH(m),y())};return fpe(d,!!e),cpe(h),U.useEffect(()=>{p(),y()},[e,d,h]),U.useEffect(()=>p,[]),[x,s,f]}function cpe(n){U.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function fpe(n,e){U.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function rH(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...rH(n.parentElement)]}const hpe=["x","y","top","bottom","left","right","width","height"],dpe=(n,e)=>hpe.every(t=>n[t]===e[t]);var ppe=Object.defineProperty,mpe=Object.defineProperties,gpe=Object.getOwnPropertyDescriptors,d5=Object.getOwnPropertySymbols,vpe=Object.prototype.hasOwnProperty,ype=Object.prototype.propertyIsEnumerable,p5=(n,e,t)=>e in n?ppe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,m5=(n,e)=>{for(var t in e||(e={}))vpe.call(e,t)&&p5(n,t,e[t]);if(d5)for(var t of d5(e))ype.call(e,t)&&p5(n,t,e[t]);return n},xpe=(n,e)=>mpe(n,gpe(e)),g5,v5;typeof window<"u"&&((g5=window.document)!=null&&g5.createElement||((v5=window.navigator)==null?void 0:v5.product)==="ReactNative")?U.useLayoutEffect:U.useEffect;function iH(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=iH(r,e,t);if(i)return i;r=r.sibling}}function sH(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const y5=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=y5;return}return y5.apply(this,arguments)};const s4=sH(U.createContext(null));class oH extends U.Component{render(){return U.createElement(s4.Provider,{value:this._reactInternals},this.props.children)}}function _pe(){const n=U.useContext(s4);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=U.useId();return U.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=iH(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function wpe(){const n=_pe(),[e]=U.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==s4&&!e.has(i)&&e.set(i,U.useContext(sH(i)))}t=t.return}return e}function bpe(){const n=wpe();return U.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>U.createElement(e,null,U.createElement(t.Provider,xpe(m5({},r),{value:n.get(t)}))),e=>U.createElement(oH,m5({},e))),[n])}const Spe=U.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=lpe,eventSource:a,eventPrefix:l,shadows:u,linear:c,flat:f,legacy:h,orthographic:d,frameloop:p,dpr:y,performance:x,raycaster:m,camera:_,scene:w,onPointerMissed:b,onCreated:S,...M},T){U.useMemo(()=>Hde(gie),[]);const P=bpe(),[C,A]=upe({scroll:!0,debounce:{scroll:50,resize:0},...r}),k=U.useRef(null),L=U.useRef(null);U.useImperativeHandle(T,()=>k.current);const H=XW(b),[F,V]=U.useState(!1),[W,G]=U.useState(!1);if(F)throw F;if(W)throw W;const N=U.useRef(null);ny(()=>{const D=k.current;A.width>0&&A.height>0&&D&&(N.current||(N.current=ope(D)),N.current.configure({gl:s,events:o,shadows:u,linear:c,flat:f,legacy:h,orthographic:d,frameloop:p,dpr:y,performance:x,raycaster:m,camera:_,scene:w,size:A,onPointerMissed:(...$)=>H.current==null?void 0:H.current(...$),onCreated:$=>{$.events.connect==null||$.events.connect(a?jde(a)?a.current:a:L.current),l&&$.setEvents({compute:(ee,te)=>{const se=ee[l+"X"],me=ee[l+"Y"];te.pointer.set(se/te.size.width*2-1,-(me/te.size.height)*2+1),te.raycaster.setFromCamera(te.pointer,te.camera)}}),S==null||S($)}}),N.current.render(z.jsx(P,{children:z.jsx($W,{set:G,children:z.jsx(U.Suspense,{fallback:z.jsx(Xde,{set:V}),children:e??null})})})))}),U.useEffect(()=>{const D=k.current;if(D)return()=>nH(D)},[]);const B=a?"none":"auto";return z.jsx("div",{ref:L,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...i},...M,children:z.jsx("div",{ref:C,style:{width:"100%",height:"100%"},children:z.jsx("canvas",{ref:k,style:{display:"block"},children:t})})})}),Epe=U.forwardRef(function(e,t){return z.jsx(oH,{children:z.jsx(Spe,{...e,ref:t})})});function WC(){return WC=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},WC.apply(null,arguments)}function Mpe(n,e,t){const r=yg(h=>h.size),i=yg(h=>h.viewport),s=typeof n=="number"?n:r.width*i.dpr,o=r.height*i.dpr,a=(typeof n=="number"?t:n)||{},{samples:l=0,depth:u,...c}=a,f=U.useMemo(()=>{const h=new Br(s,o,{minFilter:bn,magFilter:bn,type:Nc,...c});return u&&(h.depthTexture=new Hv(s,o,zs)),h.samples=l,h},[]);return U.useLayoutEffect(()=>{f.setSize(s,o),l&&(f.samples=l)},[l,f,s,o]),U.useEffect(()=>()=>f.dispose(),[]),f}const Tpe=n=>typeof n=="function",Cpe=U.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,makeDefault:r,children:i,...s},o)=>{const a=yg(({set:x})=>x),l=yg(({camera:x})=>x),u=yg(({size:x})=>x),c=U.useRef(null);U.useImperativeHandle(o,()=>c.current,[]);const f=U.useRef(null),h=Mpe(e);U.useLayoutEffect(()=>{s.manual||(c.current.aspect=u.width/u.height)},[u,s]),U.useLayoutEffect(()=>{c.current.updateProjectionMatrix()});let d=0,p=null;const y=Tpe(i);return tH(x=>{y&&(t===1/0||d<t)&&(f.current.visible=!1,x.gl.setRenderTarget(h),p=x.scene.background,n&&(x.scene.background=n),x.gl.render(x.scene,c.current),x.scene.background=p,x.gl.setRenderTarget(null),f.current.visible=!0,d++)}),U.useLayoutEffect(()=>{if(r){const x=l;return a(()=>({camera:c.current})),()=>a(()=>({camera:x}))}},[c,r,a]),U.createElement(U.Fragment,null,U.createElement("perspectiveCamera",WC({ref:c},s),!y&&i),U.createElement("group",{ref:f},y&&i(h.texture)))}),Ape=Math.PI/180;function Rpe(n){return n*Ape}function Ppe(n,e){var h;const t=Ko.physical,{vertexShader:r,fragmentShader:i,uniforms:s}=t,o=t.defines??{},a=IR.clone(s),l=new n(e.material||{});l.color&&(a.diffuse.value=l.color),"roughness"in l&&(a.roughness.value=l.roughness),"metalness"in l&&(a.metalness.value=l.metalness),"envMap"in l&&(a.envMap.value=l.envMap),"envMapIntensity"in l&&(a.envMapIntensity.value=l.envMapIntensity),Object.entries(e.uniforms??{}).forEach(([d,p])=>{a[d]=p!==null&&typeof p=="object"&&"value"in p?p:{value:p}});let u=`${e.header}
${e.vertexHeader??""}
${r}`,c=`${e.header}
${e.fragmentHeader??""}
${i}`;for(const[d,p]of Object.entries(e.vertex??{}))u=u.replace(d,`${d}
${p}`);for(const[d,p]of Object.entries(e.fragment??{}))c=c.replace(d,`${d}
${p}`);return new $r({defines:{...o},uniforms:a,vertexShader:u,fragmentShader:c,lights:!0,fog:!!((h=e.material)!=null&&h.fog)})}const Ipe=({children:n})=>z.jsx(Epe,{dpr:[1,2],frameloop:"always",className:"w-full h-full relative",children:n}),Dpe=n=>{const e=n.replace("#",""),t=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16);return[t/255,r/255,i/255]},Npe=`
float random (in vec2 st) {
    return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))*
        43758.5453123);
}
float noise (in vec2 st) {
    vec2 i = floor(st);
    vec2 f = fract(st);
    float a = random(i);
    float b = random(i + vec2(1.0, 0.0));
    float c = random(i + vec2(0.0, 1.0));
    float d = random(i + vec2(1.0, 1.0));
    vec2 u = f * f * (3.0 - 2.0 * f);
    return mix(a, b, u.x) +
           (c - a)* u.y * (1.0 - u.x) +
           (d - b) * u.x * u.y;
}
vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}
vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}
float cnoise(vec3 P){
  vec3 Pi0 = floor(P);
  vec3 Pi1 = Pi0 + vec3(1.0);
  Pi0 = mod(Pi0, 289.0);
  Pi1 = mod(Pi1, 289.0);
  vec3 Pf0 = fract(P);
  vec3 Pf1 = Pf0 - vec3(1.0);
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;
  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);
  vec4 gx0 = ixy0 / 7.0;
  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
  vec4 gx1 = ixy1 / 7.0;
  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
  vec4 norm0 = taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));
  g000 *= norm0.x; g010 *= norm0.y; g100 *= norm0.z; g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));
  g001 *= norm1.x; g011 *= norm1.y; g101 *= norm1.z; g111 *= norm1.w;
  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x,Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x,Pf1.y,Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy,Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy,Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x,Pf0.y,Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x,Pf1.yz));
  float n111 = dot(g111, Pf1);
  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);
  vec2 n_yz = mix(n_z.xy,n_z.zw,fade_xyz.y);
  float n_xyz = mix(n_yz.x,n_yz.y,fade_xyz.x);
  return 2.2 * n_xyz;
}
`,kpe=({beamWidth:n=2,beamHeight:e=15,beamNumber:t=12,lightColor:r="#ffffff",speed:i=2,noiseIntensity:s=1.75,scale:o=.2,rotation:a=0})=>{const l=U.useRef(null),u=U.useMemo(()=>Ppe(qw,{header:`
  varying vec3 vEye;
  varying float vNoise;
  varying vec2 vUv;
  varying vec3 vPosition;
  uniform float time;
  uniform float uSpeed;
  uniform float uNoiseIntensity;
  uniform float uScale;
  ${Npe}`,vertexHeader:`
  float getPos(vec3 pos) {
    vec3 noisePos =
      vec3(pos.x * 0., pos.y - uv.y, pos.z + time * uSpeed * 3.) * uScale;
    return cnoise(noisePos);
  }
  vec3 getCurrentPos(vec3 pos) {
    vec3 newpos = pos;
    newpos.z += getPos(pos);
    return newpos;
  }
  vec3 getNormal(vec3 pos) {
    vec3 curpos = getCurrentPos(pos);
    vec3 nextposX = getCurrentPos(pos + vec3(0.01, 0.0, 0.0));
    vec3 nextposZ = getCurrentPos(pos + vec3(0.0, -0.01, 0.0));
    vec3 tangentX = normalize(nextposX - curpos);
    vec3 tangentZ = normalize(nextposZ - curpos);
    return normalize(cross(tangentZ, tangentX));
  }`,fragmentHeader:"",vertex:{"#include <begin_vertex>":"transformed.z += getPos(transformed.xyz);","#include <beginnormal_vertex>":"objectNormal = getNormal(position.xyz);"},fragment:{"#include <dithering_fragment>":`
    float randomNoise = noise(gl_FragCoord.xy);
    gl_FragColor.rgb -= randomNoise / 15. * uNoiseIntensity;`},material:{fog:!0},uniforms:{diffuse:new it(...Dpe("#000000")),time:{shared:!0,mixed:!0,linked:!0,value:0},roughness:.3,metalness:.3,uSpeed:{shared:!0,mixed:!0,linked:!0,value:i},envMapIntensity:10,uNoiseIntensity:s,uScale:o}}),[i,s,o]);return z.jsxs(Ipe,{children:[z.jsxs("group",{rotation:[0,0,Rpe(a)],children:[z.jsx(lH,{ref:l,material:u,count:t,width:n,height:e}),z.jsx(Fpe,{color:r,position:[0,3,10]})]}),z.jsx("ambientLight",{intensity:1}),z.jsx("color",{attach:"background",args:["#000000"]}),z.jsx(Cpe,{makeDefault:!0,position:[0,0,20],fov:30})]})};function Lpe(n,e,t,r,i){const s=new qt,o=n*(i+1)*2,a=n*i*2,l=new Float32Array(o*3),u=new Uint32Array(a*3),c=new Float32Array(o*2);let f=0,h=0,d=0;const y=-(n*e+(n-1)*r)/2;for(let x=0;x<n;x++){const m=y+x*(e+r),_=Math.random()*300,w=Math.random()*300;for(let b=0;b<=i;b++){const S=t*(b/i-.5),M=[m,S,0],T=[m+e,S,0];l.set([...M,...T],f*3);const P=b/i;if(c.set([_,P+w,_+1,P+w],d),b<i){const C=f,A=f+1,k=f+2,L=f+3;u.set([C,A,k,k,A,L],h),h+=6}f+=2,d+=4}}return s.setAttribute("position",new vn(l,3)),s.setAttribute("uv",new vn(c,2)),s.setIndex(new vn(u,1)),s.computeVertexNormals(),s}const aH=U.forwardRef(({material:n,width:e,count:t,height:r},i)=>{const s=U.useRef(null);U.useImperativeHandle(i,()=>s.current);const o=U.useMemo(()=>Lpe(t,e,r,0,100),[t,e,r]);return tH((a,l)=>{s.current.material.uniforms.time.value+=.1*l}),z.jsx("mesh",{ref:s,geometry:o,material:n})});aH.displayName="MergedPlanes";const lH=U.forwardRef((n,e)=>z.jsx(aH,{ref:e,material:n.material,width:n.width,count:n.count,height:n.height}));lH.displayName="PlaneNoise";const Fpe=({position:n,color:e})=>{const t=U.useRef(null);return U.useEffect(()=>{if(!t.current)return;const r=t.current.shadow.camera;r&&(r.top=24,r.bottom=-24,r.left=-24,r.right=24,r.far=64,t.current.shadow.bias=-.004)},[]),z.jsx("directionalLight",{ref:t,color:e,intensity:1,position:n})},Ope=()=>{const[n,e]=U.useState(0),t=U.useRef(null),[r,i]=U.useState(window.innerWidth<=768);U.useEffect(()=>{const l=()=>i(window.innerWidth<=768);return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const s=[{title:"Portfolio Website",description:"A modern, interactive portfolio website built with React and Vite. Features smooth animations, 3D effects, and responsive design.",image:Dr.portfolioImage,demoLink:"https://mayank-kumar-portfolio.vercel.app/",technologies:["React","Vite","Tailwind CSS","Three.js","GSAP"],colorScheme:"cyan"},{title:"EMC",description:"Interactive Educational Calculator for Class 10 Mathematics",image:Dr.EMC,demoLink:"https://emc-calculator.vercel.app/",technologies:["React 18","Tailwind CSS","Framer Motion","EmailJS","React Router"],colorScheme:"violet"},{title:"Disaster Response Training Tool",description:"The Disaster Response Training Tool is an interactive web-based platform designed to enhance disaster preparedness and response training",image:Dr.DRT,demoLink:"https://disaster-response-traning-tool.vercel.app/",technologies:["HTML","CSS","JS","API"],colorScheme:"rose"},{title:"CoreX-OS",description:"CoreX OS is a web-based OS simulator with an interactive React frontend that demonstrates core operating system concepts like file systems, memory management, CPU scheduling, and process synchronization.",image:Dr.core,demoLink:"https://github.com/mayank-kumar-27/CoreX-OS",technologies:["React","Python","Bootstrap","Chart.js","Context API"],colorScheme:"emerald"},{title:"Voting Simulation Systems",description:"Voting Simulation System is a C-based command-line program that simulates voting for six parties, allowing users to cast votes, securely view results with a PIN, and demonstrating basic real-world voting logic.",image:Dr.vm,demoLink:"https://github.com/mayank-kumar-27/Voting-Machine",technologies:["C","CLI","Voting Simulation"],colorScheme:"amber"}];U.useEffect(()=>{if(!r){const l=setInterval(()=>{e(u=>(u+1)%s.length)},3e3);return()=>clearInterval(l)}},[s.length,r]);const o={cyan:{bg:"from-primary/20 to-surface/50",border:"border-primary/40",gradient:"from-primary to-primary-light",text:"text-primary",glow:"rgba(0, 212, 255, 0.3)"},violet:{bg:"from-secondary/20 to-surface/50",border:"border-secondary/40",gradient:"from-secondary to-secondary-light",text:"text-secondary-light",glow:"rgba(124, 58, 237, 0.3)"},rose:{bg:"from-tertiary/20 to-surface/50",border:"border-tertiary/40",gradient:"from-tertiary to-tertiary-light",text:"text-tertiary",glow:"rgba(244, 114, 182, 0.3)"},emerald:{bg:"from-accent/20 to-surface/50",border:"border-accent/40",gradient:"from-accent to-accent-light",text:"text-accent",glow:"rgba(16, 185, 129, 0.3)"},amber:{bg:"from-warm/20 to-surface/50",border:"border-warm/40",gradient:"from-warm to-warm-light",text:"text-warm",glow:"rgba(245, 158, 11, 0.3)"}},a=({project:l})=>{const u=o[l.colorScheme];return z.jsxs("div",{className:`bg-gradient-to-br ${u.bg} backdrop-blur-md border ${u.border} rounded-2xl p-5 flex flex-col min-h-[380px] w-full`,children:[z.jsx("div",{className:`w-full h-32 rounded-xl overflow-hidden mb-4 ring-2 ${u.border.replace("border-","ring-")}`,children:z.jsx("img",{src:l.image,alt:l.title,className:"w-full h-full object-cover"})}),z.jsx("h3",{className:"text-lg font-bold text-white mb-2 text-center",children:l.title}),z.jsx("p",{className:"text-gray-400 text-xs leading-relaxed text-center mb-4 flex-1",children:l.description}),z.jsx("div",{className:"flex flex-wrap justify-center gap-1.5 mb-4",children:l.technologies.slice(0,4).map((c,f)=>z.jsx("span",{className:`px-2 py-1 text-xs font-medium bg-gradient-to-r ${u.gradient} bg-opacity-10 text-white rounded-full border ${u.border}`,children:c},f))}),z.jsxs("a",{href:l.demoLink,target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center justify-center gap-2 px-5 py-2.5 bg-gradient-to-r ${u.gradient} rounded-full text-white text-sm font-semibold active:scale-95 transition-transform`,children:[z.jsx("span",{children:"View Demo"}),z.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})};return z.jsxs("section",{className:"relative min-h-screen w-full flex items-center overflow-visible bg-gradient-to-br from-[#0a0a0f] via-surface/20 to-[#0a0a0f] py-20",children:[z.jsx("div",{className:"absolute inset-0 z-[1]",children:z.jsx(kpe,{beamWidth:3,beamHeight:30,beamNumber:20,lightColor:"#7c3aed",speed:2,noiseIntensity:1.75,scale:.2,rotation:45})}),z.jsxs("div",{className:"absolute inset-0 overflow-hidden z-[2] pointer-events-none",children:[z.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-primary/10 rounded-full blur-3xl animate-pulse"}),z.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-secondary/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),z.jsx("div",{className:"absolute top-1/2 right-1/3 w-64 h-64 bg-tertiary/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),r?z.jsxs("div",{className:"relative z-10 w-full h-full px-4 pt-16 pb-8",children:[z.jsxs("div",{className:"text-center mb-8",children:[z.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift mb-4",children:"My Projects"}),z.jsx("p",{className:"text-sm text-gray-400 leading-relaxed px-2",children:"Explore my latest work and creative solutions. Each project showcases my passion for building innovative applications."})]}),z.jsx(CW,{autoPlayInterval:4e3,enableSwipe:!0,children:s.map((l,u)=>z.jsx(a,{project:l},u))})]}):z.jsxs("div",{className:"relative z-10 w-full max-w-[1400px] mx-auto px-8 lg:px-16 flex flex-col lg:flex-row items-center gap-16 pointer-events-none",children:[z.jsxs("div",{className:"w-full lg:w-1/3 space-y-6 pointer-events-auto",children:[z.jsxs("div",{children:[z.jsx("h1",{className:"text-6xl md:text-7xl lg:text-8xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent animate-gradient-shift mb-4",children:"My Projects"}),z.jsx("p",{className:"text-gray-400 text-lg md:text-xl leading-relaxed",children:z.jsx(n4,{text:"Explore my latest work and creative solutions. Each project showcases my passion for building innovative and functional applications.",className:"text-base sm:text-lg md:text-xl text-gray-400",parentClassName:"max-w-2xl leading-relaxed mb-10 block",speed:20,maxIterations:15,sequential:!0,revealDirection:"start",animateOn:"view"})})]}),z.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[z.jsxs("span",{className:"text-gray-500 text-sm font-medium",children:[n+1," / ",s.length]}),z.jsx("div",{className:"flex gap-2",children:s.map((l,u)=>z.jsx("div",{className:`h-1 rounded-full transition-all duration-500 ${n===u?"w-12 bg-gradient-to-r from-primary via-secondary to-tertiary":"w-6 bg-white/20"}`},u))})]})]}),z.jsx("div",{ref:t,className:"w-full lg:w-2/3 relative h-[650px] flex items-center justify-end",children:z.jsx("div",{className:"relative w-full max-w-[500px] h-full flex items-center justify-end pr-8",children:s.map((l,u)=>{const c=(u-n+s.length)%s.length,f=c===0,h=o[l.colorScheme],d=p=>p===0?"translate(-50%, -50%) translateX(0px)":p===1?"translate(-50%, -50%) translateX(180px)":p===2?"translate(-50%, -50%) translateX(360px)":p===3?"translate(-50%, -50%) translateX(540px)":p===4?"translate(-50%, -50%) translateX(720px)":"translate(-50%, -50%) translateX(900px)";return z.jsxs("div",{className:`group absolute top-1/2 left-0 w-[400px] transition-all duration-700 ease-out rounded-3xl overflow-hidden border ${h.border} bg-gradient-to-br ${h.bg} backdrop-blur-md shadow-2xl`,style:{zIndex:s.length-c,transform:d(c)+` scale(${c===0?1:.85-c*.05})`,opacity:c<5?c===0?1:.6-c*.1:0,filter:c>0?`blur(${c*1.2}px)`:"blur(0px)",pointerEvents:f?"auto":"none",boxShadow:f?`0 0 40px ${h.glow}`:"none"},children:[z.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-gradient-to-br from-secondary/20 to-primary/20 rounded-full blur-2xl"}),z.jsx("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-gradient-to-tr from-tertiary/10 to-warm/10 rounded-full blur-2xl"}),z.jsxs("div",{className:"relative flex flex-col items-center h-full p-6 min-h-[580px]",children:[z.jsx("div",{className:"flex justify-center mb-4",children:z.jsxs("div",{className:`relative w-28 h-28 rounded-2xl overflow-hidden ring-2 ${h.border.replace("border-","ring-")} transition-all duration-500 ${f?"scale-100":"scale-90"}`,style:{transitionDelay:f?"200ms":"0ms"},children:[z.jsx("img",{src:l.image,alt:l.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),z.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]})}),z.jsx("div",{className:"flex justify-center mb-4",children:z.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${h.gradient} rounded-full flex items-center justify-center transition-all duration-500 shadow-lg ${f?"rotate-0 scale-100":"rotate-12 scale-90"}`,children:z.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})})}),z.jsx("div",{className:"text-center mb-4 flex-1 flex items-center justify-center px-3",children:z.jsx("p",{className:"text-gray-400 text-sm leading-relaxed italic",children:l.description})}),z.jsx("div",{className:"text-center mb-3",children:z.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:l.title})}),z.jsx("div",{className:"w-full mb-4 px-4",children:z.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:l.technologies.map((p,y)=>z.jsx("span",{className:`px-3 py-1.5 text-xs font-bold bg-gradient-to-r ${h.gradient} bg-opacity-10 text-white rounded-full border ${h.border} transition-transform duration-300`,style:{textShadow:"0 1px 4px rgba(0,0,0,0.25)"},children:p},y))})}),z.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4 text-gray-500 text-xs",children:[z.jsxs("div",{className:"flex items-center gap-1.5 group-hover:text-gray-400 transition-colors",children:[z.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:z.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),z.jsx("span",{className:"font-medium",children:"Featured"})]}),z.jsx("div",{className:"w-px h-4 bg-surface"}),z.jsxs("div",{className:"flex items-center gap-1.5 group-hover:text-gray-400 transition-colors",children:[z.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),z.jsx("span",{className:"font-medium",children:"2025"})]})]}),f&&z.jsxs("a",{href:l.demoLink,target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center justify-center gap-2 px-6 py-2.5 bg-gradient-to-r ${h.gradient} rounded-full text-white text-sm font-semibold hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl`,children:[z.jsx("span",{children:"View Demo"}),z.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),z.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-700 rounded-3xl overflow-hidden pointer-events-none",children:z.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1500"})})]},u)})})})]})]})},Bpe=()=>{const n=_w(),e=Ba(),t=[{name:"Home",path:"/"},{name:"About",path:"/about"},{name:"Projects",path:"/projects"},{name:"Skills",path:"/skills"},{name:"Contact",path:"/contact"}],r=i=>e.pathname===i;return z.jsx("nav",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50",children:z.jsx("div",{className:"flex items-center gap-2 bg-surface/30 backdrop-blur-xl rounded-full px-4 py-2 border border-white/5",children:t.map(i=>z.jsxs("button",{onClick:()=>n(i.path),className:`
              cursor-target
              relative flex items-center gap-2 px-6 py-2.5 rounded-full font-medium text-base
              transition-all duration-300 ease-out overflow-hidden
              group
              ${r(i.path)?"bg-gradient-to-r from-primary via-secondary to-tertiary text-white shadow-lg shadow-primary/30 scale-105":"text-gray-400 hover:text-white hover:bg-white/5 hover:scale-105"}
            `,children:[!r(i.path)&&z.jsx("span",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-out bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-12"}),r(i.path)&&z.jsx("span",{className:"w-2 h-2 rounded-full bg-white animate-pulse relative z-10"}),z.jsx("span",{className:"relative z-10",children:i.name})]},i.name))})})},Upe=()=>{const[n,e]=U.useState(!1),t=_w(),r=Ba(),i=U.useRef(null),s=[{name:"Home",path:"/"},{name:"About",path:"/about"},{name:"Projects",path:"/projects"},{name:"Skills",path:"/skills"},{name:"Contact",path:"/contact"}],o=s.find(u=>u.path===r.pathname)||s[0],a=s.filter(u=>u.path!==r.pathname);U.useEffect(()=>{const u=c=>{i.current&&!i.current.contains(c.target)&&e(!1)};return n&&(document.addEventListener("touchstart",u),document.addEventListener("mousedown",u)),()=>{document.removeEventListener("touchstart",u),document.removeEventListener("mousedown",u)}},[n]);const l=u=>{t(u),e(!1)};return z.jsxs("nav",{ref:i,className:"fixed top-4 left-1/2 -translate-x-1/2 z-50",children:[z.jsxs("button",{onClick:()=>e(!n),className:`
          flex items-center gap-2 px-5 py-2.5 rounded-full
          bg-surface/60 backdrop-blur-xl border border-white/10
          transition-all duration-300
          ${n?"border-primary/40 shadow-lg shadow-primary/10":""}
        `,children:[z.jsx("span",{className:"w-2 h-2 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse"}),z.jsx("span",{className:"text-sm font-medium text-white",children:o.name}),z.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform duration-300 ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),z.jsx("div",{className:`
          absolute top-full left-1/2 -translate-x-1/2 mt-2 min-w-[140px]
          bg-surface/90 backdrop-blur-xl rounded-2xl border border-white/10
          overflow-hidden shadow-xl shadow-black/30
          transition-all duration-300 origin-top
          ${n?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}
        `,children:a.map((u,c)=>z.jsx("button",{onClick:()=>l(u.path),className:`
              w-full px-5 py-3 text-left text-sm font-medium text-gray-300
              hover:bg-white/5 hover:text-white transition-colors duration-200
              ${c!==a.length-1?"border-b border-white/5":""}
            `,children:u.name},u.name))})]})},zpe=({targetSelector:n=".cursor-target",spinDuration:e=2,hideDefaultCursor:t=!0,hoverDuration:r=.2,parallaxOn:i=!0})=>{const s=Ba(),o=U.useRef(null),a=U.useRef(null),l=U.useRef(null),u=U.useRef(null),c=U.useRef(!1),f=U.useRef(null),h=U.useRef(null),d=U.useRef(0),p=U.useMemo(()=>{const m="ontouchstart"in window||navigator.maxTouchPoints>0,_=window.innerWidth<=768,w=navigator.userAgent||navigator.vendor||window.opera,S=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(w.toLowerCase());return m&&_||S},[]),y=U.useMemo(()=>({borderWidth:3,cornerSize:12}),[]),x=U.useCallback((m,_)=>{o.current&&Wt.to(o.current,{x:m,y:_,duration:.1,ease:"power3.out"})},[]);return U.useEffect(()=>{if(p||!o.current)return;const m=document.body.style.cursor;t&&(document.body.style.cursor="none");const _=o.current;a.current=_.querySelectorAll(".target-cursor-corner");let w=null,b=null,S=null;const M=F=>{b&&F.removeEventListener("mouseleave",b),b=null};Wt.set(_,{xPercent:-50,yPercent:-50,x:window.innerWidth/2,y:window.innerHeight/2}),(()=>{l.current&&l.current.kill(),l.current=Wt.timeline({repeat:-1}).to(_,{rotation:"+=360",duration:e,ease:"none"})})();const P=()=>{if(!f.current||!o.current||!a.current)return;const F=d.current;if(F===0)return;const V=Wt.getProperty(o.current,"x"),W=Wt.getProperty(o.current,"y");Array.from(a.current).forEach((N,B)=>{const D=Wt.getProperty(N,"x"),$=Wt.getProperty(N,"y"),ee=f.current[B].x-V,te=f.current[B].y-W,se=D+(ee-D)*F,me=$+(te-$)*F,_e=F>=.99?i?.2:0:.05;Wt.to(N,{x:se,y:me,duration:_e,ease:_e===0?"none":"power1.out",overwrite:"auto"})})};h.current=P;const C=F=>x(F.clientX,F.clientY);window.addEventListener("mousemove",C);const A=()=>{if(!w||!o.current)return;const F=Wt.getProperty(o.current,"x"),V=Wt.getProperty(o.current,"y"),W=document.elementFromPoint(F,V);W&&(W===w||W.closest(n)===w)||b&&b()};window.addEventListener("scroll",A,{passive:!0});const k=()=>{u.current&&(Wt.to(u.current,{scale:.7,duration:.3}),Wt.to(o.current,{scale:.9,duration:.2}))},L=()=>{u.current&&(Wt.to(u.current,{scale:1,duration:.3}),Wt.to(o.current,{scale:1,duration:.2}))};window.addEventListener("mousedown",k),window.addEventListener("mouseup",L);const H=F=>{var _e;const V=F.target,W=[];let G=V;for(;G&&G!==document.body;)G.matches(n)&&W.push(G),G=G.parentElement;const N=W[0]||null;if(!N||!o.current||!a.current||w===N)return;w&&M(w),S&&(clearTimeout(S),S=null),w=N;const B=Array.from(a.current);B.forEach(pe=>Wt.killTweensOf(pe)),Wt.killTweensOf(o.current,"rotation"),(_e=l.current)==null||_e.pause(),Wt.set(o.current,{rotation:0});const D=N.getBoundingClientRect(),{borderWidth:$,cornerSize:ee}=y,te=Wt.getProperty(o.current,"x"),se=Wt.getProperty(o.current,"y");f.current=[{x:D.left-$,y:D.top-$},{x:D.right+$-ee,y:D.top-$},{x:D.right+$-ee,y:D.bottom+$-ee},{x:D.left-$,y:D.bottom+$-ee}],c.current=!0,Wt.ticker.add(h.current),Wt.to(d,{current:1,duration:r,ease:"power2.out"}),B.forEach((pe,Ne)=>{Wt.to(pe,{x:f.current[Ne].x-te,y:f.current[Ne].y-se,duration:.2,ease:"power2.out"})});const me=()=>{if(Wt.ticker.remove(h.current),c.current=!1,f.current=null,Wt.set(d,{current:0,overwrite:!0}),w=null,a.current){const pe=Array.from(a.current);Wt.killTweensOf(pe);const{cornerSize:Ne}=y,Ue=[{x:-Ne*1.5,y:-Ne*1.5},{x:Ne*.5,y:-Ne*1.5},{x:Ne*.5,y:Ne*.5},{x:-Ne*1.5,y:Ne*.5}],We=Wt.timeline();pe.forEach((Be,J)=>{We.to(Be,{x:Ue[J].x,y:Ue[J].y,duration:.3,ease:"power3.out"},0)})}S=setTimeout(()=>{if(!w&&o.current&&l.current){const Ne=Wt.getProperty(o.current,"rotation")%360;l.current.kill(),l.current=Wt.timeline({repeat:-1}).to(o.current,{rotation:"+=360",duration:e,ease:"none"}),Wt.to(o.current,{rotation:Ne+360,duration:e*(1-Ne/360),ease:"none",onComplete:()=>{var Ue;(Ue=l.current)==null||Ue.restart()}})}S=null},50),M(N)};b=me,N.addEventListener("mouseleave",me)};return window.addEventListener("mouseover",H,{passive:!0}),()=>{var F;h.current&&Wt.ticker.remove(h.current),window.removeEventListener("mousemove",C),window.removeEventListener("mouseover",H),window.removeEventListener("scroll",A),window.removeEventListener("mousedown",k),window.removeEventListener("mouseup",L),w&&M(w),(F=l.current)==null||F.kill(),document.body.style.cursor=m,c.current=!1,f.current=null,d.current=0}},[n,e,x,y,t,p,r,i]),U.useEffect(()=>{p||!o.current||!l.current||l.current.isActive()&&(l.current.kill(),l.current=Wt.timeline({repeat:-1}).to(o.current,{rotation:"+=360",duration:e,ease:"none"}))},[e,p]),U.useEffect(()=>{if(p||!o.current||!a.current)return;const m=Array.from(a.current);Wt.killTweensOf(m);const{cornerSize:_}=y,w=[{x:-_*1.5,y:-_*1.5},{x:_*.5,y:-_*1.5},{x:_*.5,y:_*.5},{x:-_*1.5,y:_*.5}];m.forEach((b,S)=>{Wt.to(b,{x:w[S].x,y:w[S].y,duration:.3,ease:"power3.out"})}),c.current=!1,f.current=null,Wt.set(d,{current:0}),l.current&&(l.current.kill(),l.current=Wt.timeline({repeat:-1}).to(o.current,{rotation:"+=360",duration:e,ease:"none"}))},[s.pathname,p,y,e]),p?null:z.jsxs("div",{ref:o,className:"fixed top-0 left-0 w-0 h-0 pointer-events-none z-[9999]",style:{willChange:"transform"},children:[z.jsx("div",{ref:u,className:"absolute top-1/2 left-1/2 w-1 h-1 bg-white rounded-full -translate-x-1/2 -translate-y-1/2",style:{willChange:"transform"}}),z.jsx("div",{className:"target-cursor-corner absolute top-1/2 left-1/2 w-3 h-3 border-[3px] border-white -translate-x-[150%] -translate-y-[150%] border-r-0 border-b-0",style:{willChange:"transform"}}),z.jsx("div",{className:"target-cursor-corner absolute top-1/2 left-1/2 w-3 h-3 border-[3px] border-white translate-x-1/2 -translate-y-[150%] border-l-0 border-b-0",style:{willChange:"transform"}}),z.jsx("div",{className:"target-cursor-corner absolute top-1/2 left-1/2 w-3 h-3 border-[3px] border-white translate-x-1/2 translate-y-1/2 border-l-0 border-t-0",style:{willChange:"transform"}}),z.jsx("div",{className:"target-cursor-corner absolute top-1/2 left-1/2 w-3 h-3 border-[3px] border-white -translate-x-[150%] translate-y-1/2 border-r-0 border-t-0",style:{willChange:"transform"}})]})};/**
 * postprocessing v6.38.2 build Mon Dec 22 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var I3=1/1e3,Vpe=1e3,Wpe=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*I3}get fixedDelta(){return this._fixedDelta*I3}set fixedDelta(n){this._fixedDelta=n*Vpe}get elapsed(){return this._elapsed*I3}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Hpe=(()=>{const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new qt;return t.setAttribute("position",new vn(n,3)),t.setAttribute("uv",new vn(e,2)),t})(),Wa=class HC{static get fullscreenGeometry(){return Hpe}constructor(e="Pass",t=new mu,r=new qc){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Qn(HC.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new mu),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=gm){}render(e,t,r,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Br||t instanceof Mi||t instanceof vr||t instanceof HC)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Gpe=class extends Wa{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,r,i){const s=n.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},jpe=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,uH="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",cH=class extends $r{constructor(){super({name:"CopyMaterial",defines:{COLOR_SPACE_CONVERSION:"1",DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new yn(null),depthBuffer:new yn(null),channelWeights:new yn(null),opacity:new yn(1)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:jpe,vertexShader:uH}),this.depthFunc=hR}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(n){const e=n!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){const e=n!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}get colorSpaceConversion(){return this.defines.COLOR_SPACE_CONVERSION!==void 0}set colorSpaceConversion(n){this.colorSpaceConversion!==n&&(n?this.defines.COLOR_SPACE_CONVERSION=!0:delete this.defines.COLOR_SPACE_CONVERSION,this.needsUpdate=!0)}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(n){n!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=n):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},Xpe=class extends Wa{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new cH,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new Br(1,1,{minFilter:bn,magFilter:bn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,r,i){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==Oi?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":n!==null&&n.outputColorSpace===mn&&(this.renderTarget.texture.colorSpace=mn))}},x5=new it,fH=class extends Wa{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,r,i){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=n.getClearAlpha(),l=s!==null,u=o>=0;l?(n.getClearColor(x5),n.setClearColor(s,u?o:a)):u&&n.setClearAlpha(o),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),l?n.setClearColor(x5,a):u&&n.setClearAlpha(a)}},$pe=class extends Wa{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new fH(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,r,i){const s=n.getContext(),o=n.state.buffers,a=this.scene,l=this.camera,u=this.clearPass,c=this.inverted?0:1,f=1-c;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,c,4294967295),o.stencil.setClear(f),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(n,null):(u.render(n,e),u.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(a,l)):(n.setRenderTarget(e),n.render(a,l),n.setRenderTarget(t),n.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},qpe=class{constructor(n=null,{depthBuffer:e=!0,stencilBuffer:t=!1,multisampling:r=0,frameBufferType:i}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,t,i,r),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Xpe,this.depthTexture=null,this.passes=[],this.timer=new Wpe,this.autoRenderToScreen=!0,this.setRenderer(n)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(n){const e=this.inputBuffer,t=this.multisampling;t>0&&n>0?(this.inputBuffer.samples=n,this.outputBuffer.samples=n,this.inputBuffer.dispose(),this.outputBuffer.dispose()):t!==n&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,n),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(n){if(this.renderer=n,n!==null){const e=n.getSize(new Me),t=n.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===Oi&&n.outputColorSpace===mn&&(this.inputBuffer.texture.colorSpace=mn,this.outputBuffer.texture.colorSpace=mn,this.inputBuffer.dispose(),this.outputBuffer.dispose()),n.autoClear=!1,this.setSize(e.width,e.height);for(const i of this.passes)i.initialize(n,t,r)}}replaceRenderer(n,e=!0){const t=this.renderer,r=t.domElement.parentNode;return this.setRenderer(n),e&&r!==null&&(r.removeChild(t.domElement),r.appendChild(n.domElement)),t}createDepthTexture(){const n=this.depthTexture=new Hv;return this.inputBuffer.depthTexture=n,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(n.format=kc,n.type=ou):n.type=fl,n}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const n of this.passes)n.setDepthTexture(null)}}createBuffer(n,e,t,r){const i=this.renderer,s=i===null?new Me:i.getDrawingBufferSize(new Me),o={minFilter:bn,magFilter:bn,stencilBuffer:e,depthBuffer:n,type:t},a=new Br(s.width,s.height,o);return r>0&&(a.samples=r),t===Oi&&i!==null&&i.outputColorSpace===mn&&(a.texture.colorSpace=mn),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}setMainScene(n){for(const e of this.passes)e.mainScene=n}setMainCamera(n){for(const e of this.passes)e.mainCamera=n}addPass(n,e){const t=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new Me),s=r.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(n.setRenderer(r),n.setSize(i.width,i.height),n.initialize(r,s,o),this.autoRenderToScreen&&(t.length>0&&(t[t.length-1].renderToScreen=!1),n.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?t.splice(e,0,n):t.push(n),this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!0),n.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const a=this.createDepthTexture();for(n of t)n.setDepthTexture(a)}else n.setDepthTexture(this.depthTexture)}removePass(n){const e=this.passes,t=e.indexOf(n);if(t!==-1&&e.splice(t,1).length>0){if(this.depthTexture!==null){const s=(a,l)=>a||l.needsDepthTexture;e.reduce(s,!1)||(n.getDepthTexture()===this.depthTexture&&n.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&t===e.length&&(n.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const n=this.passes;this.deleteDepthTexture(),n.length>0&&(this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!1),this.passes=[])}render(n){const e=this.renderer,t=this.copyPass;let r=this.inputBuffer,i=this.outputBuffer,s=!1,o,a,l;n===void 0&&(this.timer.update(),n=this.timer.getDelta());for(const u of this.passes)u.enabled&&(u.render(e,r,i,n,s),u.needsSwap&&(s&&(t.renderToScreen=u.renderToScreen,o=e.getContext(),a=e.state.buffers.stencil,a.setFunc(o.NOTEQUAL,1,4294967295),t.render(e,r,i,n,s),a.setFunc(o.EQUAL,1,4294967295)),l=r,r=i,i=l),u instanceof $pe?s=!0:u instanceof Gpe&&(s=!1))}setSize(n,e,t){const r=this.renderer,i=r.getSize(new Me);(n===void 0||e===void 0)&&(n=i.width,e=i.height),(i.width!==n||i.height!==e)&&r.setSize(n,e,t);const s=r.getDrawingBufferSize(new Me);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const o of this.passes)o.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const n of this.passes)n.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Wa.fullscreenGeometry.dispose()}},Mc={NONE:0,DEPTH:1,CONVOLUTION:2},An={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ype=class{constructor(){this.shaderParts=new Map([[An.FRAGMENT_HEAD,null],[An.FRAGMENT_MAIN_UV,null],[An.FRAGMENT_MAIN_IMAGE,null],[An.VERTEX_HEAD,null],[An.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Mc.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=fa}},D3=!1,_5=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case xs:t=this.materialsFlatShadedDoubleSide;break;case ri:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case xs:t=this.materialsDoubleSide;break;case ri:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof $r))return n.clone();const e=n.uniforms,t=new Map;for(const i in e){const s=e[i].value;s.isRenderTargetTexture&&(e[i].value=null,t.set(i,s))}const r=n.clone();for(const i of t)e[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=Tl;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=ri,r}),this.materialsDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=xs,r}),this.materialsFlatShaded=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=ri,r}),this.materialsFlatShadedDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=xs,r})}}render(n,e,t){const r=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,D3){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=i}n.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return D3}static set workaroundEnabled(n){D3=n}},Xu=-1,pl=class extends da{constructor(n,e=Xu,t=Xu,r=1){super(),this.resizable=n,this.baseSize=new Me(1,1),this.preferredSize=new Me(e,t),this.target=this.preferredSize,this.s=r,this.effectiveSize=new Me,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,r=this.scale;e.width!==Xu?t.width=e.width:e.height!==Xu?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*r),e.height!==Xu?t.height=e.height:e.width!==Xu?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*r)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar(Xu),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Xu}},pn={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Kpe="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Zpe="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,src.a*opacity);}",Jpe="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=(dst.rgb+src.rgb)*0.5;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Qpe="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.xy,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",eme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/max(b,1e-9))),vec3(1.0),step(1.0,a));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",tme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",nme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",rme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=abs(dst.rgb-src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ime="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb/max(src.rgb,1e-9);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",sme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-2.0*dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ome="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb,1.0);vec3 b=min(src.rgb,1.0);vec3 c=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ame="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=step(1.0,dst.rgb+src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",lme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.x,a.yz));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ume="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",cme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=src.rgb*max(1.0-dst.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",fme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",hme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",dme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb+src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",pme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(2.0*src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",mme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.xy,b.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",gme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",vme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-abs(1.0-dst.rgb-src.rgb),0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",yme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,opacity);}",xme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=2.0*src.rgb*dst.rgb;vec3 b=1.0-2.0*(1.0-src.rgb)*(1.0-dst.rgb);vec3 c=mix(a,b,step(0.5,dst.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",_me="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 c=mix(mix(src2,dst.rgb,step(0.5*dst.rgb,src.rgb)),max(src2-1.0,vec3(0.0)),step(dst.rgb,src2-1.0));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",wme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb*dst.rgb/max(1.0-src.rgb,1e-9),1.0);vec3 c=mix(a,src.rgb,step(1.0,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",bme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.x,b.y,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Sme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-min(dst.rgb*src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Eme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 d=dst.rgb+(src2-1.0);vec3 w=step(0.5,src.rgb);vec3 a=dst.rgb-(1.0-src2)*dst.rgb*(1.0-dst.rgb);vec3 b=mix(d*(sqrt(dst.rgb)-dst.rgb),d*dst.rgb*((16.0*dst.rgb-12.0)*dst.rgb+3.0),w*(1.0-step(0.25,dst.rgb)));vec3 c=mix(a,b,w);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Mme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return src;}",Tme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Cme="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=mix(max(1.0-min((1.0-dst.rgb)/(2.0*src.rgb),1.0),0.0),min(dst.rgb/(2.0*(1.0-src.rgb)),1.0),step(0.5,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ame=new Map([[pn.ADD,Kpe],[pn.ALPHA,Zpe],[pn.AVERAGE,Jpe],[pn.COLOR,Qpe],[pn.COLOR_BURN,eme],[pn.COLOR_DODGE,tme],[pn.DARKEN,nme],[pn.DIFFERENCE,rme],[pn.DIVIDE,ime],[pn.DST,null],[pn.EXCLUSION,sme],[pn.HARD_LIGHT,ome],[pn.HARD_MIX,ame],[pn.HUE,lme],[pn.INVERT,ume],[pn.INVERT_RGB,cme],[pn.LIGHTEN,fme],[pn.LINEAR_BURN,hme],[pn.LINEAR_DODGE,dme],[pn.LINEAR_LIGHT,pme],[pn.LUMINOSITY,mme],[pn.MULTIPLY,gme],[pn.NEGATION,vme],[pn.NORMAL,yme],[pn.OVERLAY,xme],[pn.PIN_LIGHT,_me],[pn.REFLECT,wme],[pn.SATURATION,bme],[pn.SCREEN,Sme],[pn.SOFT_LIGHT,Eme],[pn.SRC,Mme],[pn.SUBTRACT,Tme],[pn.VIVID_LIGHT,Cme]]),Rme=class extends da{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new yn(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return Ame.get(this.blendFunction)}},hH=class extends da{constructor(n,e,{attributes:t=Mc.NONE,blendFunction:r=pn.NORMAL,defines:i=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=n,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=a,this.defines=i,this.uniforms=s,this.extensions=o,this.blendMode=new Rme(r),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=fa,this._outputColorSpace=_s}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(n){this._inputColorSpace=n,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n,this.setChanged()}set mainScene(n){}set mainCamera(n){}getName(){return this.name}setRenderer(n){this.renderer=n}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(n){this.attributes=n,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(n){this.fragmentShader=n,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(n){this.vertexShader=n,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(n,e=gm){}update(n,e,t){}setSize(n,e){}initialize(n,e,t){}dispose(){for(const n of Object.keys(this)){const e=this[n];(e instanceof Br||e instanceof Mi||e instanceof vr||e instanceof Wa)&&this[n].dispose()}}},o4={MEDIUM:2,LARGE:3},Pme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Ime="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Dme=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Nme=class extends $r{constructor(n=new Sn){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new yn(null),texelSize:new yn(new Sn),scale:new yn(1),kernel:new yn(0)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Pme,vertexShader:Ime}),this.setTexelSize(n.x,n.y),this.kernelSize=o4.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return Dme[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,r=1/e;this.uniforms.texelSize.value.set(t,r,t*.5,r*.5)}},kme=class extends Wa{constructor({kernelSize:n=o4.MEDIUM,resolutionScale:e=.5,width:t=pl.AUTO_SIZE,height:r=pl.AUTO_SIZE,resolutionX:i=t,resolutionY:s=r}={}){super("KawaseBlurPass"),this.renderTargetA=new Br(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new pl(this,i,s,e);o.addEventListener("change",a=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new Nme,this._blurMaterial.kernelSize=n,this.copyMaterial=new cH}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,r,i){const s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,u=this.blurMaterial,c=u.kernelSequence;let f=e;this.fullscreenMaterial=u;for(let h=0,d=c.length;h<d;++h){const p=h&1?l:a;u.kernel=c[h],u.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,o),f=p}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=f.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(s,o)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==Oi?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):n!==null&&n.outputColorSpace===mn&&(this.renderTargetA.texture.colorSpace=mn,this.renderTargetB.texture.colorSpace=mn))}static get AUTO_SIZE(){return pl.AUTO_SIZE}},Lme=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Fme=class extends $r{constructor(n=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:pm.replace(/\D+/g,"")},uniforms:{inputBuffer:new yn(null),threshold:new yn(0),smoothing:new yn(1),range:new yn(null)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Lme,vertexShader:uH}),this.colorOutput=n,this.luminanceRange=e}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get threshold(){return this.uniforms.threshold.value}set threshold(n){this.smoothing>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=n}getThreshold(){return this.threshold}setThreshold(n){this.threshold=n}get smoothing(){return this.uniforms.smoothing.value}set smoothing(n){this.threshold>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=n}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(n){this.smoothing=n}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(n){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(n){n?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(n){return this.colorOutput}setColorOutputEnabled(n){this.colorOutput=n}get useRange(){return this.luminanceRange!==null}set useRange(n){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(n){n!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=n,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(n){this.luminanceRange=n}},Ome=class extends Wa{constructor({renderTarget:n,luminanceRange:e,colorOutput:t,resolutionScale:r=1,width:i=pl.AUTO_SIZE,height:s=pl.AUTO_SIZE,resolutionX:o=i,resolutionY:a=s}={}){super("LuminancePass"),this.fullscreenMaterial=new Fme(t,e),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Br(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new pl(this,o,a,r);l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(n,e,t,r,i){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}initialize(n,e,t){t!==void 0&&t!==Oi&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Bme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Ume="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",zme=class extends $r{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new yn(null),texelSize:new yn(new Me)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Bme,vertexShader:Ume})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Vme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Wme="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Hme=class extends $r{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new yn(null),supportBuffer:new yn(null),texelSize:new yn(new Me),radius:new yn(.85)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Vme,vertexShader:Wme})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}set supportBuffer(n){this.uniforms.supportBuffer.value=n}get radius(){return this.uniforms.radius.value}set radius(n){this.uniforms.radius.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Gme=class extends Wa{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Br(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new zme,this.upsamplingMaterial=new Hme,this.resolution=new Me}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(n){if(this.levels!==n){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<n;++t){const r=e.clone();r.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(r)}this.upsamplingMipmaps.push(e);for(let t=1,r=n-1;t<r;++t){const i=e.clone();i.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(n){this.upsamplingMaterial.radius=n}render(n,e,t,r,i){const{scene:s,camera:o}=this,{downsamplingMaterial:a,upsamplingMaterial:l}=this,{downsamplingMipmaps:u,upsamplingMipmaps:c}=this;let f=e;this.fullscreenMaterial=a;for(let h=0,d=u.length;h<d;++h){const p=u[h];a.setSize(f.width,f.height),a.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,o),f=p}this.fullscreenMaterial=l;for(let h=c.length-1;h>=0;--h){const d=c[h];l.setSize(f.width,f.height),l.inputBuffer=f.texture,l.supportBuffer=u[h].texture,n.setRenderTarget(d),n.render(s,o),f=d}}setSize(n,e){const t=this.resolution;t.set(n,e);let r=t.width,i=t.height;for(let s=0,o=this.downsamplingMipmaps.length;s<o;++s)r=Math.round(r*.5),i=Math.round(i*.5),this.downsamplingMipmaps[s].setSize(r,i),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(r,i)}initialize(n,e,t){if(t!==void 0){const r=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of r)i.texture.type=t;if(t!==Oi)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(n!==null&&n.outputColorSpace===mn)for(const i of r)i.texture.colorSpace=mn}}dispose(){super.dispose();for(const n of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))n.dispose()}},jme=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}`,Xme=class extends hH{constructor({blendFunction:n=pn.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:r=!0,intensity:i=1,radius:s=.85,levels:o=8,kernelSize:a=o4.LARGE,resolutionScale:l=.5,width:u=pl.AUTO_SIZE,height:c=pl.AUTO_SIZE,resolutionX:f=u,resolutionY:h=c}={}){super("BloomEffect",jme,{blendFunction:n,uniforms:new Map([["map",new yn(null)],["intensity",new yn(i)]])}),this.renderTarget=new Br(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new kme({kernelSize:a}),this.luminancePass=new Ome({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new Gme,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const d=this.resolution=new pl(this,f,h,l);d.addEventListener("change",p=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(n){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(n){this.uniforms.get("intensity").value=n}getIntensity(){return this.intensity}setIntensity(n){this.intensity=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}update(n,e,t){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(n,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,i.renderTarget):this.blurPass.render(n,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,e):this.blurPass.render(n,e,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(n,e),this.mipmapBlurPass.setSize(n,e)}initialize(n,e,t){this.blurPass.initialize(n,e,t),this.luminancePass.initialize(n,e,t),this.mipmapBlurPass.initialize(n,e,t),t!==void 0&&(this.renderTarget.texture.type=t,n!==null&&n.outputColorSpace===mn&&(this.renderTarget.texture.colorSpace=mn))}},$me=`#ifdef RADIAL_MODULATION
uniform float modulationOffset;
#endif
varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=inputColor.ra;vec2 ba=inputColor.ba;
#ifdef RADIAL_MODULATION
const vec2 center=vec2(0.5);float d=distance(uv,center)*2.0;d=max(d-modulationOffset,0.0);if(vActive>0.0&&d>0.0){ra=texture2D(inputBuffer,mix(uv,vUvR,d)).ra;ba=texture2D(inputBuffer,mix(uv,vUvB,d)).ba;}
#else
if(vActive>0.0){ra=texture2D(inputBuffer,vUvR).ra;ba=texture2D(inputBuffer,vUvB).ba;}
#endif
outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}`,qme="uniform vec2 offset;varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vActive=(shift.x!=0.0||shift.y!=0.0)?1.0:0.0;vUvR=uv+shift;vUvB=uv-shift;}",Yme=class extends hH{constructor({offset:n=new Me(.001,5e-4),radialModulation:e=!1,modulationOffset:t=.15}={}){super("ChromaticAberrationEffect",$me,{vertexShader:qme,attributes:Mc.CONVOLUTION,uniforms:new Map([["offset",new yn(n)],["modulationOffset",new yn(t)]])}),this.radialModulation=e}get offset(){return this.uniforms.get("offset").value}set offset(n){this.uniforms.get("offset").value=n}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(n){n?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(n){this.uniforms.get("modulationOffset").value=n}getOffset(){return this.offset}setOffset(n){this.offset=n}},Kme=class extends Wa{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new fH,this.overrideMaterialManager=t===null?null:new _5(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new _5(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,r,i){const s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,u=s.background,c=n.shadowMap.autoUpdate,f=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,s,o):n.render(s,o),o.layers.mask=l,s.background=u,n.shadowMap.autoUpdate=c}},Zme=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Jme="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Qme=class extends $r{constructor(n,e,t,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:pm.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new yn(null),depthBuffer:new yn(null),resolution:new yn(new Me),texelSize:new yn(new Me),cameraNear:new yn(.3),cameraFar:new yn(1e3),aspect:new yn(1),time:new yn(0)},blending:Ms,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(r)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=gm){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=Zme.replace(An.FRAGMENT_HEAD,n.get(An.FRAGMENT_HEAD)||"").replace(An.FRAGMENT_MAIN_UV,n.get(An.FRAGMENT_MAIN_UV)||"").replace(An.FRAGMENT_MAIN_IMAGE,n.get(An.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Jme.replace(An.VERTEX_HEAD,n.get(An.VERTEX_HEAD)||"").replace(An.VERTEX_MAIN_SUPPORT,n.get(An.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof ti?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return An}};function w5(n,e,t){for(const r of e){const i="$1"+n+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(s,i))}}function e0e(n,e,t){let r=e.getFragmentShader(),i=e.getVertexShader();const s=r!==void 0&&/mainImage/.test(r),o=r!==void 0&&/mainUv/.test(r);if(t.attributes|=e.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&t.attributes&Mc.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let u=l.get(An.FRAGMENT_HEAD)||"",c=l.get(An.FRAGMENT_MAIN_UV)||"",f=l.get(An.FRAGMENT_MAIN_IMAGE)||"",h=l.get(An.VERTEX_HEAD)||"",d=l.get(An.VERTEX_MAIN_SUPPORT)||"";const p=new Set,y=new Set;if(o&&(c+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const _=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);d+=`	${n}MainSupport(`,d+=_?`vUv);
`:`);
`;for(const w of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const b of w[1].split(/\s*,\s*/))t.varyings.add(b),p.add(b),y.add(b);for(const w of i.matchAll(a))y.add(w[1])}for(const _ of r.matchAll(a))y.add(_[1]);for(const _ of e.defines.keys())y.add(_.replace(/\([\w\s,]*\)/g,""));for(const _ of e.uniforms.keys())y.add(_);y.delete("while"),y.delete("for"),y.delete("if"),e.uniforms.forEach((_,w)=>t.uniforms.set(n+w.charAt(0).toUpperCase()+w.slice(1),_)),e.defines.forEach((_,w)=>t.defines.set(n+w.charAt(0).toUpperCase()+w.slice(1),_));const x=new Map([["fragment",r],["vertex",i]]);w5(n,y,t.defines),w5(n,y,x),r=x.get("fragment"),i=x.get("vertex");const m=e.blendMode;if(t.blendModes.set(m.blendFunction,m),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===mn?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==_s?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const _=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${n}MainImage(color0, UV, `,t.attributes&Mc.DEPTH&&_.test(r)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const w=n+"BlendOpacity";t.uniforms.set(w,m.opacity),f+=`color0 = blend${m.blendFunction}(color0, color1, ${w});

	`,u+=`uniform float ${w};

`}if(u+=r+`
`,i!==null&&(h+=i+`
`),l.set(An.FRAGMENT_HEAD,u),l.set(An.FRAGMENT_MAIN_UV,c),l.set(An.FRAGMENT_MAIN_IMAGE,f),l.set(An.VERTEX_HEAD,h),l.set(An.VERTEX_MAIN_SUPPORT,d),e.extensions!==null)for(const _ of e.extensions)t.extensions.add(_)}}var t0e=class extends Wa{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new Qme(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new Ype;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===pn.DST)n.attributes|=o.getAttributes()&Mc.DEPTH;else{if(n.attributes&o.getAttributes()&Mc.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);e0e("e"+e++,o,n)}let t=n.shaderParts.get(An.FRAGMENT_HEAD),r=n.shaderParts.get(An.FRAGMENT_MAIN_IMAGE),i=n.shaderParts.get(An.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const o of n.blendModes.values())t+=o.getShaderCode().replace(s,`blend${o.blendFunction}`)+`
`;n.attributes&Mc.DEPTH?(n.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===mn&&(r+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(An.FRAGMENT_HEAD,t),n.shaderParts.set(An.FRAGMENT_MAIN_IMAGE,r),n.shaderParts.set(An.FRAGMENT_MAIN_UV,i);for(const[o,a]of n.shaderParts)a!==null&&n.shaderParts.set(o,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=gm){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,r,i){for(const s of this.effects)s.update(n,e,r);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const r of this.effects)r.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==Oi&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dH=function(n,e){return(dH=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function Ha(n,e){function t(){this.constructor=n}dH(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function vt(n,e,t,r){return new(t||(t=Promise))(function(i,s){function o(u){try{l(r.next(u))}catch(c){s(c)}}function a(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){u.done?i(u.value):new t(function(c){c(u.value)}).then(o,a)}l((r=r.apply(n,[])).next())})}function yt(n,e){var t,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(n,o)}catch(f){c=[6,f],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}var n0e=function(){function n(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},n.prototype.registerFlag=function(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){var i=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+i+"."),this.set(e,i)}},n.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},n.prototype.getNumber=function(e){return this.get(e)},n.prototype.getBool=function(e){return this.get(e)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},n.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},n.prototype.setFlags=function(e){this.flags=Object.assign({},e)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,r,i=(t=this.global.location.search,r={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(s){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return r0e(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(s){var o=s.split(":"),a=o[0],l=o[1];e.urlFlags[a]=function(u,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+u+".")}(a,l)})}},n}();function r0e(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Fe(){return pH}var pH=null,k_=new Map,GC=new Map;function mH(n,e){var t=vH(n,e);return k_.get(t)}function i0e(n){return GC.get(n)}function b5(n){for(var e=k_.entries(),t=[];;){var r=e.next(),i=r.done,s=r.value;if(i)break;var o=s[0],a=s[1];o.split("_")[0]===n&&t.push(a)}return t}function gH(n){var e=n.kernelName,t=n.backendName,r=vH(e,t);if(k_.has(r))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");k_.set(r,n)}function s0e(n){var e=n.kernelName;GC.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),GC.set(e,n)}function vH(n,e){return e+"_"+n}function jC(n,e,t){return Math.max(n,Math.min(e,t))}function yH(n){return n%2==0?n:n+1}function o0e(n){for(var e=0,t=0;t<n.length;t++)e+=n[t];return e}function Z(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function kn(n,e,t){t===void 0&&(t=""),Z(bi(n,e),function(){return t+" Shapes "+n+" and "+e+" must match"})}function Mm(n){Z(n!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function sm(n,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(n)||Sl(n)&&!t)for(var r=0;r<n.length;++r)sm(n[r],e,t);else e.push(n);return e}function bt(n){if(n.length===0)return 1;for(var e=n[0],t=1;t<n.length;t++)e*=n[t];return e}function bi(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Or(n){return n%1==0}function a0e(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var e=Math.exp(2*n);return(e-1)/(e+1)}function XC(n){var e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function Ip(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function S5(n,e,t){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,i){var s=0,o=function(){if(n())r();else{s++;var a=e(s);t!=null&&s>=t?i():setTimeout(o,a)}};o()})}function l0e(n,e){for(var t=1,r=-1,i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(n[i]<0)throw Error("Shapes can not be < 0. Found "+n[i]+" at dim "+i);if(r===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+n);return n}if(t===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var s=n.slice();return s[r]=e/t,s}function ci(n,e){var t=e.length;return Z((n=n==null?e.map(function(r,i){return i}):[].concat(n)).every(function(r){return r>=-t&&r<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n}),Z(n.every(function(r){return Or(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?t+r:r})}function Bf(n,e){for(var t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,s=e==null||i?null:ci(e,n).sort(),o=0,a=0;a<n.length;++a){if(s!=null){if(s[o]===a&&n[a]!==1)throw new Error("Can't squeeze axis "+a+" since its dim '"+n[a]+"' is not 1");(s[o]==null||s[o]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),s[o]<=a&&o++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function Ev(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else{if(n!=="bool")throw new Error("Unknown data type "+n);t=new Uint8Array(e)}return t}function L_(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else{if(n!=="string")throw new Error("Unknown data type "+n);t=new Array(e)}return t}function u0e(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function c0e(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function f0e(n,e){return e!=="complex64"&&(e!=="float32"||n==="complex64")&&(e!=="int32"||n==="float32"||n==="complex64")&&(e!=="bool"||n!=="bool")}function Sl(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function xH(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function h0e(n){if(n==null)return 0;var e=0;return n.forEach(function(t){return e+=t.length}),e}function a4(n){return typeof n=="string"||n instanceof String}function d0e(n){return typeof n=="boolean"}function p0e(n){return typeof n=="number"}function ry(n){return Array.isArray(n)?ry(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":p0e(n)?"float32":a4(n)?"string":d0e(n)?"bool":"float32"}function $C(n){return!!(n&&n.constructor&&n.call&&n.apply)}function qC(n,e){for(var t=e;t<n;++t)if(n%t==0)return t;return n}function El(n){var e=n.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=n[e-1];for(var r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function _H(n,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=sm(n)),t&&u0e(n,e),function(s,o){return s instanceof Float32Array&&o==="float32"||s instanceof Int32Array&&o==="int32"||s instanceof Uint8Array&&o==="bool"}(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){for(var r=new Uint8Array(n.length),i=0;i<r.length;++i)Math.round(n[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function E5(n,e){if(n.length===0)return e[0];var t=n.reduce(function(r,i){return r*i});if(t===0)return[];if(t!==e.length)throw new Error("["+n+"] does not match the input size.");return function r(i,s,o){var a=new Array;if(s.length===1)for(var l=s[0],u=0;u<l;u++)a[u]=o[i+u];else{l=s[0];var c=s.slice(1),f=c.reduce(function(h,d){return h*d});for(u=0;u<l;u++)a[u]=r(i+u*f,c,o)}return a}(0,n,e)}function wH(n,e){for(var t=iy(n,e),r=0;r<t.length;r++)t[r]=1;return t}function iy(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+e)}function ol(){return Fe().platform.now()}function bH(n){n.forEach(function(e){Z(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function m0e(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Fe().platform.encode(n,e)}function F_(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Fe().platform.decode(n,e)}function M5(n,e,t){if(e===0)return 0;if(e===1)return n[0];for(var r=n[n.length-1],i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function g0e(n,e,t){if(e===0)return[];if(e===1)return[n];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}var v0e=function(){function n(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new y0e)}return n.prototype.profileKernel=function(e,t,r){var i,s=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(a){a.data().then(function(l){(function(u,c,f){if(c!=="float32")return!1;for(var h=0;h<u.length;h++){var d=u[h];if(isNaN(d)||!isFinite(d))return console.warn("Found "+d+" in the result of '"+f+"'"),!0}})(l,a.dtype,e),o.then(function(u){var c="";u.getExtraProfileInfo!=null&&(c=u.getExtraProfileInfo()),s.logger.logKernelProfile(e,a,l,u.kernelMs,t,c)})})}),i},n}(),y0e=function(){function n(){}return n.prototype.logKernelProfile=function(e,t,r,i,s,o){var a=typeof i=="number"?Ip(i+"ms",9):i.error,l=Ip(e,25),u=t.rank,c=t.size,f=Ip(t.shape.toString(),14),h="";for(var d in s){var p=s[d].shape||t.shape,y=p.length;h+=d+": "+y+"D "+(y>0?p:"")+" "}console.log("%c"+l+"	%c"+a+"	%c"+u+"D "+f+"	%c"+c+"	%c"+h+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}(),T5=20,w0=3,N3=7;function x0e(n,e,t,r){var i=El(e),s=function(u,c,f,h){var d=bt(c),p=h[h.length-1],y=new Array(p).fill(0),x=c.length,m=f==="complex64"?S0(u):u;if(x>1)for(var _=0;_<d/p;_++)for(var w=_*p,b=0;b<p;b++)y[b]=Math.max(y[b],b0(m[w+b],0,f).length);return y}(n,e,t,i),o=e.length,a=function u(c,f,h,d,p,y){y===void 0&&(y=!0);var x=h==="complex64"?2:1,m=f[0],_=f.length;if(_===0)return h==="complex64"?[b0(S0(c)[0],0,h)]:h==="bool"?[SH(c[0])]:[c[0].toString()];if(_===1){if(m>T5){var w=w0*x,b=Array.from(c.slice(0,w)),S=Array.from(c.slice((m-w0)*x,m*x));return h==="complex64"&&(b=S0(b),S=S0(S)),["["+b.map(function(V,W){return b0(V,p[W],h)}).join(", ")+", ..., "+S.map(function(V,W){return b0(V,p[m-w0+W],h)}).join(", ")+"]"]}return["["+(h==="complex64"?S0(c):Array.from(c)).map(function(V,W){return b0(V,p[W],h)}).join(", ")+"]"]}var M=f.slice(1),T=d.slice(1),P=d[0]*x,C=[];if(m>T5){for(var A=0;A<w0;A++){var k=(L=A*P)+P;C.push.apply(C,u(c.slice(L,k),M,h,T,p,!1))}for(C.push("..."),A=m-w0;A<m;A++)k=(L=A*P)+P,C.push.apply(C,u(c.slice(L,k),M,h,T,p,A===m-1))}else for(A=0;A<m;A++){var L;k=(L=A*P)+P,C.push.apply(C,u(c.slice(L,k),M,h,T,p,A===m-1))}var H=_===2?",":"";for(C[0]="["+C[0]+H,A=1;A<C.length-1;A++)C[A]=" "+C[A]+H;var F=`,
`;for(A=2;A<_;A++)F+=`
`;return C[C.length-1]=" "+C[C.length-1]+"]"+(y?"":F),C}(n,e,t,i,s),l=["Tensor"];return r&&(l.push("  dtype: "+t),l.push("  rank: "+o),l.push("  shape: ["+e+"]"),l.push("  values:")),l.push(a.map(function(u){return"    "+u}).join(`
`)),l.join(`
`)}function b0(n,e,t){return Ip(Array.isArray(n)?parseFloat(n[0].toFixed(N3))+" + "+parseFloat(n[1].toFixed(N3))+"j":a4(n)?"'"+n+"'":t==="bool"?SH(n):parseFloat(n.toFixed(N3)).toString(),e)}function SH(n){return n===0?"false":"true"}function S0(n){for(var e=[],t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}var Mv=function(){function n(e,t,r){var i=this;if(this.dtype=t,this.shape=e.slice(),this.size=bt(e),r!=null){var s=r.length;Z(s===this.size,function(){return"Length of values '"+s+"' does not match the size inferred by the shape '"+i.size+"'."})}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||L_(t,this.size),this.strides=El(e)}return n.prototype.set=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),Z(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"});var s=this.locToIndex(r);this.values[s]=e},n.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var r=0,i=0,s=e;i<s.length;i++){var o=s[i];if(o<0||o>=this.shape[r]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}r++}for(var l=e[e.length-1],u=0;u<e.length-1;++u)l+=this.strides[u]*e[u];return this.values[l]},n.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t},n.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return ul().makeTensor(this.values,this.shape,this.dtype)},n}(),ul=null,Ce=null,EH=null,cr=function(){function n(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=bt(e),this.strides=El(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),Z(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},n.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),this.reshape([e,t,r])},n.prototype.as4D=function(e,t,r,i){return this.throwIfDisposed(),this.reshape([e,t,r,i])},n.prototype.as5D=function(e,t,r,i,s){return this.throwIfDisposed(),this.reshape([e,t,r,i,s])},n.prototype.asType=function(e){return this.throwIfDisposed(),Ce.cast(this,e)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return vt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Ce.buffer(this.shape,this.dtype,e)]}})})},n.prototype.bufferSync=function(){return Ce.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return vt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,E5(this.shape,e)]}})})},n.prototype.arraySync=function(){return E5(this.shape,this.dataSync())},n.prototype.data=function(){return vt(this,void 0,void 0,function(){var e,t;return yt(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=ul().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=r.sent();try{return[2,t.map(function(i){return F_(i)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var e=ul().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(t){return F_(t)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},n.prototype.bytes=function(){return vt(this,void 0,void 0,function(){var e;return yt(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,ul().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(ul().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(e){return e===void 0&&(e=!1),Ce.print(this,e)},n.prototype.reshape=function(e){return this.throwIfDisposed(),Ce.reshape(this,e)},n.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},n.prototype.expandDims=function(e){return e===void 0&&(e=0),Ce.expandDims(this,e)},n.prototype.cumsum=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1),Ce.cumsum(this,e,t,r)},n.prototype.squeeze=function(e){return this.throwIfDisposed(),Ce.squeeze(this,e)},n.prototype.clone=function(){return this.throwIfDisposed(),Ce.clone(this)},n.prototype.oneHot=function(e,t,r){return this.throwIfDisposed(),Ce.oneHot(this,e,t,r)},n.prototype.toString=function(e){return e===void 0&&(e=!1),x0e(this.dataSync(),this.shape,this.dtype,e)},n.prototype.tile=function(e){return this.throwIfDisposed(),Ce.tile(this,e)},n.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),Ce.gather(this,e,t)},n.prototype.matMul=function(e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!1),this.throwIfDisposed(),Ce.matMul(this,e,t,r)},n.prototype.dot=function(e){return this.throwIfDisposed(),Ce.dot(this,e)},n.prototype.norm=function(e,t,r){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),Ce.norm(this,e,t,r)},n.prototype.slice=function(e,t){return this.throwIfDisposed(),Ce.slice(this,e,t)},n.prototype.reverse=function(e){return this.throwIfDisposed(),Ce.reverse(this,e)},n.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof n&&(e=[e]),Ce.concat([this].concat(e),t)},n.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),Ce.split(this,e,t)},n.prototype.stack=function(e,t){return t===void 0&&(t=0),Ce.stack([this,e],t)},n.prototype.unstack=function(e){return e===void 0&&(e=0),Ce.unstack(this,e)},n.prototype.pad=function(e,t){return t===void 0&&(t=0),Ce.pad(this,e,t)},n.prototype.batchNormalization=function(e,t,r,i,s){return r===void 0&&(r=.001),EH("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,s,i,r)},n.prototype.batchNorm=function(e,t,r,i,s){return s===void 0&&(s=.001),this.throwIfDisposed(),Ce.batchNorm(this,e,t,r,i,s)},n.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.all(this,e,t)},n.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.any(this,e,t)},n.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.logSumExp(this,e,t)},n.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.sum(this,e,t)},n.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.prod(this,e,t)},n.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.mean(this,e,t)},n.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.min(this,e,t)},n.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),Ce.max(this,e,t)},n.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),Ce.argMin(this,e)},n.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),Ce.argMax(this,e)},n.prototype.cast=function(e){return this.throwIfDisposed(),Ce.cast(this,e)},n.prototype.add=function(e){return this.throwIfDisposed(),Ce.add(this,e)},n.prototype.addStrict=function(e){return this.throwIfDisposed(),Ce.addStrict(this,e)},n.prototype.atan2=function(e){return this.throwIfDisposed(),Ce.atan2(this,e)},n.prototype.sub=function(e){return this.throwIfDisposed(),Ce.sub(this,e)},n.prototype.subStrict=function(e){return this.throwIfDisposed(),Ce.subStrict(this,e)},n.prototype.pow=function(e){return this.throwIfDisposed(),Ce.pow(this,e)},n.prototype.powStrict=function(e){return this.throwIfDisposed(),Ce.powStrict(this,e)},n.prototype.mul=function(e){return this.throwIfDisposed(),Ce.mul(this,e)},n.prototype.mulStrict=function(e){return this.throwIfDisposed(),Ce.mulStrict(this,e)},n.prototype.div=function(e){return this.throwIfDisposed(),Ce.div(this,e)},n.prototype.divNoNan=function(e){return this.throwIfDisposed(),Ce.divNoNan(this,e)},n.prototype.floorDiv=function(e){return this.throwIfDisposed(),Ce.floorDiv(this,e)},n.prototype.divStrict=function(e){return this.throwIfDisposed(),Ce.divStrict(this,e)},n.prototype.minimum=function(e){return this.throwIfDisposed(),Ce.minimum(this,e)},n.prototype.minimumStrict=function(e){return this.throwIfDisposed(),Ce.minimumStrict(this,e)},n.prototype.maximum=function(e){return this.throwIfDisposed(),Ce.maximum(this,e)},n.prototype.maximumStrict=function(e){return this.throwIfDisposed(),Ce.maximumStrict(this,e)},n.prototype.mod=function(e){return this.throwIfDisposed(),Ce.mod(this,e)},n.prototype.modStrict=function(e){return this.throwIfDisposed(),Ce.modStrict(this,e)},n.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Ce.squaredDifferenceStrict(this,e)},n.prototype.transpose=function(e){return this.throwIfDisposed(),Ce.transpose(this,e)},n.prototype.notEqual=function(e){return this.throwIfDisposed(),Ce.notEqual(this,e)},n.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Ce.notEqualStrict(this,e)},n.prototype.less=function(e){return this.throwIfDisposed(),Ce.less(this,e)},n.prototype.lessStrict=function(e){return this.throwIfDisposed(),Ce.lessStrict(this,e)},n.prototype.equal=function(e){return this.throwIfDisposed(),Ce.equal(this,e)},n.prototype.equalStrict=function(e){return this.throwIfDisposed(),Ce.equalStrict(this,e)},n.prototype.lessEqual=function(e){return this.throwIfDisposed(),Ce.lessEqual(this,e)},n.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),Ce.lessEqualStrict(this,e)},n.prototype.greater=function(e){return this.throwIfDisposed(),Ce.greater(this,e)},n.prototype.greaterStrict=function(e){return this.throwIfDisposed(),Ce.greaterStrict(this,e)},n.prototype.greaterEqual=function(e){return this.throwIfDisposed(),Ce.greaterEqual(this,e)},n.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),Ce.greaterEqualStrict(this,e)},n.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Ce.logicalAnd(this,e)},n.prototype.logicalOr=function(e){return this.throwIfDisposed(),Ce.logicalOr(this,e)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),Ce.logicalNot(this)},n.prototype.logicalXor=function(e){return this.throwIfDisposed(),Ce.logicalXor(this,e)},n.prototype.where=function(e,t){return this.throwIfDisposed(),Ce.where(e,this,t)},n.prototype.neg=function(){return this.throwIfDisposed(),Ce.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),Ce.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),Ce.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),Ce.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),Ce.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),Ce.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),Ce.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),Ce.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),Ce.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),Ce.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),Ce.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),Ce.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),Ce.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),Ce.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),Ce.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),Ce.abs(this)},n.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Ce.clipByValue(this,e,t)},n.prototype.relu=function(){return this.throwIfDisposed(),Ce.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),Ce.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),Ce.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),Ce.selu(this)},n.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),Ce.leakyRelu(this,e)},n.prototype.prelu=function(e){return this.throwIfDisposed(),Ce.prelu(this,e)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),Ce.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ce.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),Ce.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),Ce.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),Ce.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),Ce.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),Ce.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),Ce.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),Ce.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),Ce.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),Ce.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),Ce.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),Ce.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),Ce.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),Ce.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),Ce.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),Ce.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),Ce.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),Ce.round(this)},n.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),Ce.step(this,e)},n.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),Ce.softmax(this,e)},n.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),Ce.logSoftmax(this,e)},n.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),Ce.image.resizeBilinear(this,e,t)},n.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),Ce.image.resizeNearestNeighbor(this,e,t)},n.prototype.conv1d=function(e,t,r,i,s,o){return i===void 0&&(i="NWC"),s===void 0&&(s=1),this.throwIfDisposed(),Ce.conv1d(this,e,t,r,i,s,o)},n.prototype.conv2d=function(e,t,r,i,s,o){return i===void 0&&(i="NHWC"),s===void 0&&(s=[1,1]),this.throwIfDisposed(),Ce.conv2d(this,e,t,r,i,s,o)},n.prototype.conv2dTranspose=function(e,t,r,i,s){return this.throwIfDisposed(),Ce.conv2dTranspose(this,e,t,r,i,s)},n.prototype.depthwiseConv2D=function(e,t,r,i,s,o){return i===void 0&&(i="NHWC"),s===void 0&&(s=[1,1]),this.throwIfDisposed(),Ce.depthwiseConv2d(this,e,t,r,i,s,o)},n.prototype.separableConv2d=function(e,t,r,i,s,o){return s===void 0&&(s=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),Ce.separableConv2d(this,e,t,r,i,s,o)},n.prototype.avgPool=function(e,t,r,i){return this.throwIfDisposed(),Ce.avgPool(this,e,t,r,i)},n.prototype.maxPool=function(e,t,r,i){return this.throwIfDisposed(),Ce.maxPool(this,e,t,r,i)},n.prototype.localResponseNormalization=function(e,t,r,i){return e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5),Ce.localResponseNormalization(this,e,t,r,i)},n.prototype.pool=function(e,t,r,i,s){return this.throwIfDisposed(),Ce.pool(this,e,t,r,i,s)},n.prototype.variable=function(e,t,r){return e===void 0&&(e=!0),this.throwIfDisposed(),ul().makeVariable(this,e,t,r)},n.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Ce.unsortedSegmentSum(this,e,t)},n.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Ce.batchToSpaceND(this,e,t)},n.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Ce.spaceToBatchND(this,e,t)},n.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),Ce.topk(this,e,t)},n.prototype.stridedSlice=function(e,t,r,i,s,o,a,l){return i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),a===void 0&&(a=0),l===void 0&&(l=0),this.throwIfDisposed(),Ce.stridedSlice(this,e,t,r,i,s,o,a,l)},n.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Ce.depthToSpace(this,e,t)},n.prototype.fft=function(){return this.throwIfDisposed(),Ce.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),Ce.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),Ce.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),Ce.spectral.irfft(this)},n}();Object.defineProperty(cr,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var C5,YC,KC,ZC,JC,om=function(n){function e(t,r,i,s){var o=n.call(this,t.shape,t.dtype,t.dataId,s)||this;return o.trainable=r,o.name=i,o}return Ha(e,n),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!bi(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");ul().disposeTensor(this),this.dataId=t.dataId,ul().incRef(this,null)},e.prototype.dispose=function(){ul().disposeVariable(this),this.isDisposedInternal=!0},e}(cr);Object.defineProperty(om,Symbol.hasInstance,{value:function(n){return n instanceof cr&&n.assign!=null&&n.assign instanceof Function}}),function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"}(C5||(C5={})),function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(YC||(YC={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(KC||(KC={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(ZC||(ZC={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(JC||(JC={}));var _0e={float32:ZC,int32:YC,bool:KC,complex64:JC};function Ii(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error("Can not upcast "+n+" with "+e)}return _0e[n][e]}function k3(n){return Ii(n,"int32")}function xr(n,e){if(n.dtype===e.dtype)return[n,e];var t=Ii(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function w0e(n,e){Z(n.dtype===e.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+e.dtype+") input must match"})}function MH(n){var e=[];return function t(r,i,s){if(r!=null){if(r instanceof cr)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,a=r;for(var l in a){var u=a[l];s.has(u)||(s.add(u),t(u,i,s))}}}}(n,e,new Set),e}var L3,A5=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},n}(),b0e=function(){function n(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new A5}return n.prototype.ready=function(){return vt(this,void 0,void 0,function(){var e,t,r;return yt(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,i.label=1;case 1:return t<e.length?(r=e[t],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},n.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},n.prototype.registerBackend=function(e,t,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:r},!0)},n.prototype.setBackend=function(e){return vt(this,void 0,void 0,function(){var t,r,i;return yt(this,function(s){switch(s.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return i=s.sent(),[3,3];case 2:i=r,s.label=3;case 3:if(!i)return[2,!1];s.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new v0e(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var e=this;b5(this.backendName).forEach(function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)})},n.prototype.disposeRegisteredKernels=function(e){var t=this;b5(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(t.registry[e])})},n.prototype.initializeBackend=function(e){var t=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var s=++this.pendingBackendInitId,o=i.then(function(a){return!(s<t.pendingBackendInitId)&&(t.registry[e]=a,t.pendingBackendInit=null,!0)}).catch(function(a){return!(s<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[e]=i,{success:!0,asyncInit:!1}}catch(a){return console.warn("Initialization of backend "+e+" failed"),console.warn(a.stack||a.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,r){return e.registryFactory[r].priority-e.registryFactory[t].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var r=e[t],i=this.initializeBackend(r),s=i.success,o=i.asyncInit;if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(e,t){var r=this.state.tensorInfo.get(t),i=r.backend,s=this.readSync(t);i.disposeData(t),r.backend=e,e.move(t,s,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(e,t){var r,i=this,s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}return this.scopedRun(function(){return i.startScope(s)},function(){return i.endScope(r)},function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(e,t,r){e();try{var i=r();return t(),i}catch(s){throw t(),s}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],function(i){return{x:function(){return i.toFloat()}}},[]),t},n.prototype.runKernel=function(e,t,r,i,s){return this.runKernelFunc(null,t,null,e,r,i,s)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(e,t,r){var i=this.backend.numDataIds(),s=0;r.forEach(function(l){s+=l.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-s-o;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},n.prototype.runKernelFunc=function(e,t,r,i,s,o,a){var l,u=this;o===void 0&&(o=[]),a===void 0&&(a=[]);var c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var h,d=function(_){f&&(c=_.map(function(w){return u.keep(u.clone(w))}))},p=this.state.numBytes,y=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var x,m=mH(i,this.backendName);return h=m!=null?function(){var _=u.backend.numDataIds();x=m.kernelFunc({inputs:t,attrs:s,backend:u.backend});var w=Array.isArray(x)?x:[x];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(i,_,w);var b=w.map(function(M){var T=M.dataId,P=M.shape,C=M.dtype;return u.makeTensorFromDataId(T,P,C)}),S=b.filter(function(M,T){return a[T]});return d((o||[]).slice().concat(S)),b}:function(){var _=u.backend.numDataIds();x=u.tidy(function(){return e(u.backend,d)});var w=Array.isArray(x)?x:[x];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(i,_,w),w},this.scopedRun(function(){return u.state.kernelDepth++},function(){return u.state.kernelDepth--},function(){l=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(i,t,function(){return h()}):h()}),f&&this.addTapeNode(i,t,l,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-y,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(_){return t[_].shape}),outputShapes:l.map(function(_){return _.shape})}),Array.isArray(x)?l:l[0]},n.prototype.makeTensor=function(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var s=e;r==="string"&&a4(e[0])&&(s=e.map(function(c){return m0e(c)}));var o=i.write(s,t,r),a=new cr(t,r,o,this.nextTensorId());if(this.incRef(a,i),r==="string"){var l=this.state.tensorInfo.get(o),u=h0e(s);this.state.numBytes+=u-l.bytes,l.bytes=u}return a},n.prototype.makeTensorFromDataId=function(e,t,r,i){var s=new cr(t,r=r||"float32",e,this.nextTensorId());return this.incRef(s,i),s},n.prototype.makeVariable=function(e,t,r,i){t===void 0&&(t=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.asType(i));var s=new om(e,t,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error("Variable with name "+s.name+" was already registered");return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s},n.prototype.incRef=function(e,t){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(i=e.size*xH(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof om||this.track(e)},n.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},n.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},n.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},n.prototype.profile=function(e){return vt(this,void 0,void 0,function(){var t,r;return yt(this,function(i){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(s){return s.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(e,t,r,i,s){var o=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:s},l=i0e(e);l!=null&&(i=l.gradFunc),i!=null&&(a.gradient=function(u){return u=u.map(function(c,f){if(c==null){var h=r[f],d=iy(h.size,h.dtype);return o.makeTensor(d,h.shape,h.dtype)}return c}),i(u.length>1?u:u[0],s)}),this.state.activeTape.push(a)},n.prototype.keep=function(e){return e.kept=!0,e},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},n.prototype.endScope=function(e){for(var t=this,r=MH(e),i=new Set(r.map(function(l){return l.id})),s=0;s<this.state.activeScope.track.length;s++){var o=this.state.activeScope.track[s];o.kept||i.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(l){l.kept||l.scopeId!==a.id||t.track(l)})},n.prototype.gradients=function(e,t,r,i){var s=this;if(i===void 0&&(i=!1),Z(t.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return s.startTape()},function(){return s.endTape()},function(){return s.tidy("forward",e)});Z(o instanceof cr,function(){return"The result y returned by f() must be a tensor."});var a=function(l,u,c){for(var f={},h={},d=0;d<u.length;d++)f[u[d].id]=!0;for(d=0;d<l.length;d++){var p=(M=l[d]).inputs;for(var y in p){for(var x=p[y],m=!1,_=0;_<u.length;_++)if(f[x.id]){M.outputs.forEach(function(A){return f[A.id]=!0}),m=!0,h[M.id]=!0;break}if(m)break}}var w={};w[c.id]=!0;var b={};for(d=l.length-1;d>=0;d--)for(p=(M=l[d]).inputs,_=0;_<M.outputs.length;_++)if(w[M.outputs[_].id]){for(var y in p)w[p[y].id]=!0,b[M.id]=!0;break}var S=[];for(d=0;d<l.length;d++){var M;if(h[(M=l[d]).id]&&b[M.id]){var T={};for(var y in M.inputs){var P=M.inputs[y];f[P.id]&&(T[y]=P)}var C=Object.assign({},M);C.inputs=T,C.outputs=M.outputs,S.push(C)}}return S}(this.state.activeTape,t,o);if(!i&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var l,u,c={};c[o.id]=r??(l=o.shape,u=wH(bt(l),"float32"),le.makeTensor(u,l,"float32")),function(h,d,p){for(var y=function(m){var _=d[m],w=[];if(_.outputs.forEach(function(T){var P=h[T.id];P!=null?w.push(P):w.push(null)}),_.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+_.kernelName+".");var b=_.gradient(w),S=function(T){if(!(T in b))throw new Error("Cannot backprop through input "+T+". Available gradients found: "+Object.keys(b)+".");var P=p(function(){return b[T]()});if(P.dtype!=="float32")throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input "+T+" must have 'float32' dtype, but has '"+P.dtype+"'");var C=_.inputs[T];if(!bi(P.shape,C.shape))throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input '"+T+"' has shape '"+P.shape+"', which does not match the shape of the input '"+C.shape+"'");if(h[C.id]==null)h[C.id]=P;else{var A=h[C.id];h[C.id]=A.add(P),A.dispose()}};for(var M in _.inputs)S(M)},x=d.length-1;x>=0;x--)y(x)}(c,a,function(h){return s.tidy(h)});var f=t.map(function(h){return c[h.id]});return s.state.gradientDepth===0&&(s.state.activeTape.forEach(function(h){for(var d=0,p=h.saved;d<p.length;d++)p[d].dispose()}),s.state.activeTape=null),{value:o,grads:f}})},n.prototype.customGrad=function(e){var t=this;return Z($C(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];Z(i.every(function(a){return a instanceof cr}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(a,l){o[l]=a}),t.runKernelFunc(function(a,l){return Z((r=e.apply(void 0,i.concat([l]))).value instanceof cr,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),Z($C(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(a,l){var u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];Z(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),Z(c.every(function(h){return h instanceof cr}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(h,d){f[d]=function(){return h}}),f})}},n.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},n.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},n.prototype.time=function(e){return vt(this,void 0,void 0,function(){var t,r;return yt(this,function(i){switch(i.label){case 0:return t=ol(),[4,this.backend.time(e)];case 1:return(r=i.sent()).wallMs=ol()-t,[2,r]}})})},n.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new A5,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),le=function(){var n=function(){if(L3==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}L3=t}return L3}();if(n._tfengine==null){var e=new n0e(n);n._tfengine=new b0e(e)}return function(t){pH=t}(n._tfengine.ENV),ul=function(){return n._tfengine},n._tfengine}();function TH(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var jl=Fe();jl.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),jl.registerFlag("IS_BROWSER",function(){return TH()}),jl.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),jl.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),jl.registerFlag("PROD",function(){return!1}),jl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return jl.getBool("DEBUG")}),jl.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),jl.registerFlag("IS_TEST",function(){return!1});var Tv,So,vo,Lf={},F3={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function S0e(n,e){Lf[n]=e}function Rl(n){n in Lf||(Lf[n]=function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas<"u"&&i===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Lf[t]},!1),t===1?r.getContext("webgl",F3)||r.getContext("experimental-webgl",F3):r.getContext("webgl2",F3)}(n));var e=Lf[n];return e.isContextLost()?(delete Lf[n],Rl(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Lf[n])}function ab(n,e){return[e,n]}function xg(n){var e=bt(n);return XC(Math.ceil(e/4))}function sy(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function l4(n,e){var t,r,i,s,o,a,l,u,c,f=n;return Fe().getNumber("WEBGL_VERSION")===2?(t=f.R32F,r=f.R16F,i=f.RGBA16F,s=f.RGBA32F,o=f.RED,a=4,l=1,u=f.HALF_FLOAT,c=f.FLOAT):(t=n.RGBA,r=n.RGBA,i=n.RGBA,s=f.RGBA,o=n.RGBA,a=4,l=4,u=e!=null?e.HALF_FLOAT_OES:null,c=n.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:l,textureTypeHalfFloat:u,textureTypeFloat:c}}function Mt(n,e,t){var r=t();return e&&function(i){var s=i.getError();if(s!==i.NO_ERROR)throw new Error("WebGL Error: "+C0e(i,s))}(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Tv||(Tv={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(So||(So={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(vo||(vo={}));var E0e=596e-10,M0e=65504;function T0e(n){return!!(Fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||E0e<Math.abs(n)&&Math.abs(n)<M0e)}function C0e(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Fx(n,e,t){return Eu(n,e,function(){return n.getExtension(t)},'Extension "'+t+'" not supported on this browser.')}function A0e(n,e,t){var r=Eu(n,e,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Mt(n,e,function(){return n.shaderSource(r,t)}),Mt(n,e,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function R0e(n,e,t){var r=Eu(n,e,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Mt(n,e,function(){return n.shaderSource(r,t)}),Mt(n,e,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw function(i,s){var o=P0e.exec(s);if(o==null)return console.log("Couldn't parse line number in error: "+s),void console.log(i);for(var a=+o[1],l=i.split(`
`),u=l.length.toString().length+2,c=l.map(function(x,m){return Ip((m+1).toString(),u)+x}),f=0,h=0;h<c.length;h++)f=Math.max(c[h].length,f);var d=c.slice(0,a-1),p=c.slice(a-1,a),y=c.slice(a);console.log(d.join(`
`)),console.log(s.split(`
`)[0]),console.log("%c "+Ip(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(y.join(`
`))}(t,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var O3,B3,P0e=/ERROR: [0-9]+:([0-9]+):/g;function I0e(n,e){return Eu(n,e,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function D0e(n,e,t){if(Mt(n,e,function(){return n.linkProgram(t)}),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function U3(n,e,t){if(Mt(n,e,function(){return n.validateProgram(t)}),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function N0e(n,e,t){var r=Eu(n,e,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Mt(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),Mt(n,e,function(){return n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)}),r}function k0e(n,e,t){var r=Eu(n,e,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Mt(n,e,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),Mt(n,e,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)}),r}function L0e(n,e){return Eu(n,e,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function F0e(n,e){var t=Fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){var r="["+n+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t)throw r="["+n+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function O0e(n,e){return Eu(n,e,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function R5(n,e,t,r,i,s,o,a){var l=n.getAttribLocation(t,r);return l!==-1&&(Mt(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,i)}),Mt(n,e,function(){return n.vertexAttribPointer(l,s,n.FLOAT,!1,o,a)}),Mt(n,e,function(){return n.enableVertexAttribArray(l)}),!0)}function B0e(n,e,t,r){H0e(n,r),Mt(n,e,function(){return n.activeTexture(n.TEXTURE0+r)}),Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)})}function U0e(n,e,t,r){return Eu(n,e,function(){return n.getUniformLocation(t,r)},'uniform "'+r+'" not present in program.')}function z0e(n,e,t){return n.getUniformLocation(e,t)}function V0e(n,e,t,r,i,s){Mt(n,e,function(){return B0e(n,e,r,s)}),Mt(n,e,function(){return n.uniform1i(i,s)})}function z3(n,e,t,r){Mt(n,e,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),Mt(n,e,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0)})}function P5(n,e,t){Mt(n,e,function(){return n.bindFramebuffer(n.FRAMEBUFFER,t)}),Mt(n,e,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function Ox(n){var e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+W0e(n,e))}function W0e(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Eu(n,e,t,r){var i=Mt(n,e,function(){return t()});if(i==null)throw new Error(r);return i}function H0e(n,e){var t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function O_(n,e){return e===void 0&&(e=2),bt(n.slice(0,n.length-e))}function B_(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function V3(n){var e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[O_(n)].concat(B_(n))),e}function G0e(n,e){var t;e===void 0&&(e=!1);var r=Fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(n=n.map(function(u,c){return c>=n.length-2?yH(n[c]):n[c]})).length===1&&(n=[2,n[0]])),n.length!==2){var i=Bf(n);n=i.newShape}var s=bt(n);if(n.length<=1&&s<=r)return[1,s];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(e){var o=O_(n),a=2,l=2;return n.length&&(a=(t=B_(n))[0],l=t[1]),XC(s=o*(a/2)*(l/2)).map(function(u){return 2*u})}return XC(s)}function Bx(n){return n%2==0}function Ux(n,e){if(bi(n=n.slice(-2),e=e.slice(-2))||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){var t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||Bx(t)&&Bx(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Bx(n[0])&&Bx(e[0])}function j0e(n){if(O3==null){var e=Rl(n);O3=e.getParameter(e.MAX_TEXTURE_SIZE)}return O3}function X0e(n){if(B3==null){var e=Rl(n);B3=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,B3)}function $0e(n){if(n===0)return 0;var e=Rl(n);return sa(e,"EXT_disjoint_timer_query_webgl2")&&n===2?2:sa(e,"EXT_disjoint_timer_query")?1:0}function sa(n,e){return n.getExtension(e)!=null}function I5(n){try{if(Rl(n)!=null)return!0}catch{return!1}return!1}function q0e(n){if(n===0)return!1;var e=Rl(n);if(n===1){if(!sa(e,"OES_texture_float"))return!1}else if(!sa(e,"EXT_color_buffer_float"))return!1;return QC(e)}function Y0e(n){if(n===0)return!1;var e=Rl(n);if(n!==1){if(sa(e,"EXT_color_buffer_float"))return QC(e);if(sa(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return function(r,i){var s=l4(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,s.internalFormatHalfFloat,1,1,0,s.textureFormatFloat,s.textureTypeHalfFloat,null);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var l=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(a),l}(e,t)}return!1}return!!sa(e,"OES_texture_float")&&!!sa(e,"WEBGL_color_buffer_float")&&QC(e)}function QC(n){var e=l4(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);var i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function K0e(n){return n===2&&Rl(n).fenceSync!=null}var Vt=Fe();function CH(n){Fe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function lt(n,e){return le.tidy(n,e)}function Zs(n){MH(n).forEach(function(e){return e.dispose()})}function Z0e(n){return le.keep(n)}function U_(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Fe().getBool("IS_TEST")||console.warn.apply(console,n)}function Qc(n,e){var t=n;if(Sl(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(t)||Sl(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Fe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(s,o,a){if(a=a||[],!Array.isArray(s)&&!Sl(s))return void Z(o.length===0,function(){return"Element arr["+a.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});Z(o.length>0,function(){return"Element arr["+a.join("][")+"] should be a primitive, but is an array of "+s.length+" elements"}),Z(s.length===o[0],function(){return"Element arr["+a.join("][")+"] should have "+o[0]+" elements, but has "+s.length+" elements"});for(var l=o.slice(1),u=0;u<s.length;++u)i(s[u],l,a.concat(u))}(n,r,[]),r}function D5(n,e,t,r){if(n!=null&&(n!=="numeric"&&n!==e||n==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+n+" tensor, but got "+e+" tensor")}function Y(n,e,t,r){if(r===void 0&&(r="numeric"),n instanceof cr)return D5(r,n.dtype,e,t),n;var i=ry(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),D5(r,i,e,t),n==null||!Sl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var s=n==null?"null":n.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+s+"'")}var o=Qc(n,i);Sl(n)||Array.isArray(n)||(n=[n]);var a=i!=="string"?_H(n,i,Fe().getBool("DEBUG")):sm(n,[],!0);return le.makeTensor(a,o,i)}function z_(n,e,t,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(i,s){return Y(i,e+"["+s+"]",t)},r)}function AH(n,e){for(var t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function J0e(n,e,t){for(var r=n.length+e.length,i=[],s=0,o=0,a=0;a<r;a++)t.indexOf(a)===-1?i.push(n[s++]):i.push(e[o++]);return i}function Zi(n,e){for(var t=[],r=n.length,i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);return[t,e.map(function(s){return n[s]})]}function Qs(n,e){return J0e(n,e.map(function(t){return 1}),e)}function mo(n,e,t){Z(AH(e,t),function(){return n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."})}function Pl(n,e){if(AH(n,e))return null;for(var t=[],r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(function(i){return t.push(i)}),t}function u4(n){return n.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function Il(n,e){for(var t=[],r=e-n;r<e;++r)t.push(r);return t}function Q0e(n,e){var t=n[0].length;n.forEach(function(i,s){Z(i.length===t,function(){return"Error in concat"+t+"D: rank of tensors["+s+"] must be the same as the rank of the rest ("+t+")"})}),Z(e>=0&&e<t,function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."});var r=n[0];n.forEach(function(i,s){for(var o=0;o<t;o++)Z(o===e||i[o]===r[o],function(){return"Error in concat"+t+"D: Shape of tensors["+s+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+s+"."})})}function am(n,e){for(var t=n[0].slice(),r=1;r<n.length;r++)t[e]+=n[r][e];return t}function ie(n){var e=Object.keys(n);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var i=function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];le.startScope(t);try{var a=r.apply(void 0,s);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),le.endScope(a),a}catch(l){throw le.endScope(null),l}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}Vt.registerFlag("HAS_WEBGL",function(){return Vt.getNumber("WEBGL_VERSION")>0}),Vt.registerFlag("WEBGL_VERSION",function(){return I5(2)?2:I5(1)?1:0}),Vt.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Vt.get("WEBGL_VERSION")===2}),Vt.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Vt.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Vt.registerFlag("WEBGL_PACK",function(){return Vt.getBool("HAS_WEBGL")}),Vt.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_CLIP",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Vt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_PACK_REDUCE",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_CONV_IM2COL",function(){return Vt.getBool("WEBGL_PACK")}),Vt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return j0e(Vt.getNumber("WEBGL_VERSION"))}),Vt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return X0e(Vt.getNumber("WEBGL_VERSION"))}),Vt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=Vt.getNumber("WEBGL_VERSION");return n===0?0:$0e(n)}),Vt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Vt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),Vt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return q0e(Vt.getNumber("WEBGL_VERSION"))}),Vt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Vt.getBool("WEBGL_FORCE_F16_TEXTURES")&&Vt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Vt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Y0e(Vt.getNumber("WEBGL_VERSION"))}),Vt.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return K0e(Vt.getNumber("WEBGL_VERSION"))}),Vt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Vt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),EH=CH;var Pi=ie({complex_:function(n,e){var t=Y(n,"real","complex"),r=Y(e,"imag","complex");return kn(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),le.runKernelFunc(function(i){return i.complex(t,r)},{$real:t,$imag:r})}}),ea=ie({real_:function(n){var e=Y(n,"input","real");return le.runKernelFunc(function(t){return t.real(e)},{$input:e})}}),cl=ie({imag_:function(n){var e=Y(n,"input","imag");return le.runKernelFunc(function(t){return t.imag(e)},{$input:e})}});function Di(n,e,t){return ef(n,e,Qc(n,t),t)}function ef(n,e,t,r){if(r==null&&(r=ry(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Sl(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){bH(e);var i=bt(e),s=bt(t);Z(i===s,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+s});for(var o=0;o<t.length;++o){var a=t[o],l=o!==t.length-1||a!==bt(e.slice(o));Z(t[o]===e[o]||!l,function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "})}}return Sl(n)||Array.isArray(n)||(n=[n]),e=e||t,n=r!=="string"?_H(n,r,Fe().getBool("DEBUG")):sm(n,[],!0),le.makeTensor(n,e,r)}function tt(n,e){if((Sl(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Sl(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ef(n,[],[],e)}function Xr(n,e){Mm(n);var t=Qc(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ef(n,null,t,e)}function Tc(n,e,t){if(Mm(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Qc(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ef(n,e,r,t)}function c4(n,e,t){if(Mm(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Qc(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ef(n,e,r,t)}function Fs(n,e,t){if(Mm(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Qc(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ef(n,e,r,t)}function ege(n,e,t){if(Mm(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Qc(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ef(n,e,r,t)}function tge(n,e,t){if(Mm(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Qc(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ef(n,e=e||r,r,t)}function nge(n,e,t,r){return e===void 0&&(e=!0),le.makeVariable(n,e,t,r)}function Tm(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Tm(n,"float32"),r=Kn(n,"float32");return Pi(t,r)}var i=wH(bt(n),e);return le.makeTensor(i,n,e)}function Kn(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=Kn(n,"float32"),r=Kn(n,"float32");return Pi(t,r)}var i=iy(bt(n),e);return le.makeTensor(i,n,e)}function Ml(n,e,t){return le.runKernelFunc(function(r){return r.fill(n,e,t)},{})}function rge(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");return le.runKernelFunc(function(r){return r.linspace(n,e,t)},{})}function V_(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t===0)throw new Error("Cannot have a step of zero");if(n===e||n<e&&t<0||e<n&&t>1)return Kn([0],r);var i=iy(Math.abs(Math.ceil((e-n)/t)),r);e<n&&t===1&&(t=-1),i[0]=n;for(var s=1;s<i.length;s++)i[s]=i[s-1]+t;return Xr(i,r)}var RH=ie({onesLike_:function(n){var e=Y(n,"x","onesLike");if(e.dtype==="complex64"){var t=RH(ea(e)),r=xn(cl(e));return Pi(t,r)}return le.runKernelFunc(function(i){return i.onesLike(e)},{$x:e},function(i,s){return{$x:function(){return xn(i)}}})}}),xn=ie({zerosLike_:function(n){var e=Y(n,"x","zerosLike");return le.runKernelFunc(function(t){return t.zerosLike(e)},{$x:e},function(t,r){return{$x:function(){return xn(t)}}})}}),ii=ie({concat_:function(n,e){e===void 0&&(e=0),Z(n.length>=1,function(){return"Pass at least one tensor to concat"});var t=z_(n,"tensors","concat");t[0].dtype==="complex64"&&t.forEach(function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")}),e=ci(e,t[0].shape)[0];var r=am(t.map(function(a){return a.shape}),e);if(bt(r)===0)return Di([],r);if((t=t.filter(function(a){return a.size>0})).length===1)return t[0];var i=t.map(function(a){return a.shape});Q0e(i,e);var s=t,o={axis:e};return le.runKernelFunc(function(a){return a.concat(t,e)},s,function(a){var l=i.map(function(u){return u[e]});return f4(a,l,e).map(function(u){return function(){return u}})},"Concat",o)}}),ige=ie({concat1d_:function(n){return ii(n,0)}}),sge=ie({concat2d_:function(n,e){return ii(n,e)}}),oge=ie({concat3d_:function(n,e){return ii(n,e)}}),age=ie({concat4d_:function(n,e){return ii(n,e)}}),f4=ie({split_:function(n,e,t){t===void 0&&(t=0);var r,i=Y(n,"x","split");return t=ci(t,i.shape)[0],typeof e=="number"?(Z(i.shape[t]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(i.shape[t]/e)):(Z(i.shape[t]===e.reduce(function(s,o){return s+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),le.runKernelFunc(function(s){return s.split(i,r,t)},{$x:i},function(s){return{$x:function(){return ii(s,t)}}})}});function Fh(n,e){return n(e={exports:{}},e.exports),e.exports}var lge=Fh(function(n){(function(e,t,r){function i(a){var l,u=this,c=(l=4022871197,function(f){f=f.toString();for(var h=0;h<f.length;h++){var d=.02519603282416938*(l+=f.charCodeAt(h));d-=l=d>>>0,l=(d*=l)>>>0,l+=4294967296*(d-=l)}return 23283064365386963e-26*(l>>>0)});u.next=function(){var f=2091639*u.s0+23283064365386963e-26*u.c;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=0|f)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(a),u.s0<0&&(u.s0+=1),u.s1-=c(a),u.s1<0&&(u.s1+=1),u.s2-=c(a),u.s2<0&&(u.s2+=1),c=null}function s(a,l){return l.c=a.c,l.s0=a.s0,l.s1=a.s1,l.s2=a.s2,l}function o(a,l){var u=new i(a),c=l&&l.state,f=u.next;return f.int32=function(){return 4294967296*u.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.alea=o})(0,n)}),uge=Fh(function(n){(function(e,t,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},a===(0|a)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=0|u.charCodeAt(c),l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new i(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.xor128=o})(0,n)}),cge=Fh(function(n){(function(e,t,r){function i(a){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^f^f<<1)|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(0|a)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=0|u.charCodeAt(c),c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new i(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.xorwow=o})(0,n)}),fge=Fh(function(n){(function(e,t,r){function i(a){var l=this;l.next=function(){var u,c,f=l.x,h=l.i;return u=f[h],c=(u^=u>>>7)^u<<24,c^=(u=f[h+1&7])^u>>>10,c^=(u=f[h+3&7])^u>>>3,c^=(u=f[h+4&7])^u<<7,u=f[h+7&7],c^=(u^=u<<13)^u<<9,f[h]=c,l.i=h+1&7,c},function(u,c){var f,h=[];if(c===(0|c))h[0]=c;else for(c=""+c,f=0;f<c.length;++f)h[7&f]=h[7&f]<<15^c.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],u.x=h,u.i=0,f=256;f>0;--f)u.next()}(l,a)}function s(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},f.int32=u.next,f.quick=f,c&&(c.x&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.xorshift7=o})(0,n)}),hge=Fh(function(n){(function(e,t,r){function i(a){var l=this;l.next=function(){var u,c,f=l.w,h=l.X,d=l.i;return l.w=f=f+1640531527|0,c=h[d+34&127],u=h[d=d+1&127],c^=c<<13,u^=u<<17,c^=c>>>15,u^=u>>>12,c=h[d]=c^u,l.i=d,c+(f^f>>>16)|0},function(u,c){var f,h,d,p,y,x=[],m=128;for(c===(0|c)?(h=c,c=null):(c+="\0",h=0,m=Math.max(m,c.length)),d=0,p=-32;p<m;++p)c&&(h^=c.charCodeAt((p+32)%c.length)),p===0&&(y=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,p>=0&&(y=y+1640531527|0,d=(f=x[127&p]^=h+y)==0?d+1:0);for(d>=128&&(x[127&(c&&c.length||0)]=-1),d=127,p=512;p>0;--p)h=x[d+34&127],f=x[d=d+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,x[d]=h^f;u.w=y,u.X=x,u.i=d}(l,a)}function s(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},f.int32=u.next,f.quick=f,c&&(c.X&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.xor4096=o})(0,n)}),dge=Fh(function(n){(function(e,t,r){function i(a){var l=this,u="";l.next=function(){var f=l.b,h=l.c,d=l.d,p=l.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-d|0,l.d=d<<16^h>>>16^p,l.a=p-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=0|a):u+=a;for(var c=0;c<u.length+20;c++)l.b^=0|u.charCodeAt(c),l.next()}function s(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new i(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&s(c,u),f.state=function(){return s(u,{})}),f}t&&t.exports?t.exports=o:this.tychei=o})(0,n)}),Ff=Fh(function(n){(function(e,t){var r,i=this,s=256,o=6,a="random",l=t.pow(s,o),u=t.pow(2,52),c=2*u,f=s-1;function h(m,_,w){var b=[],S=y(function P(C,A){var k,L=[],H=typeof C;if(A&&H=="object")for(k in C)try{L.push(P(C[k],A-1))}catch{}return L.length?L:H=="string"?C:C+"\0"}((_=_==1?{entropy:!0}:_||{}).entropy?[m,x(e)]:m??function(){try{var P;return r&&(P=r.randomBytes)?P=P(s):(P=new Uint8Array(s),(i.crypto||i.msCrypto).getRandomValues(P)),x(P)}catch{var C=i.navigator,A=C&&C.plugins;return[+new Date,i,A,i.screen,x(e)]}}(),3),b),M=new d(b),T=function(){for(var P=M.g(o),C=l,A=0;P<u;)P=(P+A)*s,C*=s,A=M.g(1);for(;P>=c;)P/=2,C/=2,A>>>=1;return(P+A)/C};return T.int32=function(){return 0|M.g(4)},T.quick=function(){return M.g(4)/4294967296},T.double=T,y(x(M.S),e),(_.pass||w||function(P,C,A,k){return k&&(k.S&&p(k,M),P.state=function(){return p(M,{})}),A?(t[a]=P,C):P})(T,S,"global"in _?_.global:this==t,_.state)}function d(m){var _,w=m.length,b=this,S=0,M=b.i=b.j=0,T=b.S=[];for(w||(m=[w++]);S<s;)T[S]=S++;for(S=0;S<s;S++)T[S]=T[M=f&M+m[S%w]+(_=T[S])],T[M]=_;(b.g=function(P){for(var C,A=0,k=b.i,L=b.j,H=b.S;P--;)C=H[k=f&k+1],A=A*s+H[f&(H[k]=H[L=f&L+C])+(H[L]=C)];return b.i=k,b.j=L,A})(s)}function p(m,_){return _.i=m.i,_.j=m.j,_.S=m.S.slice(),_}function y(m,_){for(var w,b=m+"",S=0;S<b.length;)_[f&S]=f&(w^=19*_[f&S])+b.charCodeAt(S++);return x(_)}function x(m){return String.fromCharCode.apply(0,m)}if(t["seed"+a]=h,y(t.random(),e),n.exports){n.exports=h;try{r=require("crypto")}catch{}}})([],Math)});Ff.alea=lge,Ff.xor128=uge,Ff.xorwow=cge,Ff.xorshift7=fge,Ff.xor4096=hge,Ff.tychei=dge;var lb=Ff.alea,h4=function(){function n(e,t,r,i,s){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=s||Math.random();this.random=lb(o.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,r,i=!1;!i;){var s=void 0,o=void 0,a=void 0;do a=(s=2*this.random()-1)*s+(o=2*this.random()-1)*o;while(a>=1||a===0);var l=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*s*l,r=this.mean+this.stdDev*o*l,this.truncated&&!this.isValidTruncated(t)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},n.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},n.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},n}(),pge=function(){function n(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;var s=i||Math.random();this.randu=lb(s.toString()),this.randn=new h4(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var e,t,r,i,s,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,t=1-.331*(e=i*i)*e,r=.5*e+this.d*(1-o+Math.log(o)),(s=this.randu())<t||Math.log(s)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},n.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},n}(),mge=function(){function n(e,t,r,i){var s=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return s.dtype==null||s.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=lb(i)}return n.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function jt(n,e,t){return e===void 0&&(e="float32"),e=e||"float32",bH(n),new Mv(n,e,t)}function gge(n,e){e===void 0&&(e=!1),console.log(n.toString(e))}var PH=ie({batchToSpaceND_:function(n,e,t){var r=Y(n,"x","batchToSpaceND"),i=e.reduce(function(s,o){return s*o});return Z(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),Z(t.length===e.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length}),Z(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i}),le.runKernelFunc(function(s){return s.batchToSpaceND(r,e,t)},{$x:r},function(s){return{$x:function(){return s.spaceToBatchND(e,t)}}})}}),vge=ie({broadcastTo_:function(n,e){var t=Y(n,"broadcastTo","x"),r=t.shape;if(e.some(function(l){return!(l>0)||l%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<t.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+t.rank+".");if(e.length>t.rank){for(var i=t.shape.slice();i.length<e.length;)i.unshift(1);t=t.reshape(i)}for(var s=Array.from(e),o=e.length-1;o>=0;o--)if(t.shape[o]===e[o])s[o]=1;else if(t.shape[o]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var a=s.map(function(l,u){return l>1?u:-1}).filter(function(l){return l>=0});return a.length===0?t.clone():le.runKernelFunc(function(l){return l.tile(t,s)},{input:t},function(l){return{input:function(){return l.sum(a,!0)}}})}}),yge=ie({cast_:function(n,e){var t=Y(n,"x","cast");if(!c0e(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return le.runKernelFunc(function(i){return i.cast(t,e)},{x:t},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),xge=ie({clone_:function(n){var e=Y(n,"x","clone",null);return le.runKernelFunc(function(){return le.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(t){return{$x:function(){return t.toFloat()}}})}}),_ge=ie({cumsum_:function(n,e,t,r){e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1);var i=Y(n,"x","cumsum"),s=Pl([e|=0],i.rank),o=i;s!=null&&(o=i.transpose(s));var a=Il(1,i.rank)[0],l=le.runKernelFunc(function(u){return u.cumsum(o,a,t,r)},{permutedX:o},function(u){return{permutedX:function(){return u.cumsum(e,t,!r)}}});return s!=null&&(l=l.transpose(s)),l}}),wge=ie({depthToSpace_:function(n,e,t){t===void 0&&(t="NHWC");var r=Y(n,"x","depthToSpace"),i=t==="NHWC"?r.shape[1]:r.shape[2],s=t==="NHWC"?r.shape[2]:r.shape[3],o=t==="NHWC"?r.shape[3]:r.shape[1];return Z(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),Z(s*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+s+" and "+e+` for depthToSpace with input shape
          `+r.shape}),Z(o%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+r.shape}),le.runKernelFunc(function(a){return a.depthToSpace(r,e,t)},{$x:r})}}),Qo=ie({expandDims_:function(n,e){e===void 0&&(e=0);var t=Y(n,"x","expandDims",null);Z(e<=t.rank,function(){return"Axis must be <= rank of the tensor"});var r=t.shape.slice();return e<0&&(Z(-(t.rank+1)<=e,function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"}),e=t.rank+e+1),r.splice(e,0,1),Ia(t,r)}}),IH=ie({eye_:function(n,e,t,r){r===void 0&&(r="float32"),e==null&&(e=n);for(var i=jt([n,e],r),s=n<=e?n:e,o=0;o<s;++o)i.set(1,o,o);var a=i.toTensor().as2D(n,e);if(t==null)return a;if(t.length===1)return Dp(Qo(a,0),[t[0],1,1]);if(t.length===2)return Dp(Qo(Qo(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return Dp(Qo(Qo(Qo(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),bge=ie({multinomial_:function(n,e,t,r){r===void 0&&(r=!1);var i=Y(n,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+s+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);t=t||Math.random();var a=o===1?i.as2D(1,-1):i,l=le.runKernelFunc(function(u){return u.multinomial(a,r,e,t)},{logits2D:a});return o===1?l.as1D():l}}),eA=ie({oneHot_:function(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=Y(n,"indices","oneHot","int32"),s=i.shape.concat([e]);return i=i.flatten(),le.runKernelFunc(function(o){return o.oneHot(i,e,t,r)},{$indices:i},function(o){return{$indices:function(){return Kn(i.shape,"float32")}}}).reshape(s)}}),Oh=ie({pad_:function(n,e,t){t===void 0&&(t=0);var r=Y(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:t};return le.runKernelFunc(function(s){return s.pad(r,e,t)},{x:r},function(s){var o=e.map(function(a){return a[0]});return{x:function(){return s.slice(o,r.shape)}}},"PadV2",i)}}),Sge=ie({pad1d_:function(n,e,t){return t===void 0&&(t=0),Z(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Oh(n,[e],t)}}),Ege=ie({pad2d_:function(n,e,t){return t===void 0&&(t=0),Z(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oh(n,e,t)}}),Mge=ie({pad3d_:function(n,e,t){return t===void 0&&(t=0),Z(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oh(n,e,t)}}),Tge=ie({pad4d_:function(n,e,t){return t===void 0&&(t=0),Z(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oh(n,e,t)}}),Cge=ie({rand_:function(n,e,t){var r=bt(n),i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else{if(t!=="bool")throw new Error("Unknown data type "+t);i=new Uint8Array(r)}for(var s=0;s<r;s++)i[s]=e();return le.makeTensor(i,n,t)}}),Age=ie({randomNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var s=new h4(e,t,r,!1,i),o=jt(n,r),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),Rge=ie({randomGamma_:function(n,e,t,r,i){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var s=new pge(e,t,r,i),o=jt(n,r),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),DH=ie({randomUniform_:function(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=1),r===void 0&&(r="float32");for(var s=jt(n,r),o=new mge(e,t,null,i),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),Ia=ie({reshape_:function(n,e){var t=Y(n,"x","reshape",null);e=l0e(e,t.size),Z(t.size===bt(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return le.runKernelFunc(function(i){return i.reshape(t,e)},{x:t},function(i){return{x:function(){return i.reshape(t.shape)}}},"Reshape",r)}}),NH=ie({spaceToBatchND_:function(n,e,t){var r=Y(n,"x","spaceToBatchND");return Z(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),Z(t.length===e.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length}),Z(r.shape.reduce(function(i,s,o){return o>0&&o<=e.length?i&&(s+t[o-1][0]+t[o-1][1])%e[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()}),le.runKernelFunc(function(i){return i.spaceToBatchND(r,e,t)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(e,t)}}})}}),kH=ie({squeeze_:function(n,e){var t=Y(n,"x","squeeze");return Ia(t,Bf(t.shape,e).newShape)}}),Ro=ie({stack_:function(n,e){e===void 0&&(e=0);var t=z_(n,"tensors","stack");if(Z(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),t.length===1)return t[0].expandDims(e);var r=t[0].rank,i=t[0].shape,s=t[0].dtype;Z(e<=r,function(){return"Axis must be <= rank of the tensor"}),t.forEach(function(a){kn(i,a.shape,"All tensors passed to stack must have matching shapes")}),t.forEach(function(a){Z(s===a.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=t.map(function(a){return a.expandDims(e)});return ii(o,e)}}),Dp=ie({tile_:function(n,e){var t=Y(n,"x","tile",null);Z(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."});var r=[t],i={reps:e};return le.runKernelFunc(function(s,o){var a=s.tile(t,e);return o([t]),a},{x:t},function(s,o){var a=o[0];return{x:function(){var l=xn(a);if(a.rank===1)for(var u=0;u<e[0];++u)l=l.add(s.slice([u*a.shape[0]],[a.shape[0]]));else if(a.rank===2)for(u=0;u<e[0];++u)for(var c=0;c<e[1];++c)l=l.add(s.slice([u*a.shape[0],c*a.shape[1]],[a.shape[0],a.shape[1]]));else if(a.rank===3)for(u=0;u<e[0];++u)for(c=0;c<e[1];++c)for(var f=0;f<e[2];++f)l=l.add(s.slice([u*a.shape[0],c*a.shape[1],f*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(a.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+a.rank+" tensors yet.");for(u=0;u<e[0];++u)for(c=0;c<e[1];++c)for(f=0;f<e[2];++f)for(var h=0;h<e[3];++h)l=l.add(s.slice([u*a.shape[0],c*a.shape[1],f*a.shape[2],h*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return l}}},"Tile",i,r)}}),Pge=ie({truncatedNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var s=new h4(e,t,r,!0,i),o=jt(n,r),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),si=ie({unstack_:function(n,e){e===void 0&&(e=0),e=e||0;var t=Y(n,"x","unstack");Z(e>=-t.shape.length&&e<t.shape.length,function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"}),e<0&&(e+=t.shape.length);var r={axis:e};return le.runKernelFunc(function(i){return i.unstack(t,e)},{x:t},function(i){return{x:function(){return Ro(i,e)}}},"Unpack",r)}}),Ige=function(n,e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a,l,u,c,f;return yt(this,function(h){switch(h.label){case 0:return t=Y(n,"x","setdiff1d"),r=Y(e,"y","setdiff1d"),Z(t.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."}),Z(t.rank===1,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),Z(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,t.data()];case 1:return i=h.sent(),[4,r.data()];case 2:for(s=h.sent(),o=new Set(s),a=0,c=0;c<i.length;c++)o.has(i[c])||a++;for(l=new Mv([a],t.dtype),u=new Mv([a],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(l.values[f]=i[c],u.values[f]=c,f++);return[2,[l.toTensor(),u.toTensor()]]}})})};function W_(n,e,t,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);for(var s=e.length,o=0;o<s;++o)i=i.concat([n[o+1]/e[o],e[o]]);i=i.concat(n.slice(s+1))}return i}function H_(n,e,t){t===void 0&&(t=!0);var r=[];if(t){r.push(e);for(var i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var s=[],o=[];for(i=1;i<n;++i)i>=2*e+1||i%2==1?o.push(i):s.push(i);r.push.apply(r,s),r.push(0),r.push.apply(r,o)}return r}function G_(n,e,t,r){r===void 0&&(r=!0);var i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(var s=1;s<n.length;++s)s<=e.length?r?i.push(e[s-1]*n[s]):i.push(n[s]/e[s-1]):i.push(n[s]);return i}function LH(n,e){for(var t=[0],r=0;r<e;++r)t.push(n[r][0]);return t}function FH(n,e,t){for(var r=n.slice(0,1),i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}function OH(n,e){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var t=e.shape,r=t[t.length-1],i=1,s=0;s<t.length-1;++s)i*=t[s];var o=n.shape,a=t.slice();a.pop();var l=1;for(s=r;s<n.rank;++s)l*=o[s],a.push(o[s]);var u=El(n.shape).map(function(c){return c/l}).concat([1]).slice(0,r);return[a,i,l,u]}var BH=30;function W3(n){return n<=BH?n:qC(n,Math.floor(Math.sqrt(n)))}function Dge(n,e,t){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+t.shape+", indices.shape: "+e.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+i+".";if(t.rank<i)throw new Error(s+" update.rank < "+i+". ");if(n.length<r+(t.rank-i))throw new Error(s+" Output shape length < "+(r+(t.rank-i)));if(t.rank!==i+n.length-r)throw new Error(s+" update.rank != "+(i+n.length-r));for(var o=0;o<i;++o)if(t.shape[o]!==e.shape[o])throw new Error(s+" updates.shape["+o+"] ("+t.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<t.rank-i;++o)if(t.shape[o+i]!==n[o+r])throw new Error(s+" updates.shape["+(o+i)+"] ("+t.shape[o+i]+") != shape["+(o+i)+"] ("+n[o+i]+")")}function Nge(n,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}Dge(t,e,n)}function j_(n,e,t){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,s=t.length,o=1,a=i;a<s;++a)o*=t[a];var l=i<1?1:i;return{sliceRank:i,numUpdates:bt(e.shape)/l,sliceSize:o,strides:El(t.slice(0,i)).concat([1]),outputSize:bt(t)}}function kge(n,e,t){Z(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+e+" must match the rank of the array ("+n.rank+")."}),Z(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of size "+t+" must match the rank of the array ("+n.rank+")."});for(var r=function(s){Z(e[s]+t[s]<=n.shape[s],function(){return"Error in slice"+n.rank+"D: begin["+s+"] + size["+s+"] ("+(e[s]+t[s])+") would overflow input.shape["+s+"] ("+n.shape[s]+")"})},i=0;i<n.rank;++i)r(i)}function N5(n){for(var e=[],t=0;n>0;)1&n&&e.push(t),n/=2,t++;return e}function d4(n,e,t){for(var r=[],i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function Lge(n,e,t,r,i){var s=e[i],o=t[i]||1;(n&1<<i||s==null)&&(s=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return s<0&&(s+=a),s=jC(0,s,a-1)}function Fge(n,e,t,r,i){var s=e[i],o=t[i]||1;(n&1<<i||s==null)&&(s=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return s<0&&(s+=a),s=o>0?jC(0,s,a):jC(-1,s,a-1)}function UH(n,e,t){for(var r=t.length,i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function zH(n,e){for(var t=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function Oge(n,e){Z($C(n),function(){return"The f passed in variableGrads(f) must be a function"}),Z(e==null||Array.isArray(e)&&e.every(function(c){return c instanceof om}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var t=e!=null;if(!t)for(var r in e=[],le.registeredVariables)e.push(le.registeredVariables[r]);var i=t?e.filter(function(c){return!c.trainable}):null,s=e.length;Z((e=e.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+s+" variables is trainable."});var o=le.gradients(n,e,null,!0),a=o.value,l=o.grads;Z(l.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),Z(a.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"});var u={};return e.forEach(function(c,f){l[f]!=null&&(u[c.name]=l[f])}),i!=null&&i.forEach(function(c){return u[c.name]=null}),{value:a,grads:u}}function ub(n){return le.customGrad(n)}var Mu=ie({softmax_:function(n,e){e===void 0&&(e=-1);var t=Y(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return le.runKernelFunc(function(r,i){var s=r.softmax(t,e);return i([s]),s},{logits:t},function(r,i){var s=i[0],o=r.mul(s);return{logits:function(){return o.sub(o.sum([e],!0).mul(s))}}},"Softmax",{dim:e},[],[!0])}}),Bge=ie({logSoftmax_:function(n,e){e===void 0&&(e=-1);var t=Y(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return ub(function(r,i){var s=r.max(e,!0),o=r.sub(s),a=o.toFloat().sub(o.exp().sum(e,!0).log());return i([a]),{value:a,gradFunc:function(l,u){var c=u[0].exp();return l.sub(l.sum(e,!0).mul(c))}}})(t)}}),VH=function(){function n(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},n.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},n.prototype.has=function(e){return this.data.has(e)},n.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),WH=function(){function n(){}return n.prototype.time=function(e){return Ee("time")},n.prototype.read=function(e){return Ee("read")},n.prototype.readSync=function(e){return Ee("readSync")},n.prototype.numDataIds=function(){return Ee("numDataIds")},n.prototype.disposeData=function(e){return Ee("disposeData")},n.prototype.write=function(e,t,r){return Ee("write")},n.prototype.move=function(e,t,r,i){return Ee("move")},n.prototype.memory=function(){return Ee("memory")},n.prototype.floatPrecision=function(){return Ee("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(e,t,r,i){return Ee("batchMatMul")},n.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Ee("fusedBatchMatMul")},n.prototype.slice=function(e,t,r){return Ee("slice")},n.prototype.stridedSlice=function(e,t,r,i){return Ee("stridedSlice")},n.prototype.unstack=function(e,t){return Ee("unstack")},n.prototype.reverse=function(e,t){return Ee("reverse")},n.prototype.concat=function(e,t){return Ee("concat")},n.prototype.neg=function(e){return Ee("neg")},n.prototype.add=function(e,t){return Ee("add")},n.prototype.addN=function(e){return Ee("addN")},n.prototype.subtract=function(e,t){return Ee("subtract")},n.prototype.multiply=function(e,t){return Ee("multiply")},n.prototype.realDivide=function(e,t){return Ee("realDivide")},n.prototype.floorDiv=function(e,t){return Ee("floorDiv")},n.prototype.sum=function(e,t){return Ee("sum")},n.prototype.prod=function(e,t){return Ee("prod")},n.prototype.unsortedSegmentSum=function(e,t,r){return Ee("unsortedSegmentSum")},n.prototype.argMin=function(e,t){return Ee("argMin")},n.prototype.argMax=function(e,t){return Ee("argMax")},n.prototype.equal=function(e,t){return Ee("equal")},n.prototype.notEqual=function(e,t){return Ee("notEqual")},n.prototype.less=function(e,t){return Ee("less")},n.prototype.lessEqual=function(e,t){return Ee("lessEqual")},n.prototype.greater=function(e,t){return Ee("greater")},n.prototype.greaterEqual=function(e,t){return Ee("greaterEqual")},n.prototype.logicalNot=function(e){return Ee("logicalNot")},n.prototype.logicalAnd=function(e,t){return Ee("logicalAnd")},n.prototype.logicalOr=function(e,t){return Ee("logicalOr")},n.prototype.where=function(e){return Ee("where")},n.prototype.select=function(e,t,r){return Ee("select")},n.prototype.topk=function(e,t,r){return Ee("topk")},n.prototype.min=function(e,t){return Ee("min")},n.prototype.minimum=function(e,t){return Ee("minimum")},n.prototype.mod=function(e,t){return Ee("mod")},n.prototype.max=function(e,t){return Ee("max")},n.prototype.maximum=function(e,t){return Ee("maximum")},n.prototype.all=function(e,t){return Ee("all")},n.prototype.any=function(e,t){return Ee("any")},n.prototype.squaredDifference=function(e,t){return Ee("squaredDifference")},n.prototype.ceil=function(e){return Ee("ceil")},n.prototype.floor=function(e){return Ee("floor")},n.prototype.round=function(e){return Ee("round")},n.prototype.sign=function(e){return Ee("sign")},n.prototype.isNaN=function(e){return Ee("isNaN")},n.prototype.isInf=function(e){return Ee("isInf")},n.prototype.isFinite=function(e){return Ee("isFinite")},n.prototype.pow=function(e,t){return Ee("pow")},n.prototype.exp=function(e){return Ee("exp")},n.prototype.expm1=function(e){return Ee("expm1")},n.prototype.softmax=function(e,t){return Ee("softmax")},n.prototype.log=function(e){return Ee("log")},n.prototype.log1p=function(e){return Ee("log1p")},n.prototype.sqrt=function(e){return Ee("sqrt")},n.prototype.rsqrt=function(e){return Ee("rsqrt")},n.prototype.square=function(e){return Ee("square")},n.prototype.reciprocal=function(e){return Ee("reciprocal")},n.prototype.relu=function(e){return Ee("relu")},n.prototype.relu6=function(e){return Ee("relu6")},n.prototype.prelu=function(e,t){return Ee("prelu")},n.prototype.elu=function(e){return Ee("elu")},n.prototype.eluDer=function(e,t){return Ee("eluDer")},n.prototype.selu=function(e){return Ee("selu")},n.prototype.int=function(e){return Ee("int")},n.prototype.clip=function(e,t,r){return Ee("clip")},n.prototype.abs=function(e){return Ee("abs")},n.prototype.complexAbs=function(e){return Ee("complexAbs")},n.prototype.sigmoid=function(e){return Ee("sigmoid")},n.prototype.softplus=function(e){return Ee("softplus")},n.prototype.sin=function(e){return Ee("sin")},n.prototype.cos=function(e){return Ee("cos")},n.prototype.tan=function(e){return Ee("tan")},n.prototype.asin=function(e){return Ee("asin")},n.prototype.acos=function(e){return Ee("acos")},n.prototype.atan=function(e){return Ee("atan")},n.prototype.atan2=function(e,t){return Ee("atan2")},n.prototype.sinh=function(e){return Ee("sinh")},n.prototype.cosh=function(e){return Ee("cosh")},n.prototype.tanh=function(e){return Ee("tanh")},n.prototype.asinh=function(e){return Ee("asinh")},n.prototype.acosh=function(e){return Ee("acosh")},n.prototype.atanh=function(e){return Ee("atanh")},n.prototype.erf=function(e){return Ee("erf")},n.prototype.step=function(e,t){return Ee("step")},n.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ee("fusedConv2d")},n.prototype.conv2d=function(e,t,r){return Ee("conv2d")},n.prototype.conv2dDerInput=function(e,t,r){return Ee("conv2dDerInput")},n.prototype.conv2dDerFilter=function(e,t,r){return Ee("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Ee("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(e,t,r){return Ee("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(e,t,r){return Ee("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(e,t,r){return Ee("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(e,t,r){return Ee("conv3d")},n.prototype.conv3dDerInput=function(e,t,r){return Ee("conv3dDerInput")},n.prototype.conv3dDerFilter=function(e,t,r){return Ee("conv3dDerFilter")},n.prototype.maxPool=function(e,t){return Ee("maxPool")},n.prototype.maxPoolBackprop=function(e,t,r,i){return Ee("maxPoolBackprop")},n.prototype.avgPool=function(e,t){return Ee("avgPool")},n.prototype.avgPoolBackprop=function(e,t,r){return Ee("avgPoolBackprop")},n.prototype.avgPool3d=function(e,t){return Ee("avgPool3d")},n.prototype.avgPool3dBackprop=function(e,t,r){return Ee("avgPool3dBackprop")},n.prototype.maxPool3d=function(e,t){return Ee("maxPool3d")},n.prototype.maxPool3dBackprop=function(e,t,r,i){return Ee("maxPool3dBackprop")},n.prototype.reshape=function(e,t){return Ee("reshape")},n.prototype.cast=function(e,t){return Ee("cast")},n.prototype.tile=function(e,t){return Ee("tile")},n.prototype.pad=function(e,t,r){return Ee("pad")},n.prototype.transpose=function(e,t){return Ee("transpose")},n.prototype.gather=function(e,t,r){return Ee("gather")},n.prototype.gatherND=function(e,t){return Ee("gatherND")},n.prototype.scatterND=function(e,t,r){return Ee("scatterND")},n.prototype.batchToSpaceND=function(e,t,r){return Ee("batchToSpaceND")},n.prototype.spaceToBatchND=function(e,t,r){return Ee("spaceToBatchND")},n.prototype.resizeBilinear=function(e,t,r,i){return Ee("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(e,t,r){return Ee("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(e,t,r,i){return Ee("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(e,t,r){return Ee("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(e,t,r,i,s,o){return Ee("batchNormalization")},n.prototype.localResponseNormalization4D=function(e,t,r,i,s){return Ee("localResponseNormalization4D")},n.prototype.LRNGrad=function(e,t,r,i,s,o,a){return Ee("LRNGrad")},n.prototype.multinomial=function(e,t,r,i){return Ee("multinomial")},n.prototype.oneHot=function(e,t,r,i){return Ee("oneHot")},n.prototype.cumsum=function(e,t,r,i){return Ee("cumsum")},n.prototype.nonMaxSuppression=function(e,t,r,i,s){return Ee("nonMaxSuppression")},n.prototype.fft=function(e){return Ee("fft")},n.prototype.ifft=function(e){return Ee("ifft")},n.prototype.complex=function(e,t){return Ee("complex")},n.prototype.real=function(e){return Ee("real")},n.prototype.imag=function(e){return Ee("imag")},n.prototype.cropAndResize=function(e,t,r,i,s,o){return Ee("cropAndResize")},n.prototype.depthToSpace=function(e,t,r){return Ee("depthToSpace")},n.prototype.split=function(e,t,r){return Ee("split")},n.prototype.sparseToDense=function(e,t,r,i){return Ee("sparseToDense")},n.prototype.diag=function(e){return Ee("diag")},n.prototype.fill=function(e,t,r){return Ee("fill")},n.prototype.onesLike=function(e){return Ee("onesLike")},n.prototype.zerosLike=function(e){return Ee("zerosLike")},n.prototype.linspace=function(e,t,r){return Ee("linspace")},n.prototype.dispose=function(){return Ee("dispose")},n}();function Ee(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function cc(n,e){for(var t=n.length,r=[],i=0;i<t;i++){var s=t-1-i,o=n[s]||1;(e[e.length-1-i]||1)>1&&o===1&&r.unshift(s)}return r}function li(n,e){for(var t=[],r=0;r<e.length;r++){var i=n[n.length-r-1],s=e.length-r-1,o=e[s];(i==null||i===1&&o>1)&&t.unshift(s)}return t}function fn(n,e){for(var t=[],r=Math.max(n.length,e.length),i=0;i<r;i++){var s=n[n.length-i-1];s==null&&(s=1);var o=e[e.length-i-1];if(o==null&&(o=1),s===1)t.unshift(o);else if(o===1)t.unshift(s);else{if(s!==o)throw Error("Operands could not be broadcast together with shapes "+n+" and "+e+".");t.unshift(s)}}return t}function Cv(n,e,t,r,i,s,o){o===void 0&&(o="channelsLast");var a,l=q_(e),u=l[0],c=l[1];if(o==="channelsLast")a=[u,c,n[3],n[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);a=[u,c,n[1],n[1]]}return Bh(n,a,t,r,i,s,!1,o)}function X_(n,e,t,r,i,s,o){o===void 0&&(o="NDHWC");var a,l,u=tA(e),c=u[0],f=u[1],h=u[2];if(o==="NDHWC")l="channelsLast",a=[c,f,h,n[4],n[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);l="channelsFirst",a=[c,f,h,n[1],n[1]]}return $_(n,a,t,r,i,!1,l,s)}function Bh(n,e,t,r,i,s,o,a){o===void 0&&(o=!1),a===void 0&&(a="channelsLast");var l=[-1,-1,-1,-1],u=l[0],c=l[1],f=l[2],h=l[3];if(a==="channelsLast")u=n[0],c=n[1],f=n[2],h=n[3];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);u=n[0],h=n[1],c=n[2],f=n[3]}var d,p=e[0],y=e[1],x=e[3],m=q_(t),_=m[0],w=m[1],b=q_(r),S=b[0],M=b[1],T=Np(p,S),P=Np(y,M),C=function(F,V,W,G,N,B,D,$){var ee,te,se;if(typeof F=="number"){ee={top:F,bottom:F,left:F,right:F,type:F===0?"VALID":"NUMBER"};var me=function(Be,J,he,de,Ie){de==null&&(de=HH(Be,J,he));var ve=Be[0],oe=Be[1],ze=_g((ve-J+2*de)/he+1,Ie);Z(Or(ze),function(){return"The output # of rows ("+ze+") must be an integer. Change the stride and/or zero pad parameters"});var X=_g((oe-J+2*de)/he+1,Ie);return Z(Or(X),function(){return"The output # of columns ("+X+") must be an integer. Change the stride and/or zero pad parameters"}),[ze,X]}([V,W],B,G,F,$);te=me[0],se=me[1]}else if(F==="same"){te=Math.ceil(V/G),se=Math.ceil(W/N);var _e=Math.max(0,(te-1)*G+B-V),pe=Math.max(0,(se-1)*N+D-W),Ne=Math.floor(_e/2),Ue=_e-Ne,We=Math.floor(pe/2);ee={top:Ne,bottom:Ue,left:We,right:pe-We,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);ee={top:0,bottom:0,left:0,right:0,type:"VALID"},te=Math.ceil((V-B+1)/G),se=Math.ceil((W-D+1)/N)}return{padInfo:ee,outHeight:te,outWidth:se}}(i,c,f,_,w,T,P,s),A=C.padInfo,k=C.outHeight,L=C.outWidth,H=o?x*h:x;return a==="channelsFirst"?d=[u,H,k,L]:a==="channelsLast"&&(d=[u,k,L,H]),{batchSize:u,dataFormat:a,inHeight:c,inWidth:f,inChannels:h,outHeight:k,outWidth:L,outChannels:H,padInfo:A,strideHeight:_,strideWidth:w,filterHeight:p,filterWidth:y,effectiveFilterHeight:T,effectiveFilterWidth:P,dilationHeight:S,dilationWidth:M,inShape:n,outShape:d,filterShape:e}}function $_(n,e,t,r,i,s,o,a){s===void 0&&(s=!1),o===void 0&&(o="channelsLast");var l=[-1,-1,-1,-1,-1],u=l[0],c=l[1],f=l[2],h=l[3],d=l[4];if(o==="channelsLast")u=n[0],c=n[1],f=n[2],h=n[3],d=n[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);u=n[0],d=n[1],c=n[2],f=n[3],h=n[4]}var p,y=e[0],x=e[1],m=e[2],_=e[4],w=tA(t),b=w[0],S=w[1],M=w[2],T=tA(r),P=T[0],C=T[1],A=T[2],k=Np(y,P),L=Np(x,C),H=Np(m,A),F=function(D,$,ee,te,se,me,_e,pe,Ne,Ue,We){var Be,J,he,de;if(typeof D=="number"){Be={top:D,bottom:D,left:D,right:D,front:D,back:D,type:D===0?"VALID":"NUMBER"};var Ie=function(K,ge,Te,Le,Pe,De){Pe==null&&(Pe=HH(K,ge,Le));var Ae=K[0],ht=K[1],Ze=K[2],at=_g((Ae-ge+2*Pe)/Le+1,De);Z(Or(at),function(){return"The output # of depths ("+at+") must be an integer. Change the stride and/or zero pad parameters"});var Qe=_g((ht-ge+2*Pe)/Le+1,De);Z(Or(Qe),function(){return"The output # of rows ("+Qe+") must be an integer. Change the stride and/or zero pad parameters"});var $e=_g((Ze-ge+2*Pe)/Le+1,De);return Z(Or($e),function(){return"The output # of columns ("+$e+") must be an integer. Change the stride and/or zero pad parameters"}),[at,Qe,$e,Te]}([$,ee,te,1],pe,1,se,D,We);J=Ie[0],he=Ie[1],de=Ie[2]}else if(D==="same"){J=Math.ceil($/se),he=Math.ceil(ee/me),de=Math.ceil(te/_e);var ve=(J-1)*se+pe-$,oe=(he-1)*me+Ne-ee,ze=(de-1)*_e+Ue-te,X=Math.floor(ve/2),j=ve-X,ae=Math.floor(oe/2),Oe=oe-ae,Se=Math.floor(ze/2);Be={top:ae,bottom:Oe,left:Se,right:ze-Se,front:X,back:j,type:"SAME"}}else{if(D!=="valid")throw Error("Unknown padding parameter: "+D);Be={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},J=Math.ceil(($-pe+1)/se),he=Math.ceil((ee-Ne+1)/me),de=Math.ceil((te-Ue+1)/_e)}return{padInfo:Be,outDepth:J,outHeight:he,outWidth:de}}(i,c,f,h,b,S,M,k,L,H,a),V=F.padInfo,W=F.outDepth,G=F.outHeight,N=F.outWidth,B=s?_*d:_;return o==="channelsFirst"?p=[u,B,W,G,N]:o==="channelsLast"&&(p=[u,W,G,N,B]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:f,inWidth:h,inChannels:d,outDepth:W,outHeight:G,outWidth:N,outChannels:B,padInfo:V,strideDepth:b,strideHeight:S,strideWidth:M,filterDepth:y,filterHeight:x,filterWidth:m,effectiveFilterDepth:k,effectiveFilterHeight:L,effectiveFilterWidth:H,dilationDepth:P,dilationHeight:C,dilationWidth:A,inShape:n,outShape:p,filterShape:e}}function HH(n,e,t,r){r===void 0&&(r=1);var i=Np(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function q_(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function tA(n){return typeof n=="number"?[n,n,n]:n}function Np(n,e){return e<=1?n:n+(n-1)*(e-1)}function _g(n,e){if(!e)return n;switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+e)}}function lm(n){var e=q_(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function eo(n,e){return lm(n)||lm(e)}function p4(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function GH(n,e,t){if(e==="complex64"){if(n.dtype==="complex64")return n.clone();var r=Kn(n.shape),i=n.toFloat(),s=t.complex(i,r);return r.dispose(),i.dispose(),s}if(!f0e(n.dtype,e))return le.makeTensorFromDataId(n.dataId,n.shape,e);if(n.dtype==="complex64"){var o=t.real(n);return s=o.cast(e),o.dispose(),s}if(e==="int32")return t.int(n);if(e==="bool"){var a=tt(0,n.dtype);return s=t.notEqual(n,a),a.dispose(),s}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+e)}function nA(n,e){return le.makeTensorFromDataId(n.dataId,e,n.dtype)}function jH(n,e,t){var r=(e-n)/(t-1),i=iy(t,"float32");i[0]=n;for(var s=1;s<i.length;s++)i[s]=i[s-1]+r;return Xr(i,"float32")}function rA(n,e){if(n.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+e.length+".");for(var t=new Float32Array(2*n.length),r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function k5(n,e){return{real:n[2*e],imag:n[2*e+1]}}function Uge(n,e,t,r){n[2*r]=e,n[2*r+1]=t}function zge(n,e,t){var r=(t?2:-2)*Math.PI*(n/e);return{real:Math.cos(r),imag:Math.sin(r)}}function Vge(n,e,t){var r=function(s,o,a){return function(l,u,c){for(var f=0,h=l.length,d=0,p=!1;f<h;){var y=c(u,l[d=f+(h-f>>>1)]);y>0?f=d+1:(h=d,p=!y)}return p?f:-f-1}(s,o,a||Wge)}(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function Wge(n,e){return n>e?1:n<e?-1:0}function m4(n,e,t,r,i){return XH(n,e,t,r,i,0).selectedIndices}function g4(n,e,t,r,i,s){var o=XH(n,e,t,r,i,s);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function XH(n,e,t,r,i,s,o,a){a===void 0&&(a=!1);for(var l=Array.from(e).map(function(b,S){return{score:b,boxIndex:S,suppressBeginIndex:0}}).filter(function(b){return b.score>i}).sort(L5),u=s>0?-.5/s:0,c=[],f=[];c.length<t&&l.length>0;){var h=l.pop(),d=h.score,p=h.boxIndex,y=h.suppressBeginIndex;if(d<i)break;for(var x=!1,m=c.length-1;m>=y;--m){var _=Hge(n,p,c[m]);if(_>=r){x=!0;break}if(h.score=h.score*Gge(r,u,_),h.score<=i)break}h.suppressBeginIndex=c.length,x||(h.score===d?(c.push(p),f.push(h.score)):h.score>i&&Vge(l,h,L5))}var w=c.length;return a&&(c.fill(0,w),f.fill(0,w)),{selectedIndices:Xr(c,"int32"),selectedScores:Xr(f,"float32"),numValidOutputs:tt(w,"int32")}}function Hge(n,e,t){var r=n.subarray(4*e,4*e+4),i=n.subarray(4*t,4*t+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),d=(a-s)*(l-o),p=(f-u)*(h-c);if(d<=0||p<=0)return 0;var y=Math.max(s,u),x=Math.max(o,c),m=Math.min(a,f),_=Math.min(l,h),w=Math.max(m-y,0)*Math.max(_-x,0);return w/(d+p-w)}function Gge(n,e,t){var r=Math.exp(e*t*t);return t<=n?r:0}function L5(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}function $H(n,e,t){var r=new Array(n.rank).fill(0),i=n.shape.slice();return e.map(function(s){i[t]=s;var o=n.slice(r,i);return r[t]+=s,o})}function qH(n,e){for(var t=new Array(n.rank),r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];var i=jt(t,n.dtype);for(r=0;r<i.values.length;++r){for(var s=i.indexToLoc(r),o=new Array(n.rank),a=0;a<o.length;a++)o[a]=s[a]%n.shape[a];var l=n.locToIndex(o);i.values[r]=n.values[l]}return i.toTensor()}function YH(n,e,t,r,i){for(var s=e[e.length-1],o=[n.length/s,s],a=o[0],l=o[1],u=Ev(t,a*r),c=Ev("int32",a*r),f=0;f<a;f++){for(var h=f*l,d=n.subarray(h,h+l),p=[],y=0;y<d.length;y++)p.push({value:d[y],index:y});p.sort(function(b,S){return S.value-b.value});var x=f*r,m=u.subarray(x,x+r),_=c.subarray(x,x+r);for(y=0;y<r;y++)m[y]=p[y].value,_[y]=p[y].index}var w=e.slice();return w[w.length-1]=r,[Di(u,w,t),Di(c,w,"int32")]}function v4(n,e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(r);var i=jt(n,"int32"),s=jt([t.length,n.length],"int32");for(r=0;r<t.length;r++){var o=i.indexToLoc(t[r]),a=r*n.length;s.values.set(o,a)}return s.toTensor()}var jge=function(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map(function(i,s){return"T"+s});var t=[];this.variableNames.forEach(function(i){t.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},Xge=function(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map(function(i,s){return"T"+s});var t=[];this.variableNames.forEach(function(i){t.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},$ge=function(n,e,t){this.variableNames=["A"];var r=n.windowSize,i=n.batchSize,s=n.inSize,o=Math.ceil(s/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var a=e==="max"?">":"<",l=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+l+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+a+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function KH(n,e){return["x","y","z","w","u","v"].slice(0,e).map(function(t){return n+"."+t})}function Bs(n,e){return e===1?[n]:KH(n,e)}function ns(){var n,e,t,r,i,s,o,a,l,u;return Fe().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",s="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}function Zf(n,e,t){t===void 0&&(t="index");var r=El(e);return r.map(function(i,s){return"int "+n[s]+" = "+t+" / "+i+"; "+(s===r.length-1?"int "+n[s+1]+" = "+t+" - "+n[s]+" * "+i:"index -= "+n[s]+" * "+i)+";"}).join("")}function y4(n){var e=El(n).map(function(t){return t.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var ZH=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function qge(n,e,t,r){var i=[];n.forEach(function(d){var p=bt(d.shapeInfo.logicalShape);d.shapeInfo.isUniform?i.push("uniform float "+d.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+d.name+";"),i.push("uniform int offset"+d.name+";"))});var s,o,a=i.join(`
`),l=n.map(function(d){return function(p,y,x){x===void 0&&(x=!1);var m="";m+=x?JH(p):zd(p);var _=p.shapeInfo.logicalShape,w=y.logicalShape;return _.length<=w.length&&(m+=x?function(b,S){var M,T=b.name,P=T.charAt(0).toUpperCase()+T.slice(1),C="get"+P+"AtOutCoords",A=b.shapeInfo.logicalShape.length,k=S.logicalShape.length,L=cc(b.shapeInfo.logicalShape,S.logicalShape),H=qn(k),F=k-A,V=["x","y","z","w","u","v"];M=A===0?"":k<2&&L.length>=1?"coords = 0;":L.map(function(ee){return"coords."+V[ee+F]+" = 0;"}).join(`
`);var W="";W=k<2&&A>0?"coords":b.shapeInfo.logicalShape.map(function(ee,te){return"coords."+V[te+F]}).join(", ");var G="return outputValue;",N=bt(b.shapeInfo.logicalShape)===1,B=bt(S.logicalShape)===1;if(A!==1||N||B){if(N&&!B)G=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(L.length){var D=A-2,$=A-1;L.indexOf(D)>-1&&L.indexOf($)>-1?G="return vec4(outputValue.x);":L.indexOf(D)>-1?G="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":L.indexOf($)>-1&&(G="return vec4(outputValue.xx, outputValue.zz);")}}else G=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+C+`() {
      `+H+` coords = getOutputCoords();
      `+M+`
      vec4 outputValue = get`+P+"("+W+`);
      `+G+`
    }
  `}(p,y):function(b,S){var M=b.name,T=M.charAt(0).toUpperCase()+M.slice(1),P="get"+T+"AtOutCoords",C=S.texShape,A=b.shapeInfo.texShape,k=b.shapeInfo.logicalShape.length,L=S.logicalShape.length;if(!b.shapeInfo.isUniform&&k===L&&b.shapeInfo.flatOffset==null&&bi(A,C))return`
      float `+P+`() {
        return sampleTexture(`+M+`, resultUV);
      }
    `;var H,F=qn(L),V=cc(b.shapeInfo.logicalShape,S.logicalShape),W=L-k,G=["x","y","z","w","u","v"];H=k===0?"":L<2&&V.length>=1?"coords = 0;":V.map(function(B){return"coords."+G[B+W]+" = 0;"}).join(`
`);var N="";return N=L<2&&k>0?"coords":b.shapeInfo.logicalShape.map(function(B,D){return"coords."+G[D+W]}).join(", "),`
    float `+P+`() {
      `+F+` coords = getOutputCoords();
      `+H+`
      return get`+T+"("+N+`);
    }
  `}(p,y)),m}(d,e,r)}).join(`
`),u=e.texShape,c=ns(),f=function(d){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+d.texture2D+`(textureSampler, uv).r;
    }
  `}(c),h=function(d){return d.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+d.varyingFs+` vec2 resultUV;
    `+d.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+d.defineSpecialNaN+`
    `+d.defineSpecialInf+`
    `+d.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+Yge+`
    `+Kge+`
    `+Zge+`
  `}(c);return e.isPacked?(s=function(d,p){switch(d.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(b,S){var M=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];return M[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+M[1]+`.0);
      }
    `:M[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+M[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+M[0]+", "+M[1]+`));
      return 2 * (resTexRC.x * `+M[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(b,S){var M=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];if(bi(b,S))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+M[0]+", "+M[1]+`));
      }
    `;var T=Math.ceil(b[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+M[0]+", "+M[1]+`));

      int index = resTexRC.x * `+M[1]+` + resTexRC.y;
      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec2(r, c);
    }
  `}(d,p);case 3:return y=d,x=p,m=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)],_=Math.ceil(y[2]/2),w=_*Math.ceil(y[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+w+`;
      index -= b * `+w+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(b,S){for(var M=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],T=Math.ceil(b[b.length-1]/2),P=T*Math.ceil(b[b.length-2]/2),C=P,A="",k="b, r, c",L=2;L<b.length-1;L++)C*=b[b.length-L-1],A=`
      int b`+L+" = index / "+C+`;
      index -= b`+L+" * "+C+`;
    `+A,k="b"+L+", "+k;return`
    ivec`+b.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+M[0]+", "+M[1]+`));
      int index = resTexRC.x * `+M[1]+` + resTexRC.y;

      `+A+`

      int b = index / `+P+`;
      index -= b * `+P+`;

      int r = 2 * (index / `+T+`);
      int c = imod(index, `+T+`) * 2;

      return ivec`+b.length+"("+k+`);
    }
  `}(d,p)}var y,x,m,_,w}(e.logicalShape,u),o=function(d){return`
    void setOutput(vec4 val) {
      `+d.output+` = val;
    }
  `}(c)):(s=function(d,p){switch(d.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,_){return _[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return resTexRC.x * `+_[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(m,_){return bi(m,_)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(d,p);case 3:return y=p,x=Zf(["r","c","d"],d),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,_){var w=Zf(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      `+w+`
      return ivec4(r, c, d, d2);
    }
  `}(d,p);case 5:return function(m,_){var w=Zf(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+_[0]+`,
                             `+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+w+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(d,p);case 6:return function(m,_){var w=Zf(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+w+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(d,p);default:throw new Error(d.length+"-D output sampling is not yet supported")}var y,x}(e.logicalShape,u),o=function(d){return`
    void setOutput(float val) {
      `+d.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(h+=Jge),[h,f,o,a,s,l,t].join(`
`)}function zd(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var s=t.shapeInfo.texShape,o=s[0],a=s[1];if(o===1&&a===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=t.shapeInfo.texShape,u=l[0],c=l[1],f=Mf(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+u+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 1:return function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Pd(t)+`
      }
    `;var s=t.shapeInfo.texShape,o=s[0],a=s[1];if(a===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var l=Mf(r);return a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+l+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+l+") + 0.5) / "+a+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+a+", index + "+l+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 2:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=t.shapeInfo.texShape;if(o!=null&&bi(r,o)){var a=o[0],l=o[1];return`
    float `+s+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+l+".0, "+a+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var u=Bf(r),c=u.newShape,f=u.keptDims,h=c;if(h.length<r.length){var d=Vd(t,h);return`
      `+zd(d)+`
      float `+s+`(int row, int col) {
        return `+s+"("+Wd(["row","col"],f)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+s+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Pd(t)+`
      }
    `;var p=o[0],y=o[1],x=Mf(i);return y===1?`
    float `+s+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+s+`(int row, int col) {
      float index = dot(vec3(row, col, `+x+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+y+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+s+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+x+`;
    vec2 uv = uvFromFlat(`+p+", "+y+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(n);case 3:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],a=r[2],l=Bf(r),u=l.newShape,c=l.keptDims,f=u;if(f.length<r.length){var h=Vd(t,f);return`
        `+zd(h)+`
        float `+s+`(int row, int col, int depth) {
          return `+s+"("+Wd(["row","col","depth"],c)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+s+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+a+`, 1)));
        `+Pd(t)+`
      }
    `;var d=t.shapeInfo.texShape,p=d[0],y=d[1],x=t.shapeInfo.flatOffset;if(y===o&&x==null)return`
        float `+s+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+a+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+y+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(y===a&&x==null)return`
    float `+s+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+y+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var m=Mf(i);return`
      float `+s+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+a+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+p+", "+y+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(n);case 4:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],a=r[2]*o,l=r[1]*a,u=Bf(r),c=u.newShape,f=u.keptDims;if(c.length<r.length){var h=Vd(t,c);return`
      `+zd(h)+`
      float `+s+`(int row, int col, int depth, int depth2) {
        return `+s+"("+Wd(["row","col","depth","depth2"],f)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+s+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+l+", "+a+", "+o+`, 1)));
        `+Pd(t)+`
      }
    `;var d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,y=p[0],x=p[1];if(x===l&&d==null)return`
      float `+s+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+a+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+y+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(x===o&&d==null)return`
      float `+s+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+y+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var m=Mf(i);return`
    float `+s+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+a+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+y+", "+x+", index + "+m+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);case 5:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],a=r[3]*o,l=r[2]*a,u=r[1]*l,c=Bf(r),f=c.newShape,h=c.keptDims;if(f.length<r.length){var d=Vd(t,f);return`
      `+zd(d)+`
      float `+s+`(int row, int col, int depth, int depth2, int depth3) {
        return `+s+"("+Wd(["row","col","depth","depth2","depth3"],h)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+s+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+u+", "+l+", "+a+", "+o+`)) +
          depth3;
        `+Pd(t)+`
      }
    `;var p=t.shapeInfo.flatOffset,y=t.shapeInfo.texShape,x=y[0],m=y[1];if(m===u&&p==null)return`
      float `+s+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+l+", "+a+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&p==null)return`
      float `+s+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+x+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var _=Mf(i);return`
    float `+s+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+l+" + depth * "+a+` +
          depth2 * `+o+" + depth3 + "+_+`;
      vec2 uv = uvFromFlat(`+x+", "+m+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);case 6:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Bf(r),a=o.newShape,l=o.keptDims;if(a.length<r.length){var u=Vd(t,a);return`
      `+zd(u)+`
      float `+s+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+s+"("+Wd(["row","col","depth","depth2","depth3","depth4"],l)+`);
      }
    `}var c=r[5],f=r[4]*c,h=r[3]*f,d=r[2]*h,p=r[1]*d;if(t.shapeInfo.isUniform)return`
      float `+s+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+d+", "+h+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Pd(t)+`
      }
    `;var y=t.shapeInfo.flatOffset,x=t.shapeInfo.texShape,m=x[0],_=x[1];if(_===p&&y==null)return`
      float `+s+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+d+", "+h+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(_===c&&y==null)return`
      float `+s+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var w=Mf(i);return`
    float `+s+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+d+" + depth * "+h+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+w+`;
      vec2 uv = uvFromFlat(`+m+", "+_+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function JH(n){var e,t,r;switch(n.shapeInfo.logicalShape.length){case 0:return e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ns(),`
    vec4 `+t+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(i){var s=i.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),a=i.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=ns();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+l[0]+", "+l[1]+`, index);
      return `+u.texture2D+"("+s+`, uv);
    }
  `}(n);case 2:return function(i){var s=i.shapeInfo.logicalShape,o=i.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),l=i.shapeInfo.texShape,u=l[0],c=l[1],f=ns();if(l!=null&&bi(s,l))return`
      vec4 `+a+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+u+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var h=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=Math.ceil(s[1]/2);return`
    vec4 `+a+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+d+", "+h[0]+", "+h[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(n);case 3:return function(i){var s=i.shapeInfo.logicalShape,o=i.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),l=i.shapeInfo.texShape,u=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];if(s[0]===1){var c=s.slice(1),f=Vd(i,c);return`
        `+JH(f)+`
        vec4 `+a+`(int b, int row, int col) {
          return `+a+"("+Wd(["b","row","col"],[1,2])+`);
        }
      `}var h=u[0],d=u[1],p=Math.ceil(s[2]/2),y=p*Math.ceil(s[1]/2),x=ns();return`
    vec4 `+a+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+h+", "+d+", "+y+", "+p+`, b, row, col);
      return `+x.texture2D+"("+o+`, uv);
    }
  `}(n);default:return function(i){for(var s=i.shapeInfo.logicalShape,o=s.length,a=i.name,l="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=c[0],h=c[1],d=Math.ceil(s[o-1]/2),p=d*Math.ceil(s[o-2]/2),y="int b, int row, int col",x="b * "+p+" + (row / 2) * "+d+" + (col / 2)",m=2;m<o-1;m++)y="int b"+m+", "+y,p*=s[o-m-1],x="b"+m+" * "+p+" + "+x;var _=ns();return`
    vec4 `+l+"("+y+`) {
      int index = `+x+`;
      int texR = index / `+h+`;
      int texC = index - texR * `+h+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+h+", "+f+`);
      return `+_.texture2D+"("+a+`, uv);
    }
  `}(n)}}var Yge=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Kge=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Zge=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Jge=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Mf(n){return"offset"+n}function Pd(n){var e=n.name,t=bt(n.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function qn(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function Vd(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function Wd(n,e){return e.map(function(t){return n[t]}).join(", ")}var Qge=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Z(n.length>2,function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."});var i=n[n.length-1],s=Math.ceil(i/e);this.outputShape=n.slice(0,-1),s>1&&this.outputShape.push(s),r||this.variableNames.push("bestIndicesA");var o,a,l=this.outputShape,u=l.length,c=qn(u),f=Bs("coords",u);if(s===1){var h=qn(a=u+1);o=`
        `+h+" sourceLocR = "+h+"("+f.join()+`, 0);
        ++`+f[u-1]+`;
        `+h+" sourceLocG = "+h+"("+f.join()+`, 0);
        ++`+f[u-2]+`;
        `+h+" sourceLocA = "+h+"("+f.join()+`, 0);
        --`+f[u-1]+`;
        `+h+" sourceLocB = "+h+"("+f.join()+`, 0);
        --`+f[u-2]+";"}else a=u,o=`
        `+c+` sourceLocR = coords;
        ++`+f[u-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[u-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[u-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[u-2]+";";var d=["x","y","z","w","u","v"].slice(0,a),p="."+d[a-1],y=d.map(function(P){return"int "+P}),x=Bs("sourceLocR",a-1).concat("inIdx.r"),m=Bs("sourceLocG",a-1).concat("inIdx.g"),_=Bs("sourceLocB",a-1).concat("inIdx.b"),w=Bs("sourceLocA",a-1).concat("inIdx.a"),b=t==="max"?"greaterThan":"lessThan",S=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+w.join()+")));",M=`vec4(
            getAChannel(`+x.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+_.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+w.join()+") : 0.)",T=r?"":`
      float getBestIndicesAChannel(`+y.join()+`) {
        return getChannel(getBestIndicesA(`+d.join()+`),
                                          vec2(`+d.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+y.join()+`) {
        return getChannel(getA(`+d.join()+`),
                               vec2(`+d.slice(-2).join()+`));
      }
      `+T+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[u-1]+" < "+(l[u-1]-1)+`;
        bool hasNextRow = `+f[u-2]+" < "+(l[u-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+M+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+S+`
          vec4 candidate = `+M+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+b+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},eve=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,s=n.dilationHeight,o=n.dilationWidth,a=n.effectiveFilterHeight,l=n.effectiveFilterWidth,u=a-1-n.padInfo.top,c=l-1-n.padInfo.left,f=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
            wR += `+s+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+l+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},tve=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,s=n.strideHeight,o=n.strideWidth,a=n.dilationDepth,l=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterDepth,f=n.effectiveFilterHeight,h=n.effectiveFilterWidth,d=c-1-n.padInfo.front,p=f-1-n.padInfo.top,y=h-1-n.padInfo.left,x=1/(e*t*r);this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+p+", "+y+`);
      const float avgMultiplier = float(`+x+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+l+`) {
            float dyR = float(dyRCorner + wR) / `+s+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+h+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},nve=function(n,e,t,r,i,s){this.outputShape=[],this.variableNames=["x","mean","variance"],fn(n,e),fn(n,t);var o="0.0";r!=null&&(fn(n,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var a="1.0";i!=null&&(fn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+a+`;
        float inv = scale * inversesqrt(variance + float(`+s+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},rve=function(n,e,t,r,i,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],fn(n,e),fn(n,t);var o="vec4(0.0)";r!=null&&(fn(n,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var a="vec4(1.0)";i!=null&&(fn(n,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+a+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+s+`));

        setOutput((x - mean) * inv + offset);
      }
    `},ive="return areal * breal - aimag * bimag;",sve="return areal * bimag + aimag * breal;",F5=function(n,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=fn(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},H3="return a + b;",G3="return a - b;",O5="return a * b;",QH="return (a < 0.) ? b * a : a;",Sr=function(n,e,t){this.variableNames=["A","B"],this.outputShape=fn(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},eG=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Xl=function(n,e,t,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=fn(e,t);var i=this.outputShape.length,s="";if(r)if(i===0||bt(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          `+qn(i)+` coords = getOutputCoords();
        `,i===1)s+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=Bs("coords",i);s+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+s+`

        setOutput(result);
      }
    `},ove=function(){function n(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,s){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(s,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(s,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n}(),ave=function(){function n(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,s){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(s,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(s,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n}(),lve=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},uve=function(n){this.outputShape=[],this.outputShape=am(n,1),this.variableNames=n.map(function(a,l){return"T"+l});var e=new Array(n.length-1);e[0]=n[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+n[t][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var i=e[t-1];r.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+i+"));")}var s=e.length,o=e[e.length-1];r.push("else setOutput(getT"+s+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},cve=function(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=am(n,e);var t=this.outputShape,r=t.length,i=qn(r),s=Bs("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(x,m){return"T"+m});var a=new Array(n.length-1);a[0]=n[0][e];for(var l=1;l<a.length;l++)a[l]=a[l-1]+n[l][e];var u=o[e],c=o.slice(-2),f=o.join(),h="if ("+u+" < "+a[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(l=1;l<a.length;l++){var d=a[l-1];h+=`
        if (`+u+" < "+a[l]+"  && "+u+" >= "+a[l-1]+`) {
          return getChannel(
            getT`+l+"("+zx(o,u,d)+`),
            vec2(`+zx(c,u,d)+`));
        }`}var p=a.length,y=a[a.length-1];h+=`
        return getChannel(
          getT`+p+"("+zx(o,u,y)+`),
          vec2(`+zx(c,u,y)+"));",this.userCode=`
      float getValue(`+o.map(function(x){return"int "+x})+`) {
        `+h+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+s+`), 0., 0., 0.);

        `+s[r-1]+" = "+s[r-1]+` + 1;
        if (`+s[r-1]+" < "+t[r-1]+`) {
          result.g = getValue(`+s+`);
        }

        `+s[r-2]+" = "+s[r-2]+` + 1;
        if (`+s[r-2]+" < "+t[r-2]+`) {
          result.a = getValue(`+s+`);
        }

        `+s[r-1]+" = "+s[r-1]+` - 1;
        if (`+s[r-2]+" < "+t[r-2]+` &&
            `+s[r-1]+" < "+t[r-1]+`) {
          result.b = getValue(`+s+`);
        }
        setOutput(result);
      }
    `};function zx(n,e,t){var r=n.indexOf(e);return n.map(function(i,s){return s===r?i+" - "+t:i}).join()}var fve=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,s=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+s+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},hve=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,s=n.dataFormat==="channelsLast",o=e-1-n.padInfo.top,a=t-1-n.padInfo.left,l=s?1:2,u=s?2:3,c=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+l+"], coords["+u+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+s+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},dve=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.padInfo.front,s=n.padInfo.top,o=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+i+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+s+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},pve=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,s=n.strideHeight,o=n.strideWidth,a=e-1-n.padInfo.front,l=t-1-n.padInfo.top,u=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+a+", "+l+", "+u+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+s+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},mve=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,s=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+s+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},gve=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,s=e-1-n.padInfo.top,o=t-1-n.padInfo.left,a=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+a+`; dm++) {
              int d2 = d1 * `+a+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},B5=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.padInfo.top,s=n.padInfo.left,o=n.strideHeight,a=n.strideWidth,l=n.dilationHeight,u=n.dilationWidth,c=n.filterHeight,f=n.filterWidth,h=4*Math.floor(n.inChannels/4),d=n.inChannels%4,p=n.dataFormat==="channelsLast",y=p?1:2,x=p?2:3,m=p?3:1,_="",w="";t&&(_=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,w="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+_+`

      const ivec2 strides = ivec2(`+o+", "+a+`);
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+y+"], coords["+x+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+l+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+u+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+h+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(d===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+h+`) *
                    getW(wR, wC, `+h+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+h+`, xR, xC) *
                    getW(wR, wC, `+h+`, d2);
              }

            } else if (`+(d===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+h+`, d2),
                getW(wR, wC, `+h+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+h+`),
                  getX(batch, xR, xC, `+h+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+h+`, xR, xC),
                  getX(batch, `+h+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(d===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+h+`, d2),
                getW(wR, wC, `+h+` + 1, d2),
                getW(wR, wC, `+h+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+h+`),
                  getX(batch, xR, xC, `+h+` + 1),
                  getX(batch, xR, xC, `+h+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+h+`, xR, xC),
                  getX(batch, `+h+` + 1, xR, xC),
                  getX(batch, `+h+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+b+`
        `+w+`
        setOutput(result);
      }
    `},vve=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.front,t=n.padInfo.top,r=n.padInfo.left,i=n.strideDepth,s=n.strideHeight,o=n.strideWidth,a=n.dilationDepth,l=n.dilationHeight,u=n.dilationWidth,c=n.filterDepth,f=n.filterHeight,h=n.filterWidth,d=4*Math.floor(n.inChannels/4),p=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+s+", "+o+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+a+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+l+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+h+`; wC++) {
              int xC = xCCorner + wC * `+u+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+d+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+d+`) *
                  getW(wF, wR, wC, `+d+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+d+`),
                  getX(batch, xF, xR, xC, `+d+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+d+`, d2),
                  getW(wF, wR, wC, `+d+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+d+`),
                  getX(batch, xF, xR, xC, `+d+` + 1),
                  getX(batch, xF, xR, xC, `+d+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+d+`, d2),
                  getW(wF, wR, wC, `+d+` + 1, d2),
                  getW(wF, wR, wC, `+d+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},U5=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.inHeight,s=n.inWidth,o=n.padInfo.top,a=n.padInfo.left,l=n.strideHeight,u=n.strideWidth,c=n.dilationHeight,f=n.dilationWidth,h=n.filterHeight,d=n.filterWidth,p=n.outChannels/n.inChannels,y="",x="";t&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,x="result = activation(result);");var m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+l+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+h+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+s+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+x+`
        setOutput(result);
      }
    `},z5=function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var i=n.inHeight,s=n.inWidth,o=n.padInfo.top,a=n.padInfo.left,l=n.strideHeight,u=n.strideWidth,c=n.dilationHeight,f=n.dilationWidth,h=n.filterHeight,d=n.filterWidth,p=d,y="int xR; int xC; int xCOffset;",x=0;x<h;x++)for(var m=0;m<d;m++)y+=`
          vec4 xTexelR`+x+"C"+2*m+` = vec4(0.);
          vec4 wR`+x+"C"+m+` = vec4(0.);
          vec4 xR`+x+"C"+m+" = vec4(0.);";for(x=0;x<h;x++)for(var _=0;_<p;_++){if(y+=`
          xR = xRCorner + `+x*c+`;
          xC = xCCorner + `+(m=2*_)*f+`;
        `,u===1){if(m<d&&(y+=a%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+s+`) {
                  xTexelR`+x+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+s+`) {
                    xTexelR`+x+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+x+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+s+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+s+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+x+"C"+m+" = vec4(previous.zw, xTexelR"+x+"C"+m+`.xy);
                } else {
                  xR`+x+"C"+m+" = vec4(0, 0, xTexelR"+x+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+s+`) {
                  xTexelR`+x+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+m+` = vec4(0.);
                }

                xR`+x+"C"+m+" = xTexelR"+x+"C"+m+`;
              `,m+1<d)){var w=a%2==0?yH(f):f;f%2==0&&a%2==1||f%2!=0&&a%2!=1?(y+=`
                  xCOffset = xC + `+a%2+" + "+w+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+s+`) {
                    xTexelR`+x+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(y+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+s+`) {
                      xTexelR`+x+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+x+"C"+m+` = vec4(0.);
                    }
                  `),y+=`
                  xR`+x+"C"+(m+1)+` = vec4(
                    xTexelR`+x+"C"+m+".zw, xTexelR"+x+"C"+(m+2)+`.xy);
                `):y+=`
                  xCOffset = xC + `+w+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+s+`) {
                    xTexelR`+x+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+x+"C"+(m+1)+" = xTexelR"+x+"C"+(m+2)+`;
                `}}else m<d&&(y+=`
              if(xR >= 0 && xR < `+i+`) {
            `,a%2==1?(y+=`
                xCOffset = xC + 1 - `+u+`;
                if(xCOffset >= 0 && xCOffset < `+s+`) {
                  xTexelR`+x+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+s+`) {
                  xTexelR`+x+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+x+"C"+(m+2)+` = vec4(0.);
                }

                xR`+x+"C"+m+` = vec4(
                  xTexelR`+x+"C"+m+".zw, xTexelR"+x+"C"+(m+2)+`.zw);
              `,m+1<d&&(y+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+u+`;
                  if(xCOffset >= 0 && xCOffset < `+s+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+x+"C"+(m+1)+" = vec4(xTexelR"+x+"C"+(m+2)+`.xy, final.xy);
                `)):(y+=`
                if(xC >= 0 && xC < `+s+`) {
                  xTexelR`+x+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+x+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+u+`;
                if(xCOffset >= 0 && xCOffset < `+s+`) {
                  xTexelR`+x+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+x+"C"+(m+2)+` = vec4(0.);
                }

                xR`+x+"C"+m+` = vec4(
                  xTexelR`+x+"C"+m+".xy, xTexelR"+x+"C"+(m+2)+`.xy);
              `,m+1<d&&(y+=`
                  xR`+x+"C"+(m+1)+` = vec4(
                    xTexelR`+x+"C"+m+".zw, xTexelR"+x+"C"+(m+2)+`.zw);
                `)),y+="}");m<d&&(y+=`
            vec4 wTexelR`+x+"C"+m+" = getW("+x+", "+m+`, d1, q);
            wR`+x+"C"+m+" = vec4(wTexelR"+x+"C"+m+".xz, wTexelR"+x+"C"+m+`.xz);
          `,m+1<d&&(y+=`
              vec4 wTexelR`+x+"C"+(m+1)+" = getW("+x+", "+(m+1)+`, d1, q);
              wR`+x+"C"+(m+1)+` =
                vec4(wTexelR`+x+"C"+(m+1)+".xz, wTexelR"+x+"C"+(m+1)+".xz);"))}for(x=0;x<h;x++)for(m=0;m<d;m++)y+="dotProd += xR"+x+"C"+m+" * wR"+x+"C"+m+";";var b="",S="";t&&(b=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,S="result = activation(result);");var M=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+b+`

      const ivec2 strides = ivec2(`+l+", "+u+`);
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+y+`

        vec4 result = dotProd;
        `+M+`
        `+S+`
        setOutput(result);
      }
    `},yve=function(n,e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var s=n[0],o=n[1],a=n[2],l=n[3],u=e[0],c=t[0],f=t[1];this.outputShape=[u,c,f,l];var h=r==="bilinear"?1:0,d=[o-1+".0",a-1+".0"],p=d[0],y=d[1],x=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],m=x[0],_=x[1],w=x[2],b=f>1?[""+(a-1)/(f-1),"(x2-x1) * width_ratio","x1*"+y+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+y],S=b[0],M=b[1],T=b[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+S+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+s+`) {
          return;
        }

        float height_scale = `+_+`;
        float width_scale = `+M+`;

        float in_y = `+w+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+T+`;
        if( in_x < 0.0 || in_x > `+y+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+h+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},xve=function(n,e,t){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=n[n.length-1],s=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+qn(r)+` coords = getOutputCoords();
        int end = `+V5(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+s+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+V5(r,"coords")+` = idx;
          val += getX(`+function(o,a){if(o===1)return""+a;if(o===2)return a+".x, "+a+".y";if(o===3)return a+".x, "+a+".y, "+a+".z";if(o===4)return a+".x, "+a+".y, "+a+".z, "+a+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function V5(n,e){if(n===1)return""+e;if(n===2)return e+".y";if(n===3)return e+".z";if(n===4)return e+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var _ve=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Tv.DENSE;var e=xg(n),t=ns();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zf(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `},wve=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Tv.DENSE;var e=xg(n),t=ns();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Zf(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `},bve=function(){function n(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),Sve=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},Eve=function(n){this.variableNames=["A"],this.outTexUsage=So.DOWNLOAD;var e=ns();this.outputShape=n,this.userCode=`
      `+ZH+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},Mve=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=So.DOWNLOAD;var e=ns();this.outputShape=n,this.userCode=`
      `+ZH+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},Tve=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var r=ns(),i=e[0],s=e[1];this.outputShape=n;var o="result";t&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+y4(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+s+`;
        int c = imod(flatIndex, `+s+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+s+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},Cve=function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=ns(),i=e[0],s=e[1];this.outputShape=n;var o="",a="result";t&&(a="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var u=0;u<=1;u++){var c=2*l+u;o+=`
          localCoords = coords;
          if(localCoords[2] + `+u+" < "+n[2]+`) {
            localCoords[2] += `+u+`;
            if(localCoords[1] + `+l+" < "+n[1]+`) {
              localCoords[1] += `+l+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+s+`;
              c = imod(flatIndex, `+s+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+s+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+y4(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+a+`;
      }
    `},Ave="return real * expR - imag * expI;",Rve="return real * expI + imag * expR;",W5=function(n,e,t){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,s=t?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+s+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},Pve=function(){function n(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.valueLoc==null&&(t.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(t.valueLoc,e)}},n}(),Ive=function(n,e,t){this.variableNames=["A","indices"];var r=n.slice();r[t]=e,this.outputShape=r,this.rank=r.length;var i=qn(this.rank),s=function(o,a){var l=o.length;if(l>4)throw Error("Gather for rank "+l+" is not yet supported");if(l===1)return"int(getIndices(resRC))";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===a?c.push("int(getIndices("+u[f]+"))"):c.push(""+u[f]);return c.join()}(n,t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+s+`));
      }
    `},Dve=function(n,e,t){this.sliceDim=n,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var r=qn(e.length),i=qn(t.length),s=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+s+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function Nve(n,e){var t=ns();return A0e(n,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function kve(n,e){return N0e(n,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Lve(n,e){return k0e(n,e,new Uint16Array([0,1,2,2,1,3]))}function oy(n,e,t,r,i,s,o){F0e(t,r);var a=L0e(n,e),l=n.TEXTURE_2D;return Mt(n,e,function(){return n.bindTexture(l,a)}),Mt(n,e,function(){return n.texParameteri(l,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),Mt(n,e,function(){return n.texParameteri(l,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),Mt(n,e,function(){return n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.NEAREST)}),Mt(n,e,function(){return n.texParameteri(l,n.TEXTURE_MAG_FILTER,n.NEAREST)}),Mt(n,e,function(){return n.texImage2D(l,0,i,t,r,0,s,o,null)}),Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)}),a}function Fve(n,e,t,r,i){var s=ab(t,r);return oy(n,e,s[0],s[1],i.internalFormatFloat,i.textureFormatFloat,n.FLOAT)}function Ove(n,e,t,r,i){var s=ab(t,r);return oy(n,e,s[0],s[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function Bve(n,e,t,r,i){var s=ab(t,r);return oy(n,e,s[0],s[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function Uve(n,e,t,r,i){var s=sy(t,r);return oy(n,e,s[0],s[1],i.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function zve(n,e,t,r,i){var s=sy(t,r);return oy(n,e,s[0],s[1],i.internalFormatPackedHalfFloat,n.RGBA,i.textureTypeHalfFloat)}function Vve(n,e,t,r){return Mt(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),R5(n,e,t,"clipSpacePos",r,3,20,0)&&R5(n,e,t,"uv",r,2,20,12)}function Wve(n,e,t,r,i,s,o){var a,l,u;Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)}),s instanceof Uint8Array?(a=new Uint8Array(r*i*4),l=n.UNSIGNED_BYTE,u=n.RGBA):(a=new Float32Array(r*i*4),l=n.FLOAT,u=o.internalFormatPackedFloat),a.set(s),Mt(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,u,r,i,0,n.RGBA,l,a)}),Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function Hve(n,e,t,r){Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)}),r.data instanceof Uint8Array?Mt(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):Mt(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),Mt(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function Gve(n,e,t,r,i){var s=n.createBuffer();Mt(n,e,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,s)});var o=16*t*r;return Mt(n,e,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)}),Mt(n,e,function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,0)}),Mt(n,e,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),s}function jve(n,e,t){var r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function Xve(n,e,t,r,i){var s=ab(t,r),o=s[0],a=s[1],l=new Uint8Array(t*r*4);return Mt(n,e,function(){return n.readPixels(0,0,o,a,i.downloadTextureFormat,n.UNSIGNED_BYTE,l)}),new Float32Array(l.buffer)}function $ve(n,e,t,r,i,s,o,a){var l=n,u=new Float32Array(function(c,f){var h=sy(c,f);return h[0]*h[1]*4}(s,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function qve(n,e,t,r){var i=new Float32Array(t*r*4);return Mt(n,e,function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,i)}),i}var Yve=function(){function n(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=Fe().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,S0e(t,e)):this.gl=Rl(t);var r="WEBGL_color_buffer_float";if(Fe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Fx(this.gl,this.debug,"OES_texture_float"),sa(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Fx(this.gl,this.debug,"OES_texture_half_float");else if(Fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),sa(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Fx(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",sa(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!sa(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=kve(this.gl,this.debug),this.indexBuffer=Lve(this.gl,this.debug),this.framebuffer=O0e(this.gl,this.debug),this.textureConfig=l4(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return Fe().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Mt(t,this.debug,function(){return t.finish()}),Mt(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),Mt(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),Mt(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),Mt(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),Mt(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Fve(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),Ove(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),Bve(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),Hve(this.gl,this.debug,e,t)},n.prototype.uploadDenseMatrixToTexture=function(e,t,r,i){this.throwIfDisposed(),Wve(this.gl,this.debug,e,t,r,i,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),zve(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Uve(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(P5(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Mt(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,function(){return Xve(i.gl,i.debug,t,r,i.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(e,t,r,i,s,o){return $ve(this.gl,e,0,0,0,s,o,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return jve(this.gl,e,t)},n.prototype.createBufferFromTexture=function(e,t,r){this.bindTextureToFrameBuffer(e);var i=Gve(this.gl,this.debug,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},n.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},n.prototype.createFence=function(e){var t,r,i=this;if(Fe().getBool("WEBGL_FENCE_API_ENABLED")){var s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var a=s.clientWaitSync(o,0,0);return a===s.ALREADY_SIGNALED||a===s.CONDITION_SATISFIED},t=o}else Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(t,Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,function(){return qve(i.gl,i.debug,t,r)})},n.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,r=R0e(t,this.debug,e),i=Nve(t,this.debug),s=I0e(t,this.debug);return Mt(t,this.debug,function(){return t.attachShader(s,i)}),Mt(t,this.debug,function(){return t.attachShader(s,r)}),D0e(t,this.debug,s),this.debug&&U3(t,this.debug,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=Vve(t,this.debug,this.program,this.vertexBuffer)),s},n.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Mt(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},n.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&U3(this.gl,this.debug,this.program),Mt(this.gl,this.debug,function(){return t.gl.useProgram(e)})},n.prototype.getUniformLocation=function(e,t,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?U0e(this.gl,this.debug,e,t):z0e(this.gl,e,t)},n.prototype.getAttributeLocation=function(e,t){var r=this;return this.throwIfDisposed(),Mt(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,t)})},n.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},n.prototype.setInputMatrixTexture=function(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),V0e(this.gl,this.debug,this.program,e,t,r)},n.prototype.setOutputMatrixTexture=function(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)},n.prototype.setOutputPackedMatrixTexture=function(e,t,r){this.throwIfDisposed();var i=sy(t,r),s=i[0],o=i[1];this.setOutputMatrixTextureDriver(e,s,o)},n.prototype.setOutputMatrixWriteRegion=function(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)},n.prototype.setOutputPackedMatrixWriteRegion=function(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&U3(this.gl,this.debug,this.program),Ox(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Mt(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Mt(this.gl,this.debug,function(){return e.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Fx(this.gl,this.debug,Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),s=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,s),s},n.prototype.endQuery=function(){if(Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(e){return vt(this,void 0,void 0,function(){var t=this;return yt(this,function(r){switch(r.label){case 0:return[4,S5(function(){return t.disposed||t.isQueryAvailable(e,Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}return s=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint},n.prototype.pollFence=function(e){var t=this;return new Promise(function(r){t.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var e=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},n.prototype.addItemToPoll=function(e,t){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||S5(function(){return r.pollItems(),r.itemsToPoll.length===0})},n.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),z3(this.gl,this.debug,e,this.framebuffer),this.debug&&Ox(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(z3(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Ox(this.gl)):P5(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var r=t();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(e,t,r){this.throwIfDisposed();var i=this.gl;z3(i,this.debug,e,this.framebuffer),this.debug&&Ox(i),this.outputTexture=e,Mt(i,this.debug,function(){return i.viewport(0,0,t,r)}),Mt(i,this.debug,function(){return i.scissor(0,0,t,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(e,t,r,i){var s=this;this.throwIfDisposed(),Mt(this.gl,this.debug,function(){return s.gl.scissor(e,t,r,i)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n}();function H5(n,e){if(n.length!==e.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+e.length+" inputs");n.forEach(function(t,r){var i=t.logicalShape,s=e[r],o=s.shape;if(!bi(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!t.isUniform||!s.isUniform){var a=t.texShape,l=s.isUniform?null:s.texData.texShape;if(!bi(a,l))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+l+" must match")}})}var Kve=function(n,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=t.filterWidth,i=t.inChannels,s=t.strideWidth,o=t.strideHeight,a=t.padInfo,l=t.outWidth,u=t.dilationWidth,c=t.dilationHeight,f=t.dataFormat,h=a.left,d=a.top,p=i*r,y=ns(),x=f==="channelsLast",m=x?0:1,_=x?1:2,w="",b=0;b<=1;b++)for(var S=0;S<=1;S++)w+=`
          blockIndex = rc.y + `+S+`;
          pos = rc.x + `+b+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+l+")) * "+o+" - "+d+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+e[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+l+".) * "+s+". - "+h+`.);
              d1 = offsetX + `+u+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+e[_]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+x+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*b+S)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*b+S)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+w+`

        `+y.output+` = result;
      }
    `},Zve=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[];var s,o=e,a=n[3]-1;this.outputShape=n;var l="float("+t+") + float("+r+") * sum";s=i===.5?"inversesqrt("+l+")":i===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+a+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+s+`;
        setOutput(val);
      }
    `},Jve=function(n,e,t,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=t,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Qve=function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var s,o=e,a=n[3]-1;this.outputShape=n;var l="float("+t+") + float("+r+") * sum";s=i===.5?"inversesqrt("+l+")":i===1?"1.0/("+l+")":"exp(log("+l+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+a+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+s+`;
        setOutput(result);
      }
    `},eye=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideHeight,t=n.strideWidth,r=n.dilationHeight,i=n.effectiveFilterHeight,s=n.effectiveFilterWidth,o=i-1-n.padInfo.top,a=s-1-n.padInfo.left,l=i*s-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+s+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+l+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+s+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},tye=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.dilationDepth,s=n.dilationHeight,o=n.dilationWidth,a=n.effectiveFilterDepth,l=n.effectiveFilterHeight,u=n.effectiveFilterWidth,c=a-1-n.padInfo.front,f=l-1-n.padInfo.top,h=u-1-n.padInfo.left,d=a*l*u-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+h+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+a+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+l+`;
              wR += `+s+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+u+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+d+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+l+" * "+u+` +
                  wR * `+u+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},j3=function(n,e,t,r,i,s,o){t===void 0&&(t=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),s===void 0&&(s=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var a=t?n[1]:n[2],l=Math.ceil(a/2),u=t?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";s&&(d=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+s+`
        }`:`vec4 activation(vec4 x) {
          `+s+`
        }`,p="result = activation(result);");var y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+d+`

      const float sharedDimension = `+l+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+l+`; i++) {
          vec4 a = getMatrixA(rc.x, `+u+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+h[0]+`);
          result += (`+f[1]+" * "+h[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+y+`

        `+p+`

        setOutput(result);
      }
    `},nye=function(){function n(e,t,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.seedLoc==null&&(t.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(t.seedLoc,e)}},n}(),rye=function(n,e,t,r){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+t+`),
                      float(index == coords.y)));
      }
    `},iye=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var e=n.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=Bs("rc",e),r=qn(e),i=function(a,l,u){if(a===1)return"rc > "+l[0];for(var c="",f=a-2;f<a;f++)c+=u[f]+" >= "+l[f],f<a-1&&(c+="||");return c}(e,n,t),s=function(a,l,u,c){if(a===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+l+`;
    bool rEdge = rp1 >= `+u+`;
  `}(e,n[n.length-1],n[n.length-2],t),o=function(a,l){var u=a.length,c=function(f,h){for(var d=[],p=0;p<=1;p++)for(var y=0;y<=1;y++){for(var x=(p===0?"r":"rp1")+", "+(y===0?"c":"cp1"),m=2;m<f;m++)x=h[h.length-1-m]+","+x;d.push(x)}return d}(u,l);return u===1?`getA(rc),
            rc + 1 >= `+a[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(n,t);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+s+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},sye=function(n,e,t){this.variableNames=["x"],this.outputShape=e.map(function(l,u){return l[0]+n[u]+l[1]});var r=n.length,i=qn(r),s=e.map(function(l){return l[0]}).join(","),o=e.map(function(l,u){return l[0]+n[u]}).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+s+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+a+`));
        }
      }
    `:`
        int start = `+s+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},oye=function(n,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(x,m){return x[0]+n[m]+x[1]});for(var r=n.length,i=qn(r),s=e.map(function(x){return x[0]}).join(","),o=e.map(function(x,m){return x[0]+n[m]}).join(","),a=Bs("rc",r),l=Bs("source",r),u=a[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+l.slice(-2).join()+")",f=[i+" rc = outputLoc;",a[r-1]+` += 1;
       if(`+u+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+a[r-2]+` += 1;
       if(`+a[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+a[r-1]+` += 1;
         if(`+u+") {"],h=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",p=0,y=r===1?2:4;p<y;p++)d+=`
        `+f[p]+`
        if (`+h+`) {
          result[`+p+"] = float("+t+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+l.join()+"), "+c+`);
        }
      `;d+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+s+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+d+`
        setOutput(result);
      }
    `},X3=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideHeight,s=n.strideWidth,o=n.dilationHeight,a=n.dilationWidth,l=n.effectiveFilterHeight,u=n.effectiveFilterWidth,c=n.padInfo.top,f=n.padInfo.left;this.outputShape=n.outShape;var h=e==="avg",d="0.0";if(h||(d="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+s+`);
        const ivec2 pads = ivec2(`+c+", "+f+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+l+`;
              wR += `+o+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+u+`;
                wC += `+a+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+u+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(p="avgValue / count");var y=4*Math.floor(r/4),x=r%4,m=`
      if (`+h+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+s+`);
      const ivec2 pads = ivec2(`+c+", "+f+`);
      const float initializationValue = `+d+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+d+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+l+`;
            wR += `+o+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+y+`; wC += 4) {
            int xC = xCCorner + wC * `+a+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              getValue(batch, xR, xC + 3 * `+a+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+y+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+a+`, d),
              getValue(batch, xR, xC + 2 * `+a+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+p+`);
      }
    `}},$3=function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideDepth,s=n.strideHeight,o=n.strideWidth,a=n.dilationDepth,l=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterDepth,f=n.effectiveFilterHeight,h=n.effectiveFilterWidth,d=n.padInfo.front,p=n.padInfo.top,y=n.padInfo.left;this.outputShape=n.outShape;var x=e==="avg",m="0.0";if(x||(m="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+s+", "+o+`);
        const ivec3 pads = ivec3(`+d+", "+p+", "+y+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+a+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+f+`;
                wR += `+l+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+h+`;
                  wC += `+u+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+f+" * "+h+` +
                      wR * `+h+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var _=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(_="avgValue / count");var w=4*Math.floor(r/4),b=r%4,S=`
      if (`+x+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+s+", "+o+`);
      const ivec3 pads = ivec3(`+d+", "+p+", "+y+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+a+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`;
            wR += `+l+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+u+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+u+`, ch)
              );

              `+S+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(b===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(b===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(b===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+u+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+u+`, ch),
                initializationValue
              );

              `+S+`
            }
          }
          setOutput(`+_+`);
        }
      }
    `}},aye=function(n,e){this.variableNames=["x"];var t=n.windowSize,r=n.batchSize,i=n.inSize,s=Math.ceil(i/t);this.outputShape=[r,s];var o="0.0",a="";e==="prod"?o="1.0":e==="min"?(o="1.0 / 1e-20",a="min"):e==="max"&&(o="-1.0 / 1e-20",a="max");var l=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?l="sumValue":e==="prod"?l="prodValue":e==="all"?l="allValue":e==="any"&&(l="anyValue");var u=4*Math.floor(t/4),c=t%4,f=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+a+`(values, minMaxValue);
      }
    `,h="vec4";e==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):e==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");var d="";i%t>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+u+`; i += 4) {
          int inIdx = inOffset + i;
          `+h+" values = "+h+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+u+`;
        if (`+(c===1)+`) {
          `+h+" values = "+h+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+h+" values = "+h+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+h+" values = "+h+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+l+`);
      }
    `},lye=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var t="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),t+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Zf(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+y4(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+t+`

        setOutput(result);
      }
    `},uye=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],s=r[2],o=n.shape,a=o[1],l=o[2],u=[t&&a>1?i-1:i,t&&l>1?s-1:s],c=[t&&a>1?a-1:a,t&&l>1?l-1:l],f=u[0]/c[0],h=u[1]/c[1],d=1/f,p=1/h,y=2*Math.ceil(d)+2,x=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+h+`);

        const float invHeightScale = float(`+d+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+y+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(s-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},cye=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],s=n[1],o=n[2],a=n[3];this.outputShape=[i,e,t,a];var l=[r&&e>1?s-1:s,r&&t>1?o-1:o],u=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+s+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},fye=function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[0],s=n[1],o=n[2],a=n[3];this.outputShape=[i,e,t,a];var l=[r&&e>1?s-1:s,r&&t>1?o-1:o],u=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`,
          `+l[1]/u[1]+`);
      const vec3 inputShapeRC = vec3(`+s+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(a-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},hye=function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],s=r[2],o=n.shape,a=o[1],l=o[2],u=[t&&a>1?i-1:i,t&&l>1?s-1:s],c=[t&&a>1?a-1:a,t&&l>1?l-1:l],f=u[0]/c[0],h=u[1]/c[1],d=1/f,p=1/h,y=2*Math.ceil(d)+2,x=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+h+`);

        const float invHeightScale = float(`+d+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+y+`);
        const int winWidth = int(`+x+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+a+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+l+`) {
              continue;
            }

            float sourceFracRow =
              float(`+u[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+u[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+s+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},dye=function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],s=n[1],o=n[2],a=n[3];this.outputShape=[i,e,t,a];var l=[r&&e>1?s-1:s,r&&t>1?o-1:o],u=[r&&e>1?e-1:e,r&&t>1?t-1:t],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+l[0]/u[0]+`,
          `+l[1]/u[1]+`);
      const vec2 inputShapeRC = vec2(`+s+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},pye=function(n,e){this.variableNames=["x"];var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=n,t!==1){var r=n.map(function(s,o){return function(a){return e.indexOf(a)!==-1&&n[a]!==1?n[a]+" - coords["+a+"] - 1":"coords["+a+"]"}(o)}).join(","),i=qn(t);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},mye=function(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=n;var r=Bs("rc",t),i=r[t-1]+" + 1 < "+this.outputShape[t-1],s=r[t-2]+" + 1 < "+this.outputShape[t-2],o=qn(t);function a(l){var u=n.map(function(c,f){return function(h,d){return e.indexOf(h)!==-1&&n[h]!==1?n[h]+" - "+d[h]+" - 1":""+d[h]}(f,l)});return"getChannel(getX("+u.join(",")+"), vec2("+u.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(l){return a(l)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(l){return l[t-1]="("+l[t-1]+" + 1)",a(l)}(r.slice())+`;
          }
          if(`+s+`) {
            result.b = `+function(l){return l[t-2]="("+l[t-2]+" + 1)",a(l)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(l){return l[t-1]="("+l[t-1]+" + 1)",l[t-2]="("+l[t-2]+" + 1)",a(l)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},G5=function(n,e,t,r,i,s,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;var a=qn(i.length),l=qn(s.length),u="";t===1?u="i":t===2&&(u="i, j");var c="getIndices("+u+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var h="getUpdates("+f+")",d=e>1?"strides[j]":"strides";this.userCode=`
        `+a+" strides = "+a+"("+i+`);

        void main() {
          `+l+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+d+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+h+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},gye=function(n,e){this.variableNames=["x","segmentIds"];var t=n.windowSize,r=n.batchSize,i=n.inSize,s=n.numSegments,o=s*Math.ceil(i/t);this.outputShape=[r,o];var a=4*Math.floor(t/4),l=t%4,u=`
        sumValue += dot(values, segFilter);
    `,c="";i%t>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%t>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+s+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+s+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+a+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+u+`
        }

        int inIdx = inOffset + `+a+`;
        if (`+(l===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+u+`
        } else if (`+(l===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+u+`
        } else if (`+(l===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+u+`
        }
        setOutput(sumValue);
      }
    `},vye=function(n,e,t){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)i="resRC",r="resRC";else{for(var s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],a=[],l=0;l<e.length;l++)a.push(""+s[l]),l<n&&o.push(""+s[l]);r=o.join(),i=a.join()}var u=qn(t);this.userCode=`
      void main() {
        `+u+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},yye=function(){function n(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,r=qn(this.rank),i="uniform int start["+this.rank+"];",s=function(o){if(o===1)return"sourceLoc";if(o<=6)return q3.slice(0,o).map(function(a){return"sourceLoc."+a}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);t=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(o,a){return"sourceLoc."+q3[a]+" = start["+a+"] + coords."+q3[a]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+t+`
        setOutput(getSource(`+s+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n}(),q3=["x","y","z","w","u","v"],xye=function(){function n(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=qn(this.rank),r=Bs("coords",this.rank),i=Bs("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+s+")",a=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,l=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map(function(c,f){return"start["+f+"]"}).join()+");":e.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+u+`
        vec4 result = vec4(0.);
        `+a+`
        `+l+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n}(),_ye=function(n,e,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=qn(t.length),s=qn(t.length),o="";if(r===1)o="coords * strides + begin";else{var a=0;o=t.map(function(l,u){return a++,t.length===1?"coords * strides["+u+"] + begin["+u+"]":"coords["+(a-1)+"] * strides["+u+"] + begin["+u+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+n+`);
      `+i+" strides = "+i+"("+e+`);

      void main() {
        `+s+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},wye=function(){function n(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(e,t,r){var i,s=j5(t,r),o=X5(e,s,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),s===vo.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===vo.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===vo.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===vo.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===vo.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(i),i},n.prototype.releaseTexture=function(e,t,r,i){if(this.freeTextures!=null){var s=X5(t,j5(r,i),i);s in this.freeTextures||(this.freeTextures[s]=[]),this.freeTextures[s].push(e),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[s],a=o.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(i){e.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function j5(n,e){if(n===So.UPLOAD)return vo.PACKED_2X2_FLOAT32;if(n===So.RENDER||n==null)return function(t){return Fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?vo.PACKED_2X2_FLOAT32:vo.UNPACKED_FLOAT32:t?vo.PACKED_2X2_FLOAT16:vo.UNPACKED_FLOAT16}(e);if(n===So.DOWNLOAD||n===So.PIXELS)return vo.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function X5(n,e,t){return n[0]+"_"+n[1]+"_"+e+"_"+t}var bye=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[r]*e[r];this.outputShape=t,this.rank=t.length;var i=qn(this.rank),s=function(o){var a=o.length;if(a>5)throw Error("Tile for rank "+a+" is not yet supported");if(a===1)return"imod(resRC, "+o[0]+")";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],u=[],c=0;c<o.length;c++)u.push("imod("+l[c]+", "+o[c]+")");return u.join()}(n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+s+`));
      }
    `},Sye=function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];this.outputShape=t,this.rank=t.length;var i=qn(this.rank),s=function(o){var a=o.length;if(a>6)throw Error("Transpose for rank "+a+" is not yet supported");for(var l=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],u=new Array(a),c=0;c<o.length;c++)u[o[c]]=l[c];return u.join()}(e);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+s+`));
    }
    `},Eye=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=qn(this.rank),s=KH("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=s[r];var a="vec2("+o.slice(-2).join()+")",l="++"+s[this.rank-1]+" < "+t[this.rank-1],u="getChannel(getA("+o.join()+"), "+a+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+u+`;
      if(`+l+`) {
        result[1] = `+u+`;
      }
      --`+s[this.rank-1]+`;
      if(++`+s[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+u+`;
        if(`+l+`) {
          result[3] = `+u+`;
        }
      }
      setOutput(result);
    }
    `},x4=1.7580993408473768,_4=1.0507009873554805,Yt=function(n,e){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Ga="if (isnan(x)) return x;",Mye="return x;",$5="return abs(x);",tG=Ga+`
  return (x < 0.0) ? 0.0 : x;
`,nG=Ga+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,rG="return (x >= 0.0) ? x : (exp(x) - 1.0);",Tye=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+x4+`;
  float scale = `+_4+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,q5="return -x;",Y5="return ceil(x);",K5="return floor(x);",Z5="return exp(x);",J5="return exp(x) - 1.0;",Cye=Ga+`
  return sin(x);
`,Aye=Ga+`
  return cos(x);
`,Rye=Ga+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Pye=Ga+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Iye=Ga+`
  return atan(x);
`,Dye=Ga+"return log(x + sqrt(x * x + 1.0));",Nye=Ga+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,kye=Ga+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Vx="return x;",Lye="return x;",iG=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sG=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,oG=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,E0=function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},Fye=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var e=n.length,t=Bs("rc",e),r=qn(e),i=function(a,l){if(a===1)return"rc";for(var u="",c=0;c<a;c++)u+=l[c],c<a-1&&(u+=",");return u}(e,t),s=t.slice(-2),o=e<=1?"rc":"vec2("+s.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},Wx={};function Hx(n,e){if(e===void 0&&(e=!1),n==="linear")return e?Lye:Mye;if(n==="relu")return e?iG:tG;if(n==="elu")return e?oG:rG;if(n==="relu6")return e?sG:nG;if(n==="prelu")return e?eG:QH;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var Oye=600,Bye=function(n){function e(t){var r,i=n.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!Fe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var s=Rl(Fe().getNumber("WEBGL_VERSION"));i.binaryCache=((r=Fe().getNumber("WEBGL_VERSION"))in Wx||(Wx[r]={}),Wx[r]),i.gpgpu=new Yve(s),i.canvas=s.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=t,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=t.gl.canvas;return i.textureManager=new wye(i.gpgpu),i.numMBBeforeWarning=Fe().global.screen==null?1024:Fe().global.screen.height*Fe().global.screen.width*window.devicePixelRatio*Oye/1024/1024,i.texData=new VH(i,le),i}return Ha(e,n),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,r,i){if(Fe().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var s={};return this.texData.set(s,{shape:r,dtype:i,values:t,usage:So.UPLOAD}),s},e.prototype.move=function(t,r,i,s){if(Fe().getBool("DEBUG")&&this.checkNumericalProblems(r),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:i,dtype:s,values:r,usage:So.UPLOAD})},e.prototype.readSync=function(t){var r=this.texData.get(t),i=r.values,s=r.dtype,o=r.complexTensors,a=r.slice,l=r.shape,u=r.isPacked;if(a!=null){var c=void 0;c=u?new E0(l,Vx):new Yt(l,Vx);var f=this.runWebGLProgram(c,[{dataId:t,shape:l,dtype:s}],s),h=this.readSync(f.dataId);return this.disposeData(f.dataId),h}if(i!=null)return this.convertAndCacheOnCPU(t);if(s==="string")return i;var d,p,y=this.activeTimers!=null;return y&&(d=ol()),s==="complex64"?p=rA(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(t),y&&(this.downloadWaitMs+=ol()-d),this.convertAndCacheOnCPU(t,p)},e.prototype.read=function(t){return vt(this,void 0,void 0,function(){var r,i,s,o,a,l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P;return yt(this,function(C){switch(C.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise(function(A){return r.push(A)})];if(i=this.texData.get(t),s=i.values,o=i.shape,a=i.slice,l=i.dtype,u=i.complexTensors,c=i.isPacked,a!=null)return f=void 0,f=c?new E0(o,Vx):new Yt(o,Vx),h=this.runWebGLProgram(f,[{dataId:t,shape:o,dtype:l}],l),d=this.read(h.dataId),this.disposeData(h.dataId),[2,d];if(s!=null)return[2,this.convertAndCacheOnCPU(t)];if(!Fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Fe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,l!=="complex64"&&Fe().get("WEBGL_BUFFER_SUPPORTED")&&(y=this.decode(t),x=this.texData.get(y.dataId),p=(P=this.gpgpu).createBufferFromTexture.apply(P,[x.texture].concat(xg(o)))),this.pendingRead.set(t,[]),l==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:C.sent(),C.label=2;case 2:return l!=="complex64"?[3,4]:[4,Promise.all([u.real.data(),u.imag.data()])];case 3:return _=C.sent(),w=_[0],b=_[1],m=rA(w,b),[3,5];case 4:p==null?m=this.getValuesFromTexture(t):(S=bt(o),m=this.gpgpu.downloadFloat32MatrixFromBuffer(p,S)),C.label=5;case 5:return y!=null&&this.disposeData(y.dataId),M=this.convertAndCacheOnCPU(t,m),T=this.pendingRead.get(t),this.pendingRead.delete(t),T.forEach(function(A){return A(M)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,M]}})})},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var r=0;r<t.length;r++){var i=t[r];if(!T0e(i))throw Fe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var r,i=this.texData.get(t),s=i.shape,o=i.dtype,a=i.isPacked,l=bt(s);if(Fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),c=this.texData.get(u.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(xg(s))).subarray(0,l);return this.disposeData(u.dataId),f}var h=Fe().getBool("WEBGL_PACK")&&a===!0,d=h?V3(s):s,p=h?new Mve(d):new Eve(d),y=this.runWebGLProgram(p,[{shape:d,dtype:o,dataId:t}],"float32"),x=this.texData.get(y.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(x.texture,x.texShape[0],x.texShape[1]).subarray(0,l);return this.disposeData(y.dataId),m},e.prototype.time=function(t){return vt(this,void 0,void 0,function(){var r,i,s,o,a,l,u;return yt(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],s=!1,this.programTimersStack==null?(this.programTimersStack=i,s=!0):this.activeTimers.push(i),this.activeTimers=i,t(),o=sm(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),a=sm(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,s&&(this.programTimersStack=null),l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return u=c.sent(),l.kernelMs=o0e(u),l.getExtraProfileInfo=function(){return u.map(function(f,h){return{name:a[h],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:l.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,l]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ol(),endMs:null}},e.prototype.endTimer=function(t){return Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ol(),t)},e.prototype.getQueryTime=function(t){return vt(this,void 0,void 0,function(){var r;return yt(this,function(i){return Fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]})})},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var r=this.texData.get(t),i=r.texture,s=r.dtype,o=r.texShape,a=r.usage,l=r.isPacked,u=r.slice,c=u&&u.origDataId||t,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,s),this.textureManager.releaseTexture(i,o,a,l)));var h=this.texData.get(t);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return Fe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=le.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&t.every(function(s){return i.texData.get(s.dataId).texture==null&&s.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,r){var i=this.makeOutput(t.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:le.keep(t.clone()),imag:le.keep(r.clone())},i},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,i);if(bt(i)===0)return Di([],i,t.dtype);var s=this.texData.get(t.dataId).isPacked,o=UH(t.shape,r,i);if(s||!o){var a=Fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xye(i):new yye(i),l=a.getCustomSetupFunc(r);return this.compileAndRun(a,[t],null,l)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,i)},e.prototype.shallowSlice=function(t,r,i){var s=this.texData.get(t.dataId),o=this.makeOutput(i,t.dtype),a=this.texData.get(o.dataId);Object.assign(a,s),a.shape=i,a.dtype=t.dtype;var l=zH(r,t.strides);s.slice&&(l+=s.slice.flatOffset),a.slice={flatOffset:l,origDataId:s.slice&&s.slice.origDataId||t.dataId};var u=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,u+1),o},e.prototype.stridedSlice=function(t,r,i,s){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,i,s);var o=d4(r,i,s);if(o.some(function(l){return l===0}))return Di([],o);var a=new _ye(r,s,o);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,r){var i=Fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mye(t.shape,r):new pye(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.concat=function(t,r){if(t[0].dtype==="complex64"){var i=t.map(function(d){return ea(d)}),s=t.map(function(d){return cl(d)});return Pi(this.concat(i,r),this.concat(s,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(t.length===1)return t[0];if(t.length>Fe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(t.length/2),a=this.concat(t.slice(0,o),r),l=this.concat(t.slice(o),r);return this.concat([a,l],r)}if(Fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var u=new cve(t.map(function(d){return d.shape}),r);return this.compileAndRun(u,t)}var c=am(t.map(function(d){return d.shape}),r),f=t.map(function(d){return d.as2D(-1,bt(d.shape.slice(r)))}),h=new uve(f.map(function(d){return d.shape}));return this.compileAndRun(h,f).reshape(c)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,q5,t.dtype);var r=new Yt(t.shape,q5);return this.compileAndRun(r,[t])},e.prototype.batchMatMul=function(t,r,i,s){var o=i?t.shape[2]:t.shape[1],a=s?r.shape[1]:r.shape[2],l=i?t.shape[1]:t.shape[2],u=t.shape[0];if((o===1||a===1)&&l>1e3){i&&(t=t.transpose([0,2,1])),s&&(r=r.transpose([0,2,1]));var c=a===1?t:t.as3D(u,l,1),f=a===1?2:1,h=a===1?r.as3D(u,1,l):r;return this.multiply(c,h).sum(f,!0)}var d=Ii(t.dtype,r.dtype),p=new j3(t.shape,[u,o,a],i,s);return this.compileAndRun(p,[t,r],d)},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,s=t.transposeA,o=t.transposeB,a=t.bias,l=t.activation,u=t.preluActivationWeights,c=s?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],h=r.shape[0],d=Ii(r.dtype,i.dtype),p=a!=null,y=u!=null,x=l?Hx(l,!0):null,m=new j3(r.shape,[h,c,f],s,o,p,x,y),_=[r,i];return a&&_.push(a),u&&_.push(u),this.compileAndRun(m,_,d)},e.prototype.multiply=function(t,r){if(t.dtype==="complex64"){var i=this.texData.get(t.dataId),s=this.texData.get(r.dataId),o=new F5(ive,t.shape,r.shape),a=new F5(sve,t.shape,r.shape),l=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,s.complexTensors.real),this.makeComplexComponentTensorInfo(r,s.complexTensors.imag)],u=this.compileAndRun(o,l),c=this.compileAndRun(a,l),f=this.complex(u,c);return u.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,O5,t.dtype);var h=new Sr(O5,t.shape,r.shape);return this.compileAndRun(h,[t,r],t.dtype)},e.prototype.batchNormalization=function(t,r,i,s,o,a){var l=[t,r,i],u=null;a!=null&&(u=a.shape,l.push(a));var c=null;if(o!=null&&(c=o.shape,l.push(o)),Fe().getBool("WEBGL_PACK_NORMALIZATION")){var f=new rve(t.shape,r.shape,i.shape,u,c,s);return this.compileAndRun(f,l)}var h=new nve(t.shape,r.shape,i.shape,u,c,s);return this.compileAndRun(h,l)},e.prototype.localResponseNormalization4D=function(t,r,i,s,o){var a=Fe().getBool("WEBGL_PACK_NORMALIZATION")?new Qve(t.shape,r,i,s,o):new Zve(t.shape,r,i,s,o);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,r,i,s,o,a,l){var u=new Jve(r.shape,s,o,a,l);return this.compileAndRun(u,[r,i,t])},e.prototype.tile=function(t,r){if(t.dtype==="string"){var i=this.readSync(t.dataId).map(function(o){return F_(o)});return qH(jt(t.shape,t.dtype,i),r)}var s=new bye(t.shape,r);return this.compileAndRun(s,[t])},e.prototype.pad=function(t,r,i){var s=Fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oye(t.shape,r,i):new sye(t.shape,r,i);return this.compileAndRun(s,[t])},e.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var i=Fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Eye(t.shape,r):new Sye(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.gather=function(t,r,i){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,i);var s=new Ive(t.shape,r.size,i);return this.compileAndRun(s,[t,r])},e.prototype.batchToSpaceND=function(t,r,i){Z(t.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var s=r.reduce(function(f,h){return f*h}),o=W_(t.shape,r,s),a=H_(o.length,r.length),l=G_(t.shape,r,s),u=LH(i,r.length),c=FH(l,i,r.length);return t.reshape(o).transpose(a).reshape(l).slice(u,c)},e.prototype.spaceToBatchND=function(t,r,i){Z(t.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var s=r.reduce(function(h,d){return h*d}),o=[[0,0]];o.push.apply(o,i);for(var a=1+r.length;a<t.shape.length;++a)o.push([0,0]);var l=t.pad(o),u=W_(l.shape,r,s,!1),c=H_(u.length,r.length,!1),f=G_(l.shape,r,s,!1);return l.reshape(u).transpose(c).reshape(f)},e.prototype.reduce=function(t,r,i){var s=t.shape[0],o=t.shape[1],a=W3(o),l=new aye({windowSize:a,inSize:o,batchSize:s},r),u=this.compileAndRun(l,[t],i);return u.shape[1]===1?u:this.reduce(u,r,i)},e.prototype.argReduce=function(t,r,i){i===void 0&&(i=null);var s=t.shape[0],o=t.shape[1];i!=null&&(s=i.shape[0],o=i.shape[1]);var a=W3(o),l=new $ge({windowSize:a,inSize:o,batchSize:s},r,i==null),u=[t];i!=null&&u.push(i);var c=this.compileAndRun(l,u,"int32");return c.shape[1]===1?c:this.argReduce(t,r,c)},e.prototype.argReducePacked=function(t,r,i){i===void 0&&(i=null);var s=i!=null?i.shape:t.shape,o=W3(s[s.length-1]),a=new Qge(s,o,r,i==null),l=i==null?[t]:[t,i],u=this.compileAndRun(a,l,"int32");return u.rank===t.rank?this.argReducePacked(t,r,u):u},e.prototype.sum=function(t,r){mo("sum",r,t.rank);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o),l=k3(t.dtype);return this.reduce(a,"sum",l).reshape(s)},e.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o),l=k3(t.dtype);return this.reduce(a,"prod",l).reshape(s)},e.prototype.unsortedSegmentSum=function(t,r,i){var s=0,o=Pl([s],t.rank),a=t;o!=null&&(a=t.transpose(o),s=Il(1,t.rank)[0]);var l=function(d,p,y){for(var x=[],m=d.length,_=0;_<m;_++)_!==p?x.push(d[_]):x.push(y);return x}(a.shape,s,i),u=bt([a.shape[s]]),c=a.as2D(-1,u),f=k3(t.dtype),h=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(l);return o!=null&&(h=h.transpose(u4(o))),h},e.prototype.segOpCompute=function(t,r,i,s,o){var a=t.shape[0],l=t.shape[1],u=function(h,d){var p,y=!1;for(h<=BH?(p=h,y=!0):p=qC(h,Math.floor(Math.sqrt(h)));!y;)p>d||p===h?y=!0:p=qC(h,p+1);return p}(l,o),c=new gye({windowSize:u,inSize:l,batchSize:a,numSegments:o}),f=this.compileAndRun(c,[t,i],s);return f.shape[1]===o?f:(i=V_(0,o).tile([l/u]),this.segOpCompute(f,r,i,s,o))},e.prototype.argMinMaxReduce=function(t,r,i){var s=[r];if(mo("arg"+i.charAt(0).toUpperCase()+i.slice(1),s,t.rank),!Fe().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var o=Zi(t.shape,s),a=o[0],l=bt(o[1]),u=t.as2D(-1,l);return this.argReduce(u,i).reshape(a)}return this.argReducePacked(t,i)},e.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},e.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},e.prototype.cumsum=function(t,r,i,s){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var o=new xve(t.shape,i,s);return this.compileAndRun(o,[t])},e.prototype.equal=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Sr("return float(a == b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.notEqual=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Sr("return float(a != b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Sr("return float(a < b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.lessEqual=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Sr("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Sr("return float(a > b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greaterEqual=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Sr("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalNot=function(t){var r=new Yt(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},e.prototype.logicalAnd=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Sr("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalOr=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Sr("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.select=function(t,r,i){var s=new vye(t.rank,r.shape,r.rank);return this.compileAndRun(s,[t,r,i],Ii(r.dtype,i.dtype))},e.prototype.where=function(t){U_("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return v4(t.shape,r)},e.prototype.topk=function(t,r,i){return YH(t.dataSync(),t.shape,t.dtype,r)},e.prototype.min=function(t,r){mo("min",r,t.rank);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o);return this.reduce(a,"min",a.dtype).reshape(s)},e.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Sr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.mod=function(t,r){var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Sr(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);mo("max",r,t.rank);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o);return this.reduce(a,"max",a.dtype).reshape(s)},e.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Sr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.all=function(t,r){mo("all",r,t.rank);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o);return this.reduce(a,"all",a.dtype).reshape(s)},e.prototype.any=function(t,r){mo("any",r,t.rank);var i=Zi(t.shape,r),s=i[0],o=bt(i[1]),a=t.as2D(-1,o);return this.reduce(a,"any",a.dtype).reshape(s)},e.prototype.realDivide=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new Sr(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"float32")},e.prototype.floorDiv=function(t,r){if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Sr(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"int32")},e.prototype.add=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,H3);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var i=Ii(t.dtype,r.dtype);if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,H3,i);var s=new Sr(H3,t.shape,r.shape);return this.compileAndRun(s,[t,r],i)},e.prototype.packedUnaryOp=function(t,r,i){var s=new E0(t.shape,r);return this.compileAndRun(s,[t],i)},e.prototype.packedBinaryOp=function(t,r,i,s,o){o===void 0&&(o=!1);var a=new Xl(i,t.shape,r.shape,o);return this.compileAndRun(a,[t,r],s)},e.prototype.complexSeparableBinaryOp=function(t,r,i){var s=this,o=this.texData.get(t.dataId),a=this.texData.get(r.dataId),l=[[o.complexTensors.real,a.complexTensors.real],[o.complexTensors.imag,a.complexTensors.imag]].map(function(h){var d=h[0],p=h[1],y=s.makeComplexComponentTensorInfo(t,d),x=s.makeComplexComponentTensorInfo(r,p),m=new Sr(i,t.shape,r.shape);return s.compileAndRun(m,[y,x],Ii(d.dtype,p.dtype))}),u=l[0],c=l[1],f=this.complex(u,c);return u.dispose(),c.dispose(),f},e.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>Fe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),i=this.addN(t.slice(0,r)),s=this.addN(t.slice(r));return this.addN([i,s])}var o=t.map(function(u){return u.dtype}).reduce(function(u,c){return Ii(u,c)}),a=t.map(function(u){return u.shape}),l=Fe().getBool("WEBGL_PACK")?new Xge(t[0].shape,a):new jge(t[0].shape,a);return this.compileAndRun(l,t,o)},e.prototype.subtract=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,G3);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var i=Ii(t.dtype,r.dtype);if(Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,G3,t.dtype);var s=new Sr(G3,t.shape,r.shape);return this.compileAndRun(s,[t,r],i)},e.prototype.pow=function(t,r){var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Sr(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,r.shape),s=Ii(t.dtype,r.dtype);return this.compileAndRun(i,[t,r],s)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Y5,t.dtype);var r=new Yt(t.shape,Y5);return this.compileAndRun(r,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,K5,t.dtype);var r=new Yt(t.shape,K5);return this.compileAndRun(r,[t])},e.prototype.sign=function(t){var r=new Yt(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[t])},e.prototype.isNaN=function(t){var r=new Yt(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isInf=function(t){var r=new Yt(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isFinite=function(t){var r=new Yt(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.round=function(t){var r=new Yt(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Z5,t.dtype);var r=new Yt(t.shape,Z5);return this.compileAndRun(r,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,J5,t.dtype);var r=new Yt(t.shape,J5);return this.compileAndRun(r,[t])},e.prototype.softmax=function(t,r){var i=ci([r],t.shape),s=this.max(t,i),o=Qs(s.shape,i),a=this.subtract(t,s.reshape(o)),l=this.exp(a),u=this.sum(l,i).reshape(o);return this.realDivide(l,u)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var r=new Yt(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[t])},e.prototype.log1p=function(t){var r=new Yt(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},e.prototype.sqrt=function(t){var r=new Yt(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new Yt(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},e.prototype.reciprocal=function(t){var r=new Yt(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},e.prototype.relu=function(t){var r;return r=Fe().getBool("WEBGL_PACK")?new E0(t.shape,iG):new Yt(t.shape,tG),this.compileAndRun(r,[t])},e.prototype.relu6=function(t){var r;return r=Fe().getBool("WEBGL_PACK")?new E0(t.shape,sG):new Yt(t.shape,nG),this.compileAndRun(r,[t])},e.prototype.prelu=function(t,r){var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(eG,t.shape,r.shape):new Sr(QH,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.elu=function(t){if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,oG,t.dtype);var r=new Yt(t.shape,rG);return this.compileAndRun(r,[t])},e.prototype.eluDer=function(t,r){var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,r.shape):new Sr("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.selu=function(t){var r=new Yt(t.shape,Tye);return this.compileAndRun(r,[t])},e.prototype.int=function(t){var r=new Yt(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},e.prototype.clip=function(t,r,i){var s,o=(s=Fe().getBool("WEBGL_PACK_CLIP")?new ave(t.shape):new ove(t.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(s,[t],null,o)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$5,t.dtype);var r=new Yt(t.shape,$5);return this.compileAndRun(r,[t])},e.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),i=new lve(t.shape),s=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(i,s)},e.prototype.sigmoid=function(t){var r=new Yt(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},e.prototype.softplus=function(t){var r=new Yt(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[t])},e.prototype.sin=function(t){var r=new Yt(t.shape,Cye);return this.compileAndRun(r,[t])},e.prototype.cos=function(t){var r=new Yt(t.shape,Aye);return this.compileAndRun(r,[t])},e.prototype.tan=function(t){var r=new Yt(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},e.prototype.asin=function(t){var r=new Yt(t.shape,Rye);return this.compileAndRun(r,[t])},e.prototype.acos=function(t){var r=new Yt(t.shape,Pye);return this.compileAndRun(r,[t])},e.prototype.atan=function(t){var r=new Yt(t.shape,Iye);return this.compileAndRun(r,[t])},e.prototype.atan2=function(t,r){var i=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new Sr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.sinh=function(t){var r=new Yt(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.cosh=function(t){var r=new Yt(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.tanh=function(t){var r=new Yt(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[t])},e.prototype.asinh=function(t){var r=new Yt(t.shape,Dye);return this.compileAndRun(r,[t])},e.prototype.acosh=function(t){var r=new Yt(t.shape,Nye);return this.compileAndRun(r,[t])},e.prototype.atanh=function(t){var r=new Yt(t.shape,kye);return this.compileAndRun(r,[t])},e.prototype.erf=function(t){var r=new Yt(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[t])},e.prototype.step=function(t,r){var i=new Yt(t.shape,function(s){return s===void 0&&(s=0),Ga+`
    return x > 0.0 ? 1.0 : float(`+s+`);
  `}(r));return this.compileAndRun(i,[t])},e.prototype.conv2dByMatMul=function(t,r,i,s,o,a){var l=t.shape,u=this.texData.get(t.dataId),c=i.inChannels,f=l[0]*l[1]*l[2],h=i.outChannels,d=i.dataFormat==="channelsLast",p=(f===1||h===1)&&c>1e3,y=l[2]%2!=0&&!!u.isPacked;if(p||!Fe().getBool("WEBGL_LAZILY_UNPACK")||!Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!y){var x=d?l[0]*l[1]*l[2]:l[0]*l[2]*l[3],m=this.reshape(t,[1,x,i.inChannels]),_=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:_,transposeA:!1,transposeB:!1,bias:s,activation:o,preluActivationWeights:a}),i.outShape)}var w=d?l[0]*l[1]*(l[2]+1):l[0]*l[2]*(l[3]+1),b={dataId:t.dataId,shape:[1,w,i.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,Z(Ux(u.shape,b.shape),function(){return"packed reshape "+u.shape+" to "+b.shape+" isn't free"});var M=this.reshape(r,[1,i.inChannels,i.outChannels]),T=this.fusedBatchMatMul({a:b,b:M,transposeA:!1,transposeB:!1,bias:s,activation:o,preluActivationWeights:a}),P=this.texData.get(T.dataId);return Z(P.isPacked,function(){return"batchMatMul result is expected to be packed"}),u.shape=S,P.shape=i.outShape,le.makeTensorFromDataId(T.dataId,i.outShape,T.dtype)},e.prototype.conv2dWithIm2Row=function(t,r,i,s,o,a){var l=i.filterWidth,u=i.filterHeight,c=i.inChannels,f=i.outWidth,h=i.outHeight,d=i.dataFormat==="channelsLast",p=l*u*c,y=h*f,x=[p,y],m=t.squeeze([0]),_=r.reshape([1,p,-1]),w=new Kve(x,m.shape,i),b=this.compileAndRun(w,[m]).reshape([1,x[0],x[1]]),S=s!=null,M=a!=null,T=o?Hx(o,!0):null,P=new j3(b.shape,[1,y,i.outChannels],!0,!1,S,T,M),C=[b,_];s&&C.push(s),M&&C.push(a);var A=this.compileAndRun(P,C);return d?A.reshape([1,h,f,i.outChannels]):A.reshape([1,i.outChannels,h,f])},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,s=t.convInfo,o=t.bias,a=t.activation,l=t.preluActivationWeights;if(s.filterHeight===1&&s.filterWidth===1&&s.dilationHeight===1&&s.dilationWidth===1&&s.strideHeight===1&&s.strideWidth===1&&(s.padInfo.type==="SAME"||s.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,s,o,a,l);if(Fe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,s,o,a,l);var u=o!=null,c=l!=null,f=a?Hx(a,!1):null,h=new B5(s,u,f,c),d=[r,i];return o&&d.push(o),l&&d.push(l),this.compileAndRun(h,d)},e.prototype.conv2d=function(t,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(t,r,i);if(Fe().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,r,i);var s=new B5(i);return this.compileAndRun(s,[t,r])},e.prototype.conv2dDerInput=function(t,r,i){var s=new hve(i);return this.compileAndRun(s,[t,r])},e.prototype.conv2dDerFilter=function(t,r,i){var s=new fve(i);return this.compileAndRun(s,[t,r])},e.prototype.fusedDepthwiseConv2D=function(t){var r,i=t.input,s=t.filter,o=t.convInfo,a=t.bias,l=t.activation,u=t.preluActivationWeights,c=Fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=l?Hx(l,c):null,h=[i,s],d=a!=null,p=u!=null;return d&&h.push(a),p&&h.push(u),c?(r=new z5(o,d,f,p),this.compileAndRun(r,h)):(r=new U5(o,d,f,p),this.compileAndRun(r,h))},e.prototype.depthwiseConv2D=function(t,r,i){var s;return Fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(s=new z5(i),this.compileAndRun(s,[t,r])):(s=new U5(i),this.compileAndRun(s,[t,r]))},e.prototype.depthwiseConv2DDerInput=function(t,r,i){var s=new gve(i);return this.compileAndRun(s,[t,r])},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){var s=new mve(i);return this.compileAndRun(s,[t,r])},e.prototype.conv3d=function(t,r,i){var s=new vve(i);return this.compileAndRun(s,[t,r])},e.prototype.conv3dDerInput=function(t,r,i){var s=new pve(i);return this.compileAndRun(s,[t,r])},e.prototype.conv3dDerFilter=function(t,r,i){var s=new dve(i);return this.compileAndRun(s,[t,r])},e.prototype.maxPool=function(t,r){var i=new X3(r,"max",!1);return this.compileAndRun(i,[t])},e.prototype.avgPool=function(t,r){var i=new X3(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPoolBackprop=function(t,r,i,s){var o=new X3(s,"max",!0),a=this.compileAndRun(o,[r]),l=new eye(s),u=this.compileAndRun(l,[t,a],r.dtype);return a.dispose(),u},e.prototype.avgPoolBackprop=function(t,r,i){var s=new eve(i);return this.compileAndRun(s,[t],r.dtype)},e.prototype.cast=function(t,r){return GH(t,r,this)},e.prototype.unstack=function(t,r){for(var i=t.shape[r],s=new Array(t.rank-1),o=0,a=0;a<t.rank;a++)a!==r&&(s[o++]=t.shape[a]);var l=new Array(t.rank).fill(0),u=t.shape.slice();u[r]=1;var c=new Array(i);for(a=0;a<c.length;a++)l[r]=a,c[a]=this.slice(t,l,u).reshape(s);return c},e.prototype.avgPool3d=function(t,r){var i=new $3(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,r,i){var s=new tve(i);return this.compileAndRun(s,[t],r.dtype)},e.prototype.maxPool3d=function(t,r){var i=new $3(r,"max",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,r,i,s){var o=new $3(s,"max",!0),a=this.compileAndRun(o,[r]),l=new tye(s),u=this.compileAndRun(l,[t,a],r.dtype);return a.dispose(),u},e.prototype.reshape=function(t,r){var i=this.texData.get(t.dataId);if(i.isPacked&&!Ux(t.shape,r)&&(i.texture===null||!Ux(i.shape,r))){var s=this.packedReshape(t,r);return le.makeTensorFromDataId(s.dataId,s.shape,s.dtype)}return nA(t,r)},e.prototype.resizeBilinear=function(t,r,i,s){var o=Fe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fye(t.shape,r,i,s):new cye(t.shape,r,i,s);return this.compileAndRun(o,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,r,i){var s=new uye(t,r,i);return this.compileAndRun(s,[t])},e.prototype.resizeNearestNeighbor=function(t,r,i,s){var o=new dye(t.shape,r,i,s);return this.compileAndRun(o,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){var s=new hye(t,r,i);return this.compileAndRun(s,[t])},e.prototype.multinomial=function(t,r,i,s){var o=r?t:Mu(t),a=o.shape[0],l=o.shape[1],u=new nye(a,l,i),c=u.getCustomSetupFunc(s);return this.compileAndRun(u,[o],"int32",c)},e.prototype.oneHot=function(t,r,i,s){var o=new rye(t.size,r,i,s);return this.compileAndRun(o,[t])},e.prototype.diag=function(t){var r=new Sve(t.size);return this.compileAndRun(r,[t])},e.prototype.nonMaxSuppression=function(t,r,i,s,o){return U_("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),m4(t.dataSync(),r.dataSync(),i,s,o)},e.prototype.cropAndResize=function(t,r,i,s,o,a){var l=new yve(t.shape,r.shape,s,o,a);return this.compileAndRun(l,[t,r,i],"float32")},e.prototype.depthToSpace=function(t,r,i){Z(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var s=t.shape[0],o=i==="NHWC"?t.shape[1]:t.shape[2],a=i==="NHWC"?t.shape[2]:t.shape[3],l=i==="NHWC"?t.shape[3]:t.shape[1],u=o*r,c=a*r,f=l/(r*r),h=new bve(i==="NHWC"?[s,u,c,f]:[s,f,u,c],r,i);return this.compileAndRun(h,[t])},e.prototype.split=function(t,r,i){return $H(t,r,i)},e.prototype.scatterND=function(t,r,i){var s=j_(0,t,i),o=s.sliceRank,a=s.numUpdates,l=s.sliceSize,u=s.strides,c=s.outputSize,f=[c/l,l],h=t.reshape([a,o]),d=r.reshape([a,l]);if(c===0)return nA(Di([]),i);var p=tt(0),y=new G5(a,o,h.rank,d.rank,u,f);return this.compileAndRun(y,[d,h,p]).reshape(i)},e.prototype.sparseToDense=function(t,r,i,s){var o=j_(0,t,i),a=o.sliceRank,l=o.numUpdates,u=o.strides,c=o.outputSize,f=new G5(l,a,t.rank,r.rank,u,[c,1]);return this.compileAndRun(f,[r,t,s]).reshape(i)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,r){var i=this.texData.get(t.dataId),s=new W5(Ave,t.shape,r),o=new W5(Rve,t.shape,r),a=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag)],l=this.compileAndRun(s,a),u=this.compileAndRun(o,a),c=this.complex(l,u).as2D(t.shape[0],t.shape[1]);return l.dispose(),u.dispose(),c},e.prototype.gatherND=function(t,r){var i=r.shape,s=i[i.length-1],o=OH(t,r),a=o[0],l=o[1],u=o[2],c=o[3],f=r.reshape([l,s]),h=t.reshape([t.size/u,u]),d=new Dve(s,c,[l,u]);return this.compileAndRun(d,[h,f]).reshape(a)},e.prototype.fill=function(t,r,i){if((i=i||ry(r))==="string"){var s=L_(i,bt(t));return s.fill(r),le.makeTensor(s,t,i,this)}var o=new Pve(t,r),a=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,a)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,r,i){return jH(t,r,i)},e.prototype.makeTensorInfo=function(t,r){var i=this.write(null,t,r);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:r}},e.prototype.makeOutput=function(t,r){var i=this.makeTensorInfo(t,r).dataId;return le.makeTensorFromDataId(i,t,r,this)},e.prototype.unpackTensor=function(t){var r=new Fye(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},e.prototype.packTensor=function(t){var r=new iye(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,r){var i=[O_(t.shape)].concat(B_(t.shape)),s={dtype:t.dtype,shape:i,dataId:t.dataId},o=[O_(r)].concat(B_(r)),a=new lye(o,i),l=this.runWebGLProgram(a,[s],t.dtype,null,!0);return{dataId:l.dataId,shape:r,dtype:l.dtype}},e.prototype.decode=function(t){var r,i=this.texData.get(t),s=i.isPacked,o=i.shape,a=i.dtype,l=V3(o);return r=s?new wve(l):new _ve(l),{dtype:a,shape:o,dataId:this.runWebGLProgram(r,[{shape:l,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,r,i,s,o){var a=this;o===void 0&&(o=!1);var l=this.makeTensorInfo(t.outputShape,i),u=this.texData.get(l.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===Tv.DENSE){var c=xg(t.outputShape);u.texShape=c.map(function(w){return 2*w})}if(t.outTexUsage!=null&&(u.usage=t.outTexUsage),bt(l.shape)===0)return u.values=Ev(l.dtype,0),l;var f=[],h=r.map(function(w){if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var b=a.texData.get(w.dataId);if(b.texture==null){if(!t.packedInputs&&bt(w.shape)<=Fe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:b.values};t.packedInputs&&(b.isPacked=!0,b.shape=w.shape)}else if(!!b.isPacked!=!!t.packedInputs)w=b.isPacked?a.unpackTensor(w):a.packTensor(w),f.push(w),b=a.texData.get(w.dataId);else if(b.isPacked&&!Ux(b.shape,w.shape)){var S=w,M=w.shape;w.shape=b.shape,w=a.packedReshape(w,M),f.push(w),b=a.texData.get(w.dataId),S.shape=M}return a.uploadToGPU(w.dataId),{shape:w.shape,texData:b,isUniform:!1}});this.uploadToGPU(l.dataId);var d,p={shape:l.shape,texData:u,isUniform:!1},y=function(w,b,S){var M="";b.concat(S).forEach(function(C){var A=C.texData!=null&&C.texData.slice!=null&&C.texData.slice.flatOffset>0,k=C.isUniform?"uniform":C.texData.texShape;M+=C.shape+"_"+k+"_"+A});var T=w.userCode,P=w.constructor.name;return P+="_"+M+"_"+T}(t,h,p),x=this.getAndSaveBinary(y,function(){return function(w,b,S,M){var T=b.userCode,P=S.map(function(N,B){var D={logicalShape:N.shape,texShape:N.isUniform?null:N.texData.texShape,isUniform:N.isUniform,isPacked:!N.isUniform&&N.texData.isPacked,flatOffset:null};return N.texData!=null&&N.texData.slice!=null&&N.texData.slice.flatOffset>0&&(D.flatOffset=N.texData.slice.flatOffset),{name:b.variableNames[B],shapeInfo:D}}),C=P.map(function(N){return N.shapeInfo}),A={logicalShape:M.shape,texShape:M.texData.texShape,isUniform:!1,isPacked:M.texData.isPacked,flatOffset:null},k=qge(P,A,T,b.packedInputs),L=w.createProgram(k),H=null,F=w.getUniformLocation(L,"NAN",!1);Fe().getNumber("WEBGL_VERSION")===1&&(H=w.getUniformLocation(L,"INFINITY",!1));for(var V={},W=0;W<b.variableNames.length;W++){var G=b.variableNames[W];V[G]=w.getUniformLocation(L,G,!1),V["offset"+G]=w.getUniformLocation(L,"offset"+G,!1)}return{program:b,source:k,webGLProgram:L,uniformLocations:V,inShapeInfos:C,outShapeInfo:A,infLoc:H,nanLoc:F}}(a.gpgpu,t,h,p)}),m=this.activeTimers!=null;if(m&&(d=this.startTimer()),function(w,b,S,M,T){H5(b.inShapeInfos,S),H5([b.outShapeInfo],[M]);var P=M.texData.texture,C=M.texData.texShape;M.texData.isPacked?w.setOutputPackedMatrixTexture(P,C[0],C[1]):w.setOutputMatrixTexture(P,C[0],C[1]),w.setProgram(b.webGLProgram),Fe().getNumber("WEBGL_VERSION")===1&&b.infLoc!==null&&w.gl.uniform1f(b.infLoc,1/0),b.nanLoc!==null&&w.gl.uniform1f(b.nanLoc,NaN),S.forEach(function(A,k){var L=b.program.variableNames[k],H=b.uniformLocations[L],F=b.uniformLocations["offset"+L];if(H!=null)if(A.isUniform)if(bt(A.shape)<2)w.gl.uniform1f(H,A.uniformValues[0]);else{var V=A.uniformValues;V instanceof Float32Array||(V=new Float32Array(V)),w.gl.uniform1fv(H,V)}else A.texData.slice!=null&&F!=null&&w.gl.uniform1i(F,A.texData.slice.flatOffset),w.setInputMatrixTexture(A.texData.texture,H,k)}),T!=null&&T(w,b.webGLProgram),w.executeProgram()}(this.gpgpu,x,h,p,s),f.forEach(function(w){return a.disposeData(w.dataId)}),m&&(d=this.endTimer(d),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(d)})),!Fe().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){var _=this.unpackTensor(l);return this.disposeData(l.dataId),_}return l},e.prototype.compileAndRun=function(t,r,i,s,o){o===void 0&&(o=!1),i=i||r[0].dtype;var a=this.runWebGLProgram(t,r,i,s,o);return le.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(Fe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){t.gpgpu.deleteProgram(t.binaryCache[r].webGLProgram),delete t.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=lt(function(){if(!Fe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Fe().getBool("DEBUG");Fe().set("DEBUG",!1);var i=t.abs(tt(1e-8)).dataSync()[0];if(Fe().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var r,i=this.texData.get(t),s=i.shape,o=i.dtype,a=i.values,l=i.texture,u=i.usage,c=i.isPacked;if(l==null){var f,h=this.activeTimers!=null;h&&(f=ol());var d=i.texShape;if(d==null&&(d=G0e(s,c),i.texShape=d),a!=null){var p=V3(s),y=void 0,x=d[1],m=d[0],_=a instanceof Uint8Array;c?(x=(r=sy(d[0],d[1]))[0],m=r[1],y=new Cve(p,[m,x],_)):y=new Tve(p,[m,x],_);var w=this.makeTensorInfo([m,x],o);this.texData.get(w.dataId).usage=_?So.PIXELS:So.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),x,m,a);var b=this.runWebGLProgram(y,[w],o,null,!0),S=this.texData.get(b.dataId);i.texture=S.texture,i.texShape=S.texShape,i.isPacked=S.isPacked,i.usage=S.usage,this.disposeData(w.dataId),this.texData.delete(b.dataId),i.values=null,h&&(this.uploadWaitMs+=ol()-f)}else{var M=this.acquireTexture(d,u,o,c);i.texture=M}}},e.prototype.convertAndCacheOnCPU=function(t,r){var i=this.texData.get(t),s=i.dtype;return this.releaseGPUData(t),r!=null&&(i.values=function(o,a){if(a==="float32"||a==="complex64")return o;if(a==="int32"||a==="bool"){for(var l=a==="int32"?new Int32Array(o.length):new Uint8Array(o.length),u=0;u<l.length;++u)l[u]=Math.round(o[u]);return l}throw new Error("Unknown dtype "+a)}(r,s)),i.values},e.prototype.acquireTexture=function(t,r,i,s){if(this.numBytesInGPU+=this.computeBytes(t,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,s)},e.prototype.computeBytes=function(t,r){return t[0]*t[1]*xH(r)},e}(WH);TH()&&le.registerBackend("webgl",function(){return new Bye},2);var Uye=ie({square_:function(n){var e=Y(n,"x","square"),t=[e];return le.runKernelFunc(function(r,i){return i([e]),r.square(e)},{x:e},null,"Square",{},t,[])}}),Av="SquaredDifference",aG=ie({squaredDifference_:function(n,e){var t,r=Y(n,"a","squaredDifference"),i=Y(e,"b","squaredDifference");t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape);var s={a:r,b:i},o=[r,i];return le.runKernelFunc(function(a,l){var u=a.squaredDifference(r,i);return l([r,i]),u},s,function(a,l){var u=l[0],c=l[1],f=tt(2);return{a:function(){return a.mul(u.sub(c).mul(f))},b:function(){return a.mul(c.sub(u).mul(f))}}},Av,{},o,[])}}),zye=ie({abs_:function(n){var e=Y(n,"x","abs");return e.dtype==="complex64"?le.runKernelFunc(function(t){return t.complexAbs(e)},{$x:e}):le.runKernelFunc(function(t,r){var i=t.abs(e);return r([e]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return t.mul(i.toFloat().step(-1))}}},"Abs")}}),Vye=ie({acos_:function(n){var e=Y(n,"x","acos");return le.runKernelFunc(function(t,r){var i=t.acos(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(tt(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),Wye=ie({acosh_:function(n){var e=Y(n,"x","acosh");return le.runKernelFunc(function(t,r){var i=t.acosh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),Hye=ie({asin_:function(n){var e=Y(n,"x","asin");return le.runKernelFunc(function(t,r){var i=t.asin(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(tt(1).sub(i.toFloat().square()).sqrt())}}})}}),Gye=ie({asinh_:function(n){var e=Y(n,"x","asinh");return le.runKernelFunc(function(t,r){var i=t.asinh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(tt(1).add(i.toFloat().square()).sqrt())}}})}}),jye=ie({atan_:function(n){var e=Y(n,"x","atan");return le.runKernelFunc(function(t,r){var i=t.atan(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().square().add(1))}}})}}),Xye=ie({atanh_:function(n){var e=Y(n,"x","atanh");return le.runKernelFunc(function(t,r){var i=t.atanh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(tt(1).sub(i.toFloat().square()))}}})}}),$ye=ie({ceil_:function(n){var e=Y(n,"x","ceil");return le.runKernelFunc(function(t){return t.ceil(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),w4=ie({clipByValue_:function(n,e,t){var r=Y(n,"x","clipByValue");Z(e<=t,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."});var i=[r],s={min:e,max:t};return le.runKernelFunc(function(o,a){var l=o.clip(r,e,t);return a([r]),l},{x:r},function(o,a){var l=a[0];return{x:function(){return o.where(l.greaterEqual(e).logicalAnd(l.lessEqual(t)),xn(o))}}},"ClipByValue",s,i)}}),qye=ie({cos_:function(n){var e=Y(n,"x","cos"),t=[e];return le.runKernelFunc(function(r,i){var s=r.cos(e);return i([e]),s},{x:e},function(r,i){var s=i[0];return{x:function(){return s.toFloat().sin().neg().mul(r)}}},"Cos",{},t)}}),Yye=ie({cosh_:function(n){var e=Y(n,"x","cosh");return le.runKernelFunc(function(t,r){var i=t.cosh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(t)}}})}}),Kye=ie({erf_:function(n){var e=Y(n,"x","erf");return Z(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),le.runKernelFunc(function(t,r){var i=t.erf(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),iA=ie({exp_:function(n){var e=Y(n,"x","exp");return le.runKernelFunc(function(t,r){var i=t.exp(e);return r([i]),i},{x:e},function(t,r){return{x:function(){return t.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),Zye=ie({expm1_:function(n){var e=Y(n,"x","expm1");return le.runKernelFunc(function(t,r){var i=t.expm1(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.exp())}}})}}),Jye=ie({floor_:function(n){var e=Y(n,"x","floor");return le.runKernelFunc(function(t){return t.floor(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),Qye=ie({log_:function(n){var e=Y(n,"x","log"),t=[e];return le.runKernelFunc(function(r,i){var s=r.log(e);return i([e]),s},{x:e},function(r,i){var s=i[0];return{x:function(){return r.div(s.toFloat())}}},"Log",{},t)}}),e1e=ie({log1p_:function(n){var e=Y(n,"x","log1p");return le.runKernelFunc(function(t,r){var i=t.log1p(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.add(1))}}})}}),t1e=ie({logSigmoid_:function(n){var e=Y(n,"x","logSigmoid");return le.runKernelFunc(function(t,r){var i=t.softplus(e.neg()).neg();return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.neg().sigmoid())}}})}}),Y_=ie({neg_:function(n){var e=Y(n,"x","neg"),t=[e];return le.runKernelFunc(function(r){return r.neg(e)},{x:e},function(r){return{x:function(){return r.neg()}}},"Neg",{},t)}}),n1e=ie({reciprocal_:function(n){var e=Y(n,"x","reciprocal");return le.runKernelFunc(function(t,r){var i=t.reciprocal(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.square().neg())}}})}}),r1e=ie({round_:function(n){var e=Y(n,"x","round");return le.runKernelFunc(function(t){return t.round(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),lG=ie({rsqrt_:function(n){var e=Y(n,"x","rsqrt"),t=[e];return le.runKernelFunc(function(r,i){var s=r.rsqrt(e);return i([e]),s},{x:e},function(r,i){var s=i[0];return{x:function(){return r.div(s.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},t)}}),uG=ie({sigmoid_:function(n){var e=Y(n,"x","sigmoid");return le.runKernelFunc(function(t,r){var i=t.sigmoid(e);return r([i]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return t.mul(i.mul(tt(1).sub(i)))}}},"Sigmoid")}}),i1e=ie({sign_:function(n){var e=Y(n,"x","sign");return le.runKernelFunc(function(t){return t.sign(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),s1e=ie({isNaN_:function(n){var e=Y(n,"x","isNaN");return le.runKernelFunc(function(t){return t.isNaN(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),o1e=ie({isInf_:function(n){var e=Y(n,"x","isInf");return le.runKernelFunc(function(t){return t.isInf(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),a1e=ie({isFinite_:function(n){var e=Y(n,"x","isFinite");return le.runKernelFunc(function(t){return t.isFinite(e)},{$x:e},function(t){return{$x:function(){return xn(t)}}})}}),l1e=ie({sin_:function(n){var e=Y(n,"x","sin"),t=[e];return le.runKernelFunc(function(r,i){var s=r.sin(e);return i([e]),s},{x:e},function(r,i){var s=i[0];return{x:function(){return s.toFloat().cos().mul(r)}}},"Sin",{},t)}}),u1e=ie({sinh_:function(n){var e=Y(n,"x","sinh");return le.runKernelFunc(function(t,r){var i=t.sinh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(t)}}})}}),c1e=ie({softplus_:function(n){var e=Y(n,"x","softplus");return le.runKernelFunc(function(t,r){var i=t.softplus(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.sigmoid())}}})}}),f1e=ie({sqrt_:function(n){var e=Y(n,"x","sqrt");return le.runKernelFunc(function(t,r){var i=t.sqrt(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().sqrt().mul(2))}}})}}),h1e=ie({step_:function(n,e){e===void 0&&(e=0);var t=Y(n,"x","step");return le.runKernelFunc(function(r){return r.step(t,e)},{$x:t},function(r){return{$x:function(){return xn(r)}}})}}),d1e=ie({tan_:function(n){var e=Y(n,"x","tan");return le.runKernelFunc(function(t,r){var i=t.tan(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.cos().square())}}})}}),p1e=ie({tanh_:function(n){var e=Y(n,"x","tanh");return le.runKernelFunc(function(t,r){var i=t.tanh(e);return r([i]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return tt(1).sub(i.square()).mulStrict(t)}}},"Tanh",{},null,[!0])}});function cG(n,e,t,r,i,s){var o,a,l=Y(n,"x","batchNorm"),u=Y(e,"mean","batchNorm"),c=Y(t,"variance","batchNorm");return i!=null&&(o=Y(i,"scale","batchNorm")),r!=null&&(a=Y(r,"offset","batchNorm")),Z(l.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),Z(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+u.rank+"."}),Z(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&Z(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),a!=null&&Z(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."}),ay(l,u,c,a,o,s)}function fG(n,e,t,r,i,s){var o,a,l=Y(n,"x","batchNorm"),u=Y(e,"mean","batchNorm"),c=Y(t,"variance","batchNorm");return i!=null&&(o=Y(i,"scale","batchNorm")),r!=null&&(a=Y(r,"offset","batchNorm")),Z(l.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),Z(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+u.rank+"."}),Z(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&Z(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),a!=null&&Z(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."}),ay(l,u,c,a,o,s)}function hG(n,e,t,r,i,s){var o,a,l=Y(n,"x","batchNorm"),u=Y(e,"mean","batchNorm"),c=Y(t,"variance","batchNorm");return i!=null&&(o=Y(i,"scale","batchNorm")),r!=null&&(a=Y(r,"offset","batchNorm")),Z(l.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."}),Z(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+u.rank+"."}),Z(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&Z(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),a!=null&&Z(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."}),ay(l,u,c,a,o,s)}function ay(n,e,t,r,i,s){s==null&&(s=.001);var o,a,l,u=Y(n,"x","batchNorm"),c=Y(e,"mean","batchNorm"),f=Y(t,"variance","batchNorm");i!=null&&(o=Y(i,"scale","batchNorm")),r!=null&&(a=Y(r,"offset","batchNorm")),Z(c.rank===f.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),Z(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),Z(o==null||c.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),l=u.rank===0||u.rank===1?u.as4D(1,1,1,u.size):u.rank===2?u.as4D(1,1,u.shape[0],u.shape[1]):u.rank===3?u.as4D(1,u.shape[0],u.shape[1],u.shape[2]):u;var h=[u,c,f,o];return le.runKernelFunc(function(d,p){var y=d.batchNormalization(l,Gx(c),Gx(f),s,Gx(o),Gx(a));return p([u,c,f,o]),y},{x:u,mean:c,variance:f,scale:o,offset:a},function(d,p){var y=p,x=y[0],m=y[1],_=y[2],w=y[3],b=w??tt(1),S=li(m.shape,l.shape),M=[];if(m.rank===1){for(var T=0;T<l.shape.length-1;++T)M.push(l.shape[T]);M.push(1)}var P=x.sub(m),C=d.mul(b),A=lG(_.add(tt(s))),k=A.mul(A).mul(A).mul(tt(-.5));return{x:function(){return m.rank===1?d.mul(Dp(A.as4D(1,1,1,m.shape[0]),M)).mul(b).reshape(x.shape):d.mul(A).mul(b).reshape(x.shape)},mean:function(){var L=A.mul(tt(-1)).mul(C);return m.rank===1&&(L=L.sum(S)),L.reshape(m.shape)},variance:function(){var L=k.mul(P).mul(C);return m.rank===1&&(L=L.sum(S)),L.reshape(m.shape)},scale:function(){var L=P.mul(A),H=d.mul(L);return m.rank===1&&(H=H.sum(S)),H.reshape(m.shape)},offset:function(){var L=d;return m.rank===1&&(L=L.sum(S)),L.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:s},h).reshape(u.shape)}function Gx(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function cb(){CH("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var m1e=ie({batchNormalization2d_:function(n,e,t,r,i,s){return r===void 0&&(r=.001),cb(),cG(n,e,t,s,i,r)}}),g1e=ie({batchNormalization3d_:function(n,e,t,r,i,s){return r===void 0&&(r=.001),cb(),fG(n,e,t,s,i,r)}}),v1e=ie({batchNormalization4d_:function(n,e,t,r,i,s){return r===void 0&&(r=.001),cb(),hG(n,e,t,s,i,r)}}),y1e=ie({batchNormalization_:function(n,e,t,r,i,s){return r===void 0&&(r=.001),cb(),ay(n,e,t,s,i,r)}}),dG=ie({batchNorm_:ay}),x1e=ie({batchNorm2d_:cG}),_1e=ie({batchNorm3d_:fG}),w1e=ie({batchNorm4d_:hG}),fb=ie({logicalAnd_:function(n,e){var t=Y(n,"a","logicalAnd","bool"),r=Y(e,"b","logicalAnd","bool");return fn(t.shape,r.shape),le.runKernelFunc(function(i){return i.logicalAnd(t,r)},{a:t,b:r},null,"LogicalAnd")}}),b1e=ie({logicalNot_:function(n){var e=Y(n,"x","logicalNot","bool");return le.runKernelFunc(function(t){return t.logicalNot(e)},{$x:e})}}),pG=ie({logicalOr_:function(n,e){var t=Y(n,"a","logicalOr","bool"),r=Y(e,"b","logicalOr","bool");return fn(t.shape,r.shape),le.runKernelFunc(function(i){return i.logicalOr(t,r)},{$a:t,$b:r})}}),S1e=ie({logicalXor_:function(n,e){var t=Y(n,"a","logicalXor","bool"),r=Y(e,"b","logicalXor","bool");return fn(t.shape,r.shape),pG(n,e).logicalAnd(fb(n,e).logicalNot())}}),Ch=ie({where_:function(n,e,t){var r=Y(e,"a","where"),i=Y(t,"b","where"),s=Y(n,"condition","where","bool");return kn(r.shape,i.shape,"Error in where: "),s.rank===1?Z(s.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):kn(s.shape,i.shape,"Error in where: "),le.runKernelFunc(function(o,a){var l=o.select(s,r,i);return a([s]),l},{$condition:s,$a:r,$b:i},function(o,a){var l=a[0];return{$condition:function(){return xn(l).toFloat()},$a:function(){return o.mul(l.cast(o.dtype))},$b:function(){return o.mul(l.logicalNot().cast(o.dtype))}}})}}),mG=function(n){return vt(this,void 0,void 0,function(){var e,t,r;return yt(this,function(i){switch(i.label){case 0:return[4,(e=Y(n,"condition","whereAsync","bool")).data()];case 1:return t=i.sent(),r=v4(e.shape,t),n!==e&&e.dispose(),[2,r]}})})},ln=ie({add_:function(n,e){var t,r=Y(n,"a","add"),i=Y(e,"b","add");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o){return o.add(r,i)},{a:r,b:i},function(o){return{a:function(){var a=o,l=li(r.shape,s);return l.length>0&&(a=a.sum(l)),a.reshape(r.shape)},b:function(){var a=o,l=li(i.shape,s);return l.length>0&&(a=a.sum(l)),a.reshape(i.shape)}}},"Add")}}),E1e=ie({addN_:function(n){Z(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),Z(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var e=n.map(function(i,s){return Y(i,"tensors"+s,"addN")}),t=e[0];e.forEach(function(i){if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(i){if(!bi(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return le.runKernelFunc(function(i){return i.addN(e)},r,function(i){var s={};return e.forEach(function(o,a){s[a]=function(){return i.clone()}}),s},"AddN")}}),M1e=ie({addStrict_:function(n,e){var t=Y(n,"a","addStrict"),r=Y(e,"b","addStrict");return kn(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),T1e=ie({atan2_:function(n,e){var t,r=Y(n,"a","atan2"),i=Y(e,"b","atan2");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o,a){var l=o.atan2(r,i);return a([r,i]),l},{$a:r,$b:i},function(o,a){var l=a[0],u=a[1];return{$a:function(){var c=ln(l.square(),u.square()),f=o.mul(u.div(c)),h=li(l.shape,s);return h.length>0&&(f=f.sum(h)),f.reshape(l.shape)},$b:function(){var c=ln(l.square(),u.square()),f=Y_(o.mul(l.div(c))),h=li(u.shape,s);return h.length>0&&(f=f.sum(h)),f.reshape(u.shape)}}})}}),Aa=ie({div_:function(n,e){var t,r=Y(n,"a","div"),i=Y(e,"b","div");if(t=xr(r,i),r=t[0],i=t[1],r.dtype==="int32"&&i.dtype==="int32")return gG(r,i);var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o,a){var l=o.realDivide(r,i);return a([r,i]),l},{a:r,b:i},function(o,a){var l=a[0],u=a[1];return{a:function(){var c=o.div(u.toFloat()),f=li(l.shape,s);return f.length>0?c.sum(f).reshape(l.shape):c},b:function(){var c=o.mul(l.toFloat()),f=li(u.shape,s);f.length>0&&(c=c.sum(f).reshape(u.shape));var h=u.square();return c.div(h.toFloat()).neg()}}},"Div")}}),C1e=ie({divNoNan_:function(n,e){var t,r=Y(n,"a","div"),i=Y(e,"b","div");r=(t=xr(r,i))[0],i=t[1];var s=Aa(r,i),o=xn(s),a=i.equal(o);return Ch(a,o,s)}}),A1e=ie({divStrict_:function(n,e){var t=Y(n,"a","div"),r=Y(e,"b","div");return kn(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),gG=ie({floorDiv_:function(n,e){var t,r=Y(n,"a","floorDiv"),i=Y(e,"b","floorDiv");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o,a){var l=o.floorDiv(r,i);return a([r,i]),l},{a:r,b:i},function(o,a){var l=a[0],u=a[1];return{a:function(){var c=o.div(u.toFloat()),f=li(l.shape,s);return f.length>0?c.sum(f).reshape(l.shape):c},b:function(){var c=o.mul(l.toFloat()),f=li(u.shape,s);f.length>0&&(c=c.sum(f).reshape(u.shape));var h=u.square();return c.div(h.toFloat()).neg()}}},"FloorDiv")}}),b4=ie({maximum_:function(n,e){var t,r=Y(n,"a","maximum"),i=Y(e,"b","maximum");return t=xr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),fn(r.shape,i.shape),le.runKernelFunc(function(s,o){var a=s.maximum(r,i);return o([r,i]),a},{a:r,b:i},function(s,o){var a=o[0],l=o[1];return{a:function(){return s.mul(a.greaterEqual(l).toFloat())},b:function(){return s.mul(a.less(l).toFloat())}}},"Maximum")}}),R1e=ie({maximumStrict_:function(n,e){var t=Y(n,"a","maximumStrict"),r=Y(e,"b","maximumStrict");return kn(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),vG=ie({minimum_:function(n,e){var t,r=Y(n,"a","minimum"),i=Y(e,"b","minimum");return t=xr(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),fn(r.shape,i.shape),le.runKernelFunc(function(s,o){var a=s.minimum(r,i);return o([r,i]),a},{a:r,b:i},function(s,o){var a=o[0],l=o[1];return{a:function(){return s.mul(a.lessEqual(l).toFloat())},b:function(){return s.mul(a.greater(l).toFloat())}}},"Minimum")}}),P1e=ie({minimumStrict_:function(n,e){var t=Y(n,"a","minimumStrict"),r=Y(e,"b","minimumStrict");return kn(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),I1e=ie({mod_:function(n,e){var t,r=Y(n,"a","mod"),i=Y(e,"b","mod");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o,a){var l=o.mod(r,i);return a([r,i]),l},{$a:r,$b:i},function(o,a){var l=a[0],u=a[1];return{$a:function(){var c=li(l.shape,s);return c.length>0?o.sum(c).reshape(l.shape):o},$b:function(){var c=o.mul(l.div(u).floor().neg()),f=li(u.shape,s);return f.length>0?c.sum(f).reshape(u.shape):c}}})}}),D1e=ie({modStrict_:function(n,e){var t=Y(n,"a","modStrict"),r=Y(e,"b","modStrict");return kn(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),is=ie({mul_:function(n,e){var t,r=Y(n,"a","mul"),i=Y(e,"b","mul");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o,a){var l=o.multiply(r,i);return a([r,i]),l},{a:r,b:i},function(o,a){var l=a[0],u=a[1];return{a:function(){var c=o.mul(u.toFloat()),f=li(l.shape,s);return f.length>0?c.sum(f).reshape(l.shape):c},b:function(){var c=o.mul(l.toFloat()),f=li(u.shape,s);return f.length>0?c.sum(f).reshape(u.shape):c}}},"Mul")}}),N1e=ie({mulStrict_:function(n,e){var t=Y(n,"a","mul"),r=Y(e,"b","mul");return kn(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),K_=ie({pow_:function(n,e){var t,r=Y(n,"base","pow"),i=Y(e,"exp","pow");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape),o=[r,i];return le.runKernelFunc(function(a,l){var u=a.pow(r,i);return l([r,i,u]),u},{a:r,b:i},function(a,l){var u=l[0],c=l[1],f=l[2];return{a:function(){var h=c.toFloat(),d=a.mul(h.mul(u.pow(h.sub(tt(1))))),p=li(u.shape,s);return p.length>0&&(d=d.sum(p)),d.reshape(u.shape)},b:function(){var h=u.greater(0),d=u.log().where(h,xn(u)),p=a.mul(f.mul(d)),y=li(c.shape,s);return y.length>0&&(p=p.sum(y)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),k1e=ie({powStrict_:function(n,e){return kn(n.shape,e.shape,"Error in powStrict: "),n.pow(e)}}),L1e=ie({squaredDifferenceStrict_:function(n,e){var t=Y(n,"a","squaredDifferenceStrict"),r=Y(e,"b","squaredDifferenceStrict");return kn(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),ui=ie({sub_:function(n,e){var t,r=Y(n,"a","sub"),i=Y(e,"b","sub");t=xr(r,i),r=t[0],i=t[1];var s=fn(r.shape,i.shape);return le.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var a=o,l=li(r.shape,s);return l.length>0&&(a=a.sum(l)),a.reshape(r.shape)},b:function(){var a=o,l=li(i.shape,s);return l.length>0&&(a=a.sum(l)),a.neg().reshape(i.shape)}}},"Sub")}}),F1e=ie({subStrict_:function(n,e){var t=Y(n,"a","subStrict"),r=Y(e,"b","subStrict");return kn(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),yG=ie({equal_:function(n,e){var t,r=Y(n,"a","equal"),i=Y(e,"b","equal");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s){return s.equal(r,i)},{$a:r,$b:i})}}),O1e=ie({equalStrict_:function(n,e){var t=Y(n,"a","equalStrict"),r=Y(e,"b","equalStrict");return kn(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),B1e=ie({greater_:function(n,e){var t,r=Y(n,"a","greater"),i=Y(e,"b","greater");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s){return s.greater(r,i)},{a:r,b:i},null,"Greater")}}),xG=ie({greaterEqual_:function(n,e){var t,r=Y(n,"a","greaterEqual"),i=Y(e,"b","greaterEqual");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s,o){var a=s.greaterEqual(r,i);return o([r,i]),a},{a:r,b:i},function(s,o){var a=o[0],l=o[1];return{a:function(){return xn(a)},b:function(){return xn(l)}}},"GreaterEqual")}}),U1e=ie({greaterEqualStrict_:function(n,e){var t=Y(n,"a","greaterEqualStrict"),r=Y(e,"b","greaterEqualStrict");return kn(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),z1e=ie({greaterStrict_:function(n,e){var t=Y(n,"a","greaterStrict"),r=Y(e,"b","greaterStrict");return kn(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),V1e=ie({less_:function(n,e){var t,r=Y(n,"a","less"),i=Y(e,"b","less");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s){return s.less(r,i)},{a:r,b:i},null,"Less")}}),W1e=ie({lessEqual_:function(n,e){var t,r=Y(n,"a","lessEqual"),i=Y(e,"b","lessEqual");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s,o){var a=s.lessEqual(r,i);return o([r,i]),a},{a:r,b:i},null,"LessEqual")}}),H1e=ie({lessEqualStrict_:function(n,e){var t=Y(n,"a","lessEqualStrict"),r=Y(e,"b","lessEqualStrict");return kn(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),G1e=ie({lessStrict_:function(n,e){var t=Y(n,"a","lessStrict"),r=Y(e,"b","lessStrict");return kn(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),j1e=ie({notEqual_:function(n,e){var t,r=Y(n,"a","notEqual"),i=Y(e,"b","notEqual");return t=xr(r,i),r=t[0],i=t[1],fn(r.shape,i.shape),le.runKernelFunc(function(s){return s.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),X1e=ie({notEqualStrict_:function(n,e){var t=Y(n,"a","notEqualStrict"),r=Y(e,"b","notEqualStrict");return kn(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function Q5(n,e){for(var t=[],r=n;r<e;++r)t.push(r);return t}function eB(n){for(var e=[],t=0;t<n.length;++t)for(var r=0;r<n[t].length;++r)e.push(n[t][r]);return e}var S4=ie({gather_:function(n,e,t){t===void 0&&(t=0);var r=Y(n,"x","gather"),i=Y(e,"indices","gather","int32");t=ci(t,r.shape)[0];var s=function(o,a,l){for(var u=o.shape[l],c=[],f=1,h=1,d=0;d<l;d++)c.push(o.shape[d]),f*=o.shape[d];for(d=0;d<a.rank;d++)c.push(a.shape[d]);for(d=l+1;d<o.rank;d++)c.push(o.shape[d]),h*=o.shape[d];return{batchSize:f,sliceSize:h,dimSize:u,outputShape:c}}(r,i,t);return le.runKernelFunc(function(o,a){var l=o.gather(r,i.flatten(),t);return a([i]),l},{x:r,indices:i},function(o,a){var l=a[0];return{x:function(){var u=r.shape,c=l.size,f=u.slice(0,t),h=f.length,d=u.slice(t,u.length).slice(1),p=d.length,y=Q5(0,h),x=Q5(h+1,h+1+p),m=eB([f,[c],d]),_=o.reshape(m),w=l.reshape([c]),b=eB([[h],y,x]),S=_.transpose(b),M=_G(S,w,r.shape[t]),T=u4(b);return M=M.transpose(T)},indices:function(){return l}}},"Gather",{axis:t}).reshape(s.outputShape)}}),_G=ie({unsortedSegmentSum_:function(n,e,t){var r=Y(n,"x","unsortedSegmentSum"),i=Y(e,"segmentIds","unsortedSegmentSum","int32");return Z(Or(t),function(){return"numSegments must be of dtype int"}),le.runKernelFunc(function(s,o){var a=s.unsortedSegmentSum(r,i,t);return o([i]),a},{$x:r},function(s,o){var a=o[0];return{$x:function(){return function(l,u){for(var c=b4(u,xn(u)),f=S4(l,c),h=xG(u,tt(0,"int32")),d=f.rank-h.rank,p=0;p<d;++p)h=Qo(h,p+1);h=fb(h,Tm(f.shape,"bool"));var y=xn(f);return Ch(h,f,y)}(s,a)}}})}}),$1e=function(n,e,t){return vt(this,void 0,void 0,function(){var r,i,s,o,a,l,u,c,f,h,d,p,y;return yt(this,function(x){switch(x.label){case 0:for(r=Y(n,"tensor","boolMask"),i=Y(e,"mask","boolMask","bool"),s=t??0,o=i.rank,a=r.shape,Z(o>0,function(){return"mask cannot be scalar"}),kn(a.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,u=s;u<s+o;u++)l*=a[u];return c=a.slice(0,s).concat([l],a.slice(s+o)),f=r.reshape(c),h=i.reshape([-1]),[4,mG(h)];case 1:return d=x.sent(),p=d.squeeze([1]),y=S4(f,p,s),n!==r&&r.dispose(),e!==i&&i.dispose(),p.dispose(),f.dispose(),h.dispose(),d.dispose(),[2,y]}})})};function wG(n,e,t,r,i,s,o){s===void 0&&(s="NHWC"),Z(n.length===e.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"});var a=n,l=e,u=!1;e.rank===3&&(u=!0,l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),a=[1,n[0],n[1],n[2]]),Z(a.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."}),Z(l.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank}),Z(t.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank});var c=s==="NHWC"?a[3]:a[1],f=s==="NHWC"?l.shape[3]:l.shape[1];Z(c===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+t.shape[2]+"."}),Z(f===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+t.shape[3]+"."}),o!=null&&Z(Or(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var h=p4(s),d=Bh(a,t.shape,r,1,i,o,!1,h),p=le.runKernelFunc(function(y,x){var m=y.conv2dDerInput(l,t,d);return x([t,l]),m},{dy4D:l,filter:t},function(y,x){var m=x[0],_=x[1];return{dy4D:function(){return pa(y,m,r,i,s,1,o)},filter:function(){return E4(y,_,m.shape,r,i,s,o)}}});return u?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Y3(n){var e=function(s){return typeof s=="number"?[s,s,s]:s.length===2?[s[0],s[1],1]:s}(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function bG(n,e,t,r,i){Z(n.length===e.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"});var s=n,o=e,a=!1;e.rank===4&&(a=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),s=[1,n[0],n[1],n[2],n[3]]);var l=s[4],u=o.shape[4];Z(s.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+s.length+"."}),Z(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),Z(t.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank}),Z(l===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+t.shape[3]+"."}),Z(u===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+u+") must match output depth for filter "+t.shape[4]+"."});var c=$_(s,t.shape,r,1,i),f=le.runKernelFunc(function(h){return h.conv3dDerInput(o,t,c)},{dy5D:o});return a?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var q1e=ie({conv1d_:function(n,e,t,r,i,s,o){i===void 0&&(i="NWC"),s===void 0&&(s=1);var a=Y(n,"x","conv1d"),l=Y(e,"filter","conv1d"),u=a,c=!1;a.rank===2&&(c=!0,u=a.as3D(1,a.shape[0],a.shape[1])),Z(u.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."}),Z(l.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."}),o!=null&&Z(Or(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),Z(u.shape[2]===l.shape[1],function(){return"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+l.shape[1]+"."}),Z(eo(t,s),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+s+"'"}),Z(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),h=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),d=pa(h,f,[1,t],r,"NHWC",[1,s],o);return c?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),pa=ie({conv2d_:function(n,e,t,r,i,s,o){i===void 0&&(i="NHWC"),s===void 0&&(s=[1,1]);var a=Y(n,"x","conv2d"),l=Y(e,"filter","conv2d"),u=a,c=!1;a.rank===3&&(c=!0,u=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),Z(u.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."}),Z(l.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."}),o!=null&&Z(Or(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?u.shape[3]:u.shape[1];Z(f===l.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+l.shape[2]+"."}),Z(eo(t,s),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"});var h=p4(i),d=Bh(u.shape,l.shape,t,s,r,o,!1,h),p=[l,u],y=le.runKernelFunc(function(x,m){var _=x.conv2d(u,l,d);return m([l,u]),_},{x:u,filter:l},function(x,m){var _=m,w=_[0],b=_[1];return Z(lm(s),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+s+"'"}),{x:function(){return SG(b.shape,x,w,t,r,i)},filter:function(){return E4(b,x,w.shape,t,r,i)}}},"Conv2D",d,p);return c?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),Y1e=ie({conv3d_:function(n,e,t,r,i,s){i===void 0&&(i="NDHWC"),s===void 0&&(s=[1,1,1]);var o=Y(n,"x","conv3d"),a=Y(e,"filter","conv3d"),l=o,u=!1;o.rank===4&&(u=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),Z(l.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."}),Z(a.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."}),Z(l.shape[4]===a.shape[3],function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+a.shape[3]+"."}),Z(function(h,d){return Y3(h)||Y3(d)}(t,s),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"}),Z(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=$_(l.shape,a.shape,t,s,r),f=le.runKernelFunc(function(h,d){var p=h.conv3d(l,a,c);return d([l,a]),p},{x:l,$filter:a},function(h,d){Z(Y3(s),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+s+"'"});var p=d[0],y=d[1];return{x:function(){return bG(p.shape,h,y,t,r)},$filter:function(){return function(x,m,_,w,b){var S=x;x.rank===4&&(S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]));var M=m;M.rank===4&&(M=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),Z(S.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+S.shape+"."}),Z(M.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+M.shape+"."}),Z(_.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+_+"."}),Z(S.shape[4]===_[3],function(){return"Error in conv3dDerFilter: depth of input "+S.shape[4]+") must match input depth in filter ("+_[3]+"."}),Z(M.shape[4]===_[4],function(){return"Error in conv3dDerFilter: depth of dy ("+M.shape[4]+") must match output depth for filter ("+_[4]+")."});var T=$_(S.shape,_,w,1,b);return le.runKernelFunc(function(P){return P.conv3dDerFilter(S,M,T)},{x5D:S,dy5D:M})}(p,h,y.shape,t,r)}}});return u?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),E4=ie({conv2dDerFilter_:function(n,e,t,r,i,s,o){s===void 0&&(s="NHWC");var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var l=e;l.rank===3&&(l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Z(a.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."}),Z(l.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."}),Z(t.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."});var u=s==="NHWC"?a.shape[3]:a.shape[1],c=s==="NHWC"?l.shape[3]:l.shape[1];Z(u===t[2],function(){return"Error in conv2dDerFilter: depth of input "+u+") must match input depth in filter ("+t[2]+"."}),Z(c===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+t[3]+")."}),o!=null&&Z(Or(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=p4(s),h=Bh(a.shape,t,r,1,i,o,!1,f);return le.runKernelFunc(function(d){return d.conv2dDerFilter(a,l,h)},{x4D:a,dy4D:l})}}),SG=ie({conv2dDerInput_:wG}),hb=ie({depthwiseConv2d_:function(n,e,t,r,i,s,o){s===void 0&&(s=[1,1]);var a=Y(n,"x","depthwiseConv2d"),l=Y(e,"filter","depthwiseConv2d"),u=a,c=!1;a.rank===3&&(c=!0,u=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),Z(u.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+u.rank+"."}),Z(l.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."}),Z(u.shape[3]===l.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."}),s==null&&(s=[1,1]),Z(eo(t,s),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+s+"'"}),o!=null&&Z(Or(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=Bh(u.shape,l.shape,t,s,r,o,!0),h=[u,l],d=le.runKernelFunc(function(p,y){var x=p.depthwiseConv2D(u,l,f);return y([u,l]),x},{x:u,filter:l},function(p,y){Z(lm(s),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+s+"'"});var x=y[0],m=y[1];return{x:function(){return EG(x.shape,p,m,f)},filter:function(){return MG(x,p,m.shape,f)}}},"DepthwiseConv2dNative",f,h);return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),EG=ie({depthwiseConv2dDerInput_:function(n,e,t,r){var i=e,s=!1;e.rank===3&&(s=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=le.runKernelFunc(function(a){return a.depthwiseConv2DDerInput(i,t,r)},{dy4D:i});return s?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),MG=ie({depthwiseConv2dDerFilter_:function(n,e,t,r){var i=n;n.rank===3&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=e;return s.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),le.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,s,r)},{x4D:i,dy4D:s})}}),M4=ie({separableConv2d_:function(n,e,t,r,i,s,o){s===void 0&&(s=[1,1]),o===void 0&&(o="NHWC");var a=Y(n,"x","separableConv2d"),l=Y(e,"depthwiseFilter","separableConv2d"),u=Y(t,"pointwiseFilter","separableConv2d"),c=a,f=!1;if(a.rank===3&&(f=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Z(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),Z(l.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."}),Z(u.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."}),Z(u.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+u.shape[0]+"."}),Z(u.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+u.shape[1]+"."});var h=l.shape[2],d=l.shape[3];Z(u.shape[2]===h*d,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*d+", but got "+u.shape[2]+"."});var p=hb(c,l,r,i,o,s),y=pa(p,u,1,"valid",o);return f?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),K1e=ie({conv2dTranspose_:function(n,e,t,r,i,s){return wG(t,Y(n,"x","conv2dTranspose"),Y(e,"filter","conv2dTranspose"),r,i,"NHWC",s)}}),Z1e=ie({conv3dTranspose_:function(n,e,t,r,i){return bG(t,Y(n,"x","conv3dTranspose"),Y(e,"filter","conv3dTranspose"),r,i)}}),db=ie({matMul_:function(n,e,t,r){var i;t===void 0&&(t=!1),r===void 0&&(r=!1);var s=Y(n,"a","matMul"),o=Y(e,"b","matMul");i=xr(s,o),s=i[0],o=i[1];var a=t?s.shape[s.rank-2]:s.shape[s.rank-1],l=r?o.shape[o.rank-1]:o.shape[o.rank-2],u=t?s.shape[s.rank-1]:s.shape[s.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=s.shape.slice(0,-2),h=o.shape.slice(0,-2),d=bt(f),p=bt(h);Z(s.rank>=2&&o.rank>=2&&s.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+s.rank+" and "+o.rank+"."}),Z(bi(f,h),function(){return"Error in matMul: outer dimensions ("+f+") and ("+h+") of Tensors with shapes "+s.shape+" and "+o.shape+" must match."}),Z(a===l,function(){return"Error in matMul: inner shapes ("+a+") and ("+l+") of Tensors with shapes "+s.shape+" and "+o.shape+" and transposeA="+t+" and transposeB="+r+" must match."});var y=s.shape.slice(0,-2).concat([u,c]),x=t?s.as3D(d,a,u):s.as3D(d,u,a),m=r?o.as3D(p,c,l):o.as3D(p,l,c),_={transposeA:t,transposeB:r};return le.runKernelFunc(function(w,b){var S=w.batchMatMul(x,m,t,r);return b([x,m]),S},{a:x,b:m},function(w,b){var S=b,M=S[0],T=S[1];return t||r?!t&&r?{a:function(){return w.matMul(T,!1,!1)},b:function(){return w.matMul(M,!0,!1)}}:t&&!r?{a:function(){return T.matMul(w,!1,!0)},b:function(){return M.matMul(w,!1,!1)}}:{a:function(){return T.matMul(w,!0,!0)},b:function(){return w.matMul(M,!0,!0)}}:{a:function(){return w.matMul(T,!1,!0)},b:function(){return M.matMul(w,!0,!1)}}},"BatchMatMul",_).reshape(y)}}),J1e=ie({dot_:function(n,e){var t=Y(n,"t1","dot"),r=Y(e,"t2","dot");Z(!(t.rank!==1&&t.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."});var i=t.rank===1?t.size:t.shape[1],s=r.rank===1?r.size:r.shape[0];return Z(i===s,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+s+"."}),t.rank===1&&r.rank===1?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():t.rank===1&&r.rank===2?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():t.rank===2&&r.rank===1?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Q1e=ie({outerProduct_:function(n,e){var t=Y(n,"v1","outerProduct"),r=Y(e,"v2","outerProduct");return Z(t.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."}),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),ly=ie({reverse_:function(n,e){var t=Y(n,"x","reverse");if(t.rank===0)return t.clone();var r=ci(e,t.shape);return le.runKernelFunc(function(i){return i.reverse(t,r)},{$x:t},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(t)}}),exe=ie({reverse1d_:function(n){var e=Y(n,"x","reverse");return Z(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),ly(e,0)}}),txe=ie({reverse2d_:function(n,e){var t=Y(n,"x","reverse");return Z(t.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),ly(t,e)}}),nxe=ie({reverse3d_:function(n,e){var t=Y(n,"x","reverse");return Z(t.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),ly(t,e)}}),rxe=ie({reverse4d_:function(n,e){var t=Y(n,"x","reverse");return Z(t.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),ly(t,e)}});function TG(n,e,t,r,i,s){var o=Y(n,"x","maxPool"),a=o,l=!1;o.rank===3&&(l=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Z(a.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."}),Z(eo(t,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}),s!=null&&Z(Or(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."});var u=Cv(a.shape,e,t,r,i,s);if(u.filterWidth===1&&u.filterHeight===1&&bi(u.inShape,u.outShape))return o.clone();var c=[a],f=le.runKernelFunc(function(h,d){var p=h.maxPool(a,u);return d([a,p]),p},{x:a},function(h,d){var p=d[0],y=d[1];return{x:function(){return function(x,m,_,w,b,S,M,T){var P=Y(x,"dy","maxPoolBackprop"),C=Y(m,"input","maxPoolBackprop"),A=Y(_,"output","maxPoolBackprop");Z(C.rank===P.rank,function(){return"Rank of input ("+C.rank+") does not match rank of dy ("+P.rank+")"}),Z(eo(b,S),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+S+"'"}),Z(P.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+P.rank+"."}),Z(C.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+C.rank+"."});var k=Cv(C.shape,w,b,S,M,T);return le.runKernelFunc(function(L){return L.maxPoolBackprop(P,C,A,k)},{$dy:P,$input:C})}(h,p,y,e,t,r,i)}}},"MaxPool",u,c);return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function CG(n,e,t,r,i,s){var o=Y(n,"x","avgPool","float32");Z(eo(t,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"});var a=o,l=!1;o.rank===3&&(l=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Z(a.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."}),s!=null&&Z(Or(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+i+"."});var u=Cv(a.shape,e,t,r,i,s);if(u.filterWidth===1&&u.filterHeight===1&&bi(u.inShape,u.outShape))return o.clone();var c=le.runKernelFunc(function(f){return f.avgPool(a,u)},{x:a},function(f){return{x:function(){return function(h,d,p,y,x,m){var _=Y(h,"dy","avgPoolBackprop"),w=Y(d,"input","avgPoolBackprop");Z(w.rank===_.rank,function(){return"Rank of input ("+w.rank+") does not match rank of dy ("+_.rank+")"}),Z(eo(y,x),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+x+"'"});var b=w,S=_,M=!1;w.rank===3&&(M=!0,b=w.as4D(1,w.shape[0],w.shape[1],w.shape[2]),S=_.as4D(1,_.shape[0],_.shape[1],_.shape[2])),Z(S.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),Z(b.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+b.rank+"."});var T=Cv(b.shape,p,y,x,m),P=le.runKernelFunc(function(C){return C.avgPoolBackprop(S,b,T)},{dy4D:S,input4D:b});return M?P.as3D(P.shape[1],P.shape[2],P.shape[3]):P}(f,a,e,t,r,i)}}},"AvgPool",u);return c=c.cast(o.dtype),l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var yi=ie({maxPool_:function(n,e,t,r,i){return TG(n,e,t,1,r,i)}}),uy=ie({avgPool_:function(n,e,t,r,i){return CG(n,e,t,1,r,i)}}),ixe=ie({pool_:function(n,e,t,r,i,s){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");var o=Y(n,"x","maxPool"),a=o,l=!1;o.rank===3&&(l=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Z(eo(s,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+i+"'"});var u,c=Cv(a.shape,e,s,i,r),f=[c.dilationHeight,c.dilationWidth];u=r==="same"?function(b,S){var M=b.map(function(C,A){return C+(C-1)*(S[A]-1)}).map(function(C){return C-1}),T=M.map(function(C){return Math.floor(C/2)}),P=M.map(function(C,A){return C-T[A]});return M.map(function(C,A){return[T[A],P[A]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var h=f[0]===1&&f[1]===1,d=function(b,S,M){var T=M.map(function(F){return F[0]}),P=M.map(function(F){return F[1]}),C=b.concat(T,P),A=S.map(function(F,V){return(F-C[V]%F)%F}),k=P.map(function(F,V){return F+A[V]}),L=S.map(function(F,V){return[T[V],k[V]]}),H=S.map(function(F,V){return[0,A[V]]});return[L,H]}([c.inHeight,c.inWidth],f,u),p=d[0],y=d[1],x=h?r:"valid",m=h?a:NH(a,f,p),_=(t==="avg"?function(){return CG(m,e,s,1,x)}:function(){return TG(m,e,s,1,x)})(),w=h?_:PH(_,f,y);return l?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),sxe=ie({maxPool3d_:function(n,e,t,r,i,s,o){s===void 0&&(s="NDHWC");var a=Y(n,"x","maxPool3d"),l=a,u=!1;a.rank===4&&(u=!0,l=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),o==null&&(o=[1,1,1]),Z(l.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."}),Z(s==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+s}),Z(eo(t,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}),i!=null&&Z(Or(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=X_(l.shape,e,t,o,r,i,s),f=le.runKernelFunc(function(h,d){var p=h.maxPool3d(l,c);return d([l,p]),p},{x:l},function(h,d){var p=d[0],y=d[1];return{x:function(){return function(x,m,_,w,b,S,M,T){var P=Y(x,"dy","maxPool3dBackprop"),C=Y(m,"input","maxPool3dBackprop"),A=Y(_,"output","maxPool3dBackprop"),k=P,L=C,H=A,F=!1;C.rank===4&&(F=!0,k=P.as5D(1,P.shape[0],P.shape[1],P.shape[2],P.shape[3]),L=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),H=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),Z(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),Z(L.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+L.rank+"."}),Z(H.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+H.rank+"."}),S==null&&(S=[1,1,1]),Z(eo(b,S),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+S+"'"}),T!=null&&Z(Or(M),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+T+" but got pad "+M+"."});var V=X_(L.shape,w,b,S,M,T),W=le.runKernelFunc(function(G){return G.maxPool3dBackprop(k,L,H,V)},{dy5D:k,input5D:L});return F?W.as4D(W.shape[1],W.shape[2],W.shape[3],W.shape[4]):W}(h,p,y,e,t,o,r,i)}}});return u?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),oxe=ie({avgPool3d_:function(n,e,t,r,i,s,o){s===void 0&&(s="NDHWC");var a=Y(n,"x","avgPool3d","float32"),l=a,u=!1;a.rank===4&&(u=!0,l=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),o==null&&(o=[1,1,1]),Z(l.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."}),Z(s==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+s}),Z(eo(t,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}),i!=null&&Z(Or(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=X_(l.shape,e,t,o,r,i,s),f=le.runKernelFunc(function(h){return h.avgPool3d(l,c)},{x:l},function(h){return{x:function(){return function(d,p,y,x,m,_,w){var b=Y(d,"dy","avgPool3dBackprop"),S=Y(p,"input","avgPool3dBackprop"),M=b,T=S,P=!1;S.rank===4&&(P=!0,M=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3]),T=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),Z(M.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+M.rank+"."}),Z(T.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),m==null&&(m=[1,1,1]),Z(eo(x,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+m+"'"}),w!=null&&Z(Or(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+w+" but got pad "+_+"."});var C=X_(T.shape,y,x,m,_,w),A=le.runKernelFunc(function(k){return k.avgPool3dBackprop(M,T,C)},{dy5D:M,input5D:T});return P?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}(h,l,e,t,o,r,i)}}});return f=f.cast(l.dtype),u?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Al=ie({slice_:function(n,e,t){var r,i,s=Y(n,"x","slice");if(s.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(s.rank-1).fill(0)):e.length<s.rank?e.concat(new Array(s.rank-e.length).fill(0)):e.slice()).forEach(function(l){Z(l!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=t==null?new Array(s.rank).fill(-1):typeof t=="number"?[t].concat(new Array(s.rank-1).fill(-1)):t.length<s.rank?t.concat(new Array(s.rank-t.length).fill(-1)):t).map(function(l,u){return l>=0?l:(Z(l===-1,function(){return"Negative size values should be exactly -1 but got "+l+" for the slice() size at index "+u+"."}),s.shape[u]-r[u])}),kge(s,r,i);var o=s.shape,a={begin:r,size:i};return le.runKernelFunc(function(l){return l.slice(s,r,i)},{x:s},function(l){for(var u=[],c=0;c<l.rank;c++)u.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return l.pad(u)}}},"Slice",a)}}),axe=ie({slice1d_:function(n,e,t){var r=Y(n,"x","slice1d");return Z(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Al(r,[e],[t])}}),lxe=ie({slice2d_:function(n,e,t){var r=Y(n,"x","slice2d");return Z(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Al(r,e,t)}}),AG=ie({slice3d_:function(n,e,t){var r=Y(n,"x","slice3d");return Z(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Al(r,e,t)}}),uxe=ie({slice4d_:function(n,e,t){var r=Y(n,"x","slice4d");return Z(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Al(r,e,t)}});function RG(n,e,t,r,i){return e.rank<t.rank&&(e=e.reshape(Qs(e.shape,r))),n.rank<t.rank&&(n=n.reshape(Qs(n.shape,r))),{x:function(){var s=n.mul(t.equal(e).cast(n.dtype));return i==null?s:s.transpose(i)}}}var cxe=ie({all_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","all","bool"),i=ci(e,r.shape),s=i,o=Pl(s,r.rank);o!=null&&(r=r.transpose(o),s=Il(s.length,r.rank));var a=le.runKernelFunc(function(u){return u.all(r,s)},{$x:r});if(t){var l=Qs(a.shape,i);return a.reshape(l)}return a}}),fxe=ie({any_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","any","bool"),i=ci(e,r.shape),s=i,o=Pl(s,r.rank);o!=null&&(r=r.transpose(o),s=Il(s.length,r.rank));var a=le.runKernelFunc(function(u){return u.any(r,s)},{$x:r});if(t){var l=Qs(a.shape,i);return a.reshape(l)}return a}}),hxe=ie({argMax_:function(n,e){e===void 0&&(e=0);var t=Y(n,"x","argMax");e==null&&(e=0);var r=ci(e,t.shape),i=Pl(r,t.rank);i!=null&&(t=t.transpose(i),r=Il(r.length,t.rank));var s={axis:r[0]},o=[t];return le.runKernelFunc(function(a,l){var u=a.argMax(t,r[0]);return l([t]),u},{x:t},function(a,l){var u=l[0];return{x:function(){return xn(u)}}},"ArgMax",s,o)}}),dxe=ie({argMin_:function(n,e){e===void 0&&(e=0);var t=Y(n,"x","argMin");e==null&&(e=0);var r=ci(e,t.shape),i=Pl(r,t.rank);return i!=null&&(t=t.transpose(i),r=Il(r.length,t.rank)),le.runKernelFunc(function(s,o){var a=s.argMin(t,r[0]);return o([t]),a},{$x:t},function(s,o){var a=o[0];return{$x:function(){return xn(a)}}})}}),pxe=ie({logSumExp_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","logSumExp"),i=ci(e,r.shape),s=r.max(i,!0),o=r.sub(s).exp().sum(i).log(),a=s.reshape(o.shape).add(o);if(t){var l=Qs(a.shape,i);return a.reshape(l)}return a}}),pb=ie({max_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","max"),i=r,s=ci(e,r.shape),o=s,a=Pl(o,r.rank);a!=null&&(r=r.transpose(a),o=Il(o.length,r.rank));var l=[r],u=le.runKernelFunc(function(f,h){var d=f.max(r,o);return h([i,d]),d},{x:r},function(f,h){return RG(f,h[1],h[0],s,a)},"Max",{axes:o},l,[!0]);if(t){var c=Qs(u.shape,s);u=u.reshape(c)}return u}}),mxe=ie({mean_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","mean"),i=ci(e,r.shape),s=bt(Zi(r.shape,i)[1]);return ub(function(o){var a=tt(s);return{value:(a.dtype===o.dtype?o:o.cast(a.dtype)).div(a).sum(e,t),gradFunc:function(l){var u=o.shape.slice();return i.forEach(function(c){u[c]=1}),l.reshape(u).mul(Tm(o.shape,"float32")).div(s)}}})(r)}}),gxe=ie({min_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","min"),i=r,s=ci(e,r.shape),o=s,a=Pl(o,r.rank);a!=null&&(r=r.transpose(a),o=Il(o.length,r.rank));var l=[r],u=le.runKernelFunc(function(f,h){var d=f.min(r,o);return h([i,d]),d},{x:r},function(f,h){return RG(f,h[1],h[0],s,a)},"Min",{axes:o},l,[!0]);if(t){var c=Qs(u.shape,s);u=u.reshape(c)}return u}}),vxe=ie({moments_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=ci(e,(n=Y(n,"x","moments")).shape),i=n.mean(r,t),s=i.shape;t||(s=Qs(i.shape,r));var o=n.toFloat().sub(i.reshape(s)).square();return{mean:i,variance:o.mean(r,t)}}}),PG=ie({sum_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=ci(e,r.shape);return ub(function(s){var o=Pl(i,s.rank),a=i,l=s;o!=null&&(l=s.transpose(o),a=Il(a.length,s.rank));var u=function(d){var p=s.shape.slice();return i.forEach(function(y){p[y]=1}),d.reshape(p).mul(Tm(s.shape,"float32"))},c={axes:a},f=le.runKernelFunc(function(d){return d.sum(l,a)},{x:l},function(d){return{x:function(){return u(d)}}},"Sum",c);if(t){var h=Qs(f.shape,i);f=f.reshape(h)}return{value:f,gradFunc:u}})(r)}}),yxe=ie({prod_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Y(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=ci(e,r.shape),s=Pl(i,r.rank),o=i,a=r;s!=null&&(a=r.transpose(s),o=Il(o.length,r.rank));var l=le.runKernelFunc(function(c){return c.prod(a,o)},{permutedX:a});if(t){var u=Qs(l.shape,i);l=l.reshape(u)}return l}}),IG=ie({elu_:function(n){var e=Y(n,"x","elu");return le.runKernelFunc(function(t,r){var i=t.elu(e);return r([i]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return le.runKernelFunc(function(s){return s.eluDer(t,i)},{dy:t,y:i})}}})}}),xxe=ie({leakyRelu_:function(n,e){e===void 0&&(e=.2);var t=Y(n,"x","leakyRelu");return b4(tt(e).mul(t),t)}}),DG=ie({prelu_:function(n,e){var t=Y(n,"x","prelu"),r=Y(e,"alpha","prelu");return le.runKernelFunc(function(i,s){var o=i.prelu(t,r);return s([t,r]),o},{x:t,alpha:r},function(i,s){var o=s[0],a=s[1],l=o.greater(0);return{x:function(){return Ch(l,i,i.mul(a))},alpha:function(){var u=Ch(l,xn(i),i.mul(o)),c=li(a.shape,i.shape);return c.length>0&&(u=u.sum(c)),u.reshape(a.shape)}}},"Prelu")}}),pr=ie({relu_:function(n){var e=Y(n,"x","relu");return e.dtype==="bool"?e.toInt():le.runKernelFunc(function(t,r){var i=t.relu(e);return r([e]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return t.mulStrict(i.step().toFloat())}}},"Relu")}}),NG=ie({relu6_:function(n){var e=Y(n,"x","relu6");return e.dtype==="bool"?e.toInt():le.runKernelFunc(function(t,r){var i=t.relu6(e);return r([e]),i},{x:e},function(t,r){var i=r[0],s=i.lessEqual(6).mul(i.step());return{x:function(){return t.mulStrict(s.toFloat())}}},"Relu6")}}),_xe=ie({selu_:function(n){var e=Y(n,"x","selu");return le.runKernelFunc(function(t,r){var i=t.selu(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){var s=i.greater(tt(0)),o=tt(x4),a=tt(_4),l=t.mul(a),u=t.mul(o).mul(i.toFloat().exp());return Ch(s,l,u)}}})}}),Vc=ie({transpose_:function(n,e){var t=Y(n,"x","transpose");if(e==null&&(e=t.shape.map(function(i,s){return s}).reverse()),Z(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."}),e.forEach(function(i){Z(i>=0&&i<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e})}),t.rank<=1)return t.clone();var r={perm:e};return le.runKernelFunc(function(i){return i.transpose(t,e)},{x:t},function(i){var s=u4(e);return{x:function(){return i.transpose(s)}}},"Transpose",r)}}),wxe=ie({localResponseNormalization_:function(n,e,t,r,i){e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5);var s=Y(n,"x","localResponseNormalization");Z(s.rank===4||s.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+s.rank+"."}),Z(Or(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var o=s,a=!1;s.rank===3&&(a=!0,o=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]));var l=le.runKernelFunc(function(u,c){var f=u.localResponseNormalization4D(o,e,t,r,i);return c([o,f]),f},{x4D:o},function(u,c){var f=c[0],h=c[1];return{x4D:function(){return le.runKernelFunc(function(d){return d.LRNGrad(u,f,h,e,t,r,i)},{})}}});return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),kG=ie({norm_:function(n,e,t,r){e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1);var i=function a(l,u,c){if(c===void 0&&(c=null),l.rank===0)return l.abs();if(l.rank!==1&&c===null)return a(l.reshape([-1]),u,c);if(l.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(u===1)return l.abs().sum(c);if(u===1/0)return l.abs().max(c);if(u===-1/0)return l.abs().min(c);if(u==="euclidean"||u===2)return l.abs().pow(tt(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}if(Array.isArray(c)&&c.length===2){if(u===1)return l.abs().sum(c[0]).max(c[1]-1);if(u===1/0)return l.abs().sum(c[1]).max(c[0]);if(u===-1/0)return l.abs().sum(c[1]).min(c[0]);if(u==="fro"||u==="euclidean")return l.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+u)}throw new Error("Error in norm: invalid axis: "+c)}(n=Y(n,"x","norm"),e,t),s=i.shape;if(r){var o=ci(t,n.shape);s=Qs(i.shape,o)}return i.reshape(s)}}),bxe=ie({basicLSTMCell_:function(n,e,t,r,i,s){var o=Y(n,"forgetBias","basicLSTMCell"),a=Y(e,"lstmKernel","basicLSTMCell"),l=Y(t,"lstmBias","basicLSTMCell"),u=Y(r,"data","basicLSTMCell"),c=Y(i,"c","basicLSTMCell"),f=Y(s,"h","basicLSTMCell"),h=u.concat(f,1).matMul(a).add(l),d=h.shape[0],p=h.shape[1]/4,y=[d,p],x=h.slice([0,0],y),m=h.slice([0,p],y),_=h.slice([0,2*p],y),w=h.slice([0,3*p],y),b=x.sigmoid().mulStrict(m.tanh()).addStrict(c.mulStrict(o.add(_).sigmoid())),S=b.tanh().mulStrict(w.sigmoid());return[b,S]}}),Sxe=ie({multiRNNCell_:function(n,e,t,r){for(var i=Y(e,"data","multiRNNCell"),s=z_(t,"c","multiRNNCell"),o=z_(r,"h","multiRNNCell"),a=i,l=[],u=0;u<n.length;u++){var c=n[u](a,s[u],o[u]);l.push(c[0]),l.push(c[1]),a=c[1]}var f=[],h=[];for(u=0;u<l.length;u+=2)f.push(l[u]),h.push(l[u+1]);return[f,h]}}),Exe=ie({movingAverage_:function(n,e,t,r,i){i===void 0&&(i=!0);var s=Y(n,"v","movingAverage"),o=Y(e,"x","movingAverage"),a=Y(t,"decay","movingAverage");w0e(s,o),Z(bi(s.shape,o.shape),function(){return"Shape mismatch in v and x"});var l=tt(1),u=l.sub(a),c=o.sub(s).mul(u);if(i){Z(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=Y(r,"step","movingAverage");c=c.div(l.sub(K_(a,f)))}return s.add(c)}}),Mxe=ie({stridedSlice_:function(n,e,t,r,i,s,o,a,l){if(i===void 0&&(i=0),s===void 0&&(s=0),o===void 0&&(o=0),a===void 0&&(a=0),l===void 0&&(l=0),r==null&&(r=new Array(e.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var u=Y(n,"x","stridedSlice"),c=N5(a),f=u.shape.slice();c.forEach(function(x){e[x]=0,t[x]=1,f.splice(x,0,1)}),u=u.reshape(f);for(var h=0;h<u.rank;h++)e[h]=Lge(i,e,r,u.shape,h),t[h]=Fge(s,t,r,u.shape,h),r[h]=r[h]||1;var d=N5(l);d.forEach(function(x){t[x]=e[x]+1,r[x]=1});var p=d4(e,t,r),y=p.filter(function(x,m){return d.indexOf(m)===-1});return r.every(function(x){return x===1})?Al(u,e,p).reshape(y):le.runKernelFunc(function(x){return x.stridedSlice(u,e,t,r)},{$x:u}).reshape(y)}}),Txe=ie({topk_:function(n,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var r=Y(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var s=le.runKernelFunc(function(o){return o.topk(r,e,t)},{$x:r});return{values:s[0],indices:s[1]}}}),Cxe=ie({scatterND_:function(n,e,t){var r=Y(n,"indices","scatterND","int32"),i=Y(e,"updates","scatterND");return Nge(i,r,t),le.runKernelFunc(function(s){return s.scatterND(r,i,t)},{indices:r,updates:i},null,"ScatterNd",{shape:t})}}),T4=ie({fft_:function(n){Z(n.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return le.runKernelFunc(function(i){return i.fft(r)},{input:n}).reshape(n.shape)}}),Z_=ie({ifft_:function(n){Z(n.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return le.runKernelFunc(function(i){return i.ifft(r)},{input:n}).reshape(n.shape)}}),C4=ie({rfft_:function(n,e){Z(n.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+n.dtype});var t,r=n.shape[n.shape.length-1],i=n.size/r;if(e!=null&&e<r){var s=n.shape.map(function(m){return 0}),o=n.shape.map(function(m){return m});o[n.shape.length-1]=e,t=n.slice(s,o),r=e}else if(e!=null&&e>r){var a=n.shape.map(function(m){return m});a[n.shape.length-1]=e-r,t=n.concat(Kn(a),n.shape.length-1),r=e}else t=n;var l=t.zerosLike(),u=Pi(t,l).as2D(i,r),c=T4(u),f=Math.floor(r/2)+1,h=ea(c),d=cl(c),p=h.split([f,r-f],h.shape.length-1),y=d.split([f,r-f],d.shape.length-1),x=t.shape.slice();return x[t.shape.length-1]=f,Pi(p[0],y[0]).reshape(x)}}),LG=ie({irfft_:function(n){var e=n.shape[n.shape.length-1],t=n.size/e;if(e<=2){var r=n.as2D(t,e),i=Z_(r);return ea(i)}var s=[t,2*(e-1)],o=ea(n).as2D(t,e),a=cl(n).as2D(t,e),l=o.slice([0,1],[t,e-2]).reverse(1),u=a.slice([0,1],[t,e-2]).reverse(1).mul(tt(-1)),c=o.concat(l,1),f=a.concat(u,1);return r=Pi(c,f).as2D(s[0],s[1]),i=Z_(r),ea(i)}}),Axe=Object.freeze({fft:T4,ifft:Z_,rfft:C4,irfft:LG}),Rxe=ie({sparseToDense_:function(n,e,t,r){r===void 0&&(r=0);var i=Y(n,"sparseIndices","sparseToDense","int32"),s=Y(e,"sparseValues","sparseToDense"),o=Y(r,"defaultValue","sparseToDense",s.dtype);return function(a,l,u,c){if(a.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+a.dtype+".");if(a.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+a.shape+".");var f=a.rank>0?a.shape[0]:1,h=a.rank>1?a.shape[1]:1;if(u.length!==h)throw new Error("outputShape has incorrect number of elements:, "+u.length+", should be: "+h+".");var d=l.size;if(l.rank!==0&&(l.rank!==1||d!==f))throw new Error("sparseValues has incorrect shape "+l.shape+", should be [] or ["+f+"]");if(l.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,s,t,o),le.runKernelFunc(function(a){return a.sparseToDense(i,s,t,o)},{$sparseIndices:i,$sparseValues:s,$defaultValue:o})}}),Pxe=ie({gatherND_:function(n,e){var t=Y(e,"indices","gatherND","int32"),r=Y(n,"x","gatherND");return le.runKernelFunc(function(i){return i.gatherND(r,t)},{x:r,indices:t},null,"GatherNd")}}),Ixe=ie({diag_:function(n){var e=Y(n,"x","diag").flatten(),t=n.shape.concat(n.shape);return le.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(t)}}),Dxe=ie({dropout_:function(n,e,t,r){var i=Y(n,"x","dropout");if(Z(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),Z(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return n instanceof cr?i.clone():i;var s=function(l,u){if(u==null)return l.shape.slice();if(bi(l.shape,u))return u;if(l.shape.length===u.length){for(var c=[],f=0;f<l.shape.length;f++)u[f]==null&&l.shape[f]!=null?c.push(l.shape[f]):c.push(u[f]);return c}return u}(i,t),o=1-e,a=DH(s,0,1,"float32",r).add(o).floor().div(o);return i.mul(a)}});function FG(n,e,t){for(var r=1-n%2,i=new Float32Array(n),s=0;s<n;++s){var o=2*Math.PI*s/(n+r-1);i[s]=e-t*Math.cos(o)}return Xr(i,"float32")}var A4=ie({hannWindow_:function(n){return FG(n,.5,.5)}}),OG=ie({hammingWindow_:function(n){return FG(n,.54,.46)}}),R4=ie({frame_:function(n,e,t,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var s=0,o=[];s+e<=n.size;)o.push(Al(n,s,e)),s+=t;if(r)for(;s<n.size;){var a=s+e-n.size,l=ii([Al(n,s,e-a),Ml([a],i)]);o.push(l),s+=t}return o.length===0?Tc([],[0,e]):ii(o).as2D(o.length,e)}}),BG=ie({stft_:function(n,e,t,r,i){var s;i===void 0&&(i=A4),r==null&&(s=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))));for(var o=R4(n,e,t),a=is(o,i(e)),l=[],u=0;u<o.shape[0];u++)l.push(C4(a.slice([u,0],[1,e]),r));return ii(l)}}),Nxe=Object.freeze({hannWindow:A4,hammingWindow:OG,frame:R4,stft:BG}),rs,kxe=function(n,e,t){return t===void 0&&(t=1),vt(this,void 0,void 0,function(){var r,i,s,o,a,l,u,c,f,h,d,p,y,x;return yt(this,function(m){switch(m.label){case 0:return r=Y(n,"predictions","inTopK"),i=Y(e,"targets","inTopK"),Z(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),Z(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),kn(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),s=r.shape[r.shape.length-1],Z(t>0&&t<=s,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+s+"), but got "+t}),[4,r.data()];case 1:return o=m.sent(),[4,i.data()];case 2:for(a=m.sent(),l=[o.length/s,s],c=l[1],f=Ev("bool",u=l[0]),h=0;h<u;h++){for(d=h*c,p=o.subarray(d,d+c),y=[],x=0;x<p.length;x++)y.push({value:p[x],index:x});for(y.sort(function(_,w){return w.value-_.value}),f[h]=0,x=0;x<t;x++)if(y[x].index===a[h]){f[h]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),[2,Di(f,i.shape,"bool")]}})})};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(rs||(rs={}));var Lxe=ie({absoluteDifference_:function(n,e,t,r){r===void 0&&(r=rs.SUM_BY_NONZERO_WEIGHTS);var i=Y(n,"labels","absoluteDifference"),s=Y(e,"predictions","absoluteDifference"),o=null;t!=null&&(o=Y(t,"weights","absoluteDifference")),kn(i.shape,s.shape,"Error in absoluteDifference: ");var a=i.sub(s).abs();return Tu(a,o,r)}}),Tu=ie({computeWeightedLoss_:function(n,e,t){t===void 0&&(t=rs.SUM_BY_NONZERO_WEIGHTS);var r=Y(n,"losses","computeWeightedLoss"),i=null;e!=null&&(i=Y(e,"weights","computeWeightedLoss"));var s=i==null?r:r.mul(i);if(t===rs.NONE)return s;if(t===rs.SUM)return s.sum();if(t===rs.MEAN){if(i==null)return s.mean();var o=r.size/i.size,a=s.sum().div(i.sum());return o>1?a.div(tt(o)):a}if(t===rs.SUM_BY_NONZERO_WEIGHTS){if(i==null)return s.sum().div(tt(r.size));var l=i.mul(Tm(r.shape)).notEqual(tt(0)).sum().toFloat();return s.sum().div(l)}throw Error("Unknown reduction: "+t)}}),Fxe=ie({cosineDistance_:function(n,e,t,r,i){i===void 0&&(i=rs.SUM_BY_NONZERO_WEIGHTS);var s=Y(n,"labels","cosineDistance"),o=Y(e,"predictions","cosineDistance"),a=null;r!=null&&(a=Y(r,"weights","cosineDistance")),kn(s.shape,o.shape,"Error in cosineDistance: ");var l=tt(1).sub(s.mul(o).sum(t,!0));return Tu(l,a,i)}}),Oxe=ie({hingeLoss_:function(n,e,t,r){r===void 0&&(r=rs.SUM_BY_NONZERO_WEIGHTS);var i=Y(n,"labels","hingeLoss"),s=Y(e,"predictions","hingeLoss"),o=null;t!=null&&(o=Y(t,"weights","hingeLoss")),kn(i.shape,s.shape,"Error in hingeLoss: ");var a=tt(1);i=tt(2).mul(i).sub(a);var l=a.sub(i.mul(s)).relu();return Tu(l,o,r)}}),Bxe=ie({huberLoss_:function(n,e,t,r,i){r===void 0&&(r=1),i===void 0&&(i=rs.SUM_BY_NONZERO_WEIGHTS);var s=Y(n,"labels","huberLoss"),o=Y(e,"predictions","huberLoss"),a=null;t!=null&&(a=Y(t,"weights","huberLoss")),kn(s.shape,o.shape,"Error in huberLoss: ");var l=tt(r),u=o.sub(s).abs(),c=vG(u,l),f=u.sub(c),h=tt(.5).mul(c.square()).add(l.mul(f));return Tu(h,a,i)}}),Uxe=ie({logLoss_:function(n,e,t,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=rs.SUM_BY_NONZERO_WEIGHTS);var s=Y(n,"labels","logLoss"),o=Y(e,"predictions","logLoss"),a=null;t!=null&&(a=Y(t,"weights","logLoss")),kn(s.shape,o.shape,"Error in logLoss: ");var l=tt(1),u=tt(r),c=s.mul(o.add(u).log()).neg().sub(l.sub(s).mul(l.sub(o).add(u).log()));return Tu(c,a,i)}}),zxe=ie({meanSquaredError_:function(n,e,t,r){r===void 0&&(r=rs.SUM_BY_NONZERO_WEIGHTS);var i=Y(n,"labels","meanSquaredError"),s=Y(e,"predictions","meanSquaredError"),o=null;t!=null&&(o=Y(t,"weights","meanSquaredError")),kn(i.shape,s.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(s);return Tu(a,o,r)}}),Vxe=ie({sigmoidCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=rs.SUM_BY_NONZERO_WEIGHTS);var s=Y(n,"multiClassLabels","sigmoidCrossEntropy"),o=Y(e,"logits","sigmoidCrossEntropy"),a=null;if(t!=null&&(a=Y(t,"weights","sigmoidCrossEntropy")),kn(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=tt(r),u=tt(1),c=tt(.5);s=s.mul(u.sub(l)).add(c.mul(l))}var f=function(h,d){var p=Y(h,"labels","sigmoidCrossEntropyWithLogits"),y=Y(d,"logits","sigmoidCrossEntropyWithLogits");kn(p.shape,y.shape,"Error in sigmoidCrossEntropyWithLogits: ");var x=y.relu(),m=y.mul(p),_=y.abs().neg().exp().log1p();return x.sub(m).add(_)}(s,o);return Tu(f,a,i)}}),Wxe=ie({softmaxCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=rs.SUM_BY_NONZERO_WEIGHTS);var s=Y(n,"onehotLabels","softmaxCrossEntropy"),o=Y(e,"logits","softmaxCrossEntropy"),a=null;if(t!=null&&(a=Y(t,"weights","softmaxCrossEntropy")),kn(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var l=tt(r),u=tt(1),c=tt(s.shape[1]);s=s.mul(u.sub(l)).add(l.div(c))}var f=function(h,d,p){if(p===void 0&&(p=-1),p===-1&&(p=d.rank-1),p!==d.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+d.rank+" and dim was "+p);return ub(function(y,x,m){var _=x.logSumExp([p],!0),w=x.toFloat().sub(_);return m([y,w]),{value:w.mul(y).neg().sum([p]),gradFunc:function(b,S){var M=S[0],T=S[1],P=Qs(b.shape,[p]);return[b.reshape(P).mul(M.toFloat().sub(T.exp())),b.reshape(P).mul(T.exp().sub(M.toFloat()))]}}})(h,d)}(s,o);return Tu(f,a,i)}}),Hxe=Object.freeze({get Reduction(){return rs},absoluteDifference:Lxe,computeWeightedLoss:Tu,cosineDistance:Fxe,hingeLoss:Oxe,huberLoss:Bxe,logLoss:Uxe,meanSquaredError:zxe,sigmoidCrossEntropy:Vxe,softmaxCrossEntropy:Wxe});function tB(n,e){return e===void 0&&(e=!1),le.tidy(function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var t=n.shape[0],r=n.shape[1],i=IH(t),s=n.clone(),o=Tc([[1]],[1,1]),a=o.clone(),l=t>=r?r:t,u=function(f){var h,d=s,p=a,y=i;h=le.tidy(function(){var x=s.slice([f,f],[t-f,1]),m=x.norm(),_=s.slice([f,f],[1,1]),w=Tc([[-1]]).where(_.greater(0),Tc([[1]])),b=_.sub(w.mul(m)),S=x.div(b);a=S.shape[0]===1?o.clone():o.concat(S.slice([1,0],[S.shape[0]-1,S.shape[1]]),0);var M=w.matMul(b).div(m).neg(),T=s.slice([f,0],[t-f,r]),P=M.mul(a);if(f===0)s=T.sub(P.matMul(a.transpose().matMul(T)));else{var C=T.sub(P.matMul(a.transpose().matMul(T)));s=s.slice([0,0],[f,r]).concat(C,0)}var A=i.slice([0,f],[t,i.shape[1]-f]);if(f===0)i=A.sub(A.matMul(a).matMul(P.transpose()));else{var k=A.sub(A.matMul(a).matMul(P.transpose()));i=i.slice([0,0],[t,f]).concat(k,1)}return[a,s,i]}),a=h[0],s=h[1],i=h[2],Zs([d,p,y])},c=0;c<l;++c)u(c);return!e&&t>r&&(i=i.slice([0,0],[t,r]),s=s.slice([0,0],[r,r])),[i,s]})}var Gxe=ie({bandPart_:function(n,e,t){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(t%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+t+".");var r=Y(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,s=r.shape.slice(-2),o=s[0],a=s[1];if(!(e<=o))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+o+").");if(!(t<=a))throw new Error("bandPart(): numUpper ("+t+") must not be greater than the number of columns ("+a+").");e<0&&(e=o),t<0&&(t=a);var l=V_(0,o,1,"int32").reshape([-1,1]),u=V_(0,a,1,"int32"),c=ui(l,u),f=fb(c.lessEqual(tt(+e,"int32")),c.greaterEqual(tt(-t,"int32"))),h=Kn([o,a],r.dtype);return Ro(si(r.reshape([-1,o,a])).map(function(d){return Ch(f,d,h)})).reshape(i)}}),jxe=ie({gramSchmidt_:function(n){var e;if(Array.isArray(n)){e=!1,Z(n!=null&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=n[0].shape[0],r=function(l){Z(n[l].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[l].shape[0]+" vs. "+t+")"})},i=1;i<n.length;++i)r(i)}else e=!0,n=f4(n,n.shape[0],0).map(function(l){return kH(l,[0])});Z(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var s=[],o=n,a=function(l){s.push(le.tidy(function(){var u=o[l];if(l>0)for(var c=0;c<l;++c){var f=PG(s[c].mulStrict(u)).mul(s[c]);u=u.sub(f)}return u.div(kG(u,"euclidean"))}))};for(i=0;i<n.length;++i)a(i);return e?Ro(s,0):s}}),Xxe=ie({qr_:function(n,e){if(e===void 0&&(e=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return tB(n,e);var t=n.shape.slice(0,n.shape.length-2).reduce(function(o,a){return o*a}),r=si(n.reshape([t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],s=[];return r.forEach(function(o){var a=tB(o,e),l=a[0],u=a[1];i.push(l),s.push(u)}),[Ro(i,0).reshape(n.shape),Ro(s,0).reshape(n.shape)]}}),$xe=Object.freeze({bandPart:Gxe,gramSchmidt:jxe,qr:Xxe});function mb(n,e,t,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);var o=n.shape[0];return t=Math.min(t,o),Z(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),Z(n.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),Z(n.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),Z(e.rank===1,function(){return"scores must be a 1D tensor"}),Z(e.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]}),Z(0<=s&&s<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+s+"'"}),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}var qxe=ie({resizeBilinear_:function(n,e,t){t===void 0&&(t=!1);var r=Y(n,"images","resizeBilinear");Z(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),Z(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var i=r,s=!1;r.rank===3&&(s=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],a=e[1],l=le.runKernelFunc(function(u,c){return c([i]),u.resizeBilinear(i,o,a,t)},{x:i},function(u,c){return{x:function(){return le.runKernelFunc(function(f){return f.resizeBilinearBackprop(u,c[0],t)},{})}}},"ResizeBilinear",{alignCorners:t,newHeight:o,newWidth:a});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Yxe=ie({resizeNearestNeighbor_:function(n,e,t){t===void 0&&(t=!1);var r=Y(n,"images","resizeNearestNeighbor");Z(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),Z(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),Z(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,s=!1;r.rank===3&&(s=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],a=e[1],l=le.runKernelFunc(function(u,c){return c([i]),u.resizeNearestNeighbor(i,o,a,t)},{batchImages:i},function(u,c){return{batchImages:function(){return le.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(u,c[0],t)},{})}}});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Kxe=ie({nonMaxSuppression_:function(n,e,t,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var s=Y(n,"boxes","nonMaxSuppression"),o=Y(e,"scores","nonMaxSuppression"),a=mb(s,o,t,r,i);t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;var l={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return le.runKernelFunc(function(u){return u.nonMaxSuppression(s,o,t,r,i)},{boxes:s,scores:o},null,"NonMaxSuppressionV3",l)}}),Zxe=function(n,e,t,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),vt(this,void 0,void 0,function(){var s,o,a,l,u,c,f;return yt(this,function(h){switch(h.label){case 0:return s=Y(n,"boxes","nonMaxSuppressionAsync"),o=Y(e,"scores","nonMaxSuppressionAsync"),a=mb(s,o,t,r,i),t=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,Promise.all([s.data(),o.data()])];case 1:return l=h.sent(),u=l[0],c=l[1],f=m4(u,c,t,r,i),s!==n&&s.dispose(),o!==e&&o.dispose(),[2,f]}})})},Jxe=ie({nonMaxSuppressionWithScore_:function(n,e,t,r,i,s){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),s===void 0&&(s=0);var o=Y(n,"boxes","nonMaxSuppression"),a=Y(e,"scores","nonMaxSuppression"),l=mb(o,a,t,r,i,s),u={maxOutputSize:t=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:i=l.scoreThreshold,softNmsSigma:s=l.softNmsSigma},c=le.runKernel("NonMaxSuppressionV5",{boxes:o,scores:a},u);return{selectedIndices:c[0],selectedScores:c[1]}}}),Qxe=function(n,e,t,r,i,s){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),s===void 0&&(s=0),vt(this,void 0,void 0,function(){var o,a,l,u,c,f,h;return yt(this,function(d){switch(d.label){case 0:return o=Y(n,"boxes","nonMaxSuppressionAsync"),a=Y(e,"scores","nonMaxSuppressionAsync"),l=mb(o,a,t,r,i,s),t=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma,[4,Promise.all([o.data(),a.data()])];case 1:return u=d.sent(),c=u[0],f=u[1],h=g4(c,f,t,r,i,s),o!==n&&o.dispose(),a!==e&&a.dispose(),[2,h]}})})},e2e=ie({cropAndResize_:function(n,e,t,r,i,s){var o=Y(n,"image","cropAndResize"),a=Y(e,"boxes","cropAndResize","float32"),l=Y(t,"boxInd","cropAndResize","int32");i=i||"bilinear",s=s||0;var u=a.shape[0];return Z(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),Z(a.rank===2&&a.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+u+",4] but had shape "+a.shape+"."}),Z(l.rank===1&&l.shape[0]===u,function(){return"Error in cropAndResize: boxInd must be have size ["+u+"] but had shape "+a.shape+"."}),Z(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),Z(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),Z(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),le.runKernelFunc(function(c,f){return c.cropAndResize(o,a,l,r,i,s)},{images:o,boxes:a,boxInd:l},null,"CropAndResize",{method:i,extrapolationValue:s,cropSize:r})}}),P4=Object.freeze({resizeBilinear:qxe,resizeNearestNeighbor:Yxe,nonMaxSuppression:Kxe,nonMaxSuppressionAsync:Zxe,nonMaxSuppressionWithScore:Jxe,nonMaxSuppressionWithScoreAsync:Qxe,cropAndResize:e2e}),I4=function(n,e){return!(n>0)||e==="linear"},D4=function(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return n.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},N4=function(n,e){var t=e,r=li(n.shape,e.shape);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},k4=function(n,e,t){if(e==="linear")return n;if(e==="relu")return pr(n);if(e==="elu")return IG(n);if(e==="relu6")return NG(n);if(e==="prelu")return DG(n,t);throw new Error("Unknown fused activation "+e+".")},t2e=ie({fusedMatMul_:function(n){var e,t=n.a,r=n.b,i=n.transposeA,s=i!==void 0&&i,o=n.transposeB,a=o!==void 0&&o,l=n.bias,u=n.activation,c=u===void 0?"linear":u,f=n.preluActivationWeights;if(I4(le.state.gradientDepth,c)===!1){var h=db(t,r,s,a);return l!=null&&(h=ln(h,l)),k4(h,c,f)}var d=Y(t,"a","fused matMul"),p=Y(r,"b","fused matMul");e=xr(d,p),d=e[0],p=e[1];var y=s?d.shape[d.rank-2]:d.shape[d.rank-1],x=a?p.shape[p.rank-1]:p.shape[p.rank-2],m=s?d.shape[d.rank-1]:d.shape[d.rank-2],_=a?p.shape[p.rank-2]:p.shape[p.rank-1],w=d.shape.slice(0,-2),b=p.shape.slice(0,-2),S=bt(w),M=bt(b);Z(d.rank>=2&&p.rank>=2&&d.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+d.rank+" and "+p.rank+"."}),Z(bi(w,b),function(){return"Error in fused matMul: outer dimensions ("+w+") and ("+b+") of Tensors with shapes "+d.shape+" and "+p.shape+" must match."}),Z(y===x,function(){return"Error in fused matMul: inner shapes ("+y+") and ("+x+") of Tensors with shapes "+d.shape+" and "+p.shape+" and transposeA="+s+" and transposeB="+a+" must match."});var T,P,C=d.shape.slice(0,-2).concat([m,_]),A=s?d.as3D(S,y,m):d.as3D(S,m,y),k=a?p.as3D(M,_,x):p.as3D(M,x,_);l!=null&&fn(C,(T=xr(T=Y(l,"bias","fused matMul"),d)[0]).shape),f!=null&&(P=Y(f,"prelu weights","fused matMul"));var L={a:A,b:k};l!=null&&(L.bias=T),f!=null&&(L.preluActivationWeights=P);var H=[A,k];return le.runKernelFunc(function(F,V){var W=F.fusedBatchMatMul({a:A,b:k,transposeA:s,transposeB:a,bias:T,activation:c,preluActivationWeights:P});return V([A,k,W]),W},L,function(F,V){var W=V[0],G=V[1],N=V[2],B=D4(F,N,c),D={};return l!=null&&(D={bias:function(){return N4(T,B)}}),Object.assign(s||a?!s&&a?{a:function(){return B.matMul(G,!1,!1)},b:function(){return B.matMul(W,!0,!1)}}:s&&!a?{a:function(){return G.matMul(B,!1,!0)},b:function(){return W.matMul(B,!1,!1)}}:{a:function(){return G.matMul(B,!0,!0)},b:function(){return B.matMul(W,!0,!0)}}:{a:function(){return B.matMul(G,!1,!0)},b:function(){return W.matMul(B,!0,!1)}},D)},"_FusedMatMul",{transposeA:s,transposeB:a,activation:c},H,[!0]).reshape(C)}}),n2e=ie({fusedConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,s=n.dataFormat,o=s===void 0?"NHWC":s,a=n.dilations,l=a===void 0?[1,1]:a,u=n.dimRoundingMode,c=n.bias,f=n.activation,h=f===void 0?"linear":f,d=n.preluActivationWeights;if(h=h||"linear",I4(le.state.gradientDepth,h)===!1){var p=pa(e,t,r,i,o,l,u);return c!=null&&(p=ln(p,c)),k4(p,h,d)}var y=Y(e,"x","conv2d"),x=Y(t,"filter","conv2d"),m=y,_=!1;y.rank===3&&(_=!0,m=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),Z(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),Z(x.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+x.rank+"."}),u!=null&&Z(Or(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+i+"."}),Z(m.shape[3]===x.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+x.shape[2]+"."}),Z(eo(r,l),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),Z(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var w,b,S=Bh(m.shape,x.shape,r,l,i,u);c!=null&&(w=xr(w=Y(c,"bias","fused conv2d"),y)[0],fn(S.outShape,w.shape)),d!=null&&(b=Y(d,"prelu weights","fused conv2d"));var M={x:m,filter:x};c!=null&&(M.bias=w),d!=null&&(M.preluActivationWeights=b);var T=[x,m],P=le.runKernelFunc(function(C,A){var k=C.fusedConv2d({input:m,filter:x,convInfo:S,bias:w,activation:h,preluActivationWeights:b});return A([x,m,k]),k},M,function(C,A){var k=A,L=k[0],H=k[1],F=k[2],V=D4(C,F,h);Z(lm(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"});var W={};return c!=null&&(W={bias:function(){return N4(w,V)}}),Object.assign({x:function(){return SG(H.shape,V,L,r,i)},filter:function(){return E4(H,V,L.shape,r,i)}},W)},"FusedConv2D",{convInfo:S,activation:h},T,[!0]);return _?P.as3D(P.shape[1],P.shape[2],P.shape[3]):P}}),r2e=ie({fusedDepthwiseConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,s=n.dataFormat,o=s===void 0?"NHWC":s,a=n.dilations,l=a===void 0?[1,1]:a,u=n.dimRoundingMode,c=n.bias,f=n.activation,h=f===void 0?"linear":f,d=n.preluActivationWeights;if(I4(le.state.gradientDepth,h)===!1){var p=hb(e,t,r,i,o,l,u);return c!=null&&(p=ln(p,c)),k4(p,h,d)}var y=Y(e,"x","depthwiseConv2d"),x=Y(t,"filter","depthwiseConv2d"),m=y,_=!1;y.rank===3&&(_=!0,m=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),Z(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),Z(x.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+x.rank+"."}),Z(m.shape[3]===x.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+x.shape[2]+"."}),l==null&&(l=[1,1]),Z(eo(r,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),u!=null&&Z(Or(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+u+" but got pad "+i+"."});var w,b,S=Bh(m.shape,x.shape,r,l,i,u,!0);c!=null&&(w=xr(w=Y(c,"bias","fused conv2d"),y)[0],fn(S.outShape,w.shape)),d!=null&&(b=Y(d,"prelu weights","fused depthwiseConv2d"));var M={x:m,filter:x};c!=null&&(M.bias=w),d!=null&&(M.preluActivationWeights=b);var T=[x,m],P=le.runKernelFunc(function(C,A){var k=C.fusedDepthwiseConv2D({input:m,filter:x,convInfo:S,bias:w,activation:h,preluActivationWeights:b});return A([x,m,k]),k},M,function(C,A){Z(lm(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"});var k=A[0],L=A[1],H=A[2],F=D4(C,H,h),V={};return c!=null&&(V={bias:function(){return N4(w,F)}}),Object.assign({x:function(){return EG(L.shape,F,k,S)},filter:function(){return MG(L,F,k.shape,S)}},V)},"FusedDepthwiseConv2D",{convInfo:S,activation:h},T,[!0]);return _?P.as3D(P.shape[1],P.shape[2],P.shape[3]):P}}),i2e=Object.freeze({matMul:t2e,conv2d:n2e,depthwiseConv2d:r2e}),s2e=Object.freeze({image:P4,linalg:$xe,losses:Hxe,spectral:Axe,fused:i2e,signal:Nxe,square:Uye,squaredDifference:aG,conv1d:q1e,conv2d:pa,conv3d:Y1e,depthwiseConv2d:hb,separableConv2d:M4,conv2dTranspose:K1e,conv3dTranspose:Z1e,op:ie,batchNormalization2d:m1e,batchNormalization3d:g1e,batchNormalization4d:v1e,batchNormalization:y1e,batchNorm:dG,batchNorm2d:x1e,batchNorm3d:_1e,batchNorm4d:w1e,booleanMaskAsync:$1e,complex:Pi,real:ea,imag:cl,concat:ii,concat1d:ige,concat2d:sge,concat3d:oge,concat4d:age,split:f4,matMul:db,dot:J1e,outerProduct:Q1e,reverse:ly,reverse1d:exe,reverse2d:txe,reverse3d:nxe,reverse4d:rxe,maxPool:yi,avgPool:uy,pool:ixe,maxPool3d:sxe,avgPool3d:oxe,slice:Al,slice1d:axe,slice2d:lxe,slice3d:AG,slice4d:uxe,abs:zye,acos:Vye,acosh:Wye,asin:Hye,asinh:Gye,atan:jye,atanh:Xye,ceil:$ye,clipByValue:w4,cos:qye,cosh:Yye,erf:Kye,exp:iA,expm1:Zye,floor:Jye,log:Qye,log1p:e1e,logSigmoid:t1e,neg:Y_,reciprocal:n1e,round:r1e,rsqrt:lG,sigmoid:uG,sign:i1e,isNaN:s1e,isInf:o1e,isFinite:a1e,sin:l1e,sinh:u1e,softplus:c1e,sqrt:f1e,step:h1e,tan:d1e,tanh:p1e,all:cxe,any:fxe,argMax:hxe,argMin:dxe,logSumExp:pxe,max:pb,mean:mxe,min:gxe,moments:vxe,sum:PG,prod:yxe,equal:yG,equalStrict:O1e,greater:B1e,greaterEqual:xG,greaterEqualStrict:U1e,greaterStrict:z1e,less:V1e,lessEqual:W1e,lessEqualStrict:H1e,lessStrict:G1e,notEqual:j1e,notEqualStrict:X1e,add:ln,addN:E1e,addStrict:M1e,atan2:T1e,div:Aa,divNoNan:C1e,divStrict:A1e,floorDiv:gG,maximum:b4,maximumStrict:R1e,minimum:vG,minimumStrict:P1e,mod:I1e,modStrict:D1e,mul:is,mulStrict:N1e,pow:K_,powStrict:k1e,squaredDifferenceStrict:L1e,sub:ui,subStrict:F1e,elu:IG,leakyRelu:xxe,prelu:DG,relu:pr,relu6:NG,selu:_xe,logicalAnd:fb,logicalNot:b1e,logicalOr:pG,logicalXor:S1e,where:Ch,whereAsync:mG,buffer:jt,print:gge,batchToSpaceND:PH,broadcastTo:vge,cast:yge,clone:xge,cumsum:_ge,depthToSpace:wge,expandDims:Qo,eye:IH,multinomial:bge,oneHot:eA,pad:Oh,pad1d:Sge,pad2d:Ege,pad3d:Mge,pad4d:Tge,rand:Cge,randomNormal:Age,randomGamma:Rge,randomUniform:DH,reshape:Ia,spaceToBatchND:NH,squeeze:kH,stack:Ro,tile:Dp,truncatedNormal:Pge,unstack:si,setdiff1dAsync:Ige,fill:Ml,linspace:rge,ones:Tm,range:V_,scalar:tt,tensor:Di,tensor1d:Xr,tensor2d:Tc,tensor3d:c4,tensor4d:Fs,tensor5d:ege,tensor6d:tge,variable:nge,zeros:Kn,onesLike:RH,zerosLike:xn,transpose:Vc,softmax:Mu,logSoftmax:Bge,localResponseNormalization:wxe,norm:kG,gather:S4,unsortedSegmentSum:_G,basicLSTMCell:bxe,multiRNNCell:Sxe,movingAverage:Exe,stridedSlice:Mxe,topk:Txe,scatterND:Cxe,fft:T4,ifft:Z_,rfft:C4,irfft:LG,sparseToDense:Rxe,gatherND:Pxe,diag:Ixe,dropout:Dxe,hannWindow:A4,hammingWindow:OG,frame:R4,stft:BG,inTopKAsync:kxe});function Ve(n,e){Array.isArray(n)||(n=[n]),n.forEach(function(t){t!=null&&Z(t.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function K3(n,e,t,r){if(t==="linear")return n.linear(e);if(t==="relu")return n.relu(e);if(t==="elu")return n.elu(e);if(t==="relu6")return n.relu6(e);if(t==="prelu")return n.prelu(e,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var o2e=function(n){function e(){var t=n.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new VH(t,le),t}return Ha(e,n),e.prototype.write=function(t,r,i){this.firstUse&&(this.firstUse=!1,Fe().get("IS_NODE")&&U_(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var s={};return this.data.set(s,{values:t,dtype:i}),s},e.prototype.move=function(t,r,i,s){this.data.set(t,{values:r,dtype:s})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){return[2,this.readSync(t)]})})},e.prototype.readSync=function(t){var r=this.data.get(t),i=r.dtype,s=r.complexTensors;return i==="complex64"?rA(this.readSync(s.real.dataId),this.readSync(s.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),i=r;if(t.dtype==="string")try{i=r.map(function(s){return F_(s)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return jt(t.shape,t.dtype,i)},e.prototype.makeOutput=function(t,r,i){var s=this.write(t,r,i);return le.makeTensorFromDataId(s,r,i,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return vt(this,void 0,void 0,function(){var r;return yt(this,function(i){return r=ol(),t(),[2,{kernelMs:ol()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,r){var i=this.makeOutput(null,t.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:le.keep(t.clone()),imag:le.keep(r.clone())},i},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(Ve(t,"slice"),UH(t.shape,r,i)){var s=zH(r,t.strides),o=bt(i);return Di(this.readSync(t.dataId).subarray(s,s+o),i,t.dtype)}for(var a=jt(i,t.dtype),l=this.bufferSync(t),u=0;u<a.size;++u){var c=a.indexToLoc(u).map(function(f,h){return f+r[h]});a.values[u]=l.get.apply(l,c)}return a.toTensor()},e.prototype.stridedSlice=function(t,r,i,s){Ve(t,"stridedSlice");var o=d4(r,i,s);if(o.some(function(d){return d===0}))return Di([],o);for(var a=jt(o,t.dtype),l=this.bufferSync(t),u=0;u<a.size;u++){for(var c=a.indexToLoc(u),f=new Array(c.length),h=0;h<f.length;h++)f[h]=c[h]*s[h]+r[h];a.set.apply(a,[l.get.apply(l,f)].concat(c))}return a.toTensor()},e.prototype.diag=function(t){for(var r=this.readSync(t.dataId),i=jt([t.size,t.size],t.dtype),s=i.values,o=0;o<r.length;o++)s[o*t.size+o]=r[o];return i.toTensor()},e.prototype.unstack=function(t,r){for(var i=t.shape[r],s=new Array(t.rank-1),o=0,a=0;a<t.rank;a++)a!==r&&(s[o++]=t.shape[a]);var l=new Array(t.rank).fill(0),u=t.shape.slice();u[r]=1;var c=new Array(i);for(a=0;a<c.length;a++)l[r]=a,c[a]=this.slice(t,l,u).reshape(s);return c},e.prototype.reverse=function(t,r){Ve(t,"reverse");for(var i=jt(t.shape,t.dtype),s=this.bufferSync(t),o=function(l){var u=i.indexToLoc(l),c=u.slice();r.forEach(function(f){return c[f]=t.shape[f]-1-c[f]}),i.set.apply(i,[s.get.apply(s,c)].concat(u))},a=0;a<i.size;a++)o(a);return i.toTensor()},e.prototype.concat=function(t,r){var i=this;if(t[0].dtype==="complex64"){var s=t.map(function(d){return ea(d)}),o=t.map(function(d){return cl(d)});return Pi(this.concat(s,r),this.concat(o,r))}var a=t.map(function(d){var p=bt(d.shape.slice(r));return d.as2D(-1,p)}),l=am(a.map(function(d){return d.shape}),1),u=jt(l,t[0].dtype).values;if(a[0].shape[0]===1){var c=0;a.forEach(function(d){u.set(i.readSync(d.dataId),c),c+=d.size})}else{var f=0;a.forEach(function(d){for(var p=i.readSync(d.dataId),y=0,x=0;x<d.shape[0];++x)for(var m=x*l[1]+f,_=0;_<d.shape[1];++_)u[m+_]=p[y++];f+=d.shape[1]})}var h=am(t.map(function(d){return d.shape}),r);return Di(u,h,t[0].dtype)},e.prototype.neg=function(t){return Ve(t,"neg"),this.multiply(tt(-1),t)},e.prototype.add=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,s,o,a){return{real:i+o,imag:s+a}}):this.broadcastedBinaryOp(t,r,Ii(t.dtype,r.dtype),function(i,s){return i+s})},e.prototype.addN=function(t){var r=this;Ve(t,"addN");for(var i=t.map(function(c){return r.readSync(c.dataId)}),s=jt(t[0].shape,t[0].dtype),o=s.values,a=0;a<t.length;a++)for(var l=i[a],u=0;u<o.length;u++)o[u]+=l[u];return s.toTensor()},e.prototype.softmax=function(t,r){var i=ci([r],t.shape),s=this.max(t,i),o=Qs(s.shape,i),a=this.subtract(t,s.reshape(o)),l=this.exp(a),u=this.sum(l,i).reshape(o);return this.realDivide(l,u)},e.prototype.subtract=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,s,o,a){return{real:i-o,imag:s-a}}):this.broadcastedBinaryOp(t,r,Ii(t.dtype,r.dtype),function(i,s){return i-s})},e.prototype.pow=function(t,r){return Ve([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){return Math.pow(i,s)})},e.prototype.batchMatMul=function(t,r,i,s){Ve([t,r],"matMul");for(var o=i?t.shape[1]:t.shape[2],a=i?t.shape[2]:t.shape[1],l=s?r.shape[1]:r.shape[2],u=t.shape[0],c=this.readSync(t.dataId),f=this.readSync(r.dataId),h=i?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],d=h[0],p=h[1],y=h[2],x=s?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=x[0],_=x[1],w=x[2],b=a*l,S=jt([u,a,l],t.dtype),M=S.values,T=this.blockSize,P=0;P<u;P++)for(var C=0;C<a;C+=T)for(var A=0;A<l;A+=T)for(var k=0;k<o;k+=T)for(var L=Math.min(C+T,a),H=Math.min(A+T,l),F=Math.min(k+T,o),V=C;V<L;V++)for(var W=A;W<H;W++){for(var G=0,N=k;N<F;N++)G+=c[P*d+V*p+N*y]*f[N*m+W*_+P*w];M[P*b+(V*l+W)]+=G}return S.toTensor()},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,s=t.transposeA,o=t.transposeB,a=t.bias,l=t.activation,u=t.preluActivationWeights,c=this.batchMatMul(r,i,s,o);return a&&(c=this.add(c,a)),l&&(c=K3(this,c,l,u)),c},e.prototype.multiply=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,s,o,a){return{real:i*o-s*a,imag:i*a+s*o}}):this.broadcastedBinaryOp(t,r,Ii(t.dtype,r.dtype),function(i,s){return i*s})},e.prototype.realDivide=function(t,r){return Ve([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",function(i,s){return i/s})},e.prototype.floorDiv=function(t,r){return Ve([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",function(i,s){return Math.floor(i/s)})},e.prototype.sum=function(t,r){Ve(t,"sum"),mo("sum",r,t.rank);for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,Ii(t.dtype,"int32")),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=0,p=0;p<l;++p)d+=c[h+p];u[f]=d}return a},e.prototype.prod=function(t,r){Ve(t,"sum");for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,Ii(t.dtype,"int32")),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=1,p=0;p<l;++p)d*=c[h+p];u[f]=d}return a},e.prototype.unsortedSegmentSum=function(t,r,i){Ve(t,"unsortedSegmentSum");for(var s=[],o=t.rank-r.rank,a=0;a<o;++a)r=r.expandDims(a+1);for(a=0;a<i;++a){var l=tt(a,"int32"),u=yG(l,r).asType("float32").mul(t).sum(0);s.push(u)}return Ro(s)},e.prototype.argMin=function(t,r){Ve(t,"argMin");var i=[r];mo("argMin",i,t.rank);for(var s=Zi(t.shape,i),o=s[0],a=s[1],l=Kn(o,"int32"),u=bt(a),c=this.readSync(l.dataId),f=this.readSync(t.dataId),h=0;h<c.length;++h){for(var d=h*u,p=f[d],y=0,x=0;x<u;++x){var m=f[d+x];m<p&&(p=m,y=x)}c[h]=y}return l},e.prototype.argMax=function(t,r){Ve(t,"argMax");var i=[r];mo("argMax",i,t.rank);for(var s=Zi(t.shape,i),o=s[0],a=s[1],l=Kn(o,"int32"),u=bt(a),c=this.readSync(l.dataId),f=this.readSync(t.dataId),h=0;h<c.length;++h){for(var d=h*u,p=f[d],y=0,x=0;x<u;++x){var m=f[d+x];m>p&&(p=m,y=x)}c[h]=y}return l},e.prototype.cumsum=function(t,r,i,s){if(Ve(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var o=Ii(t.dtype,"int32"),a=Kn(t.shape,o),l=this.readSync(a.dataId),u=this.readSync(t.dataId),c=t.shape[t.rank-1],f=s?function(x,m){return x+c-m-1}:function(x,m){return x+m},h=0;h<u.length;h+=c)for(var d=0;d<c;d++){var p=f(h,d);if(d===0)l[p]=i?0:u[p];else{var y=f(h,d-1);l[p]=i?u[y]+l[y]:u[p]+l[y]}}return a},e.prototype.equal=function(t,r){return Ve([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i===s?1:0})},e.prototype.notEqual=function(t,r){return Ve([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i!==s?1:0})},e.prototype.less=function(t,r){return Ve([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i<s?1:0})},e.prototype.lessEqual=function(t,r){return Ve([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i<=s?1:0})},e.prototype.greater=function(t,r){return Ve([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i>s?1:0})},e.prototype.greaterEqual=function(t,r){return Ve([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i>=s?1:0})},e.prototype.logicalNot=function(t){Ve(t,"logicalNot");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),s=0;s<r.length;++s)i[s]=r[s]?0:1;return this.makeOutput(i,t.shape,"bool")},e.prototype.logicalAnd=function(t,r){return Ve([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i&&s})},e.prototype.logicalOr=function(t,r){return Ve([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",function(i,s){return i||s})},e.prototype.select=function(t,r,i){Ve([t,r,i],"select");for(var s=this.readSync(t.dataId),o=this.readSync(r.dataId),a=this.readSync(i.dataId),l=Kn(r.shape,Ii(r.dtype,i.dtype)),u=this.readSync(l.dataId),c=0,f=t.rank===0||t.rank>1||r.rank===1?1:bt(r.shape.slice(1)),h=0;h<s.length;h++)for(var d=0;d<f;d++)s[h]===1?u[c++]=o[h]:u[c++]=a[h];return l},e.prototype.where=function(t){Ve([t],"where");var r=this.readSync(t.dataId);return v4(t.shape,r)},e.prototype.topk=function(t,r,i){return Ve(t,"topk"),YH(this.readSync(t.dataId),t.shape,t.dtype,r)},e.prototype.min=function(t,r){Ve(t,"min"),mo("min",r,t.rank);for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,t.dtype),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=c[h],p=0;p<l;++p){var y=c[h+p];y<d&&(d=y)}u[f]=d}return a},e.prototype.minimum=function(t,r){return Ve([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){return Math.min(i,s)})},e.prototype.mod=function(t,r){return Ve([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){var o=i%s;return i<0&&s<0||i>=0&&s>=0?o:(o+s)%s})},e.prototype.max=function(t,r){Ve(t,"max"),mo("max",r,t.rank);for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,t.dtype),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=c[h],p=0;p<l;++p){var y=c[h+p];y>d&&(d=y)}u[f]=d}return a},e.prototype.maximum=function(t,r){return Ve([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){return Math.max(i,s)})},e.prototype.all=function(t,r){Ve(t,"all"),mo("all",r,t.rank);for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,t.dtype),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=c[h],p=0;p<l;++p){var y=c[h+p];d=d&&y}u[f]=d}return a},e.prototype.any=function(t,r){Ve(t,"any"),mo("any",r,t.rank);for(var i=Zi(t.shape,r),s=i[0],o=i[1],a=Kn(s,t.dtype),l=bt(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),f=0;f<u.length;++f){for(var h=f*l,d=c[h],p=0;p<l;++p){var y=c[h+p];d=d||y}u[f]=d}return a},e.prototype.squaredDifference=function(t,r){return Ve([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){var o=i-s;return o*o})},e.prototype.ceil=function(t){Ve(t,"ceil");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)i[s]=Math.ceil(r[s]);return this.makeOutput(i,t.shape,"float32")},e.prototype.floor=function(t){Ve(t,"floor");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)i[s]=Math.floor(r[s]);return this.makeOutput(i,t.shape,"float32")},e.prototype.sign=function(t){Ve(t,"x");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)r[s]<0?i[s]=-1:r[s]>0?i[s]=1:i[s]=0;return this.makeOutput(i,t.shape,"float32")},e.prototype.isNaN=function(t){Ve(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),s=0;s<r.length;++s)Number.isNaN(r[s])&&(i[s]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isInf=function(t){Ve(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),s=0;s<r.length;++s)Math.abs(r[s])===1/0&&(i[s]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isFinite=function(t){Ve(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),s=0;s<r.length;++s)Number.isFinite(r[s])&&(i[s]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.round=function(t){Ve(t,"round");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s){var o=Math.floor(r[s]);r[s]-o<.5?i[s]=Math.floor(r[s]):r[s]-o>.5?i[s]=Math.ceil(r[s]):i[s]=o%2==0?o:o+1}return this.makeOutput(i,t.shape,"float32")},e.prototype.exp=function(t){Ve(t,"exp");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)i[s]=Math.exp(r[s]);return this.makeOutput(i,t.shape,"float32")},e.prototype.expm1=function(t){Ve(t,"expm1");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)i[s]=Math.expm1(r[s]);return this.makeOutput(i,t.shape,"float32")},e.prototype.log=function(t){Ve(t,"log");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s){var o=r[s];i[s]=Math.log(o)}return this.makeOutput(i,t.shape,"float32")},e.prototype.log1p=function(t){Ve(t,"log1p");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s){var o=r[s];i[s]=Math.log1p(o)}return this.makeOutput(i,t.shape,"float32")},e.prototype.sqrt=function(t){Ve(t,"sqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s){var o=r[s];i[s]=Math.sqrt(o)}return this.makeOutput(i,t.shape,"float32")},e.prototype.rsqrt=function(t){Ve(t,"rsqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s){var o=r[s];i[s]=1/Math.sqrt(o)}return this.makeOutput(i,t.shape,"float32")},e.prototype.reciprocal=function(t){Ve(t,"reciprocal");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),s=0;s<r.length;++s)i[s]=1/r[s];return this.makeOutput(i,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){Ve(t,"relu");for(var r=Kn(t.shape,t.dtype),i=this.readSync(r.dataId),s=this.readSync(t.dataId),o=0;o<s.length;++o)i[o]=Math.max(0,s[o]);return r},e.prototype.relu6=function(t){Ve(t,"relu");for(var r=Kn(t.shape,t.dtype),i=this.readSync(r.dataId),s=this.readSync(t.dataId),o=0;o<s.length;++o)i[o]=Math.min(Math.max(0,s[o]),6);return r},e.prototype.prelu=function(t,r){return Ve([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){return i<0?s*i:i})},e.prototype.elu=function(t){Ve(t,"elu");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s){var o=i[s];r[s]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,t.shape,"float32")},e.prototype.eluDer=function(t,r){Ve([t,r],"eluDer");for(var i=new Float32Array(r.size),s=this.readSync(r.dataId),o=this.readSync(t.dataId),a=0;a<s.length;++a){var l=s[a];i[a]=l>=1?o[a]:o[a]*(l+1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.selu=function(t){Ve(t,"selu");for(var r=x4,i=_4,s=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var l=o[a];s[a]=l>=0?i*l:r*(Math.exp(l)-1)}return this.makeOutput(s,t.shape,"float32")},e.prototype.clip=function(t,r,i){Ve(t,"clip");for(var s=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var l=o[a];s[a]=l>i?i:l<r?r:l}return this.makeOutput(s,t.shape,"float32")},e.prototype.abs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.abs(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<t.size;++s){var o=i[2*s],a=i[2*s+1];r[s]=Math.hypot(o,a)}return this.makeOutput(r,t.shape,"float32")},e.prototype.int=function(t){Ve(t,"int");for(var r=new Int32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=i[s];return this.makeOutput(r,t.shape,"int32")},e.prototype.sigmoid=function(t){Ve(t,"sigmoid");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=1/(1+Math.exp(-i[s]));return this.makeOutput(r,t.shape,"float32")},e.prototype.softplus=function(t){Ve(t,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(t.size),s=this.readSync(t.dataId),o=0;o<s.length;++o){var a=s[o]>-r,l=s[o]<r,u=Math.exp(s[o]),c=void 0;c=l?u:a?s[o]:Math.log(1+u),i[o]=c}return this.makeOutput(i,t.shape,"float32")},e.prototype.sin=function(t){Ve(t,"sin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.sin(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cos=function(t){Ve(t,"cos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.cos(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tan=function(t){Ve(t,"tan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.tan(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asin=function(t){Ve(t,"asin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.asin(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acos=function(t){Ve(t,"acos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.acos(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan=function(t){Ve(t,"atan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.atan(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan2=function(t,r){return Ve([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,s){return Math.atan2(i,s)})},e.prototype.sinh=function(t){Ve(t,"sinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.sinh(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cosh=function(t){Ve(t,"cosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.cosh(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tanh=function(t){Ve(t,"tanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=a0e(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asinh=function(t){Ve(t,"asinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.asinh(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acosh=function(t){Ve(t,"acosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.acosh(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atanh=function(t){Ve(t,"atanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s)r[s]=Math.atanh(i[s]);return this.makeOutput(r,t.shape,"float32")},e.prototype.erf=function(t){Ve(t,"erf");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),s=0;s<i.length;++s){var o=Math.sign(i[s]),a=Math.abs(i[s]),l=1/(1+.3275911*a);r[s]=o*(1-((((1.061405429*l-1.453152027)*l+1.421413741)*l-.284496736)*l+.254829592)*l*Math.exp(-a*a))}return this.makeOutput(r,t.shape,"float32")},e.prototype.step=function(t,r){r===void 0&&(r=0),Ve(t,"step");for(var i=new Float32Array(t.size),s=this.readSync(t.dataId),o=0;o<s.length;++o){var a=s[o];isNaN(a)?i[o]=NaN:i[o]=a>0?1:r}return this.makeOutput(i,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,s=t.convInfo,o=t.bias,a=t.activation,l=t.preluActivationWeights,u=this.conv2d(r,i,s);return o&&(u=this.add(u,o)),a&&(u=K3(this,u,a,l)),u},e.prototype.conv2d=function(t,r,i){Ve([t,r],"conv2d");for(var s=i.filterHeight,o=i.filterWidth,a=i.dilationHeight,l=i.dilationWidth,u=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",h=jt(i.outShape,t.dtype),d=t.strides[0],p=f?t.strides[1]:t.strides[2],y=f?t.strides[2]:1,x=f?1:t.strides[1],m=h.strides[0],_=f?h.strides[1]:h.strides[2],w=f?h.strides[2]:1,b=f?1:h.strides[1],S=this.readSync(t.dataId),M=this.readSync(r.dataId),T=h.values,P=0;P<i.batchSize;++P)for(var C=P*d,A=P*m,k=0;k<i.outHeight;++k)for(var L=A+k*_,H=k*i.strideHeight-c,F=0;F<s;F++){var V=H+F*a;if(!(V<0||V>=i.inHeight))for(var W=F*r.strides[0],G=C+V*p,N=0;N<i.outWidth;++N)for(var B=L+N*w,D=N*i.strideWidth-u,$=0;$<o;$++){var ee=D+$*l;if(!(ee<0||ee>=i.inWidth))for(var te=G+ee*y,se=W+$*r.strides[1],me=0;me<i.inChannels;++me){for(var _e=S[te+me*x],pe=0;pe<i.outChannels;++pe)T[B+pe*b]+=_e*M[se+pe];se+=i.outChannels}}}return h.toTensor()},e.prototype.conv3d=function(t,r,i){for(var s=i.filterDepth,o=i.filterHeight,a=i.filterWidth,l=i.dilationDepth,u=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,h=i.padInfo.left,d=i.padInfo.top,p=jt(i.outShape,t.dtype),y=this.readSync(t.dataId),x=this.readSync(r.dataId),m=p.values,_=0;_<i.batchSize;++_)for(var w=_*t.strides[0],b=_*p.strides[0],S=0;S<i.outDepth;++S)for(var M=b+S*p.strides[1],T=S*i.strideDepth-f,P=0;P<s;P++){var C=T+P*l;if(!(C<0||C>=i.inDepth))for(var A=P*r.strides[0],k=w+C*t.strides[1],L=0;L<i.outHeight;++L)for(var H=M+L*p.strides[2],F=L*i.strideHeight-d,V=0;V<o;V++){var W=F+V*u;if(!(W<0||W>=i.inHeight))for(var G=A+V*r.strides[1],N=k+W*t.strides[2],B=0;B<i.outWidth;++B)for(var D=H+B*i.outChannels,$=B*i.strideWidth-h,ee=0;ee<a;ee++){var te=$+ee*c;if(!(te<0||te>=i.inWidth))for(var se=G+ee*r.strides[2],me=N+te*i.inChannels,_e=se,pe=0;pe<i.inChannels;++pe){for(var Ne=y[me+pe],Ue=0;Ue<i.outChannels;++Ue)m[D+Ue]+=Ne*x[_e+Ue];_e+=i.outChannels}}}}return p.toTensor()},e.prototype.conv2dDerInput=function(t,r,i){Ve([t,r],"conv2dDerInput");for(var s=jt(i.inShape,"float32"),o=s.values,a=this.readSync(t.dataId),l=this.readSync(r.dataId),u=r.strides,c=u[0],f=u[1],h=u[2],d=i.batchSize,p=i.filterHeight,y=i.filterWidth,x=i.inChannels,m=i.inHeight,_=i.inWidth,w=i.outChannels,b=i.outHeight,S=i.outWidth,M=i.strideHeight,T=i.strideWidth,P=i.dataFormat,C=p-1-i.padInfo.top,A=y-1-i.padInfo.left,k=P==="channelsLast",L=s.strides[0],H=k?s.strides[1]:s.strides[2],F=k?s.strides[2]:1,V=k?1:s.strides[1],W=t.strides[0],G=k?t.strides[1]:t.strides[2],N=k?t.strides[2]:1,B=k?1:t.strides[1],D=0;D<d;++D)for(var $=0;$<x;++$)for(var ee=0;ee<m;++ee)for(var te=ee-C,se=Math.max(0,Math.ceil(te/M)),me=Math.min(b,(p+te)/M),_e=0;_e<_;++_e){for(var pe=_e-A,Ne=Math.max(0,Math.ceil(pe/T)),Ue=Math.min(S,(y+pe)/T),We=0,Be=se;Be<me;++Be)for(var J=Be*M-te,he=Ne;he<Ue;++he)for(var de=W*D+G*Be+N*he,Ie=c*(p-1-J)+f*(y-1-(he*T-pe))+h*$,ve=0;ve<w;++ve)We+=a[de+B*ve]*l[Ie+ve];o[L*D+H*ee+F*_e+V*$]=We}return s.toTensor()},e.prototype.conv3dDerInput=function(t,r,i){for(var s=jt(i.inShape,"float32"),o=s.values,a=s.strides,l=a[0],u=a[1],c=a[2],f=a[3],h=this.readSync(t.dataId),d=t.strides,p=d[0],y=d[1],x=d[2],m=d[3],_=this.readSync(r.dataId),w=r.strides,b=w[0],S=w[1],M=w[2],T=w[3],P=i.batchSize,C=i.filterDepth,A=i.filterHeight,k=i.filterWidth,L=i.inChannels,H=i.inDepth,F=i.inHeight,V=i.inWidth,W=i.outChannels,G=i.outDepth,N=i.outHeight,B=i.outWidth,D=i.strideDepth,$=i.strideHeight,ee=i.strideWidth,te=C-1-i.padInfo.front,se=A-1-i.padInfo.top,me=k-1-i.padInfo.left,_e=0;_e<P;++_e)for(var pe=0;pe<L;++pe)for(var Ne=0;Ne<H;++Ne)for(var Ue=Ne-te,We=Math.max(0,Math.ceil(Ue/D)),Be=Math.min(G,(C+Ue)/D),J=0;J<F;++J)for(var he=J-se,de=Math.max(0,Math.ceil(he/$)),Ie=Math.min(N,(A+he)/$),ve=0;ve<V;++ve){for(var oe=ve-me,ze=Math.max(0,Math.ceil(oe/ee)),X=Math.min(B,(k+oe)/ee),j=0,ae=We;ae<Be;++ae)for(var Oe=ae*D-Ue,Se=de;Se<Ie;++Se)for(var K=Se*$-he,ge=ze;ge<X;++ge)for(var Te=p*_e+y*ae+x*Se+m*ge,Le=b*(C-1-Oe)+S*(A-1-K)+M*(k-1-(ge*ee-oe))+T*pe,Pe=0;Pe<W;++Pe)j+=h[Te+Pe]*_[Le+Pe];o[l*_e+u*Ne+c*J+f*ve+pe]=j}return s.toTensor()},e.prototype.conv2dDerFilter=function(t,r,i){Ve([t,r],"conv2dDerFilter");for(var s=i.strideHeight,o=i.strideWidth,a=i.filterHeight,l=i.filterWidth,u=i.dataFormat==="channelsLast",c=jt(i.filterShape,"float32"),f=i.padInfo.left,h=i.padInfo.top,d=this.bufferSync(t),p=this.bufferSync(r),y=0;y<a;++y)for(var x=Math.max(0,Math.ceil((h-y)/s)),m=Math.min(i.outHeight,(i.inHeight+h-y)/s),_=0;_<l;++_)for(var w=Math.max(0,Math.ceil((f-_)/o)),b=Math.min(i.outWidth,(i.inWidth+f-_)/o),S=0;S<i.inChannels;++S)for(var M=0;M<i.outChannels;++M){for(var T=0,P=0;P<i.batchSize;++P)for(var C=x;C<m;++C)for(var A=y+C*s-h,k=w;k<b;++k){var L=_+k*o-f;T+=u?d.get(P,A,L,S)*p.get(P,C,k,M):d.get(P,S,A,L)*p.get(P,M,C,k)}c.set(T,y,_,S,M)}return c.toTensor()},e.prototype.conv3dDerFilter=function(t,r,i){for(var s=i.strideDepth,o=i.strideHeight,a=i.strideWidth,l=i.filterDepth,u=i.filterHeight,c=i.filterWidth,f=jt(i.filterShape,"float32"),h=f.values,d=f.strides,p=d[0],y=d[1],x=d[2],m=d[3],_=this.readSync(r.dataId),w=r.strides,b=w[0],S=w[1],M=w[2],T=w[3],P=this.readSync(t.dataId),C=t.strides,A=C[0],k=C[1],L=C[2],H=C[3],F=i.padInfo.front,V=i.padInfo.left,W=i.padInfo.top,G=0;G<l;++G)for(var N=Math.max(0,Math.ceil((F-G)/s)),B=Math.min(i.outDepth,(i.inDepth+F-G)/s),D=G*p,$=0;$<u;++$)for(var ee=Math.max(0,Math.ceil((W-$)/o)),te=Math.min(i.outHeight,(i.inHeight+W-$)/o),se=$*y+D,me=0;me<c;++me)for(var _e=Math.max(0,Math.ceil((V-me)/a)),pe=Math.min(i.outWidth,(i.inWidth+V-me)/a),Ne=me*x+se,Ue=0;Ue<i.inChannels;++Ue)for(var We=Ue*m+Ne,Be=0;Be<i.outChannels;++Be){for(var J=0,he=0;he<i.batchSize;++he)for(var de=he*A,Ie=he*b,ve=N;ve<B;++ve)for(var oe=(G+ve*s-F)*k+de,ze=ve*S+Ie,X=ee;X<te;++X)for(var j=($+X*o-W)*L+oe,ae=X*M+ze,Oe=_e;Oe<pe;++Oe){var Se=Oe*T+ae;J+=P[(me+Oe*a-V)*H+j+Ue]*_[Se+Be]}h[We+Be]=J}return f.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var r=t.input,i=t.filter,s=t.convInfo,o=t.bias,a=t.activation,l=t.preluActivationWeights,u=this.depthwiseConv2D(r,i,s);return o&&(u=this.add(u,o)),a&&(u=K3(this,u,a,l)),u},e.prototype.depthwiseConv2D=function(t,r,i){Ve([t,r],"depthwiseConv2D");for(var s=i.filterHeight,o=i.filterWidth,a=i.dilationHeight,l=i.dilationWidth,u=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,h=jt(i.outShape,t.dtype),d=this.readSync(t.dataId),p=this.readSync(r.dataId),y=h.values,x=0;x<i.batchSize;++x)for(var m=x*t.strides[0],_=x*h.strides[0],w=0;w<i.outHeight;++w)for(var b=_+w*h.strides[1],S=w*i.strideHeight-u,M=0;M<s;++M){var T=S+M*a;if(!(T<0||T>=i.inHeight))for(var P=M*r.strides[0],C=m+T*t.strides[1],A=0;A<i.outWidth;++A)for(var k=b+A*h.strides[2],L=A*i.strideWidth-c,H=0;H<o;++H){var F=L+H*l;if(!(F<0||F>=i.inWidth))for(var V=P+H*r.strides[1],W=C+F*i.inChannels,G=k,N=V,B=0;B<i.inChannels;++B){for(var D=d[W+B],$=0;$<f;++$)y[G+$]+=D*p[N+$];G+=f,N+=f}}}return h.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,r,i){Ve([t,r],"depthwiseConv2DDerInput");for(var s=jt(i.inShape,"float32"),o=s.values,a=s.strides,l=a[0],u=a[1],c=a[2],f=this.readSync(t.dataId),h=t.strides,d=h[0],p=h[1],y=h[2],x=this.readSync(r.dataId),m=r.strides,_=m[0],w=m[1],b=m[2],S=i.batchSize,M=i.filterHeight,T=i.filterWidth,P=i.inChannels,C=i.inHeight,A=i.inWidth,k=i.outChannels,L=i.outHeight,H=i.outWidth,F=i.strideHeight,V=i.strideWidth,W=M-1-i.padInfo.top,G=T-1-i.padInfo.left,N=k/P,B=0;B<S;++B)for(var D=0;D<P;++D)for(var $=0;$<C;++$)for(var ee=$-W,te=Math.max(0,Math.ceil(ee/F)),se=Math.min(L,(M+ee)/F),me=0;me<A;++me){for(var _e=me-G,pe=Math.max(0,Math.ceil(_e/V)),Ne=Math.min(H,(T+_e)/V),Ue=0,We=te;We<se;++We)for(var Be=We*F-ee,J=pe;J<Ne;++J)for(var he=d*B+p*We+y*J,de=_*(M-1-Be)+w*(T-1-(J*V-_e))+b*D,Ie=0;Ie<N;++Ie)Ue+=f[he+(D*N+Ie)]*x[de+Ie];o[l*B+u*$+c*me+D]=Ue}return s.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){Ve([t,r],"depthwiseConv2DDerFilter");for(var s=i.strideHeight,o=i.strideWidth,a=i.filterHeight,l=i.filterWidth,u=jt(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,h=i.outChannels/i.inChannels,d=this.bufferSync(t),p=this.bufferSync(r),y=0;y<a;++y)for(var x=Math.max(0,Math.ceil((f-y)/s)),m=Math.min(i.outHeight,(i.inHeight+f-y)/s),_=0;_<l;++_)for(var w=Math.max(0,Math.ceil((c-_)/o)),b=Math.min(i.outWidth,(i.inWidth+c-_)/o),S=0;S<i.outChannels;++S){for(var M=Math.trunc(S/h),T=S%h,P=0,C=0;C<i.batchSize;++C)for(var A=x;A<m;++A)for(var k=y+A*s-f,L=w;L<b;++L){var H=_+L*o-c;P+=d.get(C,k,H,M)*p.get(C,A,L,S)}u.set(P,y,_,M,T)}return u.toTensor()},e.prototype.tile=function(t,r){return Ve(t,"tile"),qH(this.bufferSync(t),r)},e.prototype.pad=function(t,r,i){Ve(t,"pad");var s=r.map(function(h,d){return h[0]+t.shape[d]+h[1]}),o=r.map(function(h){return h[0]}),a=this.bufferSync(t),l=jt(s,t.dtype);i!==0&&l.values.fill(i);for(var u=0;u<t.size;u++){var c=a.indexToLoc(u),f=c.map(function(h,d){return h+o[d]});l.set.apply(l,[a.get.apply(a,c)].concat(f))}return l.toTensor()},e.prototype.transpose=function(t,r){Ve(t,"transpose");for(var i=new Array(t.rank),s=0;s<i.length;s++)i[s]=t.shape[r[s]];var o=this.readSync(t.dataId),a=jt(i,t.dtype),l=this.bufferSync(t);for(s=0;s<t.size;++s){for(var u=l.indexToLoc(s),c=new Array(u.length),f=0;f<c.length;f++)c[f]=u[r[f]];var h=a.locToIndex(c);a.values[h]=o[s]}return a.toTensor()},e.prototype.gather=function(t,r,i){Ve([t,r],"gather");var s=t.shape.slice(),o=this.readSync(r.dataId);s[i]=o.length;for(var a=jt(s,t.dtype),l=this.bufferSync(t),u=0;u<a.size;++u){var c=a.indexToLoc(u),f=c.slice();f[i]=o[c[i]];var h=l.locToIndex(f);a.values[u]=l.values[h]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,r,i){Ve([t],"batchToSpaceND");var s=r.reduce(function(f,h){return f*h}),o=W_(t.shape,r,s),a=H_(o.length,r.length),l=G_(t.shape,r,s),u=LH(i,r.length),c=FH(l,i,r.length);return t.reshape(o).transpose(a).reshape(l).slice(u,c)},e.prototype.spaceToBatchND=function(t,r,i){Ve([t],"spaceToBatchND");var s=r.reduce(function(h,d){return h*d}),o=[[0,0]];o.push.apply(o,i);for(var a=1+r.length;a<t.shape.length;++a)o.push([0,0]);var l=t.pad(o),u=W_(l.shape,r,s,!1),c=H_(u.length,r.length,!1),f=G_(l.shape,r,s,!1);return l.reshape(u).transpose(c).reshape(f)},e.prototype.pool=function(t,r,i){Ve(t,"pool");for(var s=r.strideHeight,o=r.strideWidth,a=r.dilationHeight,l=r.dilationWidth,u=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,h=r.padInfo.left,d=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(t.dataId),y=jt(r.outShape,t.dtype),x=y.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],_=r.outShape[2]*r.outShape[3],w=r.outShape[3],b=0;b<r.batchSize;++b)for(var S=b*m,M=b*t.strides[0],T=0;T<r.inChannels;++T)for(var P=0;P<r.outHeight;++P)for(var C=P*s-f,A=Math.max(0,C),k=Math.min(r.inHeight,u+C),L=S+P*_,H=0;H<r.outWidth;++H){for(var F=H*o-h,V=Math.max(0,F),W=Math.min(r.inWidth,c+F),G=d,N=0,B=0,D=A;D<k;D+=a){for(var $=M+D*t.strides[1],ee=V;ee<W;ee+=l){var te=p[$+ee*t.strides[2]+T];i==="max"&&te>G?G=te:i==="avg"&&(N+=te,B++)}if(isNaN(G))break}x[L+H*w+T]=i==="avg"?N/B:G}return y.toTensor()},e.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},e.prototype.maxPoolPositions=function(t,r){for(var i=jt(r.outShape,"int32"),s=r.strideHeight,o=r.strideWidth,a=r.dilationHeight,l=r.dilationWidth,u=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,h=r.padInfo.left,d=this.bufferSync(t),p=0;p<r.batchSize;++p)for(var y=0;y<r.inChannels;++y)for(var x=0;x<r.outHeight;++x){for(var m=x*s-f,_=m;_<0;)_+=a;for(var w=Math.min(r.inHeight,u+m),b=0;b<r.outWidth;++b){for(var S=b*o-h,M=S;M<0;)M+=l;for(var T=Math.min(r.inWidth,c+S),P=Number.NEGATIVE_INFINITY,C=-1,A=_;A<w;A+=a)for(var k=A-m,L=M;L<T;L+=l){var H=L-S,F=d.get(p,A,L,y);F>P&&(P=F,C=k*c+H)}i.set(C,p,x,b,y)}}return i.toTensor()},e.prototype.maxPoolBackprop=function(t,r,i,s){Ve([r,i],"maxPoolBackprop");for(var o=this.maxPoolPositions(r,s),a=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,c=s.dilationWidth,f=s.effectiveFilterHeight,h=s.effectiveFilterWidth,d=h-1-s.padInfo.left,p=f-1-s.padInfo.top,y=jt(r.shape,"float32"),x=this.bufferSync(o),m=this.bufferSync(t),_=0;_<s.batchSize;++_)for(var w=0;w<s.inChannels;++w)for(var b=0;b<s.inHeight;++b)for(var S=0;S<s.inWidth;++S){for(var M=b-p,T=S-d,P=0,C=0;C<f;C+=u){var A=(M+C)/a;if(!(A<0||A>=s.outHeight||Math.floor(A)!==A))for(var k=0;k<h;k+=c){var L=(T+k)/l;if(!(L<0||L>=s.outWidth||Math.floor(L)!==L)){var H=f*h-1-x.get(_,A,L,w)===C*h+k?1:0;H!==0&&(P+=m.get(_,A,L,w)*H)}}}y.set(P,_,b,S,w)}return y.toTensor()},e.prototype.avgPoolBackprop=function(t,r,i){Ve([t,r],"avgPoolBackprop");for(var s=i.strideHeight,o=i.strideWidth,a=i.filterHeight,l=i.filterWidth,u=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,h=i.effectiveFilterWidth,d=h-1-i.padInfo.left,p=f-1-i.padInfo.top,y=jt(r.shape,"float32"),x=1/(a*l),m=this.bufferSync(t),_=0;_<i.batchSize;++_)for(var w=0;w<i.inChannels;++w)for(var b=0;b<i.inHeight;++b)for(var S=0;S<i.inWidth;++S){for(var M=b-p,T=S-d,P=0,C=0;C<f;C+=u){var A=(M+C)/s;if(!(A<0||A>=i.outHeight||Math.floor(A)!==A))for(var k=0;k<h;k+=c){var L=(T+k)/o;L<0||L>=i.outWidth||Math.floor(L)!==L||(P+=m.get(_,A,L,w))}}y.set(P*x,_,b,S,w)}return y.toTensor()},e.prototype.pool3d=function(t,r,i){Ve(t,"pool3d");for(var s=r.strideDepth,o=r.strideHeight,a=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.front,y=r.padInfo.top,x=r.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=this.readSync(t.dataId),w=jt(r.outShape,t.dtype),b=w.values,S=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],M=r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[3]*r.outShape[4],P=r.outShape[4],C=0;C<r.batchSize;++C)for(var A=C*S,k=C*t.strides[0],L=0;L<r.inChannels;++L)for(var H=0;H<r.outDepth;++H){for(var F=H*s-p,V=F;V<0;)V+=l;for(var W=Math.min(r.inDepth,f+F),G=A+H*M,N=0;N<r.outHeight;++N){for(var B=N*o-y,D=B;D<0;)D+=u;for(var $=Math.min(r.inHeight,h+B),ee=G+N*T,te=0;te<r.outWidth;++te){for(var se=te*a-x,me=se;me<0;)me+=c;for(var _e=Math.min(r.inWidth,d+se),pe=ee+te*P,Ne=m,Ue=0,We=0,Be=V;Be<W;Be+=l){for(var J=k+Be*t.strides[1],he=D;he<$;he+=u){for(var de=J+he*t.strides[2],Ie=me;Ie<_e;Ie+=c){var ve=_[de+Ie*t.strides[3]+L];if(i==="max"&&ve>Ne?Ne=ve:i==="avg"&&(Ue+=ve,We++),isNaN(Ne))break}if(isNaN(Ne))break}if(isNaN(Ne))break}b[pe+L]=i==="avg"?Ue/We:Ne}}}return w.toTensor()},e.prototype.avgPool3d=function(t,r){return Ve(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,r,i){Ve([t,r],"avgPool3dBackprop");for(var s=i.strideDepth,o=i.strideHeight,a=i.strideWidth,l=i.filterDepth,u=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,h=i.dilationHeight,d=i.dilationWidth,p=i.effectiveFilterDepth,y=i.effectiveFilterHeight,x=i.effectiveFilterWidth,m=p-1-i.padInfo.front,_=x-1-i.padInfo.left,w=y-1-i.padInfo.top,b=jt(r.shape,"float32"),S=1/(l*u*c),M=this.bufferSync(t),T=0;T<i.batchSize;++T)for(var P=0;P<i.inChannels;++P)for(var C=0;C<i.inDepth;++C)for(var A=0;A<i.inHeight;++A)for(var k=0;k<i.inWidth;++k){for(var L=C-m,H=A-w,F=k-_,V=0,W=0;W<p;W+=f){var G=(L+W)/s;if(!(G<0||G>=i.outDepth||Math.floor(G)!==G))for(var N=0;N<y;N+=h){var B=(H+N)/o;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var D=0;D<x;D+=d){var $=(F+D)/a;$<0||$>=i.outWidth||Math.floor($)!==$||(V+=M.get(T,G,B,$,P))}}}b.set(V*S,T,C,A,k,P)}return b.toTensor()},e.prototype.maxPool3d=function(t,r){return Ve(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,r){for(var i=jt(r.outShape,"int32"),s=r.strideDepth,o=r.strideHeight,a=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.front,y=r.padInfo.top,x=r.padInfo.left,m=this.bufferSync(t),_=0;_<r.batchSize;++_)for(var w=0;w<r.inChannels;++w)for(var b=0;b<r.outDepth;++b){for(var S=b*s-p,M=S;M<0;)M+=l;for(var T=Math.min(r.inDepth,f+S),P=0;P<r.outHeight;++P){for(var C=P*o-y,A=C;A<0;)A+=u;for(var k=Math.min(r.inHeight,h+C),L=0;L<r.outWidth;++L){for(var H=L*a-x,F=H;F<0;)F+=c;for(var V=Math.min(r.inWidth,d+H),W=Number.NEGATIVE_INFINITY,G=-1,N=M;N<T;N+=l)for(var B=N-S,D=A;D<k;D+=u)for(var $=D-C,ee=F;ee<V;ee+=c){var te=ee-H,se=m.get(_,N,D,ee,w);se>=W&&(W=se,G=B*h*d+$*h+te)}i.set(G,_,b,P,L,w)}}}return i.toTensor()},e.prototype.maxPool3dBackprop=function(t,r,i,s){Ve([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,s),a=s.strideDepth,l=s.strideHeight,u=s.strideWidth,c=s.dilationDepth,f=s.dilationHeight,h=s.dilationWidth,d=s.effectiveFilterDepth,p=s.effectiveFilterHeight,y=s.effectiveFilterWidth,x=d-1-s.padInfo.front,m=y-1-s.padInfo.left,_=p-1-s.padInfo.top,w=jt(r.shape,"float32"),b=this.bufferSync(o),S=this.bufferSync(t),M=0;M<s.batchSize;++M)for(var T=0;T<s.inChannels;++T)for(var P=0;P<s.inDepth;++P)for(var C=0;C<s.inHeight;++C)for(var A=0;A<s.inWidth;++A){for(var k=P-x,L=C-_,H=A-m,F=0,V=0;V<d;V+=c){var W=(k+V)/a;if(!(W<0||W>=s.outDepth||Math.floor(W)!==W))for(var G=0;G<p;G+=f){var N=(L+G)/l;if(!(N<0||N>=s.outHeight||Math.floor(N)!==N))for(var B=0;B<y;B+=h){var D=(H+B)/u;if(!(D<0||D>=s.outWidth||Math.floor(D)!==D)){var $=d*p*y-1-b.get(M,W,N,D,T)===V*p*y+G*y+B?1:0;$!==0&&(F+=S.get(M,W,N,D,T)*$)}}}}w.set(F,M,P,C,A,T)}return w.toTensor()},e.prototype.cast=function(t,r){return GH(t,r,this)},e.prototype.reshape=function(t,r){return nA(t,r)},e.prototype.avgPool=function(t,r){return Ve(t,"avgPool"),this.pool(t,r,"avg").toFloat()},e.prototype.resizeBilinear=function(t,r,i,s){Ve(t,"resizeBilinear");for(var o=t.shape,a=o[0],l=o[1],u=o[2],c=o[3],f=this.readSync(t.dataId),h=new Float32Array(bt([a,r,i,c])),d=[s&&r>1?l-1:l,s&&i>1?u-1:u],p=[s&&r>1?r-1:r,s&&i>1?i-1:i],y=0,x=d[0]/p[0],m=d[1]/p[1],_=0;_<a;_++)for(var w=0;w<r;w++)for(var b=x*w,S=Math.floor(b),M=b-S,T=Math.min(l-1,Math.ceil(b)),P=_*t.strides[0]+S*t.strides[1],C=_*t.strides[0]+T*t.strides[1],A=0;A<i;A++)for(var k=m*A,L=Math.floor(k),H=k-L,F=Math.min(u-1,Math.ceil(k)),V=P+L*t.strides[2],W=C+L*t.strides[2],G=P+F*t.strides[2],N=C+F*t.strides[2],B=0;B<c;B++){var D=f[V+B],$=f[W+B],ee=D+(f[G+B]-D)*H,te=ee+($+(f[N+B]-$)*H-ee)*M;h[y++]=te}return Di(h,[a,r,i,c])},e.prototype.resizeBilinearBackprop=function(t,r,i){Ve([t,r],"resizeBilinearBackprop");for(var s=r.shape,o=s[0],a=s[1],l=s[2],u=s[3],c=t.shape,f=c[1],h=c[2],d=new Float32Array(o*a*l*u),p=[i&&f>1?a-1:a,i&&h>1?l-1:l],y=[i&&f>1?f-1:f,i&&h>1?h-1:h],x=p[0]/y[0],m=p[1]/y[1],_=this.readSync(t.dataId),w=0,b=0;b<o;b++)for(var S=b*r.strides[0],M=0;M<f;M++)for(var T=M*x,P=Math.floor(T),C=Math.min(Math.ceil(T),a-1),A=S+P*r.strides[1],k=S+C*r.strides[1],L=T-P,H=1-L,F=0;F<h;F++)for(var V=F*m,W=Math.floor(V),G=Math.min(Math.ceil(V),l-1),N=V-W,B=1-N,D=A+W*r.strides[2],$=A+G*r.strides[2],ee=k+W*r.strides[2],te=k+G*r.strides[2],se=H*B,me=H*N,_e=L*B,pe=L*N,Ne=0;Ne<u;Ne++){var Ue=_[w++];d[D+Ne]+=Ue*se,d[$+Ne]+=Ue*me,d[ee+Ne]+=Ue*_e,d[te+Ne]+=Ue*pe}return Fs(d,[o,l,a,u],r.dtype)},e.prototype.resizeNearestNeighbor=function(t,r,i,s){Ve(t,"resizeNearestNeighbor");for(var o=t.shape,a=o[0],l=o[1],u=o[2],c=o[3],f=this.readSync(t.dataId),h=new Float32Array(a*r*i*c),d=[s&&r>1?l-1:l,s&&i>1?u-1:u],p=[s&&r>1?r-1:r,s&&i>1?i-1:i],y=d[0]/p[0],x=d[1]/p[1],m=0,_=0;_<a;_++)for(var w=_*t.strides[0],b=0;b<r;b++)for(var S=y*b,M=w+Math.min(l-1,s?Math.round(S):Math.floor(S))*t.strides[1],T=0;T<i;T++)for(var P=x*T,C=M+Math.min(u-1,s?Math.round(P):Math.floor(P))*t.strides[2],A=0;A<c;A++){var k=f[C+A];h[m++]=k}return Di(h,[a,r,i,c],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){Ve([t,r],"resizeNearestNeighborBackprop");for(var s=r.shape,o=s[0],a=s[1],l=s[2],u=s[3],c=t.shape,f=c[1],h=c[2],d=new Float32Array(o*a*l*u),p=this.readSync(t.dataId),y=[i&&f>1?a-1:a,i&&h>1?l-1:l],x=[i&&f>1?f-1:f,i&&h>1?h-1:h],m=y[0]/x[0],_=y[1]/x[1],w=1/m,b=1/_,S=2*Math.ceil(w)+2,M=2*Math.ceil(b)+2,T=0;T<o;T++)for(var P=T*r.strides[0],C=0;C<a;C++)for(var A=P+C*r.strides[1],k=Math.floor(C*w),L=Math.floor(k-S/2),H=0;H<l;H++)for(var F=A+H*r.strides[2],V=Math.floor(H*b),W=Math.floor(V-M/2),G=0;G<u;G++){for(var N=0,B=0;B<S;B++){var D=B+L;if(!(D<0||D>=f)){var $=P+D*t.strides[1],ee=D*m;if(C===Math.min(a-1,i?Math.round(ee):Math.floor(ee)))for(var te=0;te<M;te++){var se=te+W;if(!(se<0||se>=h)){var me=$+se*t.strides[2],_e=se*_;H===Math.min(l-1,i?Math.round(_e):Math.floor(_e))&&(N+=p[me+G])}}}}d[F+G]=N}return Fs(d,r.shape,r.dtype)},e.prototype.batchNormalization=function(t,r,i,s,o,a){Ve([t,r,i,o,a],"batchNorm");for(var l=this.readSync(t.dataId),u=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),h=a?this.readSync(a.dataId):new Float32Array([0]),d=new Float32Array(l.length),p=h.length,y=f.length,x=c.length,m=u.length,_=0,w=0,b=0,S=0,M=0;M<l.length;++M)d[M]=h[_++]+(l[M]-u[w++])*f[b++]/Math.sqrt(c[S++]+s),_>=p&&(_=0),w>=m&&(w=0),b>=y&&(b=0),S>=x&&(S=0);return Fs(d,t.shape)},e.prototype.localResponseNormalization4D=function(t,r,i,s,o){Ve(t,"localResponseNormalization4D");var a=t.shape[3],l=a-1,u=this.readSync(t.dataId),c=t.size,f=new Float32Array(c);function h(x){for(var m=x%a,_=x-m+Math.max(0,m-r),w=x-m+Math.min(m+r,l),b=0;_<=w;_++){var S=u[_];b+=S*S}return b}for(var d=0;d<c;d++){var p=h(d),y=u[d]*Math.pow(i+s*p,-o);f[d]=y}return Fs(f,t.shape)},e.prototype.LRNGrad=function(t,r,i,s,o,a,l){Ve(t,"LRNGrad");for(var u=t.shape[3],c=this.readSync(t.dataId),f=this.readSync(r.dataId),h=this.readSync(i.dataId),d=new Float32Array(t.size),p=t.size,y=0;y<p;y++){for(var x=y%u,m=y-x+Math.max(0,x-s),_=y-x+Math.min(u,x+s+1),w=0,b=m;b<_;b++)w+=Math.pow(f[b],2);for(w=a*w+o,b=m;b<_;b++){var S=-2*a*l*f[b]*h[y]/w;y===b&&(S+=Math.pow(w,-l)),S*=c[y],d[b]+=S}}return Fs(d,t.shape)},e.prototype.multinomial=function(t,r,i,s){Ve(t,"multinomial");for(var o=r?t:Mu(t),a=o.shape[0],l=o.shape[1],u=Kn([a,i],"int32"),c=this.readSync(u.dataId),f=this.readSync(o.dataId),h=0;h<a;++h){var d=h*l,p=new Float32Array(l-1);p[0]=f[d];for(var y=1;y<p.length;++y)p[y]=p[y-1]+f[d+y];for(var x=lb(s.toString()),m=h*i,_=0;_<i;++_){var w=x();c[m+_]=p.length;for(var b=0;b<p.length;b++)if(w<p[b]){c[m+_]=b;break}}}return u},e.prototype.oneHot=function(t,r,i,s){Ve(t,"oneHot");var o=new Float32Array(t.size*r);o.fill(s);for(var a=this.readSync(t.dataId),l=0;l<t.size;++l)a[l]>=0&&a[l]<r&&(o[l*r+a[l]]=i);return Tc(o,[t.size,r],"int32")},e.prototype.nonMaxSuppression=function(t,r,i,s,o){return Ve(t,"nonMaxSuppression"),m4(this.readSync(t.dataId),this.readSync(r.dataId),i,s,o)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,r){for(var i=t.shape[0],s=t.shape[1],o=jt(t.shape,"float32"),a=jt(t.shape,"float32"),l=ea(t).as2D(i,s),u=cl(t).as2D(i,s),c=0;c<i;c++)for(var f=l.slice([c,0],[1,s]),h=u.slice([c,0],[1,s]),d=Pi(f,h),p=this.readSync(this.fftImpl(d,r).dataId),y=0;y<s;y++){var x=k5(p,y);o.values[c*s+y]=x.real,a.values[c*s+y]=x.imag}return Pi(o.toTensor(),a.toTensor()).as2D(i,s)},e.prototype.fftImpl=function(t,r){var i=t.as1D(),s=i.size;if(this.isExponentOf2(s)){var o=this.fftRadix2(i,s,r).as2D(t.shape[0],t.shape[1]);return r&&(o=Pi(ea(o).div(tt(s)),cl(o).div(tt(s)))),o}var a=this.readSync(t.dataId),l=function(u){for(var c=new Float32Array(u.length/2),f=new Float32Array(u.length/2),h=0;h<u.length;h+=2)c[h/2]=u[h],f[h/2]=u[h+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(a,s,r));return Pi(l.real,l.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,r,i){if(r===1)return t;var s=this.readSync(t.dataId),o=r/2,a=function(m){for(var _=Math.ceil(m.length/4),w=new Float32Array(_),b=new Float32Array(_),S=0;S<m.length;S+=4)w[Math.floor(S/4)]=m[S],b[Math.floor(S/4)]=m[S+1];return{real:w,imag:b}}(s),l=Pi(a.real,a.imag).as1D(),u=function(m){for(var _=Math.floor(m.length/4),w=new Float32Array(_),b=new Float32Array(_),S=2;S<m.length;S+=4)w[Math.floor(S/4)]=m[S],b[Math.floor(S/4)]=m[S+1];return{real:w,imag:b}}(s),c=Pi(u.real,u.imag).as1D();l=this.fftRadix2(l,o,i),c=this.fftRadix2(c,o,i);var f=function(m,_){for(var w=new Float32Array(m/2),b=new Float32Array(m/2),S=0;S<Math.ceil(m/2);S++){var M=(_?2:-2)*Math.PI*(S/m);w[S]=Math.cos(M),b[S]=Math.sin(M)}return{real:w,imag:b}}(r,i),h=Pi(f.real,f.imag).mul(c),d=l.add(h),p=l.sub(h),y=ea(d).concat(ea(p)),x=cl(d).concat(cl(p));return Pi(y,x).as1D()},e.prototype.fourierTransformByMatmul=function(t,r,i){for(var s=new Float32Array(2*r),o=0;o<r;o++){for(var a=0,l=0,u=0;u<r;u++){var c=zge(o*u,r,i),f=k5(t,u);a+=f.real*c.real-f.imag*c.imag,l+=f.real*c.imag+f.imag*c.real}i&&(a/=r,l/=r),Uge(s,a,l,o)}return s},e.prototype.depthToSpace=function(t,r,i){Z(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),Z(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var s=t.shape[0],o=t.shape[1],a=t.shape[2],l=t.shape[3],u=o*r,c=a*r,f=l/(r*r),h=this.readSync(t.dataId),d=new Float32Array(s*u*c*f),p=0,y=0;y<s;++y)for(var x=0;x<u;++x)for(var m=Math.floor(x/r),_=x%r,w=0;w<c;++w)for(var b=Math.floor(w/r),S=(_*r+w%r)*f,M=0;M<f;++M){var T=M+S+l*(b+a*(m+o*y));d[p++]=h[T]}return Fs(d,[s,u,c,f])},e.prototype.broadcastedBinaryOp=function(t,r,i,s){var o=fn(t.shape,r.shape),a=jt(o,i),l=this.readSync(t.dataId),u=this.readSync(r.dataId),c=cc(t.shape,o),f=cc(r.shape,o),h=a.values;if(c.length+f.length===0)for(var d=0;d<h.length;++d)h[d]=s(l[d%l.length],u[d%u.length]);else{var p=this.bufferSync(t),y=this.bufferSync(r),x=function(m){var _=a.indexToLoc(m),w=_.slice(-t.rank);c.forEach(function(T){return w[T]=0});var b=p.locToIndex(w),S=_.slice(-r.rank);f.forEach(function(T){return S[T]=0});var M=y.locToIndex(S);h[m]=s(l[b],u[M])};for(d=0;d<h.length;++d)x(d)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,r,i){var s=fn(t.shape,r.shape),o=jt(s,"float32"),a=jt(s,"float32"),l=this.readSync(t.dataId),u=this.readSync(r.dataId),c=cc(t.shape,s),f=cc(r.shape,s),h=o.values,d=a.values;if(c.length+f.length===0)for(var p=0;p<h.length;p++){var y=p%l.length,x=p%u.length,m=i(l[2*y],l[2*y+1],u[2*x],u[2*x+1]);h[p]=m.real,d[p]=m.imag}else{var _=this.bufferSync(this.data.get(t.dataId).complexTensors.real),w=this.bufferSync(this.data.get(r.dataId).complexTensors.real),b=function(S){var M=o.indexToLoc(S),T=M.slice(-t.rank);c.forEach(function(L){return T[L]=0});var P=_.locToIndex(T),C=M.slice(-r.rank);f.forEach(function(L){return C[L]=0});var A=w.locToIndex(C),k=i(l[2*P],l[2*P+1],u[2*A],u[2*A+1]);h[S]=k.real,d[S]=k.imag};for(p=0;p<h.length;p++)b(p)}return this.complex(o.toTensor(),a.toTensor())},e.prototype.split=function(t,r,i){return $H(t,r,i)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,r,i,s,o,a){for(var l=t.shape,u=l[0],c=l[1],f=l[2],h=l[3],d=r.shape[0],p=s[0],y=s[1],x=jt([d,p,y,h],"float32"),m=this.readSync(r.dataId),_=this.readSync(i.dataId),w=this.readSync(t.dataId),b=t.strides,S=x.strides,M=0;M<d;M++){var T=4*M,P=m[T],C=m[T+1],A=m[T+2],k=m[T+3],L=_[M];if(!(L>=u))for(var H=p>1?(A-P)*(c-1)/(p-1):0,F=y>1?(k-C)*(f-1)/(y-1):0,V=0;V<p;V++){var W=p>1?P*(c-1)+V*H:.5*(P+A)*(c-1);if(W<0||W>c-1)for(var G=0;G<y;G++)for(var N=0;N<h;N++){var B=N+G*S[2]+V*S[1]+M*S[0];x.values[B]=a}else if(o==="bilinear"){var D=Math.floor(W),$=Math.ceil(W),ee=W-D;for(G=0;G<y;G++)if((Be=y>1?C*(f-1)+G*F:.5*(C+k)*(f-1))<0||Be>f-1)for(N=0;N<h;N++)B=N+G*S[2]+V*S[1]+M*S[0],x.values[B]=a;else{var te=Math.floor(Be),se=Math.ceil(Be),me=Be-te;for(N=0;N<h;N++){var _e=w[B=N+te*b[2]+D*b[1]+L*b[0]],pe=w[B=N+se*b[2]+D*b[1]+L*b[0]],Ne=w[B=N+te*b[2]+$*b[1]+L*b[0]],Ue=_e+(pe-_e)*me,We=Ne+(w[B=N+se*b[2]+$*b[1]+L*b[0]]-Ne)*me;B=N+G*S[2]+V*S[1]+M*S[0],x.values[B]=Ue+(We-Ue)*ee}}}else for(G=0;G<y;++G){var Be;if((Be=y>1?C*(f-1)+G*F:.5*(C+k)*(f-1))<0||Be>f-1)for(N=0;N<h;N++)B=N+G*S[2]+V*S[1]+M*S[0],x.values[B]=a;else{var J=Math.round(Be),he=Math.round(W);for(N=0;N<h;N++){var de=N+J*b[2]+he*b[1]+L*b[0],Ie=N+G*S[2]+V*S[1]+M*S[0];x.values[Ie]=w[de]}}}}}return x.toTensor()},e.prototype.sparseToDense=function(t,r,i,s){var o=j_(0,t,i),a=o.sliceRank,l=o.numUpdates,u=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(t,r,i,f,u,l,a,c,s,!1)},e.prototype.gatherND=function(t,r){var i=r.shape,s=i[i.length-1],o=OH(t,r),a=o[0],l=o[1],u=o[2],c=o[3];if(l===0)return Di([],a,t.dtype);for(var f=new Mv([l,u],t.dtype),h=this.readSync(r.dataId),d=this.readSync(t.dataId),p=0;p<l;p++){for(var y=[],x=0,m=0;m<s;m++){var _=h[p*s+m];x+=_*c[m],y.push(_)}if(x<0||x>=t.size/u)throw new Error("Invalid indices: "+y+" does not index into "+t.shape);for(var w=0;w<u;w++)f.values[p*u+w]=d[x*u+w]}return f.toTensor().reshape(a)},e.prototype.scatterND=function(t,r,i){var s=j_(0,t,i),o=s.sliceRank,a=s.numUpdates,l=s.sliceSize,u=s.strides,c=s.outputSize,f=tt(0);return this.scatter(t,r,i,c,l,a,o,u,f,!0)},e.prototype.fill=function(t,r,i){var s=L_(i=i||ry(r),bt(t));return s.fill(r),le.makeTensor(s,t,i,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var r=L_(t.dtype,bt(t.shape));return this.makeOutput(r,t.shape,t.dtype)},e.prototype.linspace=function(t,r,i){return jH(t,r,i)},e.prototype.scatter=function(t,r,i,s,o,a,l,u,c,f){var h=[s/o,o],d=this.readSync(t.dataId),p=this.readSync(r.dataId);if(s===0)return Di([],i,r.dtype);var y=new Mv(h,r.dtype);y.values.fill(this.readSync(c.dataId)[0]);for(var x=0;x<a;x++){for(var m=[],_=0,w=0;w<l;w++){var b=d[x*l+w];m.push(b),_+=b*u[w]}if(_<0||_>=s/o)throw new Error("Invalid indices: "+m+" does not index into "+i);for(var S=0;S<o;S++)f?y.values[_*o+S]+=p[x*o+S]:y.values[_*o+S]=r.rank===0?p[0]:p[x*o+S]}return y.toTensor().reshape(i)},e}(WH);le.registerBackend("cpu",function(){return new o2e},1);for(var Z3=0,nB=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e,s=i.boxes,o=i.scores,a=r,l=a.maxOutputSize,u=a.iouThreshold,c=a.scoreThreshold,f=a.softNmsSigma,h=t;Ve(s,"NonMaxSuppressionWithScore");var d=g4(h.data.get(s.dataId).values,h.data.get(o.dataId).values,l,u,c,f);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t;Ve(r,"square");for(var s=i.data.get(r.dataId).values,o=new Float32Array(s.length),a=0;a<s.length;++a){var l=s[a];o[a]=l*l}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Av,backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,s=r.b,o=t;Ve([i,s],Av);var a=o.data.get(i.dataId).values,l=o.data.get(s.dataId).values,u=function(h,d,p,y,x,m){var _=fn(h,d),w=_.length,b=El(_),S=Ev(x,bt(_)),M=h.length,T=d.length,P=El(h),C=El(d),A=cc(h,_),k=cc(d,_);if(A.length+k.length===0)for(var L=0;L<S.length;++L)S[L]=m(p[L%p.length],y[L%y.length]);else{var H=function(F){var V=g0e(F,w,b),W=V.slice(-M);A.forEach(function(D){return W[D]=0});var G=M5(W,M,P),N=V.slice(-T);k.forEach(function(D){return N[D]=0});var B=M5(N,T,C);S[F]=m(p[G],y[B])};for(L=0;L<S.length;++L)H(L)}return[S,_]}(i.shape,s.shape,a,l,i.dtype,function(h,d){var p=h-d;return p*p}),c=u[0],f=u[1];return{dataId:o.write(c,f,i.dtype),shape:f,dtype:i.dtype}}}];Z3<nB.length;Z3++)gH(nB[Z3]);var Id,a2e=function(n){this.variableNames=["A"];var e=ns(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},l2e=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=ns(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var J3=0,rB=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs,i=e.pixels,s=r.numChannels,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,l=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],u=l[0],c=l[1],f=[c,u],h=[c,u,s];(a||o)&&(Id==null&&(Id=document.createElement("canvas").getContext("2d")),Id.canvas.width=u,Id.canvas.height=c,Id.drawImage(i,0,0,u,c),i=Id.canvas);var d=t.makeTensorInfo(f,"int32");t.texData.get(d.dataId).usage=So.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(d.dataId),i);var p=Fe().getBool("WEBGL_PACK")?new l2e(h):new a2e(h),y=t.runWebGLProgram(p,[d],"int32");return t.disposeData(d.dataId),y}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=n.attrs;U_("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,s=i.boxes,o=i.scores,a=r,l=a.maxOutputSize,u=a.iouThreshold,c=a.scoreThreshold,f=a.softNmsSigma,h=t,d=g4(h.readSync(s.dataId),h.readSync(o.dataId),l,u,c,f);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t,s=new Yt(r.shape,"return x * x;");return i.runWebGLProgram(s,[r],r.dtype)}},{kernelName:Av,backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e,i=r.a,s=r.b,o=t,a=Fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Xl("return (a - b) * (a - b);",i.shape,s.shape):new Sr("return (a - b) * (a - b);",i.shape,s.shape);return o.compileAndRun(a,[i,s])}}];J3<rB.length;J3++)gH(rB[J3]);for(var Q3=0,iB=[{kernelName:"Square",gradFunc:function(n,e){var t=e[0];return{x:function(){return n.mul(t.toFloat().mul(2))}}}},{kernelName:Av,gradFunc:function(n,e){var t=e[0],r=e[1],i=tt(2);return{a:function(){return is(n,is(i,ui(t,r)))},b:function(){return is(n,is(i,ui(r,t)))}}}}];Q3<iB.length;Q3++)s0e(iB[Q3]);var u2e=function(){function n(){}return n.prototype.fetch=function(e,t){return fetch(e,t)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},n}();Fe().get("IS_BROWSER")&&Fe().setPlatform("browser",new u2e);var eM,c2e=function(){return require("node-fetch")},f2e=function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(e,t){return Fe().global.fetch!=null?Fe().global.fetch(e,t):(eM==null&&(eM=c2e()),eM(e,t))},n.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},n}();Fe().get("IS_NODE")&&Fe().setPlatform("node",new f2e);var sA={float32:4,int32:4,uint16:2,uint8:1,bool:1},J_=4;function UG(n,e){for(var t={},r=0,i=function(a){var l=a.name,u=a.dtype,c=a.shape,f=bt(c),h=void 0;if("quantization"in a){var d=a.quantization;if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error("Weight "+a.name+" has unknown quantization dtype "+d.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=sA[d.dtype],y=n.slice(r,r+f*p),x=d.dtype==="uint8"?new Uint8Array(y):new Uint16Array(y);if(u==="float32")h=Float32Array.from(x,function(M){return M*d.scale+d.min});else{if(u!=="int32")throw new Error("Unsupported dtype in weight '"+l+"': "+u);h=Int32Array.from(x,function(M){return Math.round(M*d.scale+d.min)})}r+=f*p}else if(u==="string"){var m=bt(a.shape);h=[];for(var _=0;_<m;_++){var w=new Uint32Array(n.slice(r,r+J_))[0];r+=J_;var b=new Uint8Array(n.slice(r,r+w));h.push(b),r+=w}}else{var S=sA[u];if(y=n.slice(r,r+f*S),u==="float32")h=new Float32Array(y);else if(u==="int32")h=new Int32Array(y);else{if(u!=="bool")throw new Error("Unsupported dtype in weight '"+l+"': "+u);h=new Uint8Array(y)}r+=f*S}t[l]=Di(h,c,u)},s=0,o=e;s<o.length;s++)i(o[s]);return t}function h2e(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var e=0,t=[];n.forEach(function(s){if(e+=s.byteLength,t.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+s.constructor.name)});var r=new Uint8Array(e),i=0;return t.forEach(function(s){r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}var oA=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function sB(n){return oA?Buffer.byteLength(n):new Blob([n]).size}function L4(n){var e=0;n.forEach(function(i){e+=i.byteLength});var t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(new Uint8Array(i),r),r+=i.byteLength}),t.buffer}function oB(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var e=n.split("/");return e[e.length-1]}function cy(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:sB(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:sB(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var Eo=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(e){n.getInstance().saveRouters.push(e)},n.registerLoadRouter=function(e){n.getInstance().loadRouters.push(e)},n.getSaveHandlers=function(e){return n.getHandlers(e,"save")},n.getLoadHandlers=function(e,t){return n.getHandlers(e,"load",t)},n.getHandlers=function(e,t,r){var i=[];return(t==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(s){var o=s(e,r);o!==null&&i.push(o)}),i},n}(),kp="://",Cc=function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(e,t){Z(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(kp)&&(e=e.slice(0,e.indexOf(kp))),Z(e.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();Z(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=t},n.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function k2(n){if(n.indexOf(kp)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Cc.getSchemes().join(","));return{scheme:n.split(kp)[0],path:n.split(kp)[1]}}function aB(n,e,t){return t===void 0&&(t=!1),vt(this,void 0,void 0,function(){var r,i,s,o,a,l,u,c,f;return yt(this,function(h){switch(h.label){case 0:return Z(n!==e,function(){return"Old path and new path are the same: '"+n+"'"}),Z((r=Eo.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),Z(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),i=r[0],Z((s=Eo.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),Z(s.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),o=s[0],a=k2(n).scheme,l=k2(n).path,u=a===k2(n).scheme,[4,i.load()];case 1:return c=h.sent(),t&&u?[4,Cc.getManager(a).removeModel(l)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[4,o.save(c)];case 4:return f=h.sent(),!t||u?[3,6]:[4,Cc.getManager(a).removeModel(l)];case 5:h.sent(),h.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Jf="models_store",fc="model_info_store";function zG(){if(!Fe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function aA(n){var e=n.result;e.createObjectStore(Jf,{keyPath:"modelPath"}),e.createObjectStore(fc,{keyPath:"modelPath"})}var Lp=function(){function n(e){if(this.indexedDB=zG(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return n.prototype.save=function(e){return vt(this,void 0,void 0,function(){return yt(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},n.prototype.load=function(){return vt(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(e,t){var r=this;return new Promise(function(i,s){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return aA(o)},o.onsuccess=function(){var a=o.result;if(t==null){var l=a.transaction(Jf,"readonly"),u=l.objectStore(Jf).get(r.modelPath);u.onsuccess=function(){if(u.result==null)return a.close(),s(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(u.result.modelArtifacts)},u.onerror=function(y){return a.close(),s(u.error)},l.oncomplete=function(){return a.close()}}else{var c,f=cy(t),h=a.transaction(fc,"readwrite"),d=h.objectStore(fc),p=d.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var y=(c=a.transaction(Jf,"readwrite")).objectStore(Jf).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:f});y.onsuccess=function(){return i({modelArtifactsInfo:f})},y.onerror=function(x){var m=(d=h.objectStore(fc)).delete(r.modelPath);m.onsuccess=function(){return a.close(),s(y.error)},m.onerror=function(_){return a.close(),s(y.error)}}},p.onerror=function(y){return a.close(),s(p.error)},h.oncomplete=function(){c==null?a.close():c.oncomplete=function(){return a.close()}}}},o.onerror=function(a){return s(o.error)}})},n.URL_SCHEME="indexeddb://",n}(),lB=function(n){return Fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Lp.URL_SCHEME)?(e=n.slice(Lp.URL_SCHEME.length),new Lp(e)):null;var e};Eo.registerSaveRouter(lB),Eo.registerLoadRouter(lB);var d2e=function(){function n(){this.indexedDB=zG()}return n.prototype.listModels=function(){return vt(this,void 0,void 0,function(){var e=this;return yt(this,function(t){return[2,new Promise(function(r,i){var s=e.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return aA(s)},s.onsuccess=function(){var o=s.result,a=o.transaction(fc,"readonly"),l=a.objectStore(fc).getAll();l.onsuccess=function(){for(var u={},c=0,f=l.result;c<f.length;c++){var h=f[c];u[h.modelPath]=h.modelArtifactsInfo}r(u)},l.onerror=function(u){return o.close(),i(l.error)},a.oncomplete=function(){return o.close()}},s.onerror=function(o){return i(s.error)}})]})})},n.prototype.removeModel=function(e){return vt(this,void 0,void 0,function(){var t=this;return yt(this,function(r){var i;return e=(i=e).startsWith(Lp.URL_SCHEME)?i.slice(Lp.URL_SCHEME.length):i,[2,new Promise(function(s,o){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return aA(a)},a.onsuccess=function(){var l,u=a.result,c=u.transaction(fc,"readwrite"),f=c.objectStore(fc),h=f.get(e);h.onsuccess=function(){if(h.result==null)return u.close(),o(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var d=f.delete(e),p=function(){var y=(l=u.transaction(Jf,"readwrite")).objectStore(Jf).delete(e);y.onsuccess=function(){return s(h.result.modelArtifactsInfo)},y.onerror=function(x){return o(h.error)}};d.onsuccess=p,d.onerror=function(y){return p(),u.close(),o(h.error)}},h.onerror=function(d){return u.close(),o(h.error)},c.oncomplete=function(){l==null?u.close():l.oncomplete=function(){return u.close()}}},a.onerror=function(l){return o(a.error)}})]})})},n}();if(Fe().getBool("IS_BROWSER"))try{Cc.registerManager(Lp.URL_SCHEME,new d2e)}catch{}var Ql="/",Hd="tensorflowjs_models",VG="info",p2e="model_topology",m2e="weight_specs",g2e="weight_data",v2e="model_metadata";function WG(n){return{info:[Hd,n,VG].join(Ql),topology:[Hd,n,p2e].join(Ql),weightSpecs:[Hd,n,m2e].join(Ql),weightData:[Hd,n,g2e].join(Ql),modelMetadata:[Hd,n,v2e].join(Ql)}}function y2e(n){var e=n.split(Ql);if(e.length<3)throw new Error("Invalid key format: "+n);return e.slice(1,e.length-1).join(Ql)}var Fp=function(){function n(e){if(!Fe().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=WG(this.modelPath)}return n.prototype.save=function(e){return vt(this,void 0,void 0,function(){var t,r,i;return yt(this,function(s){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=cy(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(oA)return Buffer.from(o).toString("base64");for(var a=new Uint8Array(o),l="",u=0,c=a.length;u<c;u++)l+=String.fromCharCode(a[u]);return btoa(l)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},n.prototype.load=function(){return vt(this,void 0,void 0,function(){var e,t,r,i,s,o,a;return yt(this,function(l){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=i,(s=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(s),t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,t.userDefinedMetadata=o.userDefinedMetadata),(a=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(u){if(oA){var c=Buffer.from(u,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(u),h=new Uint8Array(f.length),d=0;d<f.length;++d)h.set([f.charCodeAt(d)],d);return h.buffer}(a),[2,t]})})},n.URL_SCHEME="localstorage://",n}(),uB=function(n){return Fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Fp.URL_SCHEME)?(e=n.slice(Fp.URL_SCHEME.length),new Fp(e)):null;var e};Eo.registerSaveRouter(uB),Eo.registerLoadRouter(uB);var x2e=function(){function n(){Z(Fe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),Z(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return vt(this,void 0,void 0,function(){var e,t,r,i,s,o;return yt(this,function(a){for(e={},t=Hd+Ql,r=Ql+VG,i=0;i<this.LS.length;++i)(s=this.LS.key(i)).startsWith(t)&&s.endsWith(r)&&(o=y2e(s),e[o]=JSON.parse(this.LS.getItem(s)));return[2,e]})})},n.prototype.removeModel=function(e){return vt(this,void 0,void 0,function(){var t,r;return yt(this,function(i){var s;if(e=(s=e).startsWith(Fp.URL_SCHEME)?s.slice(Fp.URL_SCHEME.length):s,t=WG(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]})})},n}();if(Fe().getBool("IS_BROWSER"))try{Cc.registerManager(Fp.URL_SCHEME,new x2e)}catch{}var _2e="model",w2e=".json",b2e=".weights.bin";function cB(n){return new Promise(function(e){return setTimeout(e)}).then(n)}var tM=function(){function n(e){if(!Fe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),e!=null&&e.length!==0||(e=_2e),this.modelTopologyFileName=e+w2e,this.weightDataFileName=e+b2e}return n.prototype.save=function(e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a;return yt(this,function(l){switch(l.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},s=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=s,[4,cB(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return l.sent(),e.weightData==null?[3,4]:((a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,cB(function(){return a.dispatchEvent(new MouseEvent("click"))})]);case 3:l.sent(),l.label=4;case 4:return[2,{modelArtifactsInfo:cy(e)}]}})})},n.URL_SCHEME="downloads://",n}(),S2e=function(){function n(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return n.prototype.load=function(){return vt(this,void 0,void 0,function(){var e,t,r=this;return yt(this,function(i){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(s,o){var a=new FileReader;a.onload=function(l){var u=JSON.parse(l.target.result),c=u.modelTopology;if(c!=null){t.length===0&&s({modelTopology:c});var f=u.weightsManifest;if(f!=null){var h;try{h=r.checkManifestAndWeightFiles(f,t)}catch(x){return void o(x)}var d=[],p=[],y=[];f.forEach(function(x){x.paths.forEach(function(m){p.push(m),y.push(null)}),d.push.apply(d,x.weights)}),f.forEach(function(x){x.paths.forEach(function(m){var _=new FileReader;_.onload=function(w){var b=w.target.result,S=p.indexOf(m);y[S]=b,y.indexOf(null)===-1&&s({modelTopology:c,weightSpecs:d,weightData:L4(y),format:u.format,generatedBy:u.generatedBy,convertedBy:u.convertedBy,userDefinedMetadata:u.userDefinedMetadata})},_.onerror=function(w){return o("Failed to weights data from file of path '"+m+"'.")},_.readAsArrayBuffer(h[m])})})}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(l){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)})]})})},n.prototype.checkManifestAndWeightFiles=function(e,t){for(var r=[],i=t.map(function(l){return oB(l.name)}),s={},o=0,a=e;o<a.length;o++)a[o].paths.forEach(function(l){var u=oB(l);if(r.indexOf(u)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+u+"'");if(r.push(u),i.indexOf(u)===-1)throw new Error("Weight file with basename '"+u+"' is not provided.");s[l]=t[i.indexOf(u)]});if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return s},n}();function fB(n,e,t,r){(function(s){Z(s!=null&&Array.isArray(s)&&s.length>0,function(){return"promises must be a none empty array"})})(n),function(s,o){Z(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+s}),Z(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),Z(o>=s,function(){return"startFraction must be no more than endFraction, but got startFraction "+s+" and endFraction "+o})}(t=t??0,r=r??1);var i=0;return Promise.all(n.map(function(s){return s.then(function(o){var a=t+ ++i/n.length*(r-t);return e(a),o}),s}))}function HG(n,e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a,l,u,c;return yt(this,function(f){switch(f.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?Fe().platform.fetch:e.fetchFunc,r=n.map(function(h){return t(h,e.requestInit,{isBinary:!0})}),i=0,s=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,fB(r,e.onProgress,i,s)];case 3:o=f.sent(),f.label=4;case 4:return a=o.map(function(h){return h.arrayBuffer()}),l=.5,u=1,e.onProgress!=null?[3,6]:[4,Promise.all(a)];case 5:return c=f.sent(),[3,8];case 6:return[4,fB(a,e.onProgress,l,u)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function hB(n){var e=this;return function(t,r,i){return r===void 0&&(r=""),vt(e,void 0,void 0,function(){var s,o,a,l,u,c,f,h,d,p;return yt(this,function(y){switch(y.label){case 0:if(s=t.map(function(){return!1}),o={},a=i!=null?i.map(function(){return!1}):[],l=[],t.forEach(function(x,m){var _=0;x.weights.forEach(function(w){var b="quantization"in w?w.quantization.dtype:w.dtype,S=sA[b]*bt(w.shape),M=function(){s[m]=!0,o[m]==null&&(o[m]=[]),o[m].push({manifestEntry:w,groupOffset:_,sizeBytes:S})};i!=null?i.forEach(function(T,P){T===w.name&&(M(),a[P]=!0)}):M(),l.push(w.name),_+=S})}),!a.every(function(x){return x}))throw u=i.filter(function(x,m){return!a[m]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+`. 
Manifest JSON has weights with names: `+l.join(", ")+".");return c=s.reduce(function(x,m,_){return m&&x.push(_),x},[]),f=[],c.forEach(function(x){t[x].paths.forEach(function(m){var _=r+(r.endsWith("/")?"":"/")+m;f.push(_)})}),[4,n(f)];case 1:return h=y.sent(),d={},p=0,c.forEach(function(x){for(var m=t[x].paths.length,_=0,w=0;w<m;w++)_+=h[p+w].byteLength;for(var b=new ArrayBuffer(_),S=new Uint8Array(b),M=0,T=0;T<m;T++){var P=new Uint8Array(h[p+T]);S.set(P,M),M+=P.byteLength}o[x].forEach(function(C){var A=UG(b.slice(C.groupOffset,C.groupOffset+C.sizeBytes),[C.manifestEntry]);for(var k in A)d[k]=A[k]}),p+=m}),[2,d]}})})}}Eo.registerSaveRouter(function(n){return Fe().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(tM.URL_SCHEME)?function(e){return e===void 0&&(e="model"),new tM(e)}(n.slice(tM.URL_SCHEME.length)):null});var GG=function(){function n(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(Z(typeof t.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=Fe().platform.fetch,Z(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&Z(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return n.prototype.save=function(e){return vt(this,void 0,void 0,function(){var t,r,i,s;return yt(this,function(o){switch(o.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},t.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((s=o.sent()).ok)return[2,{modelArtifactsInfo:cy(e),responses:[s]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+s.status+".")}})})},n.prototype.load=function(){return vt(this,void 0,void 0,function(){var e,t,r,i,s,o,a,l,u,c,f,h;return yt(this,function(d){switch(d.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=d.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");d.label=2;case 2:return d.trys.push([2,4,,5]),[4,e.json()];case 3:return t=d.sent(),[3,5];case 4:throw d.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.modelTopology,s=t.weightsManifest,o=t.generatedBy,a=t.convertedBy,l=t.format,u=t.userDefinedMetadata,i==null&&s==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return s==null?[3,7]:[4,this.loadWeights(s)];case 6:h=d.sent(),c=h[0],f=h[1],d.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:u,generatedBy:o,convertedBy:a,format:l}]}})})},n.prototype.loadWeights=function(e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a,l,u,c,f,h;return yt(this,function(d){switch(d.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var y=p.lastIndexOf("/"),x=p.lastIndexOf("?"),m=p.substring(0,y),_=x>y?p.substring(x):"";return[m+"/",_]}(t),i=r[0],s=r[1],o=this.weightPathPrefix||i,a=[],l=0,u=e;l<u.length;l++)c=u[l],a.push.apply(a,c.weights);return f=[],e.forEach(function(p){p.paths.forEach(function(y){f.push(o+y+s)})}),[4,HG(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=d.sent(),[2,[a,L4(h)]]}})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function lA(n){return n.match(GG.URL_SCHEME_REGEX)!=null}var dB=function(n,e){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(t){return lA(t)}):lA(n))?uA(n,{onProgress:e}):null};function uA(n,e){return new GG(n,e)}Eo.registerSaveRouter(dB),Eo.registerLoadRouter(dB);var nM=function(){function n(e){this.modelArtifacts=e}return n.prototype.load=function(){return vt(this,void 0,void 0,function(){return yt(this,function(e){return[2,this.modelArtifacts]})})},n}(),E2e=function(){function n(e){this.saveHandler=e}return n.prototype.save=function(e){return vt(this,void 0,void 0,function(){return yt(this,function(t){return[2,this.saveHandler(e)]})})},n}(),jG=Object.freeze({browserFiles:function(n){return new S2e(n)},browserHTTPRequest:function(n,e){return uA(n,e)},concatenateArrayBuffers:L4,decodeWeights:UG,encodeWeights:function(n,e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a=this;return yt(this,function(l){switch(l.label){case 0:for(t=[],r=[],i=Array.isArray(n)?n.map(function(u){return u.name}):Object.keys(n),s=function(u){var c=i[u],f=Array.isArray(n)?n[u].tensor:n[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var h={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var d=new Promise(function(p){return vt(a,void 0,void 0,function(){var y,x,m,_,w,b,S;return yt(this,function(M){switch(M.label){case 0:return[4,f.bytes()];case 1:for(y=M.sent(),x=y.reduce(function(T,P){return T+P.length},0)+J_*y.length,m=new Uint8Array(x),_=0,w=0;w<y.length;w++)b=y[w],S=new Uint8Array(new Uint32Array([b.length]).buffer),m.set(S,_),_+=J_,m.set(b,_),_+=b.length;return p(m),[2]}})})});r.push(d)}else r.push(f.data());e!=null&&(h.group=e),t.push(h)},o=0;o<i.length;++o)s(o);return[4,Promise.all(r)];case 1:return[2,{data:h2e(l.sent()),specs:t}]}})})},fromMemory:function(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new nM(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new nM({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new nM({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))},getLoadHandlers:function(n,e){return Eo.getLoadHandlers(n,e)},getModelArtifactsInfoForJSON:cy,getSaveHandlers:function(n){return Eo.getSaveHandlers(n)},http:uA,isHTTPScheme:lA,loadWeights:function(n,e,t,r){return e===void 0&&(e=""),vt(this,void 0,void 0,function(){return yt(this,function(i){return[2,hB(function(s){return HG(s,{requestInit:r})})(n,e,t)]})})},registerLoadRouter:function(n){return Eo.registerLoadRouter(n)},registerSaveRouter:function(n){return Eo.registerSaveRouter(n)},weightsLoaderFactory:hB,withSaveHandler:function(n){return new E2e(n)},copyModel:function(n,e){return vt(this,void 0,void 0,function(){return yt(this,function(t){return[2,aB(n,e,!1)]})})},listModels:function(){return vt(this,void 0,void 0,function(){var n,e,t,r,i,s,o;return yt(this,function(a){switch(a.label){case 0:n=Cc.getSchemes(),e={},t=0,r=n,a.label=1;case 1:return t<r.length?(i=r[t],[4,Cc.getManager(i).listModels()]):[3,4];case 2:for(o in s=a.sent())e[i+kp+o]=s[o];a.label=3;case 3:return t++,[3,1];case 4:return[2,e]}})})},moveModel:function(n,e){return vt(this,void 0,void 0,function(){return yt(this,function(t){return[2,aB(n,e,!0)]})})},removeModel:function(n){return vt(this,void 0,void 0,function(){var e;return yt(this,function(t){return e=k2(n),[2,Cc.getManager(e.scheme).removeModel(e.path)]})})}}),Dd;ie({confusionMatrix_:function(n,e,t){var r=Y(n,"labels","confusionMatrix"),i=Y(e,"predictions","confusionMatrix");Z(t==null||t>0&&Number.isInteger(t),function(){return"If provided, numClasses must be a positive integer, but got "+t}),Z(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),Z(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),Z(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),Z(t>0&&Number.isInteger(t),function(){return"numClasses is required to be a positive integer, but got "+t});var s=eA(r.asType("int32"),t),o=eA(i.asType("int32"),t);return s.transpose().matMul(o).asType("int32")}});var M2e=ie({fromPixels_:function(n,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var t=!1,r=!1,i=!1,s=!1,o=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)s=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);o=!0}if(i&&i&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(mH("FromPixels",le.backendName)!=null)return le.runKernel("FromPixels",{pixels:n},{numChannels:e});var a,l,u=i?[n.videoWidth,n.videoHeight]:[n.width,n.height],c=u[0],f=u[1];if(o?a=n.getContext("2d").getImageData(0,0,c,f).data:r||t?a=n.data:(s||i)&&(Dd==null&&(Dd=document.createElement("canvas").getContext("2d")),Dd.canvas.width=c,Dd.canvas.height=f,Dd.drawImage(n,0,0,c,f),a=Dd.getImageData(0,0,c,f).data),e===4)l=new Int32Array(a);else{var h=c*f;l=new Int32Array(h*e);for(var d=0;d<h;d++)for(var p=0;p<e;++p)l[d*e+p]=a[4*d+p]}return c4(l,[f,c,e],"int32")}}),F4=Object.freeze({toPixels:function(n,e){return vt(this,void 0,void 0,function(){var t,r,i,s,o,a,l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P;return yt(this,function(C){switch(C.label){case 0:if(t=Y(n,"img","toPixels"),n instanceof cr||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),i=r[0],s=r[1],(o=t.rank===2?1:t.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,t.data()];case 1:return a=C.sent(),l=t.min(),u=t.max(),[4,Promise.all([l.data(),u.data()])];case 2:if(c=C.sent(),f=c[0],h=c[1],d=f[0],p=h[0],l.dispose(),u.dispose(),t.dtype==="float32"){if(d<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+p+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(d<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+p+"].")}for(y=t.dtype==="float32"?255:1,x=new Uint8ClampedArray(s*i*4),m=0;m<i*s;++m)_=void 0,w=void 0,b=void 0,S=void 0,o===1?(_=a[m]*y,w=a[m]*y,b=a[m]*y,S=255):o===3?(_=a[3*m]*y,w=a[3*m+1]*y,b=a[3*m+2]*y,S=255):o===4&&(_=a[4*m]*y,w=a[4*m+1]*y,b=a[4*m+2]*y,S=a[4*m+3]*y),x[(M=4*m)+0]=Math.round(_),x[M+1]=Math.round(w),x[M+2]=Math.round(b),x[M+3]=Math.round(S);return e!=null&&(e.width=s,e.height=i,T=e.getContext("2d"),P=new ImageData(x,s,i),T.putImageData(P,0,0)),t!==n&&t.dispose(),[2,x]}})})},fromPixels:M2e}),T2e=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(e,t){return new e(t)},n}(),C2e=function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(e){n.getMap().classNameMap[e.className]=[e,e.fromConfig]},n}();function Uh(n){Z(n.className!=null,function(){return"Class being registered does not have the static className property defined."}),Z(typeof n.className=="string",function(){return"className is required to be a string, but got type "+typeof n.className}),Z(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),C2e.register(n)}var zh=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Ha(e,n),e.prototype.minimize=function(t,r,i){r===void 0&&(r=!1);var s=this.computeGradients(t,i),o=s.value,a=s.grads;if(i!=null){var l=i.map(function(u){return{name:u.name,tensor:a[u.name]}});this.applyGradients(l)}else this.applyGradients(a);return Zs(a),r?o:(o.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,r){return Oge(t,r)},e.prototype.dispose=function(){this.iterations_!=null&&Zs(this.iterations_)},e.prototype.saveIterations=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:tt(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(t){return vt(this,void 0,void 0,function(){var r;return yt(this,function(i){switch(i.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,t.slice(1)]}})})},e}(T2e);Object.defineProperty(zh,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var A2e=function(n){function e(t,r,i){i===void 0&&(i=null);var s=n.call(this)||this;return s.learningRate=t,s.rho=r,s.epsilon=i,s.accumulatedGrads=[],s.accumulatedUpdates=[],i==null&&(s.epsilon=le.backend.epsilon()),s}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,s){var o=le.registeredVariables[i];r.accumulatedGrads[s]==null&&(r.accumulatedGrads[s]={originalName:i+"/accum_grad",variable:lt(function(){return xn(o).variable(!1)})}),r.accumulatedUpdates[s]==null&&(r.accumulatedUpdates[s]={originalName:i+"/accum_var",variable:lt(function(){return xn(o).variable(!1)})});var a=Array.isArray(t)?t[s].tensor:t[i];if(a!=null){var l=r.accumulatedGrads[s].variable,u=r.accumulatedUpdates[s].variable;lt(function(){var c=l.mul(r.rho).add(a.square().mul(1-r.rho)),f=u.add(r.epsilon).sqrt().div(l.add(r.epsilon).sqrt()).mul(a),h=u.mul(r.rho).add(f.square().mul(1-r.rho));l.assign(c),u.assign(h);var d=f.mul(-r.learningRate).add(o);o.assign(d)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Zs(this.accumulatedGrads.map(function(t){return t.variable})),Zs(this.accumulatedUpdates.map(function(t){return t.variable})))},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){var t;return yt(this,function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){var r;return yt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=t.length/2,this.accumulatedGrads=t.slice(0,r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedUpdates=t.slice(r,2*r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(zh);Uh(A2e);var R2e=function(n){function e(t,r){r===void 0&&(r=.1);var i=n.call(this)||this;return i.learningRate=t,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,s){var o=le.registeredVariables[i];r.accumulatedGrads[s]==null&&(r.accumulatedGrads[s]={originalName:i+"/accumulator",variable:lt(function(){return Ml(o.shape,r.initialAccumulatorValue).variable(!1)})});var a=Array.isArray(t)?t[s].tensor:t[i];if(a!=null){var l=r.accumulatedGrads[s].variable;lt(function(){var u=l.add(a.square());l.assign(u);var c=a.div(u.add(le.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&Zs(this.accumulatedGrads.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(zh);Uh(R2e);var P2e=function(n){function e(t,r,i,s){s===void 0&&(s=null);var o=n.call(this)||this;return o.learningRate=t,o.beta1=r,o.beta2=i,o.epsilon=s,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],lt(function(){o.accBeta1=tt(r).variable(),o.accBeta2=tt(i).variable()}),s==null&&(o.epsilon=le.backend.epsilon()),o}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map(function(s){return s.name}):Object.keys(t);lt(function(){var s=ui(1,r.accBeta1),o=ui(1,r.accBeta2);i.forEach(function(a,l){var u=le.registeredVariables[a];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:a+"/m",variable:lt(function(){return xn(u).variable(!1)})}),r.accumulatedSecondMoment[l]==null&&(r.accumulatedSecondMoment[l]={originalName:a+"/v",variable:lt(function(){return xn(u).variable(!1)})});var c=Array.isArray(t)?t[l].tensor:t[a];if(c!=null){var f=r.accumulatedFirstMoment[l].variable,h=r.accumulatedSecondMoment[l].variable,d=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=h.mul(r.beta2).add(c.square().mul(1-r.beta2)),y=d.div(s),x=p.div(o);f.assign(d),h.assign(p);var m=y.div(x.sqrt().add(r.epsilon)).mul(-r.learningRate).add(u);u.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Zs(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedSecondMoment!=null&&Zs(this.accumulatedSecondMoment.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){var t;return yt(this,function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){var r,i=this;return yt(this,function(s){switch(s.label){case 0:return[4,this.extractIterations(t)];case 1:return t=s.sent(),lt(function(){i.accBeta1.assign(K_(i.beta1,i.iterations_+1)),i.accBeta2.assign(K_(i.beta2,i.iterations_+1))}),r=t.length/2,this.accumulatedFirstMoment=t.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=t.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(zh);Uh(P2e);var I2e=function(n){function e(t,r,i,s,o){s===void 0&&(s=null),o===void 0&&(o=0);var a=n.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=i,a.epsilon=s,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],lt(function(){a.iteration=tt(0).variable(),a.accBeta1=tt(r).variable()}),s==null&&(a.epsilon=le.backend.epsilon()),a}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map(function(s){return s.name}):Object.keys(t);lt(function(){var s=ui(1,r.accBeta1),o=Aa(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(a,l){var u=le.registeredVariables[a];r.accumulatedFirstMoment[l]==null&&(r.accumulatedFirstMoment[l]={originalName:a+"/m",variable:xn(u).variable(!1)}),r.accumulatedWeightedInfNorm[l]==null&&(r.accumulatedWeightedInfNorm[l]={originalName:a+"/v",variable:xn(u).variable(!1)});var c=Array.isArray(t)?t[l].tensor:t[a];if(c!=null){var f=r.accumulatedFirstMoment[l].variable,h=r.accumulatedWeightedInfNorm[l].variable,d=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=h.mul(r.beta2),y=c.abs(),x=p.maximum(y);f.assign(d),h.assign(x);var m=o.div(s).mul(d.div(x.add(r.epsilon))).add(u);u.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Zs(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedWeightedInfNorm!=null&&Zs(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(zh);Uh(I2e);var XG=function(n){function e(t){var r=n.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,s){var o=Array.isArray(t)?t[s].tensor:t[i];if(o!=null){var a=le.registeredVariables[i];lt(function(){var l=r.c.mul(o).add(a);a.assign(l)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Z0e(tt(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,r){return new t(r.learningRate)},e.className="SGD",e}(zh);Uh(XG);var D2e=function(n){function e(t,r,i){i===void 0&&(i=!1);var s=n.call(this,t)||this;return s.learningRate=t,s.momentum=r,s.useNesterov=i,s.accumulations=[],s.m=tt(s.momentum),s}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,s){var o=le.registeredVariables[i];r.accumulations[s]==null&&(r.accumulations[s]={originalName:i+"/momentum",variable:lt(function(){return xn(o).variable(!1)})});var a=r.accumulations[s].variable,l=Array.isArray(t)?t[s].tensor:t[i];l!=null&&lt(function(){var u,c=r.m.mul(a).add(l);u=r.useNesterov?r.c.mul(l.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),a.assign(c),o.assign(u)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Zs(this.accumulations.map(function(t){return t.variable}))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){return yt(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){return yt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(XG);Uh(D2e);var N2e=function(n){function e(t,r,i,s,o){r===void 0&&(r=.9),i===void 0&&(i=0),s===void 0&&(s=null),o===void 0&&(o=!1);var a=n.call(this)||this;if(a.learningRate=t,a.decay=r,a.momentum=i,a.epsilon=s,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,s==null&&(a.epsilon=le.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return Ha(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,s){var o=le.registeredVariables[i];r.accumulatedMeanSquares[s]==null&&(r.accumulatedMeanSquares[s]={originalName:i+"/rms",variable:lt(function(){return xn(o).variable(!1)})}),r.accumulatedMoments[s]==null&&(r.accumulatedMoments[s]={originalName:i+"/momentum",variable:lt(function(){return xn(o).variable(!1)})}),r.accumulatedMeanGrads[s]==null&&r.centered&&(r.accumulatedMeanGrads[s]={originalName:i+"/mg",variable:lt(function(){return xn(o).variable(!1)})});var a=Array.isArray(t)?t[s].tensor:t[i];if(a!=null){var l=r.accumulatedMeanSquares[s].variable,u=r.accumulatedMoments[s].variable;lt(function(){var c=l.mul(r.decay).add(a.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[s].variable,h=f.mul(r.decay).add(a.mul(1-r.decay)),d=u.mul(r.momentum).add(a.mul(r.learningRate).div(c.sub(h.square().add(r.epsilon)).sqrt()));l.assign(c),f.assign(h),u.assign(d);var p=o.sub(d);o.assign(p)}else{var y=l.mul(r.decay).add(a.square().mul(1-r.decay));d=u.mul(r.momentum).add(a.mul(r.learningRate).div(y.add(r.epsilon).sqrt())),l.assign(y),u.assign(d),p=o.sub(d),o.assign(p)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Zs(this.accumulatedMeanSquares.map(function(t){return t.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Zs(this.accumulatedMeanGrads.map(function(t){return t.variable})),this.accumulatedMoments!=null&&Zs(this.accumulatedMoments.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return vt(this,void 0,void 0,function(){var t;return yt(this,function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return vt(this,void 0,void 0,function(){var r;return yt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedMoments=t.slice(r,2*r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(zh);Uh(N2e);cr.prototype.squaredDifference=function(n){return aG(this,n)},Ce=s2e;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cA=function(n,e){return cA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},cA(n,e)};function Gt(n,e){cA(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Qi=function(){return Qi=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Qi.apply(this,arguments)};function Tt(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(f){o(f)}}function l(c){try{u(r.throw(c))}catch(f){o(f)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(n,[])).next())})}function Ct(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function wg(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var Op=function(){function n(e,t){if(!ph(e)||!ph(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n}();function gb(n,e){return n instanceof cr&&n.shape.length===e}function k2e(n){return gb(n,2)}function vb(n){return gb(n,3)}function Ac(n){return gb(n,4)}function L2e(n){return n%1!==0}function pB(n){return n%2===0}function F2e(n,e){e===void 0&&(e=2);var t=Math.pow(10,e);return Math.floor(n*t)/t}function mB(n){return n&&n.width&&n.height}function O2e(n,e){var t=n.width,r=n.height,i=e/Math.max(r,t);return new Op(Math.round(t*i),Math.round(r*i))}function O4(n){return n.reduce(function(e,t){return e.add(t)},new Pn(0,0)).div(new Pn(n.length,n.length))}function Rv(n,e,t){return Array(n).fill(0).map(function(r,i){return e+i*t})}function ph(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function gB(n){return ph(n)&&0<=n&&n<=1}var Pn=function(){function n(e,t){this._x=e,this._y=t}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(e){return new n(this.x+e.x,this.y+e.y)},n.prototype.sub=function(e){return new n(this.x-e.x,this.y-e.y)},n.prototype.mul=function(e){return new n(this.x*e.x,this.y*e.y)},n.prototype.div=function(e){return new n(this.x/e.x,this.y/e.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n}(),Wc=function(){function n(e,t){t===void 0&&(t=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(ph),s=[r.x,r.y,r.width,r.height].every(ph);if(!s&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var o=s?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=o[0],l=o[1],u=o[2],c=o[3];n.assertIsValidBox({x:a,y:l,width:u,height:c},"Box.constructor",t),this._x=a,this._y=l,this._width=u,this._height=c}return n.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(ph)},n.assertIsValidBox=function(e,t,r){if(r===void 0&&(r=!1),!n.isRect(e))throw new Error(t+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(t+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new Pn(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new Pn(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new Pn(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new Pn(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(o){return Math.round(o)}),t=e[0],r=e[1],i=e[2],s=e[3];return new n({x:t,y:r,width:i,height:s})},n.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(o){return Math.floor(o)}),t=e[0],r=e[1],i=e[2],s=e[3];return new n({x:t,y:r,width:i,height:s})},n.prototype.toSquare=function(){var e=this,t=e.x,r=e.y,i=e.width,s=e.height,o=Math.abs(i-s);return i<s&&(t-=o/2,i+=o),s<i&&(r-=o/2,s+=o),new n({x:t,y:r,width:i,height:s})},n.prototype.rescale=function(e){var t=mB(e)?e.width:e,r=mB(e)?e.height:e;return new n({x:this.x*t,y:this.y*r,width:this.width*t,height:this.height*r})},n.prototype.pad=function(e,t){var r=[this.x-e/2,this.y-t/2,this.width+e,this.height+t],i=r[0],s=r[1],o=r[2],a=r[3];return new n({x:i,y:s,width:o,height:a})},n.prototype.clipAtImageBorders=function(e,t){var r=this,i=r.x,s=r.y,o=r.right,a=r.bottom,l=Math.max(i,0),u=Math.max(s,0),c=o-l,f=a-u,h=Math.min(c,e-l),d=Math.min(f,t-u);return new n({x:l,y:u,width:h,height:d}).floor()},n.prototype.shift=function(e,t){var r=this,i=r.width,s=r.height,o=this.x+e,a=this.y+t;return new n({x:o,y:a,width:i,height:s})},n.prototype.padAtBorders=function(e,t){var r=this.width+1,i=this.height+1,s=1,o=1,a=r,l=i,u=this.left,c=this.top,f=this.right,h=this.bottom;return f>t&&(a=-f+t+r,f=t),h>e&&(l=-h+e+i,h=e),u<1&&(l=2-u,u=1),c<1&&(l=2-c,c=1),{dy:o,edy:l,dx:s,edx:a,y:c,ey:h,x:u,ex:f,w:r,h:i}},n.prototype.calibrate=function(e){return new n({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},n}(),yb=function(n){Gt(e,n);function e(t,r,i,s,o){return o===void 0&&(o=!1),n.call(this,{left:t,top:r,right:i,bottom:s},o)||this}return e}(Wc),$G=function(){function n(e,t,r,i,s){this._imageDims=new Op(s.width,s.height),this._score=e,this._classScore=t,this._className=r,this._box=new Wc(i).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new Wc(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})},n}(),Dl=function(n){Gt(e,n);function e(t,r,i){return n.call(this,t,t,"",r,i)||this}return e.prototype.forSize=function(t,r){var i=n.prototype.forSize.call(this,t,r),s=i.score,o=i.relativeBox,a=i.imageDims;return new e(s,o,a)},e}($G);function B2e(n,e,t){t===void 0&&(t=!0);var r=Math.max(0,Math.min(n.right,e.right)-Math.max(n.left,e.left)),i=Math.max(0,Math.min(n.bottom,e.bottom)-Math.max(n.top,e.top)),s=r*i;return t?s/(n.area+e.area-s):s/Math.min(n.area,e.area)}function U2e(n){var e=n.map(function(a){return a.x}),t=n.map(function(a){return a.y}),r=e.reduce(function(a,l){return l<a?l:a},1/0),i=t.reduce(function(a,l){return l<a?l:a},1/0),s=e.reduce(function(a,l){return a<l?l:a},0),o=t.reduce(function(a,l){return a<l?l:a},0);return new yb(r,i,s,o)}function Pv(n,e,t,r){r===void 0&&(r=!0);for(var i=e.map(function(a,l){return{score:a,boxIndex:l}}).sort(function(a,l){return a.score-l.score}).map(function(a){return a.boxIndex}),s=[],o=function(){var a=i.pop();s.push(a);for(var l=i,u=[],c=0;c<l.length;c++){var f=l[c],h=n[a],d=n[f];u.push(B2e(h,d,r))}i=i.filter(function(p,y){return u[y]<=t})};i.length>0;)o();return s}function fy(n,e){return lt(function(){var t=e[0],r=e[1],i=e[2],s=Ml(wg(n.shape.slice(0,3),[1]),t),o=Ml(wg(n.shape.slice(0,3),[1]),r),a=Ml(wg(n.shape.slice(0,3),[1]),i),l=ii([s,o,a],3);return ui(n,l)})}function z2e(n,e){return e===void 0&&(e=!1),lt(function(){var t=n.shape.slice(1),r=t[0],i=t[1];if(r===i)return n;var s=Math.abs(r-i),o=Math.round(s*(e?.5:1)),a=r>i?2:1,l=function(d){var p=n.shape.slice();return p[a]=d,Ml(p,0)},u=l(o),c=s-u.shape[a],f=e&&c?l(c):null,h=[f,n,u].filter(function(d){return!!d}).map(function(d){return d.toFloat()});return ii(h,a)})}function rM(n){return 1/(1+Math.exp(-n))}var B4=function(n){Gt(e,n);function e(t,r,i,s,o){return o===void 0&&(o=!1),n.call(this,{x:t,y:r,width:i,height:s},o)||this}return e}(Wc),V2e=.5,W2e=.43,H2e=.45,Q_=function(){function n(e,t,r){r===void 0&&(r=new Pn(0,0));var i=t.width,s=t.height;this._imgDims=new Op(i,s),this._shift=r,this._positions=e.map(function(o){return o.mul(new Pn(i,s)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new Pn(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new Pn(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},n.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Pn(e,t))},n.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},n.prototype.align=function(e,t){if(t===void 0&&(t={}),e){var r=e instanceof Dl?e.box.floor():new Wc(e);return this.shiftBy(r.x,r.y).align(null,t)}var i=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),s=i.useDlibAlignment,o=i.minBoxPadding;return s?this.alignDlib():this.alignMinBbox(o)},n.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],r=e[1],i=e[2],s=function(f){return i.sub(f).magnitude()},o=(s(t)+s(r))/2,a=Math.floor(o/H2e),l=O4(e),u=Math.floor(Math.max(0,l.x-V2e*a)),c=Math.floor(Math.max(0,l.y-W2e*a));return new B4(u,c,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+c))},n.prototype.alignMinBbox=function(e){var t=U2e(this.positions);return t.pad(t.width*e,t.height*e)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n}(),G2e=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],O4([t[3],t[4]])]},e}(Q_),j2e=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(O4)},e}(Q_),vB=function(){function n(e,t){this._label=e,this._distance=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+F2e(this.distance)+")":"")},n}(),yB=function(n){Gt(e,n);function e(t,r){var i=n.call(this,t)||this;return i._label=r,i}return e.assertIsValidLabeledBox=function(t,r){if(Wc.assertIsValidBox(t,r),!ph(t.label))throw new Error(r+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(Wc),jx=function(){function n(e,t){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},n.fromJSON=function(e){var t=e.descriptors.map(function(r){return new Float32Array(r)});return new n(e.label,t)},n}();(function(n){Gt(e,n);function e(t,r,i,s){var o=n.call(this,t,r)||this;return o._score=i,o._classScore=s,o}return e.assertIsValidPredictedBox=function(t,r){if(yB.assertIsValidLabeledBox(t,r),!gB(t.score)||!gB(t.classScore))throw new Error(r+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(yB);function X2e(n){return n.detection instanceof Dl}function U4(n,e){var t={detection:e};return Object.assign({},n,t)}function qG(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:e}}function YG(n){var e="";if(!n)try{n=require("fs")}catch(r){e=r.toString()}var t=n?function(r){return new Promise(function(i,s){n.readFile(r,function(o,a){return o?s(o):i(a)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:t}}function KG(){var n=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,t=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},s=YG();return Qi({Canvas:n||function(){function o(){}return o}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function o(){}return o}(),Image:e||function(){function o(){}return o}(),ImageData:global.ImageData||function(){function o(){}return o}(),Video:global.HTMLVideoElement||function(){function o(){}return o}(),createCanvasElement:t,createImageElement:r,fetch:i},s)}function ZG(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function JG(){return typeof global=="object"&&typeof require=="function"&&typeof Pj<"u"&&typeof process<"u"&&!!process.version}var Zr;function $2e(){if(!Zr)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Zr}function fA(n){Zr=n}function z4(){ZG()&&fA(qG()),JG()&&fA(KG())}function q2e(n){if(Zr||z4(),!Zr)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=n.Canvas,t=e===void 0?Zr.Canvas:e,r=n.Image,i=r===void 0?Zr.Image:r;Zr.Canvas=t,Zr.Image=i,Zr.createCanvasElement=n.createCanvasElement||function(){return new t},Zr.createImageElement=n.createImageElement||function(){return new i},Zr.ImageData=n.ImageData||Zr.ImageData,Zr.Video=n.Video||Zr.Video,Zr.fetch=n.fetch||Zr.fetch,Zr.readFile=n.readFile||Zr.readFile}var ls={getEnv:$2e,setEnv:fA,initialize:z4,createBrowserEnv:qG,createFileSystem:YG,createNodejsEnv:KG,monkeyPatch:q2e,isBrowser:ZG,isNodejs:JG};z4();function QG(n){return!ls.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function Ah(n){var e=ls.getEnv(),t=e.Canvas,r=e.CanvasRenderingContext2D;if(n instanceof r)return n;var i=QG(n);if(!(i instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var s=i.getContext("2d");if(!s)throw new Error("resolveContext2d - canvas 2d context is null");return s}var xB;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(xB||(xB={}));function ej(n){var e=ls.getEnv(),t=e.Image,r=e.Video;return n instanceof t&&n.complete||n instanceof r&&n.readyState>=3}function Y2e(n){return new Promise(function(e,t){if(n instanceof ls.getEnv().Canvas||ej(n))return e();function r(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",r),s.currentTarget.removeEventListener("error",i),e(s))}function i(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",r),s.currentTarget.removeEventListener("error",i),t(s))}n.addEventListener("load",r),n.addEventListener("error",i)})}function tj(n){var e=ls.getEnv(),t=e.Image,r=e.Video;return n instanceof t?new Op(n.naturalWidth,n.naturalHeight):n instanceof r?new Op(n.videoWidth,n.videoHeight):new Op(n.width,n.height)}function xb(n){var e=n.width,t=n.height,r=ls.getEnv().createCanvasElement,i=r();return i.width=e,i.height=t,i}function V4(n,e){var t=ls.getEnv().ImageData;if(!(n instanceof t)&&!ej(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=tj(n),i=r.width,s=r.height,o=xb({width:i,height:s});return n instanceof t?Ah(o).putImageData(n,0,0):Ah(o).drawImage(n,0,0,i,s),o}function K2e(n,e){return Tt(this,void 0,void 0,function(){var t,r,i,s,o,a;return Ct(this,function(l){switch(l.label){case 0:return t=ls.getEnv().createCanvasElement(),r=n.shape.slice(Ac(n)?1:0),i=r[0],s=r[1],o=r[2],a=lt(function(){return n.as3D(i,s,o).toInt()}),[4,F4.toPixels(a,t)];case 1:return l.sent(),a.dispose(),[2,t]}})})}function _B(n){var e=ls.getEnv(),t=e.Image,r=e.Canvas,i=e.Video;return n instanceof t||n instanceof r||n instanceof i}function Z2e(n,e,t){t===void 0&&(t=!1);var r=ls.getEnv(),i=r.Image,s=r.Canvas;if(!(n instanceof i||n instanceof s))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=tj(n),a=e/Math.max(o.height,o.width),l=a*o.width,u=a*o.height,c=xb({width:e,height:e}),f=n instanceof s?n:V4(n),h=Math.abs(l-u)/2,d=t&&l<u?h:0,p=t&&u<l?h:0;return Ah(c).drawImage(f,d,p,l,u),c}var ew=function(){function n(e,t){var r=this;if(t===void 0&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(i,s){if(vb(i)){r._imageTensors[s]=i,r._inputDimensions[s]=i.shape;return}if(Ac(i)){var o=i.shape[0];if(o!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+o+" passed, but not supported in input array");r._imageTensors[s]=i,r._inputDimensions[s]=i.shape.slice(1);return}var a=i instanceof ls.getEnv().Canvas?i:V4(i);r._canvases[s]=a,r._inputDimensions[s]=[a.height,a.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Rv(this.batchSize,0,1).map(function(t,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},n.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},n.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},n.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},n.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var t=this.getInputWidth(e),r=this.getInputHeight(e);return O2e({width:t,height:r},this.inputSize)},n.prototype.toBatchTensor=function(e,t){var r=this;return t===void 0&&(t=!0),this._inputSize=e,lt(function(){var i=Rv(r.batchSize,0,1).map(function(o){var a=r.getInput(o);if(a instanceof cr){var l=Ac(a)?a:a.expandDims();return l=z2e(l,t),(l.shape[1]!==e||l.shape[2]!==e)&&(l=P4.resizeBilinear(l,[e,e])),l.as3D(e,e,3)}if(a instanceof ls.getEnv().Canvas)return F4.fromPixels(Z2e(a,e,t));throw new Error("toBatchTensor - at batchIdx "+o+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),s=Ro(i.map(function(o){return o.toFloat()})).as4D(r.batchSize,e,e,3);return s})},n}();function Ei(n){return Tt(this,void 0,void 0,function(){var e,t,r;return Ct(this,function(i){switch(i.label){case 0:if(n instanceof ew)return[2,n];if(e=Array.isArray(n)?n:[n],!e.length)throw new Error("toNetInput - empty array passed as input");return t=function(s){return Array.isArray(n)?" at input index "+s+":":""},r=e.map(QG),r.forEach(function(s,o){if(!_B(s)&&!vb(s)&&!Ac(s))throw typeof e[o]=="string"?new Error("toNetInput -"+t(o)+" string passed, but could not resolve HTMLElement for element id "+e[o]):new Error("toNetInput -"+t(o)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ac(s)){var a=s.shape[0];if(a!==1)throw new Error("toNetInput -"+t(o)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(s){return _B(s)&&Y2e(s)}))];case 1:return i.sent(),[2,new ew(r,Array.isArray(n))]}})})}function W4(n,e){return Tt(this,void 0,void 0,function(){var t,r,i,s,o,a,l;return Ct(this,function(u){switch(u.label){case 0:return t=ls.getEnv().Canvas,r=n,n instanceof t?[3,5]:[4,Ei(n)];case 1:if(i=u.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return s=i.getInput(0),s instanceof t?(o=s,[3,4]):[3,2];case 2:return[4,K2e(s)];case 3:o=u.sent(),u.label=4;case 4:r=o,u.label=5;case 5:return a=Ah(r),l=e.map(function(c){return c instanceof Dl?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,l.map(function(c){var f=c.x,h=c.y,d=c.width,p=c.height,y=xb({width:d,height:p});return Ah(y).putImageData(a.getImageData(f,h,d,p),0,0),y})]}})})}function H4(n,e){return Tt(this,void 0,void 0,function(){return Ct(this,function(t){if(!vb(n)&&!Ac(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ac(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,lt(function(){var r=n.shape.slice(Ac(n)?1:0),i=r[0],s=r[1],o=r[2],a=e.map(function(u){return u instanceof Dl?u.forSize(s,i).box:u}).map(function(u){return u.clipAtImageBorders(s,i)}),l=a.map(function(u){var c=u.x,f=u.y,h=u.width,d=u.height;return AG(n.as3D(i,s,o),[f,c,0],[d,h,o])});return l})]})})}function J2e(n,e){return Tt(this,void 0,void 0,function(){var t,r;return Ct(this,function(i){switch(i.label){case 0:return t=ls.getEnv().fetch,[4,t(n,e)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function Q2e(n){return Tt(this,void 0,void 0,function(){return Ct(this,function(e){switch(e.label){case 0:return[4,J2e(n)];case 1:return[2,e.sent().json()]}})})}function nj(n,e){var t=e+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:t};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+t};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var i=n.split("/").filter(function(a){return a}),s=n.endsWith(".json")?i[i.length-1]:t,o=r+(n.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return o=n.startsWith("/")?"/"+o:o,{modelBaseUri:o,manifestUri:o==="/"?"/"+s:o+"/"+s}}function e_e(n,e){return Tt(this,void 0,void 0,function(){var t,r,i,s;return Ct(this,function(o){switch(o.label){case 0:return t=nj(n,e),r=t.manifestUri,i=t.modelBaseUri,[4,Q2e(r)];case 1:return s=o.sent(),[2,jG.loadWeights(s,i)]}})})}var Cu=function(){function n(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e),r=t.obj,i=t.objProp;return r[i]},n.prototype.reassignParamFromPath=function(e,t){var r=this.traversePropertyPath(e),i=r.obj,s=r.objProp;i[s].dispose(),i[s]=t},n.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var r=t.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof om})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof om)})},n.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var r=t.path,i=t.tensor;e.reassignParamFromPath(r,i.variable())})},n.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var r=t.path,i=t.tensor,s=Di(i.dataSync());i.dispose(),e.reassignParamFromPath(r,s)})},n.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},n.prototype.load=function(e){return Tt(this,void 0,void 0,function(){return Ct(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},n.prototype.loadFromUri=function(e){return Tt(this,void 0,void 0,function(){var t;return Ct(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,e_e(e,this.getDefaultModelName())];case 1:return t=r.sent(),this.loadFromWeightMap(t),[2]}})})},n.prototype.loadFromDisk=function(e){return Tt(this,void 0,void 0,function(){var t,r,i,s,o,a,l,u,c,f;return Ct(this,function(h){switch(h.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return t=ls.getEnv().readFile,r=nj(e,this.getDefaultModelName()),i=r.manifestUri,s=r.modelBaseUri,o=function(d){return Promise.all(d.map(function(p){return t(p).then(function(y){return y.buffer})}))},a=jG.weightsLoaderFactory(o),c=(u=JSON).parse,[4,t(i)];case 1:return l=c.apply(u,[h.sent().toString()]),[4,a(l,s)];case 2:return f=h.sent(),this.loadFromWeightMap(f),[2]}})})},n.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.extractWeights=function(e){var t=this.extractParams(e),r=t.paramMappings,i=t.params;this._paramMappings=r,this._params=i},n.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(s,o){if(!s.nextObj.hasOwnProperty(o))throw new Error("traversePropertyPath - object does not have property "+o+", for path "+e);return{obj:s.nextObj,objProp:o,nextObj:s.nextObj[o]}},{nextObj:this.params}),r=t.obj,i=t.objProp;if(!r||!i||!(r[i]instanceof cr))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:i}},n}();function Mo(n,e,t){return lt(function(){var r=M4(n,e.depthwise_filter,e.pointwise_filter,t,"same");return r=ln(r,e.bias),r})}function iM(n,e,t){return t===void 0&&(t=!1),lt(function(){var r=pr(t?ln(pa(n,e.conv0.filters,[2,2],"same"),e.conv0.bias):Mo(n,e.conv0,[2,2])),i=Mo(r,e.conv1,[1,1]),s=pr(ln(r,i)),o=Mo(s,e.conv2,[1,1]);return pr(ln(r,ln(i,o)))})}function Xx(n,e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),lt(function(){var i=pr(t?ln(pa(n,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Mo(n,e.conv0,r?[2,2]:[1,1])),s=Mo(i,e.conv1,[1,1]),o=pr(ln(i,s)),a=Mo(o,e.conv2,[1,1]),l=pr(ln(i,ln(s,a))),u=Mo(l,e.conv3,[1,1]);return pr(ln(i,ln(s,ln(a,u))))})}function La(n,e,t,r){return t===void 0&&(t="same"),r===void 0&&(r=!1),lt(function(){var i=ln(pa(n,e.filters,[1,1],t),e.bias);return r?pr(i):i})}function Au(n,e){Object.keys(n).forEach(function(t){e.some(function(r){return r.originalPath===t})||n[t].dispose()})}function _b(n,e){return function(t,r,i,s){var o=Fs(n(t*r*i*i),[i,i,t,r]),a=Xr(n(r));return e.push({paramPath:s+"/filters"},{paramPath:s+"/bias"}),{filters:o,bias:a}}}function G4(n,e){return function(t,r,i){var s=Tc(n(t*r),[t,r]),o=Xr(n(r));return e.push({paramPath:i+"/weights"},{paramPath:i+"/bias"}),{weights:s,bias:o}}}var rj=function(){function n(e,t,r){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=r}return n}();function j4(n,e){return function(t,r,i){var s=Fs(n(9*t),[3,3,t,1]),o=Fs(n(t*r),[1,1,t,r]),a=Xr(n(r));return e.push({paramPath:i+"/depthwise_filter"},{paramPath:i+"/pointwise_filter"},{paramPath:i+"/bias"}),new rj(s,o,a)}}function X4(n){return function(e){var t=n(e+"/depthwise_filter",4),r=n(e+"/pointwise_filter",4),i=n(e+"/bias",1);return new rj(t,r,i)}}function tf(n,e){return function(t,r,i){var s=n[t];if(!gb(s,r))throw new Error("expected weightMap["+t+"] to be a Tensor"+r+"D, instead have "+s);return e.push({originalPath:t,paramPath:i||t}),s}}function Ru(n){var e=n;function t(i){var s=e.slice(0,i);return e=e.slice(i),s}function r(){return e}return{extractWeights:t,getRemainingWeights:r}}function ij(n,e){var t=_b(n,e),r=j4(n,e);function i(o,a,l,u){u===void 0&&(u=!1);var c=u?t(o,a,3,l+"/conv0"):r(o,a,l+"/conv0"),f=r(a,a,l+"/conv1"),h=r(a,a,l+"/conv2");return{conv0:c,conv1:f,conv2:h}}function s(o,a,l,u){u===void 0&&(u=!1);var c=i(o,a,l,u),f=c.conv0,h=c.conv1,d=c.conv2,p=r(a,a,l+"/conv3");return{conv0:f,conv1:h,conv2:d,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function t_e(n){var e=[],t=Ru(n),r=t.extractWeights,i=t.getRemainingWeights,s=ij(r,e).extractDenseBlock4Params,o=s(3,32,"dense0",!0),a=s(32,64,"dense1"),l=s(64,128,"dense2"),u=s(128,256,"dense3");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:o,dense1:a,dense2:l,dense3:u}}}function sj(n){return function(e){var t=n(e+"/filters",4),r=n(e+"/bias",1);return{filters:t,bias:r}}}function oj(n,e){var t=tf(n,e),r=sj(t),i=X4(t);function s(a,l){l===void 0&&(l=!1);var u=l?r(a+"/conv0"):i(a+"/conv0"),c=i(a+"/conv1"),f=i(a+"/conv2");return{conv0:u,conv1:c,conv2:f}}function o(a,l){l===void 0&&(l=!1);var u=l?r(a+"/conv0"):i(a+"/conv0"),c=i(a+"/conv1"),f=i(a+"/conv2"),h=i(a+"/conv3");return{conv0:u,conv1:c,conv2:f,conv3:h}}return{extractDenseBlock3Params:s,extractDenseBlock4Params:o}}function n_e(n){var e=[],t=oj(n,e).extractDenseBlock4Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2"),dense3:t("dense3")};return Au(n,e),{params:r,paramMappings:e}}var aj=function(n){Gt(e,n);function e(){return n.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return lt(function(){var i=t.toBatchTensor(112,!0),s=[122.782,117.001,104.298],o=fy(i,s).div(tt(255)),a=Xx(o,r.dense0,!0);return a=Xx(a,r.dense1),a=Xx(a,r.dense2),a=Xx(a,r.dense3),a=uy(a,[7,7],[2,2],"valid"),a})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return n_e(t)},e.prototype.extractParams=function(t){return t_e(t)},e}(Cu);function ml(n,e){return lt(function(){return ln(db(n,e.weights),e.bias)})}function r_e(n,e,t){var r=[],i=Ru(n),s=i.extractWeights,o=i.getRemainingWeights,a=G4(s,r),l=a(e,t,"fc");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:r,params:{fc:l}}}function i_e(n){var e=[],t=tf(n,e);function r(s){var o=t(s+"/weights",2),a=t(s+"/bias",1);return{weights:o,bias:a}}var i={fc:r("fc")};return Au(n,e),{params:i,paramMappings:e}}function lj(n){var e={},t={};return Object.keys(n).forEach(function(r){var i=r.startsWith("fc")?t:e;i[r]=n[r]}),{featureExtractorMap:e,classifierMap:t}}var uj=function(n){Gt(e,n);function e(t,r){var i=n.call(this,t)||this;return i._faceFeatureExtractor=r,i}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return lt(function(){var s=t instanceof ew?r.faceFeatureExtractor.forwardInput(t):t;return ml(s.as2D(s.shape[0],-1),i.fc)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,s=r.paramMappings;this._params=i,this._paramMappings=s},e.prototype.extractClassifierParams=function(t){return r_e(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var r=lj(t),i=r.featureExtractorMap,s=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),i_e(s)},e.prototype.extractParams=function(t){var r=this.getClassifierChannelsIn(),i=this.getClassifierChannelsOut(),s=i*r+i,o=t.slice(0,t.length-s),a=t.slice(t.length-s);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(a)},e}(Cu),wB=["neutral","happy","sad","angry","fearful","disgusted","surprised"],s_e=function(){function n(e){var t=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);wB.forEach(function(r,i){t[r]=e[i]})}return n.prototype.asSortedArray=function(){var e=this;return wB.map(function(t){return{expression:t,probability:e[t]}}).sort(function(t,r){return r.probability-t.probability})},n}(),o_e=function(n){Gt(e,n);function e(t){return t===void 0&&(t=new aj),n.call(this,"FaceExpressionNet",t)||this}return e.prototype.forwardInput=function(t){var r=this;return lt(function(){return Mu(r.runNet(t))})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictExpressions=function(t){return Tt(this,void 0,void 0,function(){var r,i,s,o,a=this;return Ct(this,function(l){switch(l.label){case 0:return[4,Ei(t)];case 1:return r=l.sent(),[4,this.forwardInput(r)];case 2:return i=l.sent(),[4,Promise.all(si(i).map(function(u){return Tt(a,void 0,void 0,function(){var c;return Ct(this,function(f){switch(f.label){case 0:return[4,u.data()];case 1:return c=f.sent(),u.dispose(),[2,c]}})})}))];case 3:return s=l.sent(),i.dispose(),o=s.map(function(u){return new s_e(u)}),[2,r.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(uj);function cj(n,e){var t={expressions:e};return Object.assign({},n,t)}function a_e(n){return X2e(n)&&n.landmarks instanceof Q_&&n.unshiftedLandmarks instanceof Q_&&n.alignedRect instanceof Dl}function $4(n,e){var t=n.detection.box,r=e.shiftBy(t.x,t.y),i=r.align(),s=n.detection.imageDims,o=new Dl(n.detection.score,i.rescale(s.reverse()),s),a={landmarks:r,unshiftedLandmarks:e,alignedRect:o};return Object.assign({},n,a)}function l_e(n,e){var t=_b(n,e),r=j4(n,e);function i(o,a,l){var u=r(o,a,l+"/separable_conv0"),c=r(a,a,l+"/separable_conv1"),f=t(o,a,1,l+"/expansion_conv");return{separable_conv0:u,separable_conv1:c,expansion_conv:f}}function s(o,a){var l=r(o,o,a+"/separable_conv0"),u=r(o,o,a+"/separable_conv1"),c=r(o,o,a+"/separable_conv2");return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:t,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:s}}function u_e(n,e){var t=[],r=Ru(n),i=r.extractWeights,s=r.getRemainingWeights,o=l_e(i,t),a=o.extractConvParams,l=o.extractSeparableConvParams,u=o.extractReductionBlockParams,c=o.extractMainBlockParams,f=a(3,32,3,"entry_flow/conv_in"),h=u(32,64,"entry_flow/reduction_block_0"),d=u(64,128,"entry_flow/reduction_block_1"),p={conv_in:f,reduction_block_0:h,reduction_block_1:d},y={};Rv(e,0,1).forEach(function(w){y["main_block_"+w]=c(128,"middle_flow/main_block_"+w)});var x=u(128,256,"exit_flow/reduction_block"),m=l(256,512,"exit_flow/separable_conv"),_={reduction_block:x,separable_conv:m};if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:t,params:{entry_flow:p,middle_flow:y,exit_flow:_}}}function c_e(n,e){var t=tf(n,e),r=sj(t),i=X4(t);function s(a){var l=i(a+"/separable_conv0"),u=i(a+"/separable_conv1"),c=r(a+"/expansion_conv");return{separable_conv0:l,separable_conv1:u,expansion_conv:c}}function o(a){var l=i(a+"/separable_conv0"),u=i(a+"/separable_conv1"),c=i(a+"/separable_conv2");return{separable_conv0:l,separable_conv1:u,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:s,extractMainBlockParams:o}}function f_e(n,e){var t=[],r=c_e(n,t),i=r.extractConvParams,s=r.extractSeparableConvParams,o=r.extractReductionBlockParams,a=r.extractMainBlockParams,l=i("entry_flow/conv_in"),u=o("entry_flow/reduction_block_0"),c=o("entry_flow/reduction_block_1"),f={conv_in:l,reduction_block_0:u,reduction_block_1:c},h={};Rv(e,0,1).forEach(function(x){h["main_block_"+x]=a("middle_flow/main_block_"+x)});var d=o("exit_flow/reduction_block"),p=s("exit_flow/separable_conv"),y={reduction_block:d,separable_conv:p};return Au(n,t),{params:{entry_flow:f,middle_flow:h,exit_flow:y},paramMappings:t}}function fj(n,e,t){return ln(pa(n,e.filters,t,"same"),e.bias)}function sM(n,e,t){t===void 0&&(t=!0);var r=t?pr(n):n;return r=Mo(r,e.separable_conv0,[1,1]),r=Mo(pr(r),e.separable_conv1,[1,1]),r=yi(r,[3,3],[2,2],"same"),r=ln(r,fj(n,e.expansion_conv,[2,2])),r}function h_e(n,e){var t=Mo(pr(n),e.separable_conv0,[1,1]);return t=Mo(pr(t),e.separable_conv1,[1,1]),t=Mo(pr(t),e.separable_conv2,[1,1]),t=ln(t,n),t}var d_e=function(n){Gt(e,n);function e(t){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=t,r}return e.prototype.forwardInput=function(t){var r=this,i=this.params;if(!i)throw new Error("TinyXception - load model before inference");return lt(function(){var s=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],a=fy(s,o).div(tt(256)),l=pr(fj(a,i.entry_flow.conv_in,[2,2]));return l=sM(l,i.entry_flow.reduction_block_0,!1),l=sM(l,i.entry_flow.reduction_block_1),Rv(r._numMainBlocks,0,1).forEach(function(u){l=h_e(l,i.middle_flow["main_block_"+u])}),l=sM(l,i.exit_flow.reduction_block),l=pr(Mo(l,i.exit_flow.separable_conv,[1,1])),l})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return f_e(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return u_e(t,this._numMainBlocks)},e}(Cu);function p_e(n){var e=[],t=Ru(n),r=t.extractWeights,i=t.getRemainingWeights,s=G4(r,e),o=s(512,1,"fc/age"),a=s(512,2,"fc/gender");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{fc:{age:o,gender:a}}}}function m_e(n){var e=[],t=tf(n,e);function r(s){var o=t(s+"/weights",2),a=t(s+"/bias",1);return{weights:o,bias:a}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Au(n,e),{params:i,paramMappings:e}}var tw;(function(n){n.FEMALE="female",n.MALE="male"})(tw||(tw={}));var g_e=function(n){Gt(e,n);function e(t){t===void 0&&(t=new d_e(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=t,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var r=this,i=this.params;if(!i)throw new Error(this._name+" - load model before inference");return lt(function(){var s=t instanceof ew?r.faceFeatureExtractor.forwardInput(t):t,o=uy(s,[7,7],[2,2],"valid").as2D(s.shape[0],-1),a=ml(o,i.fc.age).as1D(),l=ml(o,i.fc.gender);return{age:a,gender:l}})},e.prototype.forwardInput=function(t){var r=this;return lt(function(){var i=r.runNet(t),s=i.age,o=i.gender;return{age:s,gender:Mu(o)}})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return Tt(this,void 0,void 0,function(){var r,i,s,o,a,l,u=this;return Ct(this,function(c){switch(c.label){case 0:return[4,Ei(t)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return i=c.sent(),s=si(i.age),o=si(i.gender),a=s.map(function(f,h){return{ageTensor:f,genderTensor:o[h]}}),[4,Promise.all(a.map(function(f){var h=f.ageTensor,d=f.genderTensor;return Tt(u,void 0,void 0,function(){var p,y,x,m,_;return Ct(this,function(w){switch(w.label){case 0:return[4,h.data()];case 1:return p=w.sent()[0],[4,d.data()];case 2:return y=w.sent()[0],x=y>.5,m=x?tw.MALE:tw.FEMALE,_=x?y:1-y,h.dispose(),d.dispose(),[2,{age:p,gender:m,genderProbability:_}]}})})}))];case 3:return l=c.sent(),i.age.dispose(),i.gender.dispose(),[2,r.isBatchInput?l:l[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.faceFeatureExtractor.dispose(t),n.prototype.dispose.call(this,t)},e.prototype.loadClassifierParams=function(t){var r=this.extractClassifierParams(t),i=r.params,s=r.paramMappings;this._params=i,this._paramMappings=s},e.prototype.extractClassifierParams=function(t){return p_e(t)},e.prototype.extractParamsFromWeigthMap=function(t){var r=lj(t),i=r.featureExtractorMap,s=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),m_e(s)},e.prototype.extractParams=function(t){var r=1539,i=t.slice(0,t.length-r),s=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(s)},e}(Cu),hj=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.postProcess=function(t,r,i){var s=i.map(function(a){var l=a.width,u=a.height,c=r/Math.max(u,l);return{width:l*c,height:u*c}}),o=s.length;return lt(function(){var a=function(h,d){return Ro([Ml([68],h),Ml([68],d)],1).as2D(1,136).as1D()},l=function(h,d){var p=s[h],y=p.width,x=p.height;return d(y,x)?Math.abs(y-x)/2:0},u=function(h){return l(h,function(d,p){return d<p})},c=function(h){return l(h,function(d,p){return p<d})},f=t.mul(Ml([o,136],r)).sub(Ro(Array.from(Array(o),function(h,d){return a(u(d),c(d))}))).div(Ro(Array.from(Array(o),function(h,d){return a(s[d].width,s[d].height)})));return f})},e.prototype.forwardInput=function(t){var r=this;return lt(function(){var i=r.runNet(t);return r.postProcess(i,t.inputSize,t.inputDimensions.map(function(s){var o=s[0],a=s[1];return{height:o,width:a}}))})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.detectLandmarks=function(t){return Tt(this,void 0,void 0,function(){var r,i,s,o=this;return Ct(this,function(a){switch(a.label){case 0:return[4,Ei(t)];case 1:return r=a.sent(),i=lt(function(){return si(o.forwardInput(r))}),[4,Promise.all(i.map(function(l,u){return Tt(o,void 0,void 0,function(){var c,f,h,d,p;return Ct(this,function(y){switch(y.label){case 0:return h=(f=Array).from,[4,l.data()];case 1:return c=h.apply(f,[y.sent()]),d=c.filter(function(x,m){return pB(m)}),p=c.filter(function(x,m){return!pB(m)}),[2,new j2e(Array(68).fill(0).map(function(x,m){return new Pn(d[m],p[m])}),{height:r.getInputHeight(u),width:r.getInputWidth(u)})]}})})}))];case 2:return s=a.sent(),i.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?s:s[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(uj),dj=function(n){Gt(e,n);function e(t){return t===void 0&&(t=new aj),n.call(this,"FaceLandmark68Net",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(hj);function v_e(n){var e=[],t=oj(n,e).extractDenseBlock3Params,r={dense0:t("dense0",!0),dense1:t("dense1"),dense2:t("dense2")};return Au(n,e),{params:r,paramMappings:e}}function y_e(n){var e=[],t=Ru(n),r=t.extractWeights,i=t.getRemainingWeights,s=ij(r,e).extractDenseBlock3Params,o=s(3,32,"dense0",!0),a=s(32,64,"dense1"),l=s(64,128,"dense2");if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:o,dense1:a,dense2:l}}}var x_e=function(n){Gt(e,n);function e(){return n.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return lt(function(){var i=t.toBatchTensor(112,!0),s=[122.782,117.001,104.298],o=fy(i,s).div(tt(255)),a=iM(o,r.dense0,!0);return a=iM(a,r.dense1),a=iM(a,r.dense2),a=uy(a,[14,14],[2,2],"valid"),a})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return v_e(t)},e.prototype.extractParams=function(t){return y_e(t)},e}(Cu),__e=function(n){Gt(e,n);function e(t){return t===void 0&&(t=new x_e),n.call(this,"FaceLandmark68TinyNet",t)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(hj);(function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(dj);function w_e(n,e){return ln(is(n,e.weights),e.biases)}function q4(n,e,t,r,i){i===void 0&&(i="same");var s=e.conv,o=s.filters,a=s.bias,l=pa(n,o,t,i);return l=ln(l,a),l=w_e(l,e.scale),r?pr(l):l}function b_e(n,e){return q4(n,e,[1,1],!0)}function pj(n,e){return q4(n,e,[1,1],!1)}function mj(n,e){return q4(n,e,[2,2],!0,"valid")}function S_e(n,e){function t(a,l,u){var c=n(a),f=c.length/(l*u*u);if(L2e(f))throw new Error("depth has to be an integer: "+f+", weights.length: "+c.length+", numFilters: "+l+", filterSize: "+u);return lt(function(){return Vc(Fs(c,[l,f,u,u]),[2,3,1,0])})}function r(a,l,u,c){var f=t(a,l,u),h=Xr(n(l));return e.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:f,bias:h}}function i(a,l){var u=Xr(n(a)),c=Xr(n(a));return e.push({paramPath:l+"/weights"},{paramPath:l+"/biases"}),{weights:u,biases:c}}function s(a,l,u,c){var f=r(a,l,u,c+"/conv"),h=i(l,c+"/scale");return{conv:f,scale:h}}function o(a,l,u,c,f){f===void 0&&(f=!1);var h=s((f?.5:1)*a,l,u,c+"/conv1"),d=s(a,l,u,c+"/conv2");return{conv1:h,conv2:d}}return{extractConvLayerParams:s,extractResidualLayerParams:o}}function E_e(n){var e=Ru(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],s=S_e(t,i),o=s.extractConvLayerParams,a=s.extractResidualLayerParams,l=o(4704,32,7,"conv32_down"),u=a(9216,32,3,"conv32_1"),c=a(9216,32,3,"conv32_2"),f=a(9216,32,3,"conv32_3"),h=a(36864,64,3,"conv64_down",!0),d=a(36864,64,3,"conv64_1"),p=a(36864,64,3,"conv64_2"),y=a(36864,64,3,"conv64_3"),x=a(147456,128,3,"conv128_down",!0),m=a(147456,128,3,"conv128_1"),_=a(147456,128,3,"conv128_2"),w=a(589824,256,3,"conv256_down",!0),b=a(589824,256,3,"conv256_1"),S=a(589824,256,3,"conv256_2"),M=a(589824,256,3,"conv256_down_out"),T=lt(function(){return Vc(Tc(t(256*128),[128,256]),[1,0])});if(i.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var P={conv32_down:l,conv32_1:u,conv32_2:c,conv32_3:f,conv64_down:h,conv64_1:d,conv64_2:p,conv64_3:y,conv128_down:x,conv128_1:m,conv128_2:_,conv256_down:w,conv256_1:b,conv256_2:S,conv256_down_out:M,fc:T};return{params:P,paramMappings:i}}function M_e(n,e){var t=tf(n,e);function r(o){var a=t(o+"/scale/weights",1),l=t(o+"/scale/biases",1);return{weights:a,biases:l}}function i(o){var a=t(o+"/conv/filters",4),l=t(o+"/conv/bias",1),u=r(o);return{conv:{filters:a,bias:l},scale:u}}function s(o){return{conv1:i(o+"/conv1"),conv2:i(o+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function T_e(n){var e=[],t=M_e(n,e),r=t.extractConvLayerParams,i=t.extractResidualLayerParams,s=r("conv32_down"),o=i("conv32_1"),a=i("conv32_2"),l=i("conv32_3"),u=i("conv64_down"),c=i("conv64_1"),f=i("conv64_2"),h=i("conv64_3"),d=i("conv128_down"),p=i("conv128_1"),y=i("conv128_2"),x=i("conv256_down"),m=i("conv256_1"),_=i("conv256_2"),w=i("conv256_down_out"),b=n.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!k2e(b))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+b);var S={conv32_down:s,conv32_1:o,conv32_2:a,conv32_3:l,conv64_down:u,conv64_1:c,conv64_2:f,conv64_3:h,conv128_down:d,conv128_1:p,conv128_2:y,conv256_down:x,conv256_1:m,conv256_2:_,conv256_down_out:w,fc:b};return Au(n,e),{params:S,paramMappings:e}}function tl(n,e){var t=b_e(n,e.conv1);return t=pj(t,e.conv2),t=ln(t,n),t=pr(t),t}function $x(n,e){var t=mj(n,e.conv1);t=pj(t,e.conv2);var r=uy(n,2,2,"valid"),i=Kn(r.shape),s=r.shape[3]!==t.shape[3],o=r.shape[1]!==t.shape[1]||r.shape[2]!==t.shape[2];if(o){var a=wg(t.shape);a[1]=1;var l=Kn(a);t=ii([t,l],1);var u=wg(t.shape);u[2]=1;var c=Kn(u);t=ii([t,c],2)}return r=s?ii([r,i],3):r,t=ln(r,t),t=pr(t),t}var C_e=function(n){Gt(e,n);function e(){return n.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return lt(function(){var i=t.toBatchTensor(150,!0).toFloat(),s=[122.782,117.001,104.298],o=fy(i,s).div(tt(256)),a=mj(o,r.conv32_down);a=yi(a,3,2,"valid"),a=tl(a,r.conv32_1),a=tl(a,r.conv32_2),a=tl(a,r.conv32_3),a=$x(a,r.conv64_down),a=tl(a,r.conv64_1),a=tl(a,r.conv64_2),a=tl(a,r.conv64_3),a=$x(a,r.conv128_down),a=tl(a,r.conv128_1),a=tl(a,r.conv128_2),a=$x(a,r.conv256_down),a=tl(a,r.conv256_1),a=tl(a,r.conv256_2),a=$x(a,r.conv256_down_out);var l=a.mean([1,2]),u=db(l,r.fc);return u})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return Tt(this,void 0,void 0,function(){var r,i,s,o=this;return Ct(this,function(a){switch(a.label){case 0:return[4,Ei(t)];case 1:return r=a.sent(),i=lt(function(){return si(o.forwardInput(r))}),[4,Promise.all(i.map(function(l){return l.data()}))];case 2:return s=a.sent(),i.forEach(function(l){return l.dispose()}),[2,r.isBatchInput?s:s[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return T_e(t)},e.prototype.extractParams=function(t){return E_e(t)},e}(Cu);function gj(n,e){var t={descriptor:e};return Object.assign({},n,t)}function vj(n,e){var t={age:e};return Object.assign({},n,t)}function yj(n,e,t){var r={gender:e,genderProbability:t};return Object.assign({},n,r)}var xj=function(){function n(e){var t=e===void 0?{}:e,r=t.minFaceSize,i=t.scaleFactor,s=t.maxNumScales,o=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=i||.709,this._maxNumScales=s||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=a,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(l){return typeof l!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(l){return typeof l!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n}();function A_e(n,e){function t(l,u){var c=Fs(n(9*l),[3,3,l,1]),f=Xr(n(l)),h=Xr(n(l)),d=Xr(n(l)),p=Xr(n(l));return e.push({paramPath:u+"/filters"},{paramPath:u+"/batch_norm_scale"},{paramPath:u+"/batch_norm_offset"},{paramPath:u+"/batch_norm_mean"},{paramPath:u+"/batch_norm_variance"}),{filters:c,batch_norm_scale:f,batch_norm_offset:h,batch_norm_mean:d,batch_norm_variance:p}}function r(l,u,c,f,h){var d=Fs(n(l*u*c*c),[c,c,l,u]),p=Xr(n(u));return e.push({paramPath:f+"/filters"},{paramPath:f+"/"+(h?"batch_norm_offset":"bias")}),{filters:d,bias:p}}function i(l,u,c,f){var h=r(l,u,c,f,!0),d=h.filters,p=h.bias;return{filters:d,batch_norm_offset:p}}function s(l,u,c){var f=t(l,c+"/depthwise_conv"),h=i(l,u,1,c+"/pointwise_conv");return{depthwise_conv:f,pointwise_conv:h}}function o(){var l=i(3,32,3,"mobilenetv1/conv_0"),u=s(32,64,"mobilenetv1/conv_1"),c=s(64,128,"mobilenetv1/conv_2"),f=s(128,128,"mobilenetv1/conv_3"),h=s(128,256,"mobilenetv1/conv_4"),d=s(256,256,"mobilenetv1/conv_5"),p=s(256,512,"mobilenetv1/conv_6"),y=s(512,512,"mobilenetv1/conv_7"),x=s(512,512,"mobilenetv1/conv_8"),m=s(512,512,"mobilenetv1/conv_9"),_=s(512,512,"mobilenetv1/conv_10"),w=s(512,512,"mobilenetv1/conv_11"),b=s(512,1024,"mobilenetv1/conv_12"),S=s(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:u,conv_2:c,conv_3:f,conv_4:h,conv_5:d,conv_6:p,conv_7:y,conv_8:x,conv_9:m,conv_10:_,conv_11:w,conv_12:b,conv_13:S}}function a(){var l=i(1024,256,1,"prediction_layer/conv_0"),u=i(256,512,3,"prediction_layer/conv_1"),c=i(512,128,1,"prediction_layer/conv_2"),f=i(128,256,3,"prediction_layer/conv_3"),h=i(256,128,1,"prediction_layer/conv_4"),d=i(128,256,3,"prediction_layer/conv_5"),p=i(256,64,1,"prediction_layer/conv_6"),y=i(64,128,3,"prediction_layer/conv_7"),x=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),_=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),w=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),b=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),S=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),M=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),T=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),P=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),A=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),k=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),L={box_encoding_predictor:x,class_predictor:m},H={box_encoding_predictor:_,class_predictor:w},F={box_encoding_predictor:b,class_predictor:S},V={box_encoding_predictor:M,class_predictor:T},W={box_encoding_predictor:P,class_predictor:C},G={box_encoding_predictor:A,class_predictor:k};return{conv_0:l,conv_1:u,conv_2:c,conv_3:f,conv_4:h,conv_5:d,conv_6:p,conv_7:y,box_predictor_0:L,box_predictor_1:H,box_predictor_2:F,box_predictor_3:V,box_predictor_4:W,box_predictor_5:G}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:a}}function R_e(n){var e=[],t=Ru(n),r=t.extractWeights,i=t.getRemainingWeights,s=A_e(r,e),o=s.extractMobilenetV1Params,a=s.extractPredictionLayerParams,l=o(),u=a(),c=c4(r(5118*4),[1,5118,4]),f={extra_dim:c};if(e.push({paramPath:"output_layer/extra_dim"}),i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{params:{mobilenetv1:l,prediction_layer:u,output_layer:f},paramMappings:e}}function P_e(n,e){var t=tf(n,e);function r(u,c,f){var h=t(u+"/Conv2d_"+c+"_pointwise/weights",4,f+"/filters"),d=t(u+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,f+"/batch_norm_offset");return{filters:h,batch_norm_offset:d}}function i(u){var c="mobilenetv1/conv_"+u,f="MobilenetV1/Conv2d_"+u+"_depthwise",h=c+"/depthwise_conv",d=c+"/pointwise_conv",p=t(f+"/depthwise_weights",4,h+"/filters"),y=t(f+"/BatchNorm/gamma",1,h+"/batch_norm_scale"),x=t(f+"/BatchNorm/beta",1,h+"/batch_norm_offset"),m=t(f+"/BatchNorm/moving_mean",1,h+"/batch_norm_mean"),_=t(f+"/BatchNorm/moving_variance",1,h+"/batch_norm_variance");return{depthwise_conv:{filters:p,batch_norm_scale:y,batch_norm_offset:x,batch_norm_mean:m,batch_norm_variance:_},pointwise_conv:r("MobilenetV1",u,d)}}function s(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function o(u,c){var f=t(u+"/weights",4,c+"/filters"),h=t(u+"/biases",1,c+"/bias");return{filters:f,bias:h}}function a(u){var c=o("Prediction/BoxPredictor_"+u+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+u+"/box_encoding_predictor"),f=o("Prediction/BoxPredictor_"+u+"/ClassPredictor","prediction_layer/box_predictor_"+u+"/class_predictor");return{box_encoding_predictor:c,class_predictor:f}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:l}}function I_e(n){var e=[],t=P_e(n,e),r=t.extractMobilenetV1Params,i=t.extractPredictionLayerParams,s=n["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!vb(s))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+s);var o={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:s}};return Au(n,e),{params:o,paramMappings:e}}function rl(n,e,t){return lt(function(){var r=pa(n,e.filters,t,"same");return r=ln(r,e.batch_norm_offset),w4(r,0,6)})}var D_e=.0010000000474974513;function N_e(n,e,t){return lt(function(){var r=hb(n,e.filters,t,"same");return r=dG(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,D_e),w4(r,0,6)})}function k_e(n){return[2,4,6,12].some(function(e){return e===n})?[2,2]:[1,1]}function L_e(n,e){return lt(function(){var t=null,r=rl(n,e.conv_0,[2,2]),i=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(i.forEach(function(s,o){var a=o+1,l=k_e(a);r=N_e(r,s.depthwise_conv,l),r=rl(r,s.pointwise_conv,[1,1]),a===11&&(t=r)}),t===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:t}})}function F_e(n,e,t,r,i){var s=n.shape[0],o=Math.min(t,s),a=e.map(function(c,f){return{score:c,boxIndex:f}}).filter(function(c){return c.score>i}).sort(function(c,f){return f.score-c.score}),l=function(c){return c<=r?1:0},u=[];return a.forEach(function(c){if(!(u.length>=o)){for(var f=c.score,h=u.length-1;h>=0;--h){var d=O_e(n,c.boxIndex,u[h]);if(d!==0&&(c.score*=l(d),c.score<=i))break}f===c.score&&u.push(c.boxIndex)}}),u}function O_e(n,e,t){var r=n.arraySync(),i=Math.min(r[e][0],r[e][2]),s=Math.min(r[e][1],r[e][3]),o=Math.max(r[e][0],r[e][2]),a=Math.max(r[e][1],r[e][3]),l=Math.min(r[t][0],r[t][2]),u=Math.min(r[t][1],r[t][3]),c=Math.max(r[t][0],r[t][2]),f=Math.max(r[t][1],r[t][3]),h=(o-i)*(a-s),d=(c-l)*(f-u);if(h<=0||d<=0)return 0;var p=Math.max(i,l),y=Math.max(s,u),x=Math.min(o,c),m=Math.min(a,f),_=Math.max(x-p,0)*Math.max(m-y,0);return _/(h+d-_)}function B_e(n){var e=si(Vc(n,[1,0])),t=[ui(e[2],e[0]),ui(e[3],e[1])],r=[ln(e[0],Aa(t[0],tt(2))),ln(e[1],Aa(t[1],tt(2)))];return{sizes:t,centers:r}}function U_e(n,e){var t=B_e(n),r=t.sizes,i=t.centers,s=si(Vc(e,[1,0])),o=Aa(is(iA(Aa(s[2],tt(5))),r[0]),tt(2)),a=ln(is(Aa(s[0],tt(10)),r[0]),i[0]),l=Aa(is(iA(Aa(s[3],tt(5))),r[1]),tt(2)),u=ln(is(Aa(s[1],tt(10)),r[1]),i[1]);return Vc(Ro([ui(a,o),ui(u,l),ln(a,o),ln(u,l)]),[1,0])}function z_e(n,e,t){return lt(function(){var r=n.shape[0],i=U_e(Ia(Dp(t.extra_dim,[r,1,1]),[-1,4]),Ia(n,[-1,4]));i=Ia(i,[r,i.shape[0]/r,4]);var s=uG(Al(e,[0,0,1],[-1,-1,-1])),o=Al(s,[0,0,0],[-1,-1,1]);o=Ia(o,[r,o.shape[1]]);var a=si(i),l=si(o);return{boxes:a,scores:l}})}function Nd(n,e){return lt(function(){var t=n.shape[0],r=Ia(La(n,e.box_encoding_predictor),[t,-1,1,4]),i=Ia(La(n,e.class_predictor),[t,-1,3]);return{boxPredictionEncoding:r,classPrediction:i}})}function V_e(n,e,t){return lt(function(){var r=rl(n,t.conv_0,[1,1]),i=rl(r,t.conv_1,[2,2]),s=rl(i,t.conv_2,[1,1]),o=rl(s,t.conv_3,[2,2]),a=rl(o,t.conv_4,[1,1]),l=rl(a,t.conv_5,[2,2]),u=rl(l,t.conv_6,[1,1]),c=rl(u,t.conv_7,[2,2]),f=Nd(e,t.box_predictor_0),h=Nd(n,t.box_predictor_1),d=Nd(i,t.box_predictor_2),p=Nd(o,t.box_predictor_3),y=Nd(l,t.box_predictor_4),x=Nd(c,t.box_predictor_5),m=ii([f.boxPredictionEncoding,h.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,y.boxPredictionEncoding,x.boxPredictionEncoding],1),_=ii([f.classPrediction,h.classPrediction,d.classPrediction,p.classPrediction,y.classPrediction,x.classPrediction],1);return{boxPredictions:m,classPredictions:_}})}var wb=function(){function n(e){var t=e===void 0?{}:e,r=t.minConfidence,i=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=i||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n}(),_j=function(n){Gt(e,n);function e(){return n.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(t){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return lt(function(){var i=t.toBatchTensor(512,!1).toFloat(),s=ui(is(i,tt(.007843137718737125)),tt(1)),o=L_e(s,r.mobilenetv1),a=V_e(o.out,o.conv11,r.prediction_layer),l=a.boxPredictions,u=a.classPredictions;return z_e(l,u,r.output_layer)})},e.prototype.forward=function(t){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r=this.forwardInput,[4,Ei(t)];case 1:return[2,r.apply(this,[i.sent()])]}})})},e.prototype.locateFaces=function(t,r){return r===void 0&&(r={}),Tt(this,void 0,void 0,function(){var i,s,o,a,l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P;return Ct(this,function(C){switch(C.label){case 0:return i=new wb(r),s=i.maxResults,o=i.minConfidence,[4,Ei(t)];case 1:for(a=C.sent(),l=this.forwardInput(a),u=l.boxes,c=l.scores,f=u[0],h=c[0],d=1;d<u.length;d++)u[d].dispose(),c[d].dispose();return x=(y=Array).from,[4,h.data()];case 2:return p=x.apply(y,[C.sent()]),m=.5,_=F_e(f,p,s,m,o),w=a.getReshapedInputDimensions(0),b=a.inputSize,S=b/w.width,M=b/w.height,T=f.arraySync(),P=_.map(function(A){var k=[Math.max(0,T[A][0]),Math.min(1,T[A][2])].map(function(G){return G*M}),L=k[0],H=k[1],F=[Math.max(0,T[A][1]),Math.min(1,T[A][3])].map(function(G){return G*S}),V=F[0],W=F[1];return new Dl(p[A],new B4(V,L,W-V,H-L),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}),f.dispose(),h.dispose(),[2,P]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return I_e(t)},e.prototype.extractParams=function(t){return R_e(t)},e}(Cu);(function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(_j);var W_e=.4,H_e=[new Pn(.738768,.874946),new Pn(2.42204,2.65704),new Pn(4.30971,7.04493),new Pn(10.246,4.59428),new Pn(12.6868,11.8741)],G_e=[new Pn(1.603231,2.094468),new Pn(6.041143,7.080126),new Pn(2.882459,3.518061),new Pn(4.266906,5.178857),new Pn(9.041765,10.66308)],j_e=[117.001,114.697,97.404],X_e="tiny_yolov2_model",$_e="tiny_yolov2_separable_conv_model",qx=function(n){return typeof n=="number"};function q_e(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!qx(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(e){return e||{}}).every(function(e){return qx(e.x)&&qx(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(qx)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Y4(n){return lt(function(){var e=is(n,tt(.10000000149011612));return ln(pr(ui(n,e)),e)})}function $u(n,e){return lt(function(){var t=Oh(n,[[0,0],[1,1],[1,1],[0,0]]);return t=pa(t,e.conv.filters,[1,1],"valid"),t=ui(t,e.bn.sub),t=is(t,e.bn.truediv),t=ln(t,e.conv.bias),Y4(t)})}function qu(n,e){return lt(function(){var t=Oh(n,[[0,0],[1,1],[1,1],[0,0]]);return t=M4(t,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),t=ln(t,e.bias),Y4(t)})}function Y_e(n,e){var t=_b(n,e);function r(o,a){var l=Xr(n(o)),u=Xr(n(o));return e.push({paramPath:a+"/sub"},{paramPath:a+"/truediv"}),{sub:l,truediv:u}}function i(o,a,l){var u=t(o,a,3,l+"/conv"),c=r(a,l+"/bn");return{conv:u,bn:c}}var s=j4(n,e);return{extractConvParams:t,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function K_e(n,e,t,r){var i=Ru(n),s=i.extractWeights,o=i.getRemainingWeights,a=[],l=Y_e(s,a),u=l.extractConvParams,c=l.extractConvWithBatchNormParams,f=l.extractSeparableConvParams,h;if(e.withSeparableConvs){var d=r[0],p=r[1],y=r[2],x=r[3],m=r[4],_=r[5],w=r[6],b=r[7],S=r[8],M=e.isFirstLayerConv2d?u(d,p,3,"conv0"):f(d,p,"conv0"),T=f(p,y,"conv1"),P=f(y,x,"conv2"),C=f(x,m,"conv3"),A=f(m,_,"conv4"),k=f(_,w,"conv5"),L=b?f(w,b,"conv6"):void 0,H=S?f(b,S,"conv7"):void 0,F=u(S||b||w,5*t,1,"conv8");h={conv0:M,conv1:T,conv2:P,conv3:C,conv4:A,conv5:k,conv6:L,conv7:H,conv8:F}}else{var d=r[0],p=r[1],y=r[2],x=r[3],m=r[4],_=r[5],w=r[6],b=r[7],S=r[8],M=c(d,p,"conv0"),T=c(p,y,"conv1"),P=c(y,x,"conv2"),C=c(x,m,"conv3"),A=c(m,_,"conv4"),k=c(_,w,"conv5"),L=c(w,b,"conv6"),H=c(b,S,"conv7"),F=u(S,5*t,1,"conv8");h={conv0:M,conv1:T,conv2:P,conv3:C,conv4:A,conv5:k,conv6:L,conv7:H,conv8:F}}if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:h,paramMappings:a}}function Z_e(n,e){var t=tf(n,e);function r(a){var l=t(a+"/sub",1),u=t(a+"/truediv",1);return{sub:l,truediv:u}}function i(a){var l=t(a+"/filters",4),u=t(a+"/bias",1);return{filters:l,bias:u}}function s(a){var l=i(a+"/conv"),u=r(a+"/bn");return{conv:l,bn:u}}var o=X4(t);return{extractConvParams:i,extractConvWithBatchNormParams:s,extractSeparableConvParams:o}}function J_e(n,e){var t=[],r=Z_e(n,t),i=r.extractConvParams,s=r.extractConvWithBatchNormParams,o=r.extractSeparableConvParams,a;if(e.withSeparableConvs){var l=e.filterSizes&&e.filterSizes.length||9;a={conv0:e.isFirstLayerConv2d?i("conv0"):o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:l>7?o("conv6"):void 0,conv7:l>8?o("conv7"):void 0,conv8:i("conv8")}}else a={conv0:s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:s("conv6"),conv7:s("conv7"),conv8:i("conv8")};return Au(n,t),{params:a,paramMappings:t}}var bB;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(bB||(bB={}));var K4=function(){function n(e){var t=e===void 0?{}:e,r=t.inputSize,i=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=i||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n}(),wj=function(n){Gt(e,n);function e(t){var r=n.call(this,"TinyYolov2")||this;return q_e(t),r._config=t,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,r){var i=$u(t,r.conv0);return i=yi(i,[2,2],[2,2],"same"),i=$u(i,r.conv1),i=yi(i,[2,2],[2,2],"same"),i=$u(i,r.conv2),i=yi(i,[2,2],[2,2],"same"),i=$u(i,r.conv3),i=yi(i,[2,2],[2,2],"same"),i=$u(i,r.conv4),i=yi(i,[2,2],[2,2],"same"),i=$u(i,r.conv5),i=yi(i,[2,2],[1,1],"same"),i=$u(i,r.conv6),i=$u(i,r.conv7),La(i,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,r){var i=this.config.isFirstLayerConv2d?Y4(La(t,r.conv0,"valid",!1)):qu(t,r.conv0);return i=yi(i,[2,2],[2,2],"same"),i=qu(i,r.conv1),i=yi(i,[2,2],[2,2],"same"),i=qu(i,r.conv2),i=yi(i,[2,2],[2,2],"same"),i=qu(i,r.conv3),i=yi(i,[2,2],[2,2],"same"),i=qu(i,r.conv4),i=yi(i,[2,2],[2,2],"same"),i=qu(i,r.conv5),i=yi(i,[2,2],[1,1],"same"),i=r.conv6?qu(i,r.conv6):i,i=r.conv7?qu(i,r.conv7):i,La(i,r.conv8,"valid",!1)},e.prototype.forwardInput=function(t,r){var i=this,s=this.params;if(!s)throw new Error("TinyYolov2 - load model before inference");return lt(function(){var o=t.toBatchTensor(r,!1).toFloat();return o=i.config.meanRgb?fy(o,i.config.meanRgb):o,o=o.div(tt(256)),i.config.withSeparableConvs?i.runMobilenet(o,s):i.runTinyYolov2(o,s)})},e.prototype.forward=function(t,r){return Tt(this,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return i=this.forwardInput,[4,Ei(t)];case 1:return[4,i.apply(this,[s.sent(),r])];case 2:return[2,s.sent()]}})})},e.prototype.detect=function(t,r){return r===void 0&&(r={}),Tt(this,void 0,void 0,function(){var i,s,o,a,l,u,c,f,h,d,p,y,x,m,_=this;return Ct(this,function(w){switch(w.label){case 0:return i=new K4(r),s=i.inputSize,o=i.scoreThreshold,[4,Ei(t)];case 1:return a=w.sent(),[4,this.forwardInput(a,s)];case 2:return l=w.sent(),u=lt(function(){return si(l)[0].expandDims()}),c={width:a.getInputWidth(0),height:a.getInputHeight(0)},[4,this.extractBoxes(u,a.getReshapedInputDimensions(0),o)];case 3:return f=w.sent(),l.dispose(),u.dispose(),h=f.map(function(b){return b.box}),d=f.map(function(b){return b.score}),p=f.map(function(b){return b.classScore}),y=f.map(function(b){return _.config.classes[b.label]}),x=Pv(h.map(function(b){return b.rescale(s)}),d,this.config.iouThreshold,!0),m=x.map(function(b){return new $G(d[b],p[b],y[b],h[b],c)}),[2,m]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return J_e(t,this.config)},e.prototype.extractParams=function(t){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,i=r?r.length:void 0;if(i!==7&&i!==8&&i!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+i+" filterSizes in config");return K_e(t,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(t,r,i){return Tt(this,void 0,void 0,function(){var s,o,a,l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P,C,A,k,L,H,F,V,W,G,N=this;return Ct(this,function(B){switch(B.label){case 0:return s=r.width,o=r.height,a=Math.max(s,o),l=a/s,u=a/o,c=t.shape[1],f=this.config.anchors.length,h=lt(function(){var D=t.reshape([c,c,f,N.boxEncodingSize]),$=D.slice([0,0,0,0],[c,c,f,4]),ee=D.slice([0,0,0,4],[c,c,f,1]),te=N.withClassScores?Mu(D.slice([0,0,0,5],[c,c,f,N.config.classes.length]),3):tt(0);return[$,ee,te]}),d=h[0],p=h[1],y=h[2],x=[],[4,p.array()];case 1:return m=B.sent(),[4,d.array()];case 2:_=B.sent(),w=0,B.label=3;case 3:if(!(w<c))return[3,12];b=0,B.label=4;case 4:if(!(b<c))return[3,11];S=0,B.label=5;case 5:return S<f?(M=rM(m[w][b][S][0]),!i||M>i?(T=(b+rM(_[w][b][S][0]))/c*l,P=(w+rM(_[w][b][S][1]))/c*u,C=Math.exp(_[w][b][S][2])*this.config.anchors[S].x/c*l,A=Math.exp(_[w][b][S][3])*this.config.anchors[S].y/c*u,k=T-C/2,L=P-A/2,H={row:w,col:b,anchor:S},this.withClassScores?[4,this.extractPredictedClass(y,H)]:[3,7]):[3,9]):[3,10];case 6:return G=B.sent(),[3,8];case 7:G={classScore:1,label:0},B.label=8;case 8:F=G,V=F.classScore,W=F.label,x.push(Qi({box:new yb(k,L,k+C,L+A),score:M,classScore:M*V,label:W},H)),B.label=9;case 9:return S++,[3,5];case 10:return b++,[3,4];case 11:return w++,[3,3];case 12:return d.dispose(),p.dispose(),y.dispose(),[2,x]}})})},e.prototype.extractPredictedClass=function(t,r){return Tt(this,void 0,void 0,function(){var i,s,o,a;return Ct(this,function(l){switch(l.label){case 0:return i=r.row,s=r.col,o=r.anchor,[4,t.array()];case 1:return a=l.sent(),[2,Array(this.config.classes.length).fill(0).map(function(u,c){return a[i][s][o][c]}).map(function(u,c){return{classScore:u,label:c}}).reduce(function(u,c){return u.classScore>c.classScore?u:c})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(Cu),Q_e=function(n){Gt(e,n);function e(t){t===void 0&&(t=!0);var r=this,i=Object.assign({},{withSeparableConvs:t,iouThreshold:W_e,classes:["face"]},t?{anchors:G_e,meanRgb:j_e}:{anchors:H_e,withClassScores:!0});return r=n.call(this,i)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return Tt(this,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return[4,this.detect(t,r)];case 1:return i=s.sent(),[2,i.map(function(o){return new Dl(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?$_e:X_e},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e}(wj),bj=function(n){Gt(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return e}(K4),hy=function(){function n(){}return n.prototype.then=function(e){return Tt(this,void 0,void 0,function(){var t;return Ct(this,function(r){switch(r.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return Tt(this,void 0,void 0,function(){return Ct(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},n}();function bb(n,e,t,r,i){return i===void 0&&(i=function(s){var o=s.alignedRect;return o}),Tt(this,void 0,void 0,function(){var s,o,a,l,u;return Ct(this,function(c){switch(c.label){case 0:return s=n.map(function(f){return a_e(f)?i(f):f.detection}),a=r,a?[3,5]:e instanceof cr?[4,H4(e,s)]:[3,2];case 1:return l=c.sent(),[3,4];case 2:return[4,W4(e,s)];case 3:l=c.sent(),c.label=4;case 4:a=l,c.label=5;case 5:return o=a,[4,t(o)];case 6:return u=c.sent(),o.forEach(function(f){return f instanceof cr&&f.dispose()}),[2,u]}})})}function Z4(n,e,t,r,i){return Tt(this,void 0,void 0,function(){var s=this;return Ct(this,function(o){return[2,bb([n],e,function(a){return Tt(s,void 0,void 0,function(){return Ct(this,function(l){return[2,t(a[0])]})})},r,i)]})})}function ewe(n){return lt(function(){return Ro(si(n,3).reverse(),3)})}var Yx=2,nw=12;function twe(n,e){var t=_b(n,e),r=G4(n,e);function i(u,c){var f=Xr(n(u));return e.push({paramPath:c}),f}function s(u,c,f){f===void 0&&(f=!1);var h=t(u[0],u[1],3,c+"/conv1"),d=i(u[1],c+"/prelu1_alpha"),p=t(u[1],u[2],3,c+"/conv2"),y=i(u[2],c+"/prelu2_alpha"),x=t(u[2],u[3],f?2:3,c+"/conv3"),m=i(u[3],c+"/prelu3_alpha");return{conv1:h,prelu1_alpha:d,conv2:p,prelu2_alpha:y,conv3:x,prelu3_alpha:m}}function o(){var u=s([3,10,16,32],"pnet"),c=t(32,2,1,"pnet/conv4_1"),f=t(32,4,1,"pnet/conv4_2");return Qi(Qi({},u),{conv4_1:c,conv4_2:f})}function a(){var u=s([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),f=i(128,"rnet/prelu4_alpha"),h=r(128,2,"rnet/fc2_1"),d=r(128,4,"rnet/fc2_2");return Qi(Qi({},u),{fc1:c,prelu4_alpha:f,fc2_1:h,fc2_2:d})}function l(){var u=s([3,32,64,64],"onet"),c=t(64,128,2,"onet/conv4"),f=i(128,"onet/prelu4_alpha"),h=r(1152,256,"onet/fc1"),d=i(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),y=r(256,4,"onet/fc2_2"),x=r(256,10,"onet/fc2_3");return Qi(Qi({},u),{conv4:c,prelu4_alpha:f,fc1:h,prelu5_alpha:d,fc2_1:p,fc2_2:y,fc2_3:x})}return{extractPNetParams:o,extractRNetParams:a,extractONetParams:l}}function nwe(n){var e=Ru(n),t=e.extractWeights,r=e.getRemainingWeights,i=[],s=twe(t,i),o=s.extractPNetParams,a=s.extractRNetParams,l=s.extractONetParams,u=o(),c=a(),f=l();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:c,onet:f},paramMappings:i}}function rwe(n,e){var t=tf(n,e);function r(c){var f=t(c+"/weights",4,c+"/filters"),h=t(c+"/bias",1);return{filters:f,bias:h}}function i(c){var f=t(c+"/weights",2),h=t(c+"/bias",1);return{weights:f,bias:h}}function s(c){return t(c,1)}function o(c){var f=r(c+"/conv1"),h=s(c+"/prelu1_alpha"),d=r(c+"/conv2"),p=s(c+"/prelu2_alpha"),y=r(c+"/conv3"),x=s(c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:d,prelu2_alpha:p,conv3:y,prelu3_alpha:x}}function a(){var c=o("pnet"),f=r("pnet/conv4_1"),h=r("pnet/conv4_2");return Qi(Qi({},c),{conv4_1:f,conv4_2:h})}function l(){var c=o("rnet"),f=i("rnet/fc1"),h=s("rnet/prelu4_alpha"),d=i("rnet/fc2_1"),p=i("rnet/fc2_2");return Qi(Qi({},c),{fc1:f,prelu4_alpha:h,fc2_1:d,fc2_2:p})}function u(){var c=o("onet"),f=r("onet/conv4"),h=s("onet/prelu4_alpha"),d=i("onet/fc1"),p=s("onet/prelu5_alpha"),y=i("onet/fc2_1"),x=i("onet/fc2_2"),m=i("onet/fc2_3");return Qi(Qi({},c),{conv4:f,prelu4_alpha:h,fc1:d,prelu5_alpha:p,fc2_1:y,fc2_2:x,fc2_3:m})}return{extractPNetParams:a,extractRNetParams:l,extractONetParams:u}}function iwe(n){var e=[],t=rwe(n,e),r=t.extractPNetParams,i=t.extractRNetParams,s=t.extractONetParams,o=r(),a=i(),l=s();return Au(n,e),{params:{pnet:o,rnet:a,onet:l},paramMappings:e}}function hA(n,e){var t=e[0],r=e[1];return{height:Math.floor(t*n),width:Math.floor(r*n)}}function swe(n,e,t){for(var r=t[0],i=t[1],s=nw/n,o=[],a=Math.min(r,i)*s,l=0;a>=12;)o.push(s*Math.pow(e,l)),a=a*e,l+=1;return o}var J4=function(n){Gt(e,n);function e(t,r,i,s){return n.call(this,{left:t,top:r,right:i,bottom:s},!0)||this}return e}(Wc);function Sj(n){return lt(function(){return is(ui(n,tt(127.5)),tt(.0078125))})}function Bp(n,e){return lt(function(){return ln(pr(n),is(e,Y_(pr(Y_(n)))))})}function Q4(n,e,t){return t===void 0&&(t=!1),lt(function(){var r=La(n,e.conv1,"valid");return r=Bp(r,e.prelu1_alpha),r=yi(r,t?[2,2]:[3,3],[2,2],"same"),r=La(r,e.conv2,"valid"),r=Bp(r,e.prelu2_alpha),r=t?r:yi(r,[3,3],[2,2],"valid"),r=La(r,e.conv3,"valid"),r=Bp(r,e.prelu3_alpha),r})}function owe(n,e){return lt(function(){var t=Q4(n,e,!0),r=La(t,e.conv4_1,"valid"),i=Qo(pb(r,3),3),s=Mu(ui(r,i),3),o=La(t,e.conv4_2,"valid");return{prob:s,regions:o}})}function awe(n,e){return lt(function(){var t=hA(e,n.shape.slice(1)),r=t.height,i=t.width,s=P4.resizeBilinear(n,[r,i]),o=Sj(s);return Vc(o,[0,2,1,3])})}function lwe(n,e,t,r){for(var i=[],s=n.arraySync(),o=0;o<n.shape[0];o++)for(var a=0;a<n.shape[1];a++)s[o][a]>=r&&i.push(new Pn(a,o));var l=i.map(function(u){var c=new yb(Math.round((u.y*Yx+1)/t),Math.round((u.x*Yx+1)/t),Math.round((u.y*Yx+nw)/t),Math.round((u.x*Yx+nw)/t)),f=s[u.y][u.x],h=e.arraySync(),d=new J4(h[u.y][u.x][0],h[u.y][u.x][1],h[u.y][u.x][2],h[u.y][u.x][3]);return{cell:c,score:f,region:d}});return l}function uwe(n,e,t,r,i){i.stage1=[];var s=e.map(function(h){return lt(function(){var d={scale:h},p=awe(n,h),y=Date.now(),x=owe(p,r),m=x.prob,_=x.regions;d.pnet=Date.now()-y;var w=si(si(m,3)[1])[0],b=si(_)[0];return{scoresTensor:w,regionsTensor:b,scale:h,statsForScale:d}})}),o=s.map(function(h){var d=h.scoresTensor,p=h.regionsTensor,y=h.scale,x=h.statsForScale,m=lwe(d,p,y,t);if(d.dispose(),p.dispose(),!m.length)return i.stage1.push(x),[];var _=Date.now(),w=Pv(m.map(function(b){return b.cell}),m.map(function(b){return b.score}),.5);return x.nms=Date.now()-_,x.numBoxes=w.length,i.stage1.push(x),w.map(function(b){return m[b]})}),a=o.reduce(function(h,d){return h.concat(d)},[]),l=[],u=[];if(a.length>0){var c=Date.now(),f=Pv(a.map(function(h){return h.cell}),a.map(function(h){return h.score}),.7);i.stage1_nms=Date.now()-c,u=f.map(function(h){return a[h].score}),l=f.map(function(h){return a[h]}).map(function(h){var d=h.cell,p=h.region;return new yb(d.left+p.left*d.width,d.top+p.top*d.height,d.right+p.right*d.width,d.bottom+p.bottom*d.height).toSquare().round()})}return{boxes:l,scores:u}}function Ej(n,e,t){var r=t.width,i=t.height;return Tt(this,void 0,void 0,function(){var s,o,a,l=this;return Ct(this,function(u){switch(u.label){case 0:return s=Ah(n),[4,Promise.all(e.map(function(c){return Tt(l,void 0,void 0,function(){var f,h,d,p,y,x,m,_;return Ct(this,function(w){return f=c.padAtBorders(n.height,n.width),h=f.y,d=f.ey,p=f.x,y=f.ex,x=p-1,m=h-1,_=s.getImageData(x,m,y-x,d-m),[2,ls.isNodejs()?V4(_):createImageBitmap(_)]})})}))];case 1:return o=u.sent(),a=[],o.forEach(function(c){var f=xb({width:r,height:i}),h=Ah(f);h.drawImage(c,0,0,r,i);for(var d=h.getImageData(0,0,r,i).data,p=[],y=0;y<d.length;y+=4)p.push(d[y+2]),p.push(d[y+1]),p.push(d[y]);a.push(p)}),[2,a.map(function(c){var f=lt(function(){var h=Vc(Fs(c,[1,r,i,3]),[0,2,1,3]).toFloat();return Sj(h)});return f})]}})})}function cwe(n,e){return lt(function(){var t=Q4(n,e),r=Ia(t,[t.shape[0],e.fc1.weights.shape[0]]),i=ml(r,e.fc1),s=Bp(i,e.prelu4_alpha),o=ml(s,e.fc2_1),a=Qo(pb(o,1),1),l=Mu(ui(o,a),1),u=ml(s,e.fc2_2),c=si(l,1)[1];return{scores:c,regions:u}})}function fwe(n,e,t,r,i){return Tt(this,void 0,void 0,function(){var s,o,a,l,u,c,f,h,d,p,y,x,m,_;return Ct(this,function(w){switch(w.label){case 0:return s=Date.now(),[4,Ej(n,e,{width:24,height:24})];case 1:return o=w.sent(),i.stage2_extractImagePatches=Date.now()-s,s=Date.now(),a=o.map(function(b){var S=cwe(b,r);return b.dispose(),S}),i.stage2_rnet=Date.now()-s,l=a.length>1?ii(a.map(function(b){return b.scores})):a[0].scores,f=(c=Array).from,[4,l.data()];case 2:return u=f.apply(c,[w.sent()]),l.dispose(),h=u.map(function(b,S){return{score:b,idx:S}}).filter(function(b){return b.score>t}).map(function(b){var S=b.idx;return S}),d=h.map(function(b){return e[b]}),p=h.map(function(b){return u[b]}),y=[],x=[],d.length>0&&(s=Date.now(),m=Pv(d,p,.7),i.stage2_nms=Date.now()-s,_=m.map(function(b){var S=a[h[b]].regions.arraySync();return new J4(S[0][0],S[0][1],S[0][2],S[0][3])}),x=m.map(function(b){return p[b]}),y=m.map(function(b,S){return d[b].calibrate(_[S])})),a.forEach(function(b){b.regions.dispose(),b.scores.dispose()}),[2,{boxes:y,scores:x}]}})})}function hwe(n,e){return lt(function(){var t=Q4(n,e);t=yi(t,[2,2],[2,2],"same"),t=La(t,e.conv4,"valid"),t=Bp(t,e.prelu4_alpha);var r=Ia(t,[t.shape[0],e.fc1.weights.shape[0]]),i=ml(r,e.fc1),s=Bp(i,e.prelu5_alpha),o=ml(s,e.fc2_1),a=Qo(pb(o,1),1),l=Mu(ui(o,a),1),u=ml(s,e.fc2_2),c=ml(s,e.fc2_3),f=si(l,1)[1];return{scores:f,regions:u,points:c}})}function dwe(n,e,t,r,i){return Tt(this,void 0,void 0,function(){var s,o,a,l,u,c,f,h,d,p,y,x,m,_,w;return Ct(this,function(b){switch(b.label){case 0:return s=Date.now(),[4,Ej(n,e,{width:48,height:48})];case 1:return o=b.sent(),i.stage3_extractImagePatches=Date.now()-s,s=Date.now(),a=o.map(function(S){var M=hwe(S,r);return S.dispose(),M}),i.stage3_onet=Date.now()-s,l=a.length>1?ii(a.map(function(S){return S.scores})):a[0].scores,f=(c=Array).from,[4,l.data()];case 2:return u=f.apply(c,[b.sent()]),l.dispose(),h=u.map(function(S,M){return{score:S,idx:M}}).filter(function(S){return S.score>t}).map(function(S){var M=S.idx;return M}),d=h.map(function(S){var M=a[S].regions.arraySync();return new J4(M[0][0],M[0][1],M[0][2],M[0][3])}),p=h.map(function(S,M){return e[S].calibrate(d[M])}),y=h.map(function(S){return u[S]}),x=[],m=[],_=[],p.length>0&&(s=Date.now(),w=Pv(p,y,.7,!1),i.stage3_nms=Date.now()-s,x=w.map(function(S){return p[S]}),m=w.map(function(S){return y[S]}),_=w.map(function(S,M){return Array(5).fill(0).map(function(T,P){var C=a[S].points.arraySync();return new Pn(C[0][P]*(x[M].width+1)+x[M].left,C[0][P+5]*(x[M].height+1)+x[M].top)})})),a.forEach(function(S){S.regions.dispose(),S.scores.dispose(),S.points.dispose()}),[2,{boxes:x,scores:m,points:_}]}})})}var pwe=function(n){Gt(e,n);function e(){return n.call(this,"Mtcnn")||this}return e.prototype.load=function(t){return Tt(this,void 0,void 0,function(){return Ct(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,t)]})})},e.prototype.loadFromDisk=function(t){return Tt(this,void 0,void 0,function(){return Ct(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,t)]})})},e.prototype.forwardInput=function(t,r){return r===void 0&&(r={}),Tt(this,void 0,void 0,function(){var i,s,o,a,l,u,c,f,h,d,p,y,x,m,_,w,b,S,M,T,P;return Ct(this,function(C){switch(C.label){case 0:if(i=this.params,!i)throw new Error("Mtcnn - load model before inference");if(s=t.canvases[0],!s)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},a=Date.now(),l=lt(function(){return ewe(Qo(F4.fromPixels(s)).toFloat())}),u=function(A){return l.dispose(),o.total=Date.now()-a,A},c=l.shape.slice(1),f=c[0],h=c[1],d=new xj(r),p=d.minFaceSize,y=d.scaleFactor,x=d.maxNumScales,m=d.scoreThresholds,_=d.scaleSteps,w=(_||swe(p,y,[f,h])).filter(function(A){var k=hA(A,[f,h]);return Math.min(k.width,k.height)>nw}).slice(0,x),o.scales=w,o.pyramid=w.map(function(A){return hA(A,[f,h])}),b=Date.now(),[4,uwe(l,w,m[0],i.pnet,o)];case 1:return S=C.sent(),o.total_stage1=Date.now()-b,S.boxes.length?(o.stage2_numInputBoxes=S.boxes.length,b=Date.now(),[4,fwe(s,S.boxes,m[1],i.rnet,o)]):[2,u({results:[],stats:o})];case 2:return M=C.sent(),o.total_stage2=Date.now()-b,M.boxes.length?(o.stage3_numInputBoxes=M.boxes.length,b=Date.now(),[4,dwe(s,M.boxes,m[2],i.onet,o)]):[2,u({results:[],stats:o})];case 3:return T=C.sent(),o.total_stage3=Date.now()-b,P=T.boxes.map(function(A,k){return $4(U4({},new Dl(T.scores[k],new B4(A.left/h,A.top/f,A.width/h,A.height/f),{height:f,width:h})),new G2e(T.points[k].map(function(L){return L.sub(new Pn(A.left,A.top)).div(new Pn(A.width,A.height))}),{width:A.width,height:A.height}))}),[2,u({results:P,stats:o})]}})})},e.prototype.forward=function(t,r){return r===void 0&&(r={}),Tt(this,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return i=this.forwardInput,[4,Ei(t)];case 1:return[4,i.apply(this,[s.sent(),r])];case 2:return[2,s.sent().results]}})})},e.prototype.forwardWithStats=function(t,r){return r===void 0&&(r={}),Tt(this,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return i=this.forwardInput,[4,Ei(t)];case 1:return[2,i.apply(this,[s.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return iwe(t)},e.prototype.extractParams=function(t){return nwe(t)},e}(Cu),mwe=.4,gwe=[new Pn(1.603231,2.094468),new Pn(6.041143,7.080126),new Pn(2.882459,3.518061),new Pn(4.266906,5.178857),new Pn(9.041765,10.66308)],vwe=[117.001,114.697,97.404],ywe=function(n){Gt(e,n);function e(){var t=this,r={withSeparableConvs:!0,iouThreshold:mwe,classes:["face"],anchors:gwe,meanRgb:vwe,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t=n.call(this,r)||this,t}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,r){return Tt(this,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return[4,this.detect(t,r)];case 1:return i=s.sent(),[2,i.map(function(o){return new Dl(o.score,o.relativeBox,{width:o.imageWidth,height:o.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(t){return n.prototype.extractParamsFromWeigthMap.call(this,t)},e}(wj),Ws={ssdMobilenetv1:new _j,tinyFaceDetector:new ywe,tinyYolov2:new Q_e,mtcnn:new pwe,faceLandmark68Net:new dj,faceLandmark68TinyNet:new __e,faceRecognitionNet:new C_e,faceExpressionNet:new o_e,ageGenderNet:new g_e},Mj=function(n){Gt(e,n);function e(t,r,i){var s=n.call(this)||this;return s.parentTask=t,s.input=r,s.extractedFaces=i,s}return e}(hy),eI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i=this;return Ct(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return t=s.sent(),[4,bb(t,this.input,function(o){return Tt(i,void 0,void 0,function(){return Ct(this,function(a){switch(a.label){case 0:return[4,Promise.all(o.map(function(l){return Ws.faceExpressionNet.predictExpressions(l)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=s.sent(),[2,t.map(function(o,a){return cj(o,r[a])})]}})})},e.prototype.withAgeAndGender=function(){return new iI(this,this.input)},e}(Mj),tI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r;return Ct(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Z4(t,this.input,function(s){return Ws.faceExpressionNet.predictExpressions(s)},this.extractedFaces)]:[2];case 2:return r=i.sent(),[2,cj(t,r)]}})})},e.prototype.withAgeAndGender=function(){return new sI(this,this.input)},e}(Mj),nI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new oI(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lI(this,this.input)},e}(eI),rI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new aI(this,this.input)},e.prototype.withFaceDescriptor=function(){return new uI(this,this.input)},e}(tI),Tj=function(n){Gt(e,n);function e(t,r,i){var s=n.call(this)||this;return s.parentTask=t,s.input=r,s.extractedFaces=i,s}return e}(hy),iI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i=this;return Ct(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return t=s.sent(),[4,bb(t,this.input,function(o){return Tt(i,void 0,void 0,function(){return Ct(this,function(a){switch(a.label){case 0:return[4,Promise.all(o.map(function(l){return Ws.ageGenderNet.predictAgeAndGender(l)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=s.sent(),[2,t.map(function(o,a){var l=r[a],u=l.age,c=l.gender,f=l.genderProbability;return vj(yj(o,c,f),u)})]}})})},e.prototype.withFaceExpressions=function(){return new eI(this,this.input)},e}(Tj),sI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i,s,o;return Ct(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?[4,Z4(t,this.input,function(l){return Ws.ageGenderNet.predictAgeAndGender(l)},this.extractedFaces)]:[2];case 2:return r=a.sent(),i=r.age,s=r.gender,o=r.genderProbability,[2,vj(yj(t,s,o),i)]}})})},e.prototype.withFaceExpressions=function(){return new tI(this,this.input)},e}(Tj),oI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new nI(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lI(this,this.input)},e}(iI),aI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new rI(this,this.input)},e.prototype.withFaceDescriptor=function(){return new uI(this,this.input)},e}(sI),Cj=function(n){Gt(e,n);function e(t,r){var i=n.call(this)||this;return i.parentTask=t,i.input=r,i}return e}(hy),lI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r;return Ct(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),[4,bb(t,this.input,function(s){return Promise.all(s.map(function(o){return Ws.faceRecognitionNet.computeFaceDescriptor(o)}))},null,function(s){return s.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=i.sent(),[2,r.map(function(s,o){return gj(t[o],s)})]}})})},e.prototype.withFaceExpressions=function(){return new nI(this,this.input)},e.prototype.withAgeAndGender=function(){return new oI(this,this.input)},e}(Cj),uI=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r;return Ct(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return t=i.sent(),t?[4,Z4(t,this.input,function(s){return Ws.faceRecognitionNet.computeFaceDescriptor(s)},null,function(s){return s.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=i.sent(),[2,gj(t,r)]}})})},e.prototype.withFaceExpressions=function(){return new rI(this,this.input)},e.prototype.withAgeAndGender=function(){return new aI(this,this.input)},e}(Cj),Aj=function(n){Gt(e,n);function e(t,r,i){var s=n.call(this)||this;return s.parentTask=t,s.input=r,s.useTinyLandmarkNet=i,s}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Ws.faceLandmark68TinyNet:Ws.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(hy),xwe=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i,s,o,a=this;return Ct(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return t=l.sent(),r=t.map(function(u){return u.detection}),this.input instanceof cr?[4,H4(this.input,r)]:[3,3];case 2:return s=l.sent(),[3,5];case 3:return[4,W4(this.input,r)];case 4:s=l.sent(),l.label=5;case 5:return i=s,[4,Promise.all(i.map(function(u){return a.landmarkNet.detectLandmarks(u)}))];case 6:return o=l.sent(),i.forEach(function(u){return u instanceof cr&&u.dispose()}),[2,t.map(function(u,c){return $4(u,o[c])})]}})})},e.prototype.withFaceExpressions=function(){return new nI(this,this.input)},e.prototype.withAgeAndGender=function(){return new oI(this,this.input)},e.prototype.withFaceDescriptors=function(){return new lI(this,this.input)},e}(Aj),_we=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i,s,o;return Ct(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?(r=t.detection,this.input instanceof cr?[4,H4(this.input,[r])]:[3,3]):[2];case 2:return s=a.sent(),[3,5];case 3:return[4,W4(this.input,[r])];case 4:s=a.sent(),a.label=5;case 5:return i=s,[4,this.landmarkNet.detectLandmarks(i[0])];case 6:return o=a.sent(),i.forEach(function(l){return l instanceof cr&&l.dispose()}),[2,$4(t,o)]}})})},e.prototype.withFaceExpressions=function(){return new rI(this,this.input)},e.prototype.withAgeAndGender=function(){return new aI(this,this.input)},e.prototype.withFaceDescriptor=function(){return new uI(this,this.input)},e}(Aj),Rj=function(n){Gt(e,n);function e(t,r){r===void 0&&(r=new wb);var i=n.call(this)||this;return i.input=t,i.options=r,i}return e}(hy),wwe=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r,i,s;return Ct(this,function(o){switch(o.label){case 0:return t=this,r=t.input,i=t.options,i instanceof xj?[4,Ws.mtcnn.forward(r,i)]:[3,2];case 1:return[2,o.sent().map(function(a){return a.detection})];case 2:if(s=i instanceof bj?function(a){return Ws.tinyFaceDetector.locateFaces(a,i)}:i instanceof wb?function(a){return Ws.ssdMobilenetv1.locateFaces(a,i)}:i instanceof K4?function(a){return Ws.tinyYolov2.locateFaces(a,i)}:null,!s)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,s(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(r){return Tt(t,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return[4,this.run()];case 1:return i=s.sent(),[2,r(i.map(function(o){return U4({},o)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new xwe(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new eI(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new iI(this.runAndExtendWithFaceDetections(),this.input)},e}(Rj),bwe=function(n){Gt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.run=function(){return Tt(this,void 0,void 0,function(){var t,r;return Ct(this,function(i){switch(i.label){case 0:return[4,new wwe(this.input,this.options)];case 1:return t=i.sent(),r=t[0],t.forEach(function(s){s.score>r.score&&(r=s)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(r){return Tt(t,void 0,void 0,function(){var i;return Ct(this,function(s){switch(s.label){case 0:return[4,this.run()];case 1:return i=s.sent(),[2,r(i?U4({},i):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return t===void 0&&(t=!1),new _we(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new tI(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new sI(this.runAndExtendWithFaceDetection(),this.input)},e}(Rj);function Swe(n,e){return e===void 0&&(e=new wb),new bwe(n,e)}function Ewe(n,e){if(n.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var t=Array.from(n),r=Array.from(e);return Math.sqrt(t.map(function(i,s){return i-r[s]}).reduce(function(i,s){return i+Math.pow(s,2)},0))}(function(){function n(e,t){t===void 0&&(t=.6),this._distanceThreshold=t;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var i=1,s=function(){return"person "+i++};this._labeledDescriptors=r.map(function(o){if(o instanceof jx)return o;if(o instanceof Float32Array)return new jx(s(),[o]);if(o.descriptor&&o.descriptor instanceof Float32Array)return new jx(s(),[o.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(e,t){return t.map(function(r){return Ewe(r,e)}).reduce(function(r,i){return r+i},0)/(t.length||1)},n.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(r){var i=r.descriptors,s=r.label;return new vB(s,t.computeMeanDistance(e,i))}).reduce(function(r,i){return r.distance<i.distance?r:i})},n.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new vB("unknown",t.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},n.fromJSON=function(e){var t=e.labeledDescriptors.map(function(r){return jx.fromJSON(r)});return new n(t,e.distanceThreshold)},n})();const Mwe=`
varying vec2 vUv;
void main(){
  vUv = uv;
  gl_Position = vec4(position.xy, 0.0, 1.0);
}
`,Twe=`
precision highp float;
uniform vec3 iResolution;
uniform float iTime;
uniform vec2 uSkew;
uniform float uTilt;
uniform float uYaw;
uniform float uLineThickness;
uniform vec3 uLinesColor;
uniform vec3 uScanColor;
uniform float uGridScale;
uniform float uLineStyle;
uniform float uLineJitter;
uniform float uScanOpacity;
uniform float uScanDirection;
uniform float uNoise;
uniform float uBloomOpacity;
uniform float uScanGlow;
uniform float uScanSoftness;
uniform float uPhaseTaper;
uniform float uScanDuration;
uniform float uScanDelay;
varying vec2 vUv;

uniform float uScanStarts[8];
uniform float uScanCount;

const int MAX_SCANS = 8;

float smoother01(float a, float b, float x){
  float t = clamp((x - a) / max(1e-5, (b - a)), 0.0, 1.0);
  return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}

void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    vec2 p = (2.0 * fragCoord - iResolution.xy) / iResolution.y;

    vec3 ro = vec3(0.0);
    vec3 rd = normalize(vec3(p, 2.0));

    float cR = cos(uTilt), sR = sin(uTilt);
    rd.xy = mat2(cR, -sR, sR, cR) * rd.xy;

    float cY = cos(uYaw), sY = sin(uYaw);
    rd.xz = mat2(cY, -sY, sY, cY) * rd.xz;

    vec2 skew = clamp(uSkew, vec2(-0.7), vec2(0.7));
    rd.xy += skew * rd.z;

    vec3 color = vec3(0.0);
  float minT = 1e20;
  float gridScale = max(1e-5, uGridScale);
    float fadeStrength = 2.0;
    vec2 gridUV = vec2(0.0);

  float hitIsY = 1.0;
    for (int i = 0; i < 4; i++)
    {
        float isY = float(i < 2);
        float pos = mix(-0.2, 0.2, float(i)) * isY + mix(-0.5, 0.5, float(i - 2)) * (1.0 - isY);
        float num = pos - (isY * ro.y + (1.0 - isY) * ro.x);
        float den = isY * rd.y + (1.0 - isY) * rd.x;
        float t = num / den;
        vec3 h = ro + rd * t;

        float depthBoost = smoothstep(0.0, 3.0, h.z);
        h.xy += skew * 0.15 * depthBoost;

    bool use = t > 0.0 && t < minT;
    gridUV = use ? mix(h.zy, h.xz, isY) / gridScale : gridUV;
    minT = use ? t : minT;
    hitIsY = use ? isY : hitIsY;
    }

    vec3 hit = ro + rd * minT;
    float dist = length(hit - ro);

  float jitterAmt = clamp(uLineJitter, 0.0, 1.0);
  if (jitterAmt > 0.0) {
    vec2 j = vec2(
      sin(gridUV.y * 2.7 + iTime * 1.8),
      cos(gridUV.x * 2.3 - iTime * 1.6)
    ) * (0.15 * jitterAmt);
    gridUV += j;
  }
  float fx = fract(gridUV.x);
  float fy = fract(gridUV.y);
  float ax = min(fx, 1.0 - fx);
  float ay = min(fy, 1.0 - fy);
  float wx = fwidth(gridUV.x);
  float wy = fwidth(gridUV.y);
  float halfPx = max(0.0, uLineThickness) * 0.5;

  float tx = halfPx * wx;
  float ty = halfPx * wy;

  float aax = wx;
  float aay = wy;

  float lineX = 1.0 - smoothstep(tx, tx + aax, ax);
  float lineY = 1.0 - smoothstep(ty, ty + aay, ay);
  if (uLineStyle > 0.5) {
    float dashRepeat = 4.0;
    float dashDuty = 0.5;
    float vy = fract(gridUV.y * dashRepeat);
    float vx = fract(gridUV.x * dashRepeat);
    float dashMaskY = step(vy, dashDuty);
    float dashMaskX = step(vx, dashDuty);
    if (uLineStyle < 1.5) {
      lineX *= dashMaskY;
      lineY *= dashMaskX;
    } else {
      float dotRepeat = 6.0;
      float dotWidth = 0.18;
      float cy = abs(fract(gridUV.y * dotRepeat) - 0.5);
      float cx = abs(fract(gridUV.x * dotRepeat) - 0.5);
      float dotMaskY = 1.0 - smoothstep(dotWidth, dotWidth + fwidth(gridUV.y * dotRepeat), cy);
      float dotMaskX = 1.0 - smoothstep(dotWidth, dotWidth + fwidth(gridUV.x * dotRepeat), cx);
      lineX *= dotMaskY;
      lineY *= dotMaskX;
    }
  }
  float primaryMask = max(lineX, lineY);

  vec2 gridUV2 = (hitIsY > 0.5 ? hit.xz : hit.zy) / gridScale;
  if (jitterAmt > 0.0) {
    vec2 j2 = vec2(
      cos(gridUV2.y * 2.1 - iTime * 1.4),
      sin(gridUV2.x * 2.5 + iTime * 1.7)
    ) * (0.15 * jitterAmt);
    gridUV2 += j2;
  }
  float fx2 = fract(gridUV2.x);
  float fy2 = fract(gridUV2.y);
  float ax2 = min(fx2, 1.0 - fx2);
  float ay2 = min(fy2, 1.0 - fy2);
  float wx2 = fwidth(gridUV2.x);
  float wy2 = fwidth(gridUV2.y);
  float tx2 = halfPx * wx2;
  float ty2 = halfPx * wy2;
  float aax2 = wx2;
  float aay2 = wy2;
  float lineX2 = 1.0 - smoothstep(tx2, tx2 + aax2, ax2);
  float lineY2 = 1.0 - smoothstep(ty2, ty2 + aay2, ay2);
  if (uLineStyle > 0.5) {
    float dashRepeat2 = 4.0;
    float dashDuty2 = 0.5;
    float vy2m = fract(gridUV2.y * dashRepeat2);
    float vx2m = fract(gridUV2.x * dashRepeat2);
    float dashMaskY2 = step(vy2m, dashDuty2);
    float dashMaskX2 = step(vx2m, dashDuty2);
    if (uLineStyle < 1.5) {
      lineX2 *= dashMaskY2;
      lineY2 *= dashMaskX2;
    } else {
      float dotRepeat2 = 6.0;
      float dotWidth2 = 0.18;
      float cy2 = abs(fract(gridUV2.y * dotRepeat2) - 0.5);
      float cx2 = abs(fract(gridUV2.x * dotRepeat2) - 0.5);
      float dotMaskY2 = 1.0 - smoothstep(dotWidth2, dotWidth2 + fwidth(gridUV2.y * dotRepeat2), cy2);
      float dotMaskX2 = 1.0 - smoothstep(dotWidth2, dotWidth2 + fwidth(gridUV2.x * dotRepeat2), cx2);
      lineX2 *= dotMaskY2;
      lineY2 *= dotMaskX2;
    }
  }
    float altMask = max(lineX2, lineY2);

    float edgeDistX = min(abs(hit.x - (-0.5)), abs(hit.x - 0.5));
    float edgeDistY = min(abs(hit.y - (-0.2)), abs(hit.y - 0.2));
    float edgeDist = mix(edgeDistY, edgeDistX, hitIsY);
    float edgeGate = 1.0 - smoothstep(gridScale * 0.5, gridScale * 2.0, edgeDist);
    altMask *= edgeGate;

  float lineMask = max(primaryMask, altMask);

    float fade = exp(-dist * fadeStrength);

    float dur = max(0.05, uScanDuration);
    float del = max(0.0, uScanDelay);
    float scanZMax = 2.0;
    float widthScale = max(0.1, uScanGlow);
    float sigma = max(0.001, 0.18 * widthScale * uScanSoftness);
    float sigmaA = sigma * 2.0;

    float combinedPulse = 0.0;
    float combinedAura = 0.0;

    float cycle = dur + del;
    float tCycle = mod(iTime, cycle);
    float scanPhase = clamp((tCycle - del) / dur, 0.0, 1.0);
    float phase = scanPhase;
    if (uScanDirection > 0.5 && uScanDirection < 1.5) {
      phase = 1.0 - phase;
    } else if (uScanDirection > 1.5) {
      float t2 = mod(max(0.0, iTime - del), 2.0 * dur);
      phase = (t2 < dur) ? (t2 / dur) : (1.0 - (t2 - dur) / dur);
    }
    float scanZ = phase * scanZMax;
    float dz = abs(hit.z - scanZ);
    float lineBand = exp(-0.5 * (dz * dz) / (sigma * sigma));
    float taper = clamp(uPhaseTaper, 0.0, 0.49);
    float headW = taper;
    float tailW = taper;
    float headFade = smoother01(0.0, headW, phase);
    float tailFade = 1.0 - smoother01(1.0 - tailW, 1.0, phase);
    float phaseWindow = headFade * tailFade;
    float pulseBase = lineBand * phaseWindow;
    combinedPulse += pulseBase * clamp(uScanOpacity, 0.0, 1.0);
    float auraBand = exp(-0.5 * (dz * dz) / (sigmaA * sigmaA));
    combinedAura += (auraBand * 0.25) * phaseWindow * clamp(uScanOpacity, 0.0, 1.0);

    for (int i = 0; i < MAX_SCANS; i++) {
      if (float(i) >= uScanCount) break;
      float tActiveI = iTime - uScanStarts[i];
      float phaseI = clamp(tActiveI / dur, 0.0, 1.0);
      if (uScanDirection > 0.5 && uScanDirection < 1.5) {
        phaseI = 1.0 - phaseI;
      } else if (uScanDirection > 1.5) {
        phaseI = (phaseI < 0.5) ? (phaseI * 2.0) : (1.0 - (phaseI - 0.5) * 2.0);
      }
      float scanZI = phaseI * scanZMax;
      float dzI = abs(hit.z - scanZI);
      float lineBandI = exp(-0.5 * (dzI * dzI) / (sigma * sigma));
      float headFadeI = smoother01(0.0, headW, phaseI);
      float tailFadeI = 1.0 - smoother01(1.0 - tailW, 1.0, phaseI);
      float phaseWindowI = headFadeI * tailFadeI;
      combinedPulse += lineBandI * phaseWindowI * clamp(uScanOpacity, 0.0, 1.0);
      float auraBandI = exp(-0.5 * (dzI * dzI) / (sigmaA * sigmaA));
      combinedAura += (auraBandI * 0.25) * phaseWindowI * clamp(uScanOpacity, 0.0, 1.0);
    }

  float lineVis = lineMask;
  vec3 gridCol = uLinesColor * lineVis * fade;
  vec3 scanCol = uScanColor * combinedPulse;
  vec3 scanAura = uScanColor * combinedAura;

    color = gridCol + scanCol + scanAura;

  float n = fract(sin(dot(gl_FragCoord.xy + vec2(iTime * 123.4), vec2(12.9898,78.233))) * 43758.5453123);
  color += (n - 0.5) * uNoise;
  color = clamp(color, 0.0, 1.0);
  float alpha = clamp(max(lineVis, combinedPulse), 0.0, 1.0);
  float gx = 1.0 - smoothstep(tx * 2.0, tx * 2.0 + aax * 2.0, ax);
  float gy = 1.0 - smoothstep(ty * 2.0, ty * 2.0 + aay * 2.0, ay);
  float halo = max(gx, gy) * fade;
  alpha = max(alpha, halo * clamp(uBloomOpacity, 0.0, 1.0));
  fragColor = vec4(color, alpha);
}

void main(){
  vec4 c;
  mainImage(c, vUv * iResolution.xy);
  gl_FragColor = c;
}
`,Cwe=({enableWebcam:n=!1,showPreview:e=!1,modelsPath:t="https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@0.22.2/weights",sensitivity:r=.55,lineThickness:i=1,linesColor:s="#392e4e",scanColor:o="#FF9FFC",scanOpacity:a=.4,gridScale:l=.1,lineStyle:u="solid",lineJitter:c=.1,scanDirection:f="pingpong",enablePost:h=!0,bloomIntensity:d=0,bloomThreshold:p=0,bloomSmoothing:y=0,chromaticAberration:x=.002,noiseIntensity:m=.01,scanGlow:_=.5,scanSoftness:w=2,scanPhaseTaper:b=.9,scanDuration:S=2,scanDelay:M=2,enableGyro:T=!1,scanOnClick:P=!1,snapBackDelay:C=250,className:A,style:k})=>{const L=U.useRef(null),H=U.useRef(null),F=U.useRef(null),V=U.useRef(null),W=U.useRef(null),G=U.useRef(null),N=U.useRef(null),B=U.useRef(null),[D,$]=U.useState(!1),[ee,te]=U.useState(!1),se=U.useRef(new Me(0,0)),me=U.useRef(0),_e=U.useRef(0),pe=U.useRef(new Me(0,0)),Ne=U.useRef(new Me(0,0)),Ue=U.useRef(0),We=U.useRef(0),Be=U.useRef(0),J=U.useRef(0),he=8,de=U.useRef([]),Ie=Pe=>{const De=de.current.slice();if(De.length>=he&&De.shift(),De.push(Pe),de.current=De,V.current){const Ae=V.current.uniforms,ht=new Array(he).fill(0);for(let Ze=0;Ze<De.length&&Ze<he;Ze++)ht[Ze]=De[Ze];Ae.uScanStarts.value=ht,Ae.uScanCount.value=De.length}},ve=U.useRef([]),oe=U.useRef([]),ze=U.useRef([]),X=U.useRef([]),j=uo.clamp(r,0,1),ae=uo.lerp(.06,.2,j),Oe=uo.lerp(.12,.3,j),Se=uo.lerp(.1,.28,j),K=uo.lerp(.25,.45,j),ge=uo.lerp(.45,.12,j),Te=1/0,Le=uo.lerp(1.2,1.6,j);return U.useEffect(()=>{const Pe=L.current;if(!Pe)return;let De=null;const Ae=Qe=>{if(ee)return;De&&(clearTimeout(De),De=null);const $e=Pe.getBoundingClientRect(),Dt=(Qe.clientX-$e.left)/$e.width*2-1,Ft=-((Qe.clientY-$e.top)/$e.height*2-1);se.current.set(Dt,Ft)},ht=async()=>{const Qe=performance.now()/1e3;if(P&&Ie(Qe),T&&typeof window<"u"&&window.DeviceOrientationEvent&&DeviceOrientationEvent.requestPermission)try{await DeviceOrientationEvent.requestPermission()}catch{}},Ze=()=>{De&&(clearTimeout(De),De=null)},at=()=>{ee||(De&&clearTimeout(De),De=window.setTimeout(()=>{se.current.set(0,0),me.current=0,_e.current=0},Math.max(0,C||0)))};return Pe.addEventListener("mousemove",Ae),Pe.addEventListener("mouseenter",Ze),P&&Pe.addEventListener("click",ht),Pe.addEventListener("mouseleave",at),()=>{Pe.removeEventListener("mousemove",Ae),Pe.removeEventListener("mouseenter",Ze),Pe.removeEventListener("mouseleave",at),P&&Pe.removeEventListener("click",ht),De&&clearTimeout(De)}},[ee,C,P,T]),U.useEffect(()=>{const Pe=L.current;if(!Pe)return;const De=new xm({antialias:!0,alpha:!0});F.current=De,De.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),De.setSize(Pe.clientWidth,Pe.clientHeight),De.outputColorSpace=mn,De.toneMapping=ka,De.autoClear=!1,De.setClearColor(0,0),Pe.appendChild(De.domElement);const Ae={iResolution:{value:new Q(Pe.clientWidth,Pe.clientHeight,De.getPixelRatio())},iTime:{value:0},uSkew:{value:new Me(0,0)},uTilt:{value:0},uYaw:{value:0},uLineThickness:{value:i},uLinesColor:{value:Kx(s)},uScanColor:{value:Kx(o)},uGridScale:{value:l},uLineStyle:{value:u==="dashed"?1:u==="dotted"?2:0},uLineJitter:{value:Math.max(0,Math.min(1,c||0))},uScanOpacity:{value:a},uNoise:{value:m},uBloomOpacity:{value:d},uScanGlow:{value:_},uScanSoftness:{value:w},uPhaseTaper:{value:b},uScanDuration:{value:S},uScanDelay:{value:M},uScanDirection:{value:f==="backward"?1:f==="pingpong"?2:0},uScanStarts:{value:new Array(he).fill(0)},uScanCount:{value:0}},ht=new $r({uniforms:Ae,vertexShader:Mwe,fragmentShader:Twe,transparent:!0,depthWrite:!1,depthTest:!1});V.current=ht;const Ze=new mu,at=new qc(-1,1,1,-1,0,1),Qe=new Qn(new yl(2,2),ht);Ze.add(Qe);let $e=null;if(h){$e=new qpe(De),W.current=$e;const Ke=new Kme(Ze,at);$e.addPass(Ke);const He=new Xme({intensity:1,luminanceThreshold:p,luminanceSmoothing:y});He.blendMode.opacity.value=Math.max(0,d),G.current=He;const re=new Yme({offset:new Me(x,x),radialModulation:!0,modulationOffset:0});N.current=re;const je=new t0e(at,He,re);je.renderToScreen=!0,$e.addPass(je)}const Dt=()=>{De.setSize(Pe.clientWidth,Pe.clientHeight),ht.uniforms.iResolution.value.set(Pe.clientWidth,Pe.clientHeight,De.getPixelRatio()),W.current&&W.current.setSize(Pe.clientWidth,Pe.clientHeight)};window.addEventListener("resize",Dt);let Ft=performance.now();const sn=()=>{const Ke=performance.now(),He=Math.max(0,Math.min(.1,(Ke-Ft)/1e3));Ft=Ke,pe.current.copy(Awe(pe.current,se.current,Ne.current,ge,Te,He));const re=SB(Ue.current,me.current,{v:We.current},ge,Te,He);Ue.current=re.value,We.current=re.v;const je=SB(Be.current,_e.current,{v:J.current},ge,Te,He);Be.current=je.value,J.current=je.v;const qe=new Me(pe.current.x*ae,-pe.current.y*Le*ae);ht.uniforms.uSkew.value.set(qe.x,qe.y),ht.uniforms.uTilt.value=Ue.current*Oe,ht.uniforms.uYaw.value=uo.clamp(Be.current*Se,-.6,.6),ht.uniforms.iTime.value=Ke/1e3,De.clear(!0,!0,!0),W.current?W.current.render(He):De.render(Ze,at),B.current=requestAnimationFrame(sn)};return B.current=requestAnimationFrame(sn),()=>{B.current&&cancelAnimationFrame(B.current),window.removeEventListener("resize",Dt),ht.dispose(),Qe.geometry.dispose(),W.current&&(W.current.dispose(),W.current=null),De.dispose(),Pe.removeChild(De.domElement)}},[r,i,s,o,a,l,u,c,f,h,m,d,_,w,b,S,M,p,y,x,ge,Te,ae,Le,Oe,Se]),U.useEffect(()=>{const Pe=V.current;if(Pe){const De=Pe.uniforms;De.uLineThickness.value=i,De.uLinesColor.value.copy(Kx(s)),De.uScanColor.value.copy(Kx(o)),De.uGridScale.value=l,De.uLineStyle.value=u==="dashed"?1:u==="dotted"?2:0,De.uLineJitter.value=Math.max(0,Math.min(1,c||0)),De.uBloomOpacity.value=Math.max(0,d),De.uNoise.value=Math.max(0,m),De.uScanGlow.value=_,De.uScanOpacity.value=Math.max(0,Math.min(1,a)),De.uScanDirection.value=f==="backward"?1:f==="pingpong"?2:0,De.uScanSoftness.value=w,De.uPhaseTaper.value=b,De.uScanDuration.value=Math.max(.05,S),De.uScanDelay.value=Math.max(0,M)}G.current&&(G.current.blendMode.opacity.value=Math.max(0,d),G.current.luminanceMaterial.threshold=p,G.current.luminanceMaterial.smoothing=y),N.current&&N.current.offset.set(x,x)},[i,s,o,l,u,c,d,p,y,x,m,_,a,f,w,b,S,M]),U.useEffect(()=>{if(!T)return;const Pe=De=>{if(ee)return;const Ae=De.gamma??0,ht=De.beta??0,Ze=uo.clamp(Ae/45,-1,1),at=uo.clamp(-ht/30,-1,1);se.current.set(Ze,at),me.current=uo.degToRad(Ae)*.4};return window.addEventListener("deviceorientation",Pe),()=>{window.removeEventListener("deviceorientation",Pe)}},[T,ee]),U.useEffect(()=>{let Pe=!1;return(async()=>{try{await Promise.all([Ws.tinyFaceDetector.loadFromUri(t),Ws.faceLandmark68TinyNet.loadFromUri(t)]),Pe||$(!0)}catch{Pe||$(!1)}})(),()=>{Pe=!0}},[t]),U.useEffect(()=>{let Pe=!1,De=0;const Ae=H.current;return(async()=>{if(!n||!D||!Ae)return;try{const Qe=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}},audio:!1});Ae.srcObject=Qe,await Ae.play()}catch{return}const Ze=new bj({inputSize:320,scoreThreshold:.5}),at=async Qe=>{if(!Pe){if(Qe-De>=33){De=Qe;try{const $e=await Swe(Ae,Ze).withFaceLandmarks(!0);if($e&&$e.detection){const Ft=$e.detection.box,sn=Ae.videoWidth||1,Ke=Ae.videoHeight||1,He=Ft.x+Ft.width*.5,re=Ft.y+Ft.height*.5,je=He/sn*2-1,qe=re/Ke*2-1;Zx(ve.current,je,5),Zx(oe.current,qe,5);const At=Jx(ve.current),_t=Jx(oe.current),Jt=new Me(Math.tanh(At),Math.tanh(_t)),cn=Math.min(1,Math.hypot(Ft.width/sn,Ft.height/Ke)),ut=1+K*(cn-.25);se.current.copy(Jt.multiplyScalar(ut));const ot=$e.landmarks.getLeftEye(),xt=$e.landmarks.getRightEye(),Ge=EB(ot),wt=EB(xt),Et=Math.atan2(wt.y-Ge.y,wt.x-Ge.x);Zx(ze.current,Et,5),me.current=Jx(ze.current);const kt=$e.landmarks.getNose(),Bn=kt[kt.length-1]||kt[Math.floor(kt.length/2)],Bt=$e.landmarks.getJawOutline(),In=Bt[3]||Bt[2],ir=Bt[13]||Bt[14],Ln=MB(Bn,In),Dn=MB(Bn,ir),_n=Math.hypot(wt.x-Ge.x,wt.y-Ge.y)+1e-6;let qr=uo.clamp((Dn-Ln)/(_n*1.6),-1,1);qr=Math.tanh(qr),Zx(X.current,qr,5),_e.current=Jx(X.current),te(!0)}else te(!1)}catch{te(!1)}}"requestVideoFrameCallback"in HTMLVideoElement.prototype?Ae.requestVideoFrameCallback(()=>at(performance.now())):requestAnimationFrame(at)}};requestAnimationFrame(at)})(),()=>{if(Pe=!0,Ae){const Ze=Ae.srcObject;Ze&&Ze.getTracks().forEach(at=>at.stop()),Ae.pause(),Ae.srcObject=null}}},[n,D,K]),z.jsx("div",{ref:L,className:`relative w-full h-full overflow-hidden ${A??""}`,style:k,children:e&&z.jsxs("div",{className:"absolute right-3 bottom-3 w-[220px] h-[132px] rounded-lg overflow-hidden border border-white/25 shadow-[0_4px_16px_rgba(0,0,0,0.4)] bg-black text-white text-[12px] leading-[1.2] font-sans pointer-events-none",children:[z.jsx("video",{ref:H,muted:!0,playsInline:!0,autoPlay:!0,className:"w-full h-full object-cover -scale-x-100"}),z.jsx("div",{className:"absolute left-2 top-2 px-[6px] py-[2px] bg-black/50 rounded-[6px] backdrop-blur-[4px]",children:n?D?ee?"Face: tracking":"Face: searching":"Loading models":"Webcam disabled"})]})})};function Kx(n){return new it(n).convertSRGBToLinear()}function Awe(n,e,t,r,i,s){const o=n.clone();r=Math.max(1e-4,r);const a=2/r,l=a*s,u=1/(1+l+.48*l*l+.235*l*l*l);let c=n.clone().sub(e);const f=e.clone(),h=i*r;c.length()>h&&c.setLength(h),e=n.clone().sub(c);const d=t.clone().addScaledVector(c,a).multiplyScalar(s);t.sub(d.clone().multiplyScalar(a)),t.multiplyScalar(u),o.copy(e.clone().add(c.add(d).multiplyScalar(u)));const p=f.clone().sub(n),y=o.clone().sub(f);return p.dot(y)>0&&(o.copy(f),t.set(0,0)),o}function SB(n,e,t,r,i,s){r=Math.max(1e-4,r);const o=2/r,a=o*s,l=1/(1+a+.48*a*a+.235*a*a*a);let u=n-e;const c=e,f=i*r;u=Math.sign(u)*Math.min(Math.abs(u),f),e=n-u;const h=(t.v+o*u)*s;t.v=(t.v-o*h)*l;let d=e+(u+h)*l;const p=c-n,y=d-c;return p*y>0&&(d=c,t.v=0),{value:d,v:t.v}}function Zx(n,e,t){n.push(e),n.length>t&&n.shift()}function Jx(n){if(n.length===0)return 0;const e=[...n].sort((r,i)=>r-i),t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])*.5}function EB(n){let e=0,t=0;const r=n.length||1;for(const i of n)e+=i.x,t+=i.y;return{x:e/r,y:t/r}}function MB(n,e){return Math.hypot(n.x-e.x,n.y-e.y)}const Rwe=({onLoadComplete:n,isMobile:e=!1})=>{const[t,r]=U.useState(0),[i,s]=U.useState("Initializing..."),[o,a]=U.useState(!1);return U.useEffect(()=>{let h=0;const d=setInterval(()=>{h+=1.25,h>=100?(h=100,clearInterval(d),s("Complete!"),setTimeout(()=>{a(!0),setTimeout(()=>{n&&n()},800)},300)):h<30?s("Initializing..."):h<60?s("Loading assets..."):h<90?s("Almost there..."):s("Finalizing..."),r(Math.min(h,100))},50);return()=>clearInterval(d)},[n]),z.jsxs("div",{className:`loader-container ${o?"loader-exit":""}`,children:[z.jsx("div",{className:"absolute inset-0 z-0",children:z.jsx(Cwe,{sensitivity:.55,lineThickness:1,linesColor:"#1a1a2e",gridScale:.1,scanColor:"#FF9FFC",scanOpacity:.4,enablePost:!0,bloomIntensity:.6,chromaticAberration:.002,noiseIntensity:.01})}),z.jsxs("div",{className:"loader-content",children:[z.jsxs("div",{className:"brand-container",children:[z.jsx("h1",{className:"brand-name",children:"Mayank Kumar"}),z.jsx("p",{className:"brand-subtitle",children:"Portfolio"})]}),z.jsx("div",{className:"progress-container",children:z.jsx("div",{className:"progress-bar-wrapper",children:z.jsx("div",{className:"progress-bar-bg",children:z.jsx("div",{className:"progress-bar-fill",style:{width:`${t}%`}})})})}),z.jsxs("div",{className:"loading-dots",children:[z.jsx("span",{className:"dot"}),z.jsx("span",{className:"dot"}),z.jsx("span",{className:"dot"})]})]}),z.jsx("div",{className:"corner-decoration top-left"}),z.jsx("div",{className:"corner-decoration top-right"}),z.jsx("div",{className:"corner-decoration bottom-left"}),z.jsx("div",{className:"corner-decoration bottom-right"})]})},Pwe=({onDismiss:n})=>{const[e,t]=U.useState(!0),[r,i]=U.useState(!1),s=()=>{i(!0),setTimeout(()=>{t(!1),sessionStorage.setItem("mobileAlertDismissed","true"),n&&n()},300)};return e?z.jsxs("div",{className:`fixed inset-0 z-[10000] flex items-center justify-center bg-[#0a0a0f]/98 backdrop-blur-xl transition-opacity duration-300 ${r?"opacity-0":"opacity-100"}`,children:[z.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[z.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-primary/10 rounded-full blur-3xl animate-pulse"}),z.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-64 h-64 bg-secondary/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),z.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-tertiary/5 rounded-full blur-3xl animate-pulse",style:{animationDelay:"0.5s"}})]}),z.jsxs("div",{className:"relative z-10 px-8 py-12 max-w-sm mx-4 text-center",children:[z.jsx("div",{className:"mb-8 flex justify-center",children:z.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-primary/20 to-secondary/20 border border-primary/30 flex items-center justify-center",children:z.jsx("svg",{className:"w-10 h-10 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})}),z.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-primary via-secondary to-tertiary bg-clip-text text-transparent mb-4",children:"Desktop Recommended"}),z.jsx("p",{className:"text-gray-400 text-base leading-relaxed mb-10",children:"For the best experience, please open this website on a laptop or desktop."}),z.jsx("button",{onClick:s,className:"px-8 py-4 rounded-full bg-gradient-to-r from-surface/80 to-surface-light/80 border border-white/10 text-gray-300 font-medium text-sm transition-all duration-300 hover:border-primary/30 hover:text-white active:scale-95",children:"Ruin My Experience"})]})]}):null},Iwe=()=>{const[n,e]=U.useState(!1);return U.useEffect(()=>{const t=()=>{e(window.innerWidth<=768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),n};function Dwe(){Ba();const n=Iwe(),[e,t]=U.useState(()=>typeof window>"u"?!1:!sessionStorage.getItem("mobileAlertDismissed")&&window.innerWidth<=768),[r,i]=U.useState(()=>{const a=window.location.pathname==="/",l=sessionStorage.getItem("loaderShown"),u=sessionStorage.getItem("mobileAlertDismissed");return window.innerWidth<=768&&!u?!1:a&&!l});U.useEffect(()=>{r&&sessionStorage.setItem("loaderShown","true")},[r]);const s=()=>{i(!1)},o=()=>{t(!1);const a=window.location.pathname==="/",l=sessionStorage.getItem("loaderShown");a&&!l&&i(!0)};return e&&n?z.jsx(Pwe,{onDismiss:o}):r?z.jsx(Rwe,{onLoadComplete:s,isMobile:n}):z.jsxs("div",{className:`w-full min-h-screen bg-[#0a0a0f] ${n?"overflow-y-auto overflow-x-hidden":"h-screen overflow-hidden"}`,children:[!n&&z.jsx(zpe,{}),n?z.jsx(Upe,{}):z.jsx(Bpe,{}),z.jsxs(GY,{children:[z.jsx(kd,{path:"/",element:z.jsx(afe,{})}),z.jsx(kd,{path:"/about",element:z.jsx(ffe,{})}),z.jsx(kd,{path:"/projects",element:z.jsx(Ope,{})}),z.jsx(kd,{path:"/skills",element:z.jsx(kde,{})}),z.jsx(kd,{path:"/contact",element:z.jsx(rde,{})})]})]})}function Nwe(){return z.jsx(pK,{children:z.jsx(Dwe,{})})}z6(document.getElementById("root")).render(z.jsx(U.StrictMode,{children:z.jsx(Nwe,{})}))});export default kwe();
